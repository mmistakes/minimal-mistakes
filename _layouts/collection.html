---
layout: archive
---

{{ content }}

{% assign entries_layout = page.entries_layout | default: 'list' %}

{%- if page.collection == "people" -%}

  {%- assign faculty = site.people  | where: "role", "faculty" | sort: "title" -%}
  {%- assign students = site.people | where: "role", "student" | sort: "title" -%}
  {%- assign guests  = site.people  | where: "role", "guest"   | sort: "title" -%}
  {%- assign alumni  = site.people  | where: "role", "alumni"  | sort: "title" -%}

  {%- assign faculty_count = faculty | size -%}
  {%- if faculty_count > 0 -%}
    <h2 id="faculty">Faculty</h2>
    <div class="people-grid">
      {%- for post in faculty -%}
        {% include person-card.html %}
      {%- endfor -%}
    </div>
  {%- endif -%}

  {%- assign students_count = students | size -%}
  {%- if students_count > 0 -%}
    <h2 id="students">Students</h2>
    <div class="people-grid">
      {%- for post in students -%}
        {% include person-card.html %}
      {%- endfor -%}
    </div>
  {%- endif -%}

  {%- assign guests_count = guests | size -%}
  {%- if guests_count > 0 -%}
    <h2 id="guests">Guests</h2>
    <div class="people-grid">
      {%- for post in guests -%}
        {% include person-card.html %}
      {%- endfor -%}
    </div>
  {%- endif -%}

{%- assign alumni_count = alumni | size -%}
{%- if alumni_count > 0 -%}
  <h2 id="alumni">Alumni</h2>
  <ul class="alumni-list">
    {%- assign alumni_sorted = alumni | sort: "grad_year" | reverse -%}
    {%- for post in alumni_sorted -%}
      <li>
        <a href="{{ post.url | relative_url }}">{{ post.first_name }} {{ post.last_name }}</a>
        {%- if post.role_title %} â€” {{ post.role_title }}{%- endif -%}
        {%- if post.grad_year %} (graduated {{ post.grad_year }}){%- endif -%}
      </li>
    {%- endfor -%}
  </ul>
{%- endif -%}
  

{%- elsif page.collection == "publications" -%}

  {%- comment -%} Build filter controls: unique types from the publications collection {%- endcomment -%}
  {%- assign all_pubs = site.publications -%}
  {%- assign types = all_pubs | map: 'type' | uniq | sort -%}

  <style>
    /* Filter controls styling */
    .pub-container{ margin-inline:auto; width:100%; max-width: var(--site-max-width, 1100px); }
    .pub-filters{ display:flex; gap:1.25rem; align-items:center; flex-wrap:wrap; margin-bottom:1rem; width:100% }
    .pub-filters label{ margin-right:.5rem; font-weight:600 }
    .pub-filter-type{ display:flex; align-items:center; gap:.5rem }
    .pub-filter-type label{ margin:0 }

    /* Move type + controls inline on wide screens */
    @media (min-width:640px){
      .pub-filters{ flex-wrap:nowrap }
      .pub-filter-type{ margin-right:1rem }
    }
  </style>

  <style>
    /* Checkbox styling for type filter: horizontal layout */
    .filter-checkboxes{
      display:flex;
      gap:0.5rem;
      align-items:center;
      flex-wrap:wrap; /* allow wrapping by default */
      overflow-x:auto; /* allow horizontal scroll on narrow screens */
      -webkit-overflow-scrolling: touch;
      padding-bottom: 0.25rem;
    }
    .filter-checkboxes::-webkit-scrollbar{ height: 8px }
    .pub-type-choice{ white-space:nowrap; display:inline-flex; align-items:center; gap:0.35rem; font-size:0.95rem }
    .pub-type-choice input{ transform:translateY(1px) }

    /* Keep choices on a single line on medium+ screens */
    @media (min-width:640px){
      .filter-checkboxes{ flex-wrap:nowrap }
    }
    /* Force wrap into second row when container width is very small */
    @media (max-width:200px){
      .filter-checkboxes{ flex-wrap:wrap; gap:0.35rem }
      .pub-type-choice{ font-size:0.9rem }
    }
  </style>

  <div class="pub-container wrapper">
    <div class="pub-filters">
      <div class="pub-filter-type">
        <span class="filter-label">Type:</span>
        <div class="filter-checkboxes">
          {%- for t in types -%}
            {%- if t and t != "" -%}
              <label class="pub-type-choice"><input type="checkbox" name="pub-filter-type[]" value="{{ t }}"> {{ t | capitalize }}</label>
            {%- endif -%}
          {%- endfor -%}
        </div>
      </div>
      <div class="pub-order-control" style="margin-left:auto; display:flex; align-items:center; gap:.5rem">
        <label for="pub-order-toggle" class="filter-label">Order:</label>
        <button id="pub-order-toggle" class="btn" aria-pressed="false" title="Toggle publications order">Newest first</button>
      </div>
    </div>

    <div id="publications-list">
    {%- comment -%} Output publications with a year first (sorted by year), then those without a year {%- endcomment -%}
    {%- assign with_year_items = all_pubs | where_exp: "p", "p.year" -%}
    {%- assign without_year_items = all_pubs | where_exp: "p", "p.year == nil" -%}
    {%- assign sorted_with_year = with_year_items | sort: "year" | reverse -%}
    {%- for post in sorted_with_year -%}
      {% include archive-single.html type=entries_layout %}
    {%- endfor -%}
    {%- for post in without_year_items -%}
      {% include archive-single.html type=entries_layout %}
    {%- endfor -%}
    </div>
  </div>

  <script>
    // Simple client-side filter for publications listing by type only
    (function(){
      var typeCheckboxes = Array.prototype.slice.call(document.querySelectorAll('input[name="pub-filter-type[]"]'));
      var list = document.getElementById('publications-list');

      function getSelectedTypes(){
        return typeCheckboxes.filter(function(cb){ return cb.checked; }).map(function(cb){ return cb.value; });
      }

      function applyFilters(){
        var selectedTypes = getSelectedTypes();
        // Only inspect direct children of the publications list to avoid matching inner elements twice
        var items = Array.prototype.slice.call(list.children).filter(function(el){ return el.hasAttribute && el.hasAttribute('data-year'); });
        items.forEach(function(el){
          var elType = (el.getAttribute('data-type') || '').toString();
          var match = true;
          // If there are selected types, require the element's type to be one of them
          if(selectedTypes && selectedTypes.length > 0){ 
            if(selectedTypes.indexOf(elType) === -1) match = false; 
          }
          el.style.display = match ? '' : 'none';
        });
      }

      // Wire type checkboxes to filters
      if(typeCheckboxes && typeCheckboxes.length > 0){
        typeCheckboxes.forEach(function(cb){ 
          cb.addEventListener('change', function(){ applyFilters(); }); 
        });
      }

      // Expose for other scripts (ordering toggle) to call
      window.applyFilters = applyFilters;
    })();
  </script>

  <script>
    // Ordering toggle for publications list. This reverses the DOM children in-place
    // and stores the state in the `order` query param (order=reverse). Default is newest-first.
    (function(){
      var btn = document.getElementById('pub-order-toggle');
      var list = document.getElementById('publications-list');
      if(!btn || !list) return;

      function getQueryParam(name){
        var params = new URLSearchParams(window.location.search);
        return params.get(name);
      }

      function setQueryParam(name, value){
        var url = new URL(window.location.href);
        var params = url.searchParams;
        if(value === null){ params.delete(name); } else { params.set(name, value); }
        // Use pushState to avoid reload
        window.history.pushState({}, '', url.pathname + (params.toString() ? ('?' + params.toString()) : '') + url.hash);
      }

      function reverseList(){
        // Reverse only direct children to preserve structure
        var children = Array.prototype.slice.call(list.children);
        for(var i = children.length - 1; i >= 0; i--){
          list.appendChild(children[i]);
        }
      }

      function setButtonState(reversed){
        btn.setAttribute('aria-pressed', reversed ? 'true' : 'false');
        btn.textContent = reversed ? 'Oldest first' : 'Newest first';
      }

      // Initialize from URL
      var isReverse = (getQueryParam('order') === 'reverse');
      if(isReverse){ reverseList(); }
      setButtonState(isReverse);

      btn.addEventListener('click', function(e){
        e.preventDefault();
        // Toggle
        isReverse = !isReverse;
        reverseList();
        setButtonState(isReverse);
        setQueryParam('order', isReverse ? 'reverse' : null);
        // Re-apply filters to respect visibility rules after reordering
        if(window.applyFilters) try{ window.applyFilters(); } catch(e){}
      });
    })();
  </script>

{%- else -%}

  <div class="entries-{{ entries_layout }}">
    {%- assign items = site[page.collection] -%}
    {%- for post in items -%}
      {% include archive-single.html type=entries_layout %}
    {%- endfor -%}
  </div>

{%- endif -%}