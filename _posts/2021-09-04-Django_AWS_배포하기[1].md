---

layout: single

title: "Django(장고)기반 애플리케이션 AWS EC2로 배포하는 방법 - [1] 배포할 Django 프로젝트 준비"

date: 2020-09-04

---



> Django 프로젝트를 팀원과 협업하기 편하게 github에 업로드 후 AWS로 배포하는 과정을 남겨 보았습니다.
>
> 개인 공부 후 남기는 내용이므로 오류가 있으면 지적 부탁드립니다. 
>
> 현재 Django 프로젝트는 Window 운영체제에서 운영 중이며 이를 AWS EC2 서버 (Ubuntu 18.04 LTS) 로 배포중 dependency문제가 생겨 이를 어떻게 해결했는지 설명 남겼습니다. (이부분은 생각보다 문제 있던 분들이 없었던 까닭인지 googling 을 많이 해서 발견했습니다 ㅠㅠ)
>
> 저도 처음 스터디시 [네로의 다락방](https://nerogarret.tistory.com/)을 많이 참고하여 많은 내용이 겹치지만 대부분 Django 프로젝트를 배포하는 내용을 담은 블로그 작성자 분들은 대부분 Unix계열 기반의 운영체제에서 배포를 하셔서 Window 운영체제에서 Django 프로젝트를 시작시 배포때 생기는 문제가 없으신거 같아 글을 남겨보려 합니다!
>
> 장고의 views, urls 와 같은 요소들의 사용법은 알고 계시다는 가정하에 읽어 주시면 감사하겠습니다 :)
>
> (작동 방법이 어렵지 않아서 제가 적어놓은 것만 보셔도 이해 되실꺼라 믿습니다!)
>
> **목표**: AWS EC2 서버에 Django 프로젝트를 실행 시키기



# 배포 준비 순서

1. **[배포할 Django 프로젝트 준비](#1-배포할-django-프로젝트-준비)**
   1. **[가상 환경 준비](#1-가상-환경-준비)**
   2. **[Django 프로젝트 만들기](#2-django-프로젝트-만들기)**
   3. **[requirements.txt 만들기](#3-requirementstxt-만들기)**
2. AWS EC2 Server
   1. Instance 생성하기
      1. Ubuntu Server 18.04 LTS
      2. key pair (.pem)
   2. Instance 접속하기
      1. ssh를 이용한 원격 접속
   3. AWS EC2 서버 세팅
3. Github 활용
   1. github repository에 Django 프로젝트 업로드
   2. AWS EC2 서버에 git 연동해서 Django 프로젝트 다운
4. uWSGI 연결
   1. runserver 테스트
   2. uWSGI 서버 연결
5. nginx 연결
   1. nginx와 uwsgi 연결

---

## 1. 배포할 Django 프로젝트 준비

### 1. 가상 환경 준비



파이썬이 기본적으로 설치 되어있어야 하며

![python-version](/images/2021-09-04/python-version.jpg)



가상환경을 만들어주는 **virutalenv** 패키지를 설치해 주어야 합니다.

```python
pip install virtualenv
```



가상환경을 만들어 주고 싶은 경로에 아래 명령어를 입력하면 됩니다.

```python
virtualenv env
```

env는 현재 만들 가상환경의 이름을 입력하면 됩니다.

> 제 경우에는 아래처럼 Desktop경로에 env라는 가상환경을 생성 하였습니다.

![virtualenv](/images/2021-09-04/virtualenv.jpg)



가상환경을 활성화 해주세요

```python
env\Scripts\activate
```

![activate](/images/2021-09-04/activate.jpg)

> 가상환경이 활성화 되면 (env) [현재 경로]$ 로서 나타나게 됩니다

### 2. Django 프로젝트 만들기



Django를 설치해 줍니다.

> 저의 경우 pip를 입력하면 python3.x 버전과 연결되어 있어서 python2.x버전을 사용하시는 분들이라면 pip3를 이용해 주세요!

```python
pip install django
```



Django 프로젝트를 만들어 줍니다.

```python
django-admin startproject testSite
```

![djangoProject](/images/2021-09-04/djangoProject.jpg)

> 가상환경과 Django 프로젝트는 같은 Desktop경로에 저장되어 있는걸 확인 할 수 있습니다.

![스크린샷(4)_LI](/images/2021-09-04/스크린샷(4)_LI.jpg)



**testSite** 프로젝트에 testApp이라는 앱을 만들어 줍니다.

```python
cd testSite
python manage.py startapp testApp
```



앱을 만들었으면 시스템이 앱이 등록되었는지 알아야겠죠?

그래서 testSite/settings.py에 INSTALLED_APPS에 등록해 줍시다.

![installedApp](/images/2021-09-04/installedApp.jpg)





배포할때 나타날 화면을 구현하기 위해 해주어야 할 세팅이 있습니다.

우선 testApp 폴더 내부에 templates 폴더와 그 안에 testApp이라는 폴더를 다시 만들어 주세요.

testApp 폴더 안에 index.html 이라는 파일을 만들어 주세요.



testApp/templates/testApp/index.html

![pageInApp](/images/2021-09-04/pageInApp.jpg)

index.html파일의 내부는 아래처럼 간단히 채워줍시다.

![indexContent](/images/2021-09-04/indexContent.jpg)



이렇게 만든 templates 내부의 파일에 접속하기 위해서 settings.py에서 조금의 수정이 필요합니다.

testSite/settings.py로 들어가서 TEMPLATES 내부의 DIRS 에 경로를 아래처럼 넣어주세요. (필요한 경우 상단에 import os를 해주세요)

![templatePath](/images/2021-09-04/templatePath.jpg)



이제 url을 설정해 볼까요?

testSite의 urls.py를 수정해 봅시다.

![projectUrls](/images/2021-09-04/projectUrls.jpg)

프로젝트의 urls 경로를 앱의 urls로 연결시켜 주는 과정입니다.



그런데 testApp에는 urls.py라는 파일이 없네요? 그래서 만들어 줍시다.

testApp/urls.py 이렇게요. 그다음에 내부는 이렇게 넣어줍니다.

![appUrls](/images/2021-09-04/appUrls.jpg)

이 url이 화면을 띄워주는 views로 연결시켜주는 역할을 합니다.



이제 views.py에서 화면을 직접 띄워주게 도와주는 index 함수를 설정하러 가봅시다.

![viewDef](/images/2021-09-04/viewDef.jpg)

이 함수가 아까 만들었던 index.html을 화면에 띄워줄꺼예요.



이제 장고 프로젝트는 배포할 준비가 되었어요!

migrate후 runserver를 해주면 우리가 만든 Django 프로젝트가 나타날 꺼예요 :)

```python
python manage.py makemigrations && python manage.py migrate
python manage.py runserver
```



장고는 처음의 개발서버가 **http://127.0.0.1:8000/**으로 설정이 되어있어요.

여기로 접속하면 아래처럼 화면이 나타납니다.

![djangoScreen](/images/2021-09-04/djangoScreen.jpg)



### 3. requirements.txt 만들기

지금까지는 local에서만 프로젝트를 실행시킬 수 있어요.

우리는 AWS EC2 서버를 통해서 배포할 예정인데, 지금 local에서 사용중인 패키지를 AWS서버에서도 동일하게 맞춰줘야겠죠? 그러기 위해서 현재 사용중인 패키지들을 확인할 수 있는 리스트가 필요해요.

requirements.txt라는 파일에 만들어 줄께요.

```python
pip freeze >>requirements.txt
```

---

참고자료:

* [네로의 다락방](https://nerogarret.tistory.com/45)

* [Dennis Ivy Youtube](https://www.youtube.com/watch?v=-qUoCBExAvY&list=PL-51WBLyFTg1pUMaTJ4WSgnyvWfLGmwDm&index=1)

