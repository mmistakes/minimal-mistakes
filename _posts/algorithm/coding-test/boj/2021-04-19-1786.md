---
title:  "[ë°±ì¤€ 1786][ğŸ’›1] ì°¾ê¸° (KMP)" 

categories:
  - BOJ
tags:
  - [Algorithm, Coding Test, Cpp]

toc: true
toc_sticky: true

date: 2021-04-19
last_modified_at: 2021-04-19
---


## ğŸš€ ë‚œì´ë„ 

> ğŸ’› ê³¨ë“œ 1

<br>

## ğŸš€ ë¬¸ì œ

> <https://www.acmicpc.net/problem/1786>

![image](https://user-images.githubusercontent.com/42318591/115111907-a91fc900-9fbd-11eb-9f4b-9881458bbfe4.png)

![image](https://user-images.githubusercontent.com/42318591/115111917-b3da5e00-9fbd-11eb-86ec-9d29c3ea34b1.png)

ì´ ë¬¸ì œì—ì„œ ì„¤ëª…í•˜ëŠ” ê²ƒ ìì²´ê°€ **KMP ì•Œê³ ë¦¬ì¦˜**ì´ë‹¤. 

<br>

## ğŸš€ ë‚´ í’€ì´ 

> ğŸ“Œ KMP ì•Œê³ ë¦¬ì¦˜ ì— ëŒ€í•œ ìì„¸í•œ ì„¤ëª…ì€ ë§í¬ë¡œ <https://ansohxxn.github.io/algorithm/kmp/>

KMP ì•Œê³ ë¦¬ì¦˜ì˜ ëŒ€í‘œì ì¸ ë‘ ì½”ë“œë¡œ ì œì¶œì„ í–ˆë‹¤. ìì„¸í•œ ì„¤ëª…ì€ ìœ„ ë§í¬ì— ë‹¤ ê¸°ì¬í•´ë‘ì—ˆê¸° ë•Œë¬¸ì— ì´ í¬ìŠ¤íŠ¸ì—ì„  ì„¤ëª…ì„ ìƒëµí•˜ê² ë‹¤.

### ğŸ”¥ ì²« ë²ˆì§¸ í’€ì´ â­•

```cpp
#include <bits/stdc++.h>

using namespace std;

vector<int> Fail(string pattern) {
	int m = pattern.length();
	vector<int> pi(m); // partial match table

	int begin = 1;
	int matched = 0;
	pi[0] = 0;
	while (begin + matched < m) {
		if (pattern[begin + matched] == pattern[matched]) {
			matched++;
			pi[begin + matched - 1] = matched;
		}
		else {
			if (matched == 0)
				begin++;
			else {
				begin += matched - pi[matched - 1];
				matched = pi[matched - 1];
			}
		}
	}
	return pi;
}

vector<int> KMP(string pattern, string text) {
	int m = pattern.length();
	int n = text.length();
	vector<int> pos;
	vector<int> pi = Fail(pattern);

	int begin = 0;
	int matched = 0;
	while (begin + m <= n) {
		if (matched < m && text[begin + matched] == pattern[matched]) {
			matched++;

			if (matched == m)
				pos.push_back(begin + 1); // ìœ„ì¹˜ë¥¼ 1 ë¶€í„° ì¹˜ê¸° ë•Œë¬¸ì— +1 í•´ì¤Œ
		}
		else {
			if (matched == 0)
				begin++;
			else {
				begin += matched - pi[matched - 1];
				matched = pi[matched - 1];
			}
		}
	}
	return pos;
}

int main() {
	//freopen("input.txt", "r", stdin);
    ios::sync_with_stdio(false);
    cin.tie(NULL);
    cout.tie(NULL);

	// ê³µë°±ì„ í¬í•¨í•˜ëŠ” ë¬¸ìì—´ ì…ë ¥
	string text;
	getline(cin, text);
	string pattern;
	getline(cin, pattern);

	vector<int> answer = KMP(pattern, text); // answer ì— ê²€ìƒ‰ì— ì„±ê³µí•œ ìœ„ì¹˜ë“¤ì´ ë‹´ê¸°ê²Œ ëœë‹¤.
	cout << answer.size() << '\n';
	for (int i = 0; i < answer.size(); ++i)
		cout << answer[i] << ' ';
}
```

<br>

### ğŸ”¥ ë‘ ë²ˆì§¸ í’€ì´ â­•

```cpp
#include <bits/stdc++.h>

using namespace std;

vector<int> Fail(string pattern) {
	int m = pattern.length();
	vector<int> pi(m); // partial match table

	pi[0] = 0;
	for (int i = 1, j = 0; i < m; i++) { 
		while (j > 0 && pattern[i] != pattern[j])
			j = pi[j - 1]; 
		if (pattern[i] == pattern[j])
			pi[i] = ++j; 
	} 
	return pi;
}

vector<int> KMP(string pattern, string text) {
	int m = pattern.length();
	int n = text.length();
	vector<int> pos;
	vector<int> pi = Fail(pattern);

	for (int i = 0, j = 0; i < n; i++) {
		while (j > 0 && text[i] != pattern[j])
			j = pi[j - 1];
		if (text[i] == pattern[j]) {
			if (j == m - 1) {
				pos.push_back(i - m + 1 + 1); // ìœ„ì¹˜ë¥¼ 1 ë¶€í„° ì¹˜ê¸° ë•Œë¬¸ì— +1 í•´ì¤Œ
				j = pi[j];
			}
			else j++;
		}
	}
	return pos;
}

int main() {
	//freopen("input.txt", "r", stdin);
    ios::sync_with_stdio(false);
    cin.tie(NULL);
    cout.tie(NULL);

	// ê³µë°±ì„ í¬í•¨í•˜ëŠ” ë¬¸ìì—´ ì…ë ¥
	string text;
	getline(cin, text);
	string pattern;
	getline(cin, pattern);

	vector<int> answer = KMP(pattern, text); // answer ì— ê²€ìƒ‰ì— ì„±ê³µí•œ ìœ„ì¹˜ë“¤ì´ ë‹´ê¸°ê²Œ ëœë‹¤.
	cout << answer.size() << '\n';
	for (int i = 0; i < answer.size(); ++i)
		cout << answer[i] << ' ';
}
```


***
<br>

    ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš° 
    ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}