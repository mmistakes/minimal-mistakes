---
title:  "[ë°±ì¤€ 9250][ğŸ’š2] ë¬¸ìì—´ ì§‘í•© íŒë³„ (ì•„í˜¸-ì½”ë¼ì‹, íŠ¸ë¼ì´)" 

categories:
  - BOJ
tags:
  - [Algorithm, Coding Test, Cpp]

toc: true
toc_sticky: true

date: 2021-04-20
last_modified_at: 2021-04-20
---


## ğŸš€ ë‚œì´ë„ 

> ğŸ’š í”Œë˜í‹°ë„˜ 2

<br>

## ğŸš€ ë¬¸ì œ

> <https://www.acmicpc.net/problem/9250>

![image](https://user-images.githubusercontent.com/42318591/115105529-7f08df80-9f9a-11eb-948b-7aa993305cad.png)

<br>

## ğŸš€ ë‚´ í’€ì´ 

### ğŸ”¥ 'ì•„í˜¸-ì½”ë¼ì‹' ìœ¼ë¡œ í’€ì´ â­•

ì•„í˜¸-ì½”ë¼ì‹ ì•Œê³ ë¦¬ì¦˜ì— ëŒ€í•´ì„œëŠ” [(C++) ë¬¸ìì—´ ê²€ìƒ‰ ì•Œê³ ë¦¬ì¦˜ : ì•„í˜¸-ì½”ë¼ì‹(Aho-Corasick) ì•Œê³ ë¦¬ì¦˜](https://ansohxxn.github.io/algorithm/ahocorasick/) ğŸ‘ˆ ì´ í¬ìŠ¤íŠ¸ì— ìì„¸íˆ ì„¤ëª…í•´ë‘ì—ˆìœ¼ë‹ˆ ì°¸ê³  :) ì œì¶œí–ˆë˜ ì•„ë˜ ì½”ë“œëŠ” ì•„í˜¸-ì½”ë¼ì‹ ì½”ë“œ ê·¸ëŒ€ë¡œì´ë‹¤.

ì•„í˜¸ ì½”ë¼ì‹ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ë©´, ê²€ìƒ‰ì–´ì˜ ê°œìˆ˜ê°€ \\(k\\) ê°œ ì¼ ë•Œ í•˜ë‚˜ì˜ í…ìŠ¤íŠ¸ ë‹¹ \\(O(n + m_{1} + m_{2} + .. + m_{k})\\) ì˜ ì„ í˜• ì‹œê°„ ë³µì¡ë„ë§Œ ì†Œìš” ëœë‹¤. ì¦‰, í…ìŠ¤íŠ¸(ì•„ë˜ ì½”ë“œì—ì„  `word[i]`)ë¥¼ í•œë²ˆë§Œ ìˆœíšŒí•˜ë©´ ë˜ëŠ” ê²ƒì´ë‹¤. 


```cpp
#include <bits/stdc++.h>

using namespace std;

struct Trie {
public:
	bool isEnd;
	map<char, Trie*> child;
	Trie* fail;

	Trie() : isEnd(false), fail(nullptr) {}

	void Insert(string pattern) {
		Trie* now = this;
		int m = pattern.length();
		for (int i = 0; i < m; ++i) {
			if (now->child.find(pattern[i]) == now->child.end())
				now->child[pattern[i]] = new Trie;
			now = now->child[pattern[i]];

			if (i == m - 1) now->isEnd = true;
		}
	}

	void Fail() {  // BFS + KMP
		Trie* root = this;
		queue<Trie*> q;

		q.push(root);

		while (!q.empty()) {
			Trie* now = q.front();
			q.pop();

			for (auto& ch : now->child) {

				Trie* next = ch.second;
				if (now == root)
					next->fail = root;
				else {
					Trie* prev = now->fail;
					while (prev != root && prev->child.find(ch.first) == prev->child.end())
						prev = prev->fail;
					if (prev->child.find(ch.first) != prev->child.end())
						prev = prev->child[ch.first];
					next->fail = prev;
				}

				if (next->fail->isEnd)
					next->isEnd = true;

				q.push(next);
			}
		}
	}
};

// ê²€ìƒ‰ì–´ë“¤ì´ ëª¨ì—¬ ìˆëŠ” íŠ¸ë¼ì´ë¥¼ í†µí•´ íƒìƒ‰í•˜ë©° word ì˜ ë¶€ë¶„ ë¬¸ìì—´ê³¼ ì¼ì¹˜í•˜ëŠ” ê²ƒì„ ì²˜ìŒìœ¼ë¡œ ì°¾ì•„ë‚´ìë§ˆì return true í•˜ê³  ì¢…ë£Œí•¨
bool KMP(string word, Trie* root) {
	Trie* now = root;
	int n = word.length();
	for (int i = 0; i < n; ++i) {
		while (now != root && now->child.find(word[i]) == now->child.end())
			now = now->fail;
		if (now->child.find(word[i]) != now->child.end())
			now = now->child[word[i]];
		if (now->isEnd)
			return true;
	}
	return false;
}

int main() {
	//freopen("input.txt", "r", stdin);

	int N;
	cin >> N;
	vector<string> patterns(N);
	for (int i = 0; i < N; ++i)
		cin >> patterns[i];
	Trie* root = new Trie;
	for (int i = 0; i < N; ++i)
		root->Insert(patterns[i]);
	root->Fail();

	int Q;
	cin >> Q;
	vector<string> words(Q);
	for (int i = 0; i < Q; ++i)
		cin >> words[i];
	for (int i = 0; i < Q; ++i) {
		if (KMP(words[i], root))
			cout << "YES" << '\n';
		else
			cout << "NO" << '\n';
	}
}

```

***
<br>

    ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš° 
    ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}