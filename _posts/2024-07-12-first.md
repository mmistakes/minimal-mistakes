---
layout: single
title: "모노레포"
typora-root-url: ../
categories: [📌 ARCHITECTURE]
tag: [monorepo, architecture]
author_profile: false # 연락처 정보 숨기기
sidebar: # 사이드바 네이게이션 수정
  # nav: "docs" # /_data/navigation.yml의 docs를 의미
  nav: "counts"
search: true
---

위퍼블릭 프로젝트를 진행시 NestJS에 모노레포를 적용하였던 경험에 기반하여 개념을 명확히 하고자 한다.

당시 개발 초기에는 백엔드 서버와 컨트랙 서버를 마이크로 서비스 개념에 근거하여 기능별로 각각의 애플리케이션으로 나누어 멀티레포로 구성하여 관리하였지만, 효율적인 관리를 위해 모노레포로 변경하였다.

## 모노레포 개념

![monorepo_multirepo_c598bd93e9](/images/2024-07-12-first/monorepo_multirepo_c598bd93e9.png)

Monolithic Repository란 레포지토리를 관리하는 방법론 중 하나로, 하나의 저장소(Repository)에서 여러개의 프로젝트를 관리하는 방법이다.

모노레포가 등장한 배경에는 여러 이유가 있을 수 있겠지만, 가장 중요한 이유는 결국 생산성과 효율성이라고 생각한다. 멀티레포로 구성시, 코드 중복이나 의존성 관리, 모듈화 등에 있어서 크고 작은 문제가 발생할 수 있다. 이런 상황에 모노레포는 좋은 선택지가 될 수 있다.

## 모노레포 장단점

실제 모노레포로 구성하여 개발하면서 느꼈던 크게 느꼈던 장점과 단점들은 아래와 같다.

#### 장점

- 공통 모듈의 효율적인 관리 : 공통되는 코드나 모듈을 공유하여 재사용하거나 관리하기가 용이했다. 이는 불필요한 중복을 막아주었기 때문에 생산성을 높여주었다. 일례로 날짜 포맷을 관리하는 함수라던지 다양한 데코레이터, ENUM 값들이나 exception filter 등 공통 모듈을 만들어 재사용함으로써 개발 시간이 상당히 단축됨을 느꼈다.
- 빠른 협업과 리뷰 : 하나의 레포지토리를 관리하면서 깃헙을 통해 빠른 리뷰를 함으로써 협업이 편리해짐을 느낄 수 있었다.
- 의존성 관리 : 하나의 레포 안에서 관리하기 때문에 의존성 관리가 상당히 편리했었다.
- 코드 컨벤션 : 리팩토링을 하거나 코드 리뷰를 진행할 때, 일관성을 유지하기 용이했다.

#### 단점

- 복잡성 증가 : 하나의 레포에서 여러 프로젝트를 관리하기 때문에 의도치 않게 코드 충돌의 문제가 생길 수 있다.
- 의도치 않은 영향 : 하나의 프로젝트에서 발생한 변경 사항이 의도치 않게 다른 프로젝트에 영향을 줄 수 있다.
- 배포 대한 주의 : 모노레포에 존재하는 모든 프로젝트가 함께 배포되기 때문에 배포 주기가 다르거나 배포가 되면 안되는 커밋이 있거나 하는 상황에 대한 주의가 필요했다.
- 다른 언어를 사용하는 프로젝트는 통합하기 어려움

### NestJS 프로젝트의 모노레포 폴더 구성

NestJS에서는 CLI로 모노레포를 구성할 수 있도록 편리하게 되어있기 때문에 이를 참고하면 쉽게 구성할 수 있다. 아래는 실제 프로젝트의 폴더 구조로 apps 안에서 각각의 프로젝트들을 관리했고, 공통모듈은 libs에서 관리하였다. 구성 과정의 자세한 내용은 [NestJS 공홈](https://docs.nestjs.com/cli/monorepo)을 참고하였다.

![folder_structure](/images/2024-07-12-first/folder_structure.png)

참고

https://com789.tistory.com/44

https://shiningjean.tistory.com/90
