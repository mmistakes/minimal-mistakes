---
layout: single
title: 'μ‹ κ²½λ§μ„ μ„ν• λ°μ΄ν„° ν‘ν„ & μ‹ κ²½λ§ μµμ ν™”'
---

# 1. μ‹ κ²½λ§μ„ μ„ν• λ°μ΄ν„° ν‘ν„ π“ {#1-μ‹ κ²½λ§μ„-μ„ν•-λ°μ΄ν„°-ν‘ν„-}


## 1.ν…μ„(tensor)λ€? : 
λ°μ΄ν„°λ¥Ό μ„ν• μ»¨ν…μ΄λ„ , ν…μ„λ” μ„μμ μ°¨μ›(μ¶•) κ°μλ¥Ό κ°€μ§€λ” ν–‰λ ¬μ μΌλ°ν™”λ λ¨μµ. 
:::


### 1.1.1 μ¤μΉΌλΌ(λ­ν¬ - 0 ν…μ„) {#111-μ¤μΉΌλΌλ­ν¬---0-ν…μ„}

ν•λ‚μ μ«μλ§ λ‹΄κ³  μλ” ν…μ„λ¥Ό μ¤μΉΌλΌλΌκ³  λ¶€λ¥Έλ‹¤.

λ„νμ΄μ—μ„ float32λ‚ float64 νƒ€μ…μ μ«μ =\> μ¤μΉΌλΌ ν…μ„

ndim μ†μ„±μ„ μ‚¬μ©ν•΄μ„ λ„νμ΄ λ°°μ—΄μ μ¶• κ°μλ¥Ό ν™•μΈν•΄λ³΄λ©΄ μ¤μΉΌλΌ ν…μ„μ
μ¶•κ°μλ” 0μ΄λ‹¤. (ν…μ„μ μ¶• κ°μλ¥Ό **λ­ν¬(rank)**λΌκ³  λ¶€λ¥Έλ‹¤.)
:::


``` {.python}
import numpy as np
x = np.array(12)
print('xμ μ¶•μ κ°μ: ',x.ndim)
```


    xμ μ¶•μ κ°μ:  0

:::


### 1.1.2 λ²΅ν„°(λ­ν¬ - 1 ν…μ„) 

μ«μμ λ°°μ—΄μ„ λ°±ν„° λλ” λ­ν¬-1 ν…μ„λ‚ 1Dν…μ„λΌκ³  λ¶€λ¥Έλ‹¤. λ²΅ν„°λ” 1κ°μ
μ¶•μ„ κ°€μ§„λ‹¤.
:::


``` {.python}
x = np.array([24,6,22,12,5])
print(x)
print('xμ μ¶•μ κ°μ: ',x.ndim)
```


    [24  6 22 12  5]
    xμ μ¶•μ κ°μ:  1

:::


*μ„μ λ²΅ν„°λ” 5μ°¨μ› λ²΅ν„°μ΄λ‹¤. 5Dλ²΅ν„° β‰  5Dν…μ„ ,* **μ°¨μ› μ** *λ” νΉμ •
μ¶•μ„ λ”°λΌ λ†“μ€ μ›μ† κ°μ or ν…μ„μ μ¶•μ κ°μ.*

*5Dλ²΅ν„°λ” ν•λ‚μ μ¶•μ„ λ”°λΌ 5κ°μ μ°¨μ›μ„ κ°€μ§„ λ²΅ν„°μ΄κ³  , 5Dλ” 5κ°μ μ¶•μ„ κ°€μ§„ κ²ƒ*
:::


### 1.1.3 ν–‰λ ¬(λ­ν¬ - 2 ν…μ„)

λ°±ν„°μ λ°°μ—΄μ€ ν–‰λ ¬(matrix)λλ” λ­ν¬-2 ν…μ„λ‚ 2D ν…μ„μ΄λ‹¤.
:::


``` {.python}
x = np.array([[5,2,72,12,6],
            [21,534,86,3,21],
            [45,12,69,3,4]])
print(x)
print('xμ μ¶•μ κ°μ: ',x.ndim)
```

    [[  5   2  72  12   6]
     [ 21 534  86   3  21]
     [ 45  12  69   3   4]]
    xμ μ¶•μ κ°μ:  2
:::


μ„μ λ²΅ν„°μ—μ„ μ²«λ²μ§Έ μ¶•μ μ›μ†λ¥Ό ν–‰, λ‘λ²μ§Έ μ¶•μ μ›μ†λ¥Ό μ—΄μ΄λΌκ³  λ¶€λ¥Έλ‹¤.
:::


### 1.1.4 λ­ν¬-3 ν…μ„μ™€ λ” λ†’μ€ λ­ν¬μ ν…μ„ 

μ„μ™€ κ°™μ€ ν–‰λ ¬λ“¤μ„ ν•λ‚μ μƒλ΅μ΄ λ°°μ—΄λ΅ ν•©μΉλ©΄ μ«μ°¨κ°€ μ±„μ›μ§„ μ§μ΅λ©΄μ²΄λ΅
ν•΄μ„ν•  μ μλ” λ­ν¬-3 ν…μ„κ°€ λ§λ“¤μ–΄μ§„λ‹¤.
:::


``` {.python}
x = np.array([[[5,2,72,12,6],
            [21,534,86,3,21],
            [45,12,69,3,4]],
            [[5,2,72,12,6],
            [21,534,86,3,21],
            [45,12,69,3,4]],
            [[5,2,72,12,6],
            [21,534,86,3,21],
            [45,12,69,3,4]]])
print('xμ μ¶•μ κ°μ: ',x.ndim)
```


    xμ μ¶•μ κ°μ:  3
:::

λ­ν¬-3 νƒ μ„λ“¤μ„ ν•λ‚μ λ°°μ—΄λ΅ ν•©μΉλ©΄ λ­ν¬-4 ν…μ„λ¥Ό λ§λ“λ” μ‹μΌλ΅μ΄μ–΄μ§„λ‹¤.

**λ”¥λ¬λ‹μ—μ„λ” λ³΄ν†µ λ­ν¬ 0μ—μ„ 4κΉμ§€μ ν…μ„λ¥Ό λ‹¤λ£¬λ‹¤.**
:::


### 1.1.5 ν•µμ‹¬μ†μ„± 

-   μ¶•μ κ°μ (λ­ν¬) : λ„νμ΄λ‚ ν…μ„ν”λ΅ λ“±μ νμ΄μ¬ λΌμ΄λΈλ¬λ¦¬μ—μ„λ”
    ndim μ†μ„±μ— μ €μ¥λμ–΄ μλ‹¤.
-   ν¬κΈ°(shape) : ν…μ„μ κ° μ¶•μ„ λ”°λΌ μ–Όλ§λ‚ λ§μ€ μ°¨μ›μ΄ μλ”μ§€ λ‚νƒ€λ‚Έ
    νμ΄μ¬μ νν”μ΄λ‹¤. μλ¥Ό λ“¤μ–΄ μ„μ ν–‰λ ¬μ ν¬κΈ°λ” (3,5) , λ­ν¬-3
    ν…μ„λ” (3,3,5)μ΄λ‹¤.
-   ν…μ΄ν„° νƒ€μ…(dtype) : ν…μ„μ— ν¬ν•¨λ λ°μ΄ν„°μ νƒ€μ…. ex) float16,
    float32, float64 , uint8 , string λ“±μ΄ μλ‹¤.
:::


MNIST λ°μ΄ν„°λ¥Ό ν™μ©ν•΄μ„ μ„μ λ‚΄μ©μ„ κµ¬μ²΄μ μΌλ΅ λ‹¤λ¤„λ³΄μ.

λ¨Όμ € MNIST λ°μ΄ν„°μ…‹μ„ λ¶λ¬λ“λ¦°λ‹¤.



``` {.python}
from tensorflow.keras.datasets import mnist
(train_images,train_labels),(test_images,test_label) = mnist.load_data()
```


    Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/mnist.npz
    11493376/11490434 [==============================] - 0s 0us/step
    11501568/11490434 [==============================] - 0s 0us/step




train_images λ°°μ—΄μ ndim μ†μ„±μΌλ΅ μ¶•μ κ°μλ¥Ό ν™•μΈν•λ‹¤.



``` {.python}
train_images.ndim
```


    3



λ‹¤μμΌλ΅ λ°°μ—΄μ ν¬κΈ°λ¥Ό ν™•μΈν•λ‹¤.


``` {.python}
train_images.shape
```

    (60000, 28, 28)



dtype μ†μ„±μ„ μ΄μ©ν•΄μ„ λ°μ΄ν„° νƒ€μ…μ„ ν™•μΈν•λ‹¤.



``` {.python}
train_images.dtype
```


    dtype('uint8')



μ„μ λ‚΄μ©λ“¤λ΅ train_images λ°°μ—΄μ€ 8λΉ„νΈ μ •μν• , λ­ν¬-3 ν…μ„μ΄κ³  , 28x28
ν¬κΈ°μ μ •μν–‰λ ¬ 6λ§κ°κ°€ μλ” λ°°μ—΄μΈ κ²ƒμ„ μ• μ μλ‹¤.

κ° ν–‰λ ¬μ€ ν‘λ°± μ΄λ―Έμ§€κ³  , ν–‰λ ¬μ κ° μ›μ†λ” 0μ—μ„ 255μ‚¬μ΄μ κ°’μ„ κ°€μ§„λ‹¤.
:::

## 1.2 λ„νμ΄λ΅ ν…μ„ μ΅°μ‘ν•κΈ° 

train_image\[i\] κ°™μ€ ν•μ‹μΌλ΅ λ°°μ—΄μ— μλ” νΉμ • μ›μ†λ“¤μ„ μ„ νƒν•λ” κ²ƒμ„ **μ¬λΌμ΄μ‹±(slicing)** μ΄λΌκ³  ν•λ‹¤.

λ‹¤μ μ½”λ“λ” 11λ²μ§Έμ—μ„ 101λ²μ§ΈκΉμ§€ (101λ²μ§Έλ” ν¬ν•¨X) μ«μλ¥Ό μ„ νƒν•΄μ„
(90,28,28)ν¬κΈ°μ λ°°μ—΄μ„ λ§λ“ λ‹¤.
:::


``` {.python}
ex_slice = train_images[10:100]
ex_slice.shape
```


    (90, 28, 28)
:::

μ΅°κΈ λ” μμ„Έν• slicing ν‘κΈ°λ²•μ€ κ° λ°°μ—΄μ μ¶•μ„ λ”°λΌ μ¬λΌμ΄μ‹±μ μ‹μ‘
μΈλ±μ¤μ™€ λ§μ§€λ§‰ μΈλ±μ¤λ¥Ό μ§€μ •ν•λ” κ²ƒμ΄λ‹¤. :(μ½λ΅ )μ€ μ „μ²΄ μΈλ±μ¤λ¥Ό
μ„ νƒν•λ‹¤.
:::


``` {.python}
ex_slice= train_images[10:100,:,:]
print(ex_slice.shape)

ex2_slice = train_images[10:100, 0:25 , 0:25]
print(ex2_slice.shape)
```


    (90, 28, 28)
    (90, 25, 25)



μμ μΈλ±μ¤λ„ μ‚¬μ©ν•  μ μλ‹¤. νμ΄μ¬ λ¦¬μ¤νΈμ μμ μΈλ±μ¤μ™€ λ§μ°¬κ°€μ§€λ΅
ν„μ¬ μ¶•μ λμ—μ„ μƒλ€μ μΈ μ„μΉλ¥Ό λ‚νƒ€λ‚Έλ‹¤.

μ •μ¤‘μ•™μ 14x14 ν”½μ…€ μ΅°κ°μ„ μ΄λ―Έμ§€μ—μ„ μλΌλ‚΄λ ¤λ©΄ λ‹¤μ μ½”λ“μ™€ κ°™μ΄ ν•λ©΄
λλ‹¤.
:::


``` {.python}
mid_slice = train_images[:,7:-7,7:-7]
mid_slice.shape
```


    (60000, 14, 14)



## 1.3 λ°°μΉ λ°μ΄ν„° 

λ”¥λ¬λ‹ λ¨λΈμ€ ν•λ²μ— μ „μ²΄ λ°μ΄ν„°μ…‹μ„ μ²λ¦¬ν•μ§€ μ•λ”λ‹¤.

κ·Έλ€μ‹  μ‘μ€ λ°°μΉ(batch)λ΅ λ‚λλ‹¤. μλ¥Ό λ“¤μ–΄ MNIST μ«μ λ°μ΄ν„°μ—μ„ ν¬κΈ°κ°€
128μΈ λ°μ΄ν„° λ°°μΉλ” λ‹¤μκ³Ό κ°™λ‹¤.

``` {.python}
batch = train_images[:128]
```

nλ²μ§Έ λ°°μΉλ” λ‹¤μκ³Ό κ°™λ‹¤.
:::


``` {.python}
n = 3 
batch = train_images[128 * n : 128 * (n+1)]
```

μ΄λ° λ°°μΉ λ°μ΄ν„°λ¥Ό λ‹¤λ£° λ• μ²«λ²μ§Έ μ¶• (0λ² μ¶•)μ„ **λ°°μΉ μ¶•** or **λ°°μΉ
μ°¨μ›**μ΄λΌκ³  λ¶€λ¥Έλ‹¤.


## 1.4 ν…μ„μ μ—°μ‚° 

:::


### 1.4.1 μ›μ†λ³„ μ—°μ‚° 


μ΄ μ—°μ‚°μ€ ν…μ„μ— μλ” κ° μ›μ†μ— λ…λ¦½μ μΌλ΅ μ μ©λλ‹¤.

λ„νμ΄ λ°°μ—΄μ„ λ‹¤λ£° λ•λ” μµμ ν™”λ λ„νμΈ λ‚΄μ¥ν•¨μλ΅
λ§μ…,κ³±μ…,λΊ„μ…,reluν•¨μ λ“±μ„ μ²λ¦¬ν•  μ μλ‹¤.
:::

``` {.python}
import numpy as np
z = x + y #μ›μ†λ³„ λ§μ…
z = np.maximum(z,0.) #μ›μ†λ³„ relu ν•¨μ
```



### 1.4.2 λΈλ΅λ“μΊμ¤ν… {#142-λΈλ΅λ“μΊμ¤ν…}

ν¬κΈ°κ°€ λ‹¤λ¥Έ λ‘ ν…μ„κ°€ λ”ν•΄μ§ λ• λΈλ΅λ“μΊμ¤ν…μ΄ μΌμ–΄λ‚λ‹¤.

λ‹¤μκ³Ό κ°™μ€ μμ„λ΅ μ΄λ¤„μ§„λ‹¤.

1.  ν° ν…μ„μ ndimμ— λ§μ¶° μ‘μ€ ν…μ„μ— μ¶•μ΄ μ¶”κ°€λλ‹¤.
2.  μ‘μ€ ν…μ„κ°€ μƒ μ¶•μ„ λ”°λΌμ„ ν° ν…μ„μ ν¬κΈ°μ— λ§λ„λ΅ λ°λ³µλλ‹¤.



### 1.4.3 ν…μ„ κ³±μ… {#143-ν…μ„-κ³±μ…}

μ κ³±μ΄λΌκ³ λ„ λ¶λ¦¬λ” ν…μ„ κ³±μ…μ€ κ°€μ¥ λ„λ¦¬ μ‚¬μ©λλ” ν…μ„ μ—°μ‚°μ΄λ‹¤.
(*μ—°μ‚°μλ¥Ό μ‚¬μ©ν•λ” μ›μ†λ³„ κ³±μ…κ³Ό λ‹¤λ¥΄λ‹¤*)

λ„νμ΄μ—μ„ np.dot ν•¨μλ¥Ό μ‚¬μ©ν•΄μ„ ν…μ„ κ³±μ…μ„ μν–‰ν•λ‹¤.



``` {.python}
import numpy as np
x = np.random.random((5,5))
y = np.random.random((5,5))
z = np.dot(x,y)
```

μ κ³±μ€ μ„μμ μ¶• κ°μλ¥Ό κ°€μ§„ ν…μ„μ— μΌλ°ν™” λλ‹¤.

κ°€μ¥ μΌλ°μ μΈ μ©λ„μΈ λ‘ ν–‰λ ¬ κ°„μ μ κ³±μ€ x.shape\[1\] == y.shape\[0\]
μΌλ• μ κ³± (dot(x,y))μ΄ μ„±λ¦½ν•λ‹¤.

## 1.5 ν…μ„ ν¬κΈ° λ³€ν™ {#15-ν…μ„-ν¬κΈ°-λ³€ν™}

ν…μ„ ν¬κΈ° λ³€ν™μ€ νΉμ • ν¬κΈ°μ— λ§κ² μ—΄κ³Ό ν–‰μ„ μ¬λ°°μ—΄ν•λ” κ²ƒμ΄λ‹¤. λ¬Όλ΅ 
ν…μ„μ μ›μ† κ°μλ” λ™μΌν•λ‹¤.

``` {.python}
x = np.array([[0,1],
              [2,3],
              [4,5]])
print(x.shape)
x = x.reshape((6,1))
print(x)
x = x.reshape((2,3))
print(x)
```

    (3, 2)
    [[0]
     [1]
     [2]
     [3]
     [4]
     [5]]
    [[0 1 2]
     [3 4 5]]



μμ£Ό μ“°λ” νΉλ³„ν• ν¬κΈ° λ³€ν™μ€ **μ „μΉ(transposition)**μ΄λ‹¤. ν–‰κ³Ό μ—΄μ„
λ°”κΎΈλ” κ²ƒμ΄λ‹¤. μλ¥Ό λ“¤μ–΄ , x\[i,j\]λ” x\[j,i\]κ°€ λλ‹¤.

# 2. κ·Έλ λ””μ–ΈνΈ κΈ°λ° μµμ ν™” π“‰ 

## 2.1 ν™•λ¥ μ  κ²½μ‚¬ ν•κ°•λ²• 

λ‹¤μμ μμ„λ΅ μµμ ν™”λ¥Ό μ§„ν–‰ν•  μ μλ‹¤.

1.  ν›λ ¨ μƒν” λ°°μΉ xμ™€ μ΄μ— μƒμ‘ν•λ” νƒ€κΉƒ y_trueλ¥Ό μ¶”μ¶ν•λ‹¤.
2.  xλ΅ λ¨λΈμ„ ν›λ ¨ν•κ³  μμΈ΅ y_predλ¥Ό κµ¬ν•λ‹¤(μ •λ°©ν–¥ ν¨μ¤).
3.  μ΄ λ°°μΉμ—μ„ y_predμ™€ y_true μ‚¬μ΄μ μ¤μ°¨(λ¨λΈμ μ†μ‹¤)μ„ κ³„μ‚°ν•λ‹¤.
4.  λ¨λΈμ νλΌλ―Έν„°μ— λ€ν• μ†μ‹¤ ν•¨μμ κ·Έλ λ””μ–ΈνΈλ¥Ό κ³„μ‚°ν•λ‹¤(μ—­λ°©ν–¥
    ν¨μ¤).
5.  κ·Έλ λ””μ–ΈνΈμ λ°λ€ λ°©ν–¥μΌλ΅ νλΌλ―Έν„°λ¥Ό μ΅°κΈμ”© μ΄λ™μ‹ν‚¨λ‹¤. μλ¥Ό λ“¤μ–΄ W
    -= learning_rate \* gradientμ²λΌ μ†μ‹¤μ„ μ΅°κΈ κ°μ†μ‹ν‚¨λ‹¤.

μ„μ λ°©λ²•μ΄ **λ―Έλ‹ λ°°μΉ SGD**μ΄λ‹¤.

λ§μ•½ λ€μƒ νλΌλ―Έν„°κ°€ μ‘μ€ ν•™μµλ¥ μ„ κ°€μ§„ SGDλ΅ μµμ ν™”λμ—λ‹¤λ©΄ μ „μ—­
μµμ†κ°’μ΄ μ•„λ‹ μ§€μ—­ μµμ†κ°’μ— κ°‡νκ² λ  κ²ƒμ΄λ‹¤.

μ΄λ¬ν• λ¬Έμ λ¥Ό **λ¨λ©ν…€**μ΄λΌλ” κ°λ…μΌλ΅ ν•΄κ²°ν•  μ μλ‹¤. λ¨λ©ν…€μ€ ν„μ¬
κ·Έλ λ””μ–ΈνΈ κ°’ λΏλ§ μ•„λ‹λΌ μ΄μ „μ— μ—…λ°μ΄νΈν• νλΌλ―Έν„°μ— κΈ°μ΄ν•μ—¬ νλΌλ―Έν„°
**W**λ¥Ό μ—…λ°μ΄νΈ ν•λ‹¤.

λ‹¤μμ€ λ¨λ©ν…€μ λ‹¨μ κµ¬ν„ μλ‹¤.

``` {.python}
past_velocity = 0
momentum = 0.1
while loss > 0.01:
  w, loss , gradient = get_current_parameters()
  velocity = momentum * velocity - learning_rate * gradient
  w = w + momentum * velocity - learning_rate * gradient
  past_velocity = velocity
  update_parameter(w)
```

## 2.2 μ—­μ „ν μ•κ³ λ¦¬μ¦ {#22-μ—­μ „ν-μ•κ³ λ¦¬μ¦}

λ³µμ΅ν• μ‹μ κ·Έλ λ””μ–ΈνΈλ¥Ό κ³„μ‚°ν•λ” λ°©λ²•μ΄ **μ—­μ „ν μ•κ³ λ¦¬μ¦**μ΄λ‹¤.

μ—°μ‡„ λ²•μΉ™μ„ μ—­λ°©ν–¥ κ·Έλν”„μ— μ μ©ν•λ©΄ , λ…Έλ“κ°€ μ—°κ²°λ κ²½λ΅λ¥Ό λ”°λΌμ„
μ°λ¦¬κ°€ μ›ν•λ” κ·Έλ λ””μ–ΈνΈμ κ³„μ‚°μ΄ κ°€λ¥ν•΄μ§„λ‹¤.

μ—­μ „νλ” μµμΆ… μ†μ‹¤κ°’μ—μ„ μ‹μ‘ν•΄μ„ λ§¨ μ„μΈµκΉμ§€ κ±°κΎΈλ΅ μ¬λΌκ°€μ„ κ°
νλΌλ―Έν„°κ°€ μ†μ‹¤κ°’μ— κΈ°μ—¬ν• μ •λ„λ” κ³„μ‚°ν•λ‹¤. μ”μ¦μ—λ” ν…μ„ν”λ΅μ™€ κ°™μ΄
**μλ™ λ―Έλ¶„**μ΄ κ°€λ¥ν• ν”„λ μ„ μ›ν¬ λ•λ¶„μ— μ—­μ „νλ¥Ό μ‰½κ² κµ¬ν„ν•  μ μλ‹¤.

### κ·Έλ λ””μ–ΈνΈ ν…μ΄ν”„ (GradientTape)

κ·Έλ λ””μ–ΈνΈ ν…μ΄ν”„λ” ν•΄λ‹Ή μ½”λ“ λΈ”λ΅ μ•μ λ¨λ“  ν…μ„ μ—°μ‚°μ„ κ³„μ‚° κ·Έλν”„
ν•νƒ(**Tape**)λ΅ κΈ°λ΅ν•λ‹¤. κ·Έ λ‹¤μ κ³„μ‚° κ·Έλν”„λ¥Ό μ‚¬μ©ν•΄μ„ tf.Variable
ν΄λμ¤ λ³€μ λλ” λ³€μ μ§‘ν•©μ— λ€ν• μ–΄λ–¤ μ¶λ ¥μ κ·Έλ λ””μ–ΈνΈλ„ κ³„μ‚°ν•  μ
μλ‹¤. (tf.Variableμ€ λ³€κ²½ κ°€λ¥ν• μƒνƒλ¥Ό λ‹΄κΈ° μ„ν• νΉλ³„ν• ν…μ„μ΄λ‹¤.)

``` {.python}
import tensorflow as tf

x = tf.Variable(0.) # μ΄κΈ°κ°’ 0μΌλ΅ μ¤μΉΌλΌ λ³€μλ¥Ό μƒμ„±
with tf.GradientTape() as tape: 
  y = 2 * x + 3     # λ³€μμ— ν…μ„ μ—°μ‚°μ„ μ μ©
grad_of_y_wrt_x = tape_gradient(y,x) # tapeλ¥Ό μ‚¬μ©ν•΄μ„ xμ— λ€ν• yμ κ·Έλ λ””μ–ΈνΈ κ³„μ‚°
```
:::
