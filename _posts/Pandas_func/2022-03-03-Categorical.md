---
title : "ğŸŒµPandas 4. pd.Categorical( )"

categories:
    - Pandas_func
tags:
    - [Pandas, DataFrame, Data, sort, category]

toc : true
toc_sticky : true

date: 2022-03-03
last_modified_at: 2022-03-03
---
* * *  

ğŸŒµ ê°€ë”ì”© ë°ì´í„° ì „ì²˜ë¦¬ë¥¼ í•˜ë‹¤ ë³´ë©´ <a>sort_values( )</a> í•¨ìˆ˜ë‚˜ <a>sort_index( )</a> í•¨ìˆ˜ë¥¼ ì¨ë„ ì›í•˜ëŠ”ëŒ€ë¡œ ì •ë ¬ì´ ì´ë¤„ì§€ì§€ ì•ŠëŠ” ê²½ìš°ê°€ ìˆë‹¤. ì´ ìƒí™©ì€ apply( ) ë¡œ ì„ì˜ì˜ í•¨ìˆ˜ë¥¼ ë°ì´í„°ì— ì ìš©í•  ë•Œ ì£¼ë¡œ ìƒê¸°ëŠ”ë°, ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ì´ë¥¼ í•´ê²°í•˜ëŠ” í•¨ìˆ˜ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ì.  

## pd.Categorical( ) í•¨ìˆ˜

ğŸŒµ ì•ì„  í¬ìŠ¤íŒ…ì—ì„œ ë‹¤ë£¬ pd. to_datetime( ) í•¨ìˆ˜ì— dt ë©”ì„œë“œë¥¼ ì ìš©í•˜ë©´ ë…„, ì›”, ì¼, ìš”ì¼ ë“± ì‹œê³„ì—´ê³¼ ê´€ë ¨í•œ ë‹¤ì–‘í•œ column ì„ ë§Œë“¤ ìˆ˜  ìˆë‹¤. í•˜ì§€ë§Œ ì´ë•Œ ìƒê¸°ëŠ” ìš”ì¼ì€ 0, 1, 2...6 ì˜ í˜•íƒœë¥¼ ê°€ì§€ê¸° ë•Œë¬¸ì— ë°ì´í„°ë¥¼ ê°€ê³µí•˜ëŠ” ê³¼ì •ì—ì„œ ìš°ë¦¬ëŠ” ìµìˆ™í•œ í˜•íƒœë¡œ ë°”ê¾¸ëŠ” ê²½ìš°ê°€ ìì£¼ ìˆë‹¤. ë¨¼ì € ë°ì´í„°í”„ë ˆì„ì„ í•œë²ˆ í™•ì¸í•´ë³´ì.  

```py
birth_date['weekday'] = birth_date['date'].dt.weekday
birth_date.head()
```
```
>>
        year	month	day	births	date	        weekday
0	1969	1	1	8486	1969-01-01	2
1	1969	1	2	9002	1969-01-02	3
2	1969	1	3	9542	1969-01-03	4
3	1969	1	4	8960	1969-01-04	5
4	1969	1	5	8390	1969-01-05	6
```  

ë¸”ë¡œê·¸ì˜ íŒë‹¤ìŠ¤ ì—°ìŠµí•œ í¬ìŠ¤íŒ… ì¤‘ì— í•œ ë°ì´í„°ë¥¼ ê¸ì–´ì™”ë‹¤.  

ìœ„ì˜ ë°ì´í„°í”„ë ˆì„ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë“¯ì´ ìš”ì¼ì„ ì˜ë¯¸í•˜ëŠ” ì—´ì¸ weekday ê°€ ìˆ«ìë¡œ ì í˜€ìˆë‹¤. ê·¸ëŸ¼ ì´ weekdayë¥¼ ìµìˆ™í•œ í˜•íƒœë¡œ ë¨¼ì € ë°”ê¿”ì£¼ì.  

```py
def weekday_func(row):
    if row['weekday'] == 0:
        row['weekday'] = 'Mon'
    elif row['weekday'] == 1:
        row['weekday'] = 'Tue'
    elif row['weekday'] == 2:
        row['weekday'] = 'Wed'
    elif row['weekday'] == 3:
        row['weekday'] = 'Thu'
    elif row['weekday'] == 4:
        row['weekday'] = 'Fri' 
    elif row['weekday'] == 5:
        row['weekday'] = 'Sat'
    elif row['weekday'] == 6:
        row['weekday'] = 'Sun'
    
    return row

birth_date = birth_date.apply(weekday_func, axis = 1)
birth_date.head()
```
```
>>
        year	month	day	births	date	        weekday
0	1969	1	1	8486	1969-01-01	Wed
1	1969	1	2	9002	1969-01-02	Thu
2	1969	1	3	9542	1969-01-03	Fri
3	1969	1	4	8960	1969-01-04	Sat
4	1969	1	5	8390	1969-01-05	Sun
```  

ì´ì œ ì´ ì¹œêµ¬ë¥¼ weekday ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í•´ë³´ì.  

```py
birth_date = birth_date.sort_values('weekday', ascending = False)
birth_date
```
```
>>
        year	month	day	births	date	        weekday
0	1969	1	1	8486	1969-01-01	Wed
6274	1985	7	3	11698	1985-07-03	Wed
6281	1985	7	10	11640	1985-07-10	Wed
2220	1974	10	16	9211	1974-10-16	Wed
2213	1974	10	9	9505	1974-10-09	Wed
...	...	...	...	...	...	        ...
1606	1973	3	9	9100	1973-03-09	Fri
6636	1986	6	27	11286	1986-06-27	Fri
5542	1983	7	22	11043	1983-07-22	Fri
1613	1973	3	16	8899	1973-03-16	Fri
4770	1981	7	3	9717	1981-07-03	Fri

7305 rows Ã— 6 columns
```  

ìš°ë¦¬ì—ê²Œ ìµìˆ™í•œ ì›”ìš”ì¼ë¶€í„° ì¼ìš”ì¼ê¹Œì§€ ì •ë ¬ë˜ëŠ” ëŠë‚Œì„ ì›í–ˆëŠ”ë°, ìŒ ì‹¤íŒ¨í–ˆë‹¤ğŸ˜….  

ì´ì œëŠ” Categorical í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ë³´ë„ë¡ í•˜ì.  

```py
birth_date['weekday'] = pd.Categorical(birth_date['weekday'], categories=['Mon','Tue','Wed','Thu','Fri','Sat','Sun'], ordered = True)
birth_date = birth_date.sort_values(['weekday', 'year'], ascending = True)
birth_date
```
```
>>
        year	month	day	births	date	        weekday
198	1969	7	7	10634	1969-07-07	Mon
219	1969	7	28	10548	1969-07-28	Mon
189	1969	6	30	10588	1969-06-30	Mon
241	1969	8	18	10650	1969-08-18	Mon
234	1969	8	11	10706	1969-08-11	Mon
...	...	...	...	...	...	        ...
7226	1988	1	31	8515	1988-01-31	Sun
7369	1988	6	19	9038	1988-06-19	Sun
7282	1988	3	27	8534	1988-03-27	Sun
7311	1988	4	24	8485	1988-04-24	Sun
7275	1988	3	20	8646	1988-03-20	Sun

7305 rows Ã— 6 columns
```  

ğŸŒµ ì´ì™•ì´ë©´ ë…„ë„ë„ ìˆœì„œëŒ€ë¡œ ë³´ê³  ì‹¶ì–´ì„œ year ì™€ weekday ë¥¼ ë™ì‹œì— sort_values í–ˆê³ , ê²°ê³¼ëŠ” ë³´ëŠ” ë°”ì™€ ê°™ì´ ì„±ê³µì´ë‹¤ğŸ‘. í•¨ìˆ˜ ë‚´ì— ì •ë ¬ì„ ì›í•˜ëŠ” ì‹œë¦¬ì¦ˆì™€ ì¹´í…Œê³ ë¦¬ë¥¼ ì§€ì •í•´ì£¼ê³ , ì •ë ¬ê°’ì— True ë¥¼ ë°°ì •í•´ì„œ ì‚¬ìš©í•œë‹¤. ë¬¸ë²•ì„ ì‚´í´ë³´ê³  ëë‚´ë„ë¡ í•˜ì.  

### ğŸ”‘ í•¨ìˆ˜ ë¬¸ë²•
* * *

<b>pd . Categorical ( ì‹œë¦¬ì¦ˆ, categories = [ì¹´í…Œê³ ë¦¬ë¦¬ìŠ¤íŠ¸], ordered = True )</b>  

```py
ex1 ) Series = pd.Categorical(Series, categories = [âšª, âšª, âšª],ordered = True)  

ex2 ) birth_date['weekday'] = pd.Categorical(birth_date['weekday'], categories=['Mon','Tue','Wed','Thu','Fri','Sat','Sun'], ordered = True)
```  
* * *

ğŸŒµ ê°€ë³ê²Œ Categoical í•¨ìˆ˜ì— ëŒ€í•´ì„œ ì‚´í´ë´¤ë‹¤. í•¨ìˆ˜ ë‚´ì— ì¼ì¼ì´ ì¹´í…Œê³ ë¦¬ ë¦¬ìŠ¤íŠ¸ë¥¼ ìˆœì„œì§€ì–´ ë„£ì–´ì¤˜ì•¼í•œë‹¤ëŠ” ì ì´ ì»¤ë‹¤ë€ ë°ì´í„° ë¶„ì„ì— ì‚¬ìš©í•˜ê¸°ì—ëŠ” ì•½ê°„ ê±¸ë¦¬ì§€ë§Œ datetime í•¨ìˆ˜ì™€ ì—®ì–´ì„œ ì‚¬ìš©í•  ë•ŒëŠ” í›¨ì”¬ ê¹”ë”í•œ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤ê³  ìƒê°í•œë‹¤. ì •ë ¬ì„ í•´ë„ ì›í•˜ëŠ” ê²°ê³¼ê°€ ì•ˆ ë‚˜ì˜¬ë•ŒëŠ” ì´ í•¨ìˆ˜ë¥¼ ì¨ë³´ëŠ” ê±´ ì–´ë–¨ê¹ŒğŸ˜Š!!
