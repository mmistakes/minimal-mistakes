---
title:  "[Python Pandas] GroupBy ë¥¼ ì´ìš©í•œ ì§‘ê³„ - sum, count, min, etc"
layout: single

categories: "Pandas"
tags: 
    - Python
    - Pandas

toc: true
toc_sticky: true
toc_label : "ëª©ì°¨"
author_profile: false
sidebar:
    nav: "study"
---

***

# ê·¸ë£¹í™” (GroupBy)
ê·¸ë£¹í™”ëŠ” ë‹¤ìŒ ë‹¨ê³„ ì¤‘ í•˜ë‚˜ ì´ìƒì„ í¬í•¨í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ì´ë‹¤.
- ëª‡ ê°€ì§€ ê¸°ì¤€ì— ë”°ë¼ ë°ì´í„°ë¥¼ ê·¸ë£¹ìœ¼ë¡œ **ë¶„í•  (splitting)**
- ê° ê·¸ë£¹ì— ë…ë¦½ì ìœ¼ë¡œ ê¸°ëŠ¥ì„ **ì ìš© (applying)**
- ê²°ê³¼ë¥¼ ë°ì´í„° êµ¬ì¡°ë¡œ **ê²°í•© (combining)**

<br>

# ì ìš©í•˜ë©° ë°°ì›Œë³´ëŠ” GroupBy
ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì§‘ê³„ ë©”ì†Œë“œ(method) ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. 
- count, sum
- min, max
- mean, median
- std, var, quantile
- first, last

## ë°ì´í„° ì •ë³´
- Dataset : KOSIS ì˜ë£Œê¸°ê´€ì¢…ë³„ í™˜ì ìˆ˜ (2014 ~ 2017)
- Dataset ë¯¸ë¦¬ë³´ê¸° ( ì•„ë˜ ì½”ë“œì˜ ê²°ê³¼ë¬¼ )
- [ğŸ‘‰ ë°ì´í„° ë³´ëŸ¬ê°€ê¸°](https://kosis.kr/statHtml/statHtml.do?orgId=117&tblId=DT_117030_001)

```python
# ë°ì´í„° ë¡œë“œ
df = pd.read_excel(file_name)
# ì»¬ëŸ¼ì„ êµ¬ì„±í•˜ê³  ìˆëŠ” ì—°ì›” ì •ë³´ë¥¼ í–‰ìœ¼ë¡œ ë…¹ì´ê¸°
df = df[df["ì˜ë£Œê¸°ê´€ì¢…ë³„(1)"]!="ì˜ë£Œê¸°ê´€ì¢…ë³„(1)"]
df = df.melt(id_vars="ì˜ë£Œê¸°ê´€ì¢…ë³„(1)", var_name="ì—°ë„", value_name="í™˜ììˆ˜")
# ê²°ì¸¡ì¹˜ ì œê±° ë° í™˜ì ìˆ˜ ë°ì´í„° íƒ€ì… str -> float 
df = df[df["í™˜ììˆ˜"] != "-"]
df["í™˜ììˆ˜"] = df["í™˜ììˆ˜"].astype("float")
df.head()
```

||	ì˜ë£Œê¸°ê´€ì¢…ë³„(1)|	ì—°ë„	|í™˜ììˆ˜|
|:---|:---|:---|:---|
|0|	ì „ì²´|	2014|	9105050.0|
|1	|ìƒê¸‰ì¢…í•©ë³‘ì›	|2014	|1615801.0|
|2	|ì¢…í•©ë³‘ì›|	2014|	2929371.0|
|3	|ë³‘ì›	|2014|	2751873.0|
|4	|ìš”ì–‘ë³‘ì›|	2014|	267349.0|

## íŠ¹ì • ì»¬ëŸ¼ì— ëŒ€í•´ ì§‘ê³„ ë©”ì†Œë“œ ì‚¬ìš©

### (1) ì˜ë£Œê¸°ê´€ì¢…ë³„, ì „ ì—°ë„ í™˜ì ìˆ˜

```python
df.groupby(by="ì˜ë£Œê¸°ê´€ì¢…ë³„(1)").sum()
```

|	|í™˜ììˆ˜|
|:--|:--|
|ì˜ë£Œê¸°ê´€ì¢…ë³„(1)||
|ë³‘ì›	|4.739752e+08|
|ë³´ê±´ì†Œ|	3.340283e+07|
|ë³´ê±´ì˜ë£Œì›|	4.168446e+06|
|ë³´ê±´ì§€ì†Œ|	2.224900e+07|
|ë³´ê±´ì§„ë£Œì†Œ|	2.761705e+07|
|ìƒê¸‰ì¢…í•©ë³‘ì›|	2.935339e+08|
|ìš”ì–‘ë³‘ì›|	2.645382e+07|
|ì˜ì›|	3.802586e+09|
|ì „ì²´|	6.512185e+09|
|ì¢…í•©ë³‘ì›|	5.096768e+08|
|ì¹˜ê³¼ë³‘ì›|	2.853760e+07|
|ì¹˜ê³¼ì˜ì›|	4.880480e+08|
|í•œë°©ë³‘ì›|	4.046266e+07|
|í•œì˜ì›	|7.614742e+08|


### (2) ì˜ë£Œê¸°ê´€ì¢…ë³„, ì „ ì—°ë„ì—ì„œ ìµœëŒ€ í™˜ì ìˆ˜

```python
df.groupby(by="ì˜ë£Œê¸°ê´€ì¢…ë³„(1)")[["í™˜ììˆ˜"]].max()
```

||í™˜ììˆ˜|
|:--|:--|
|ì˜ë£Œê¸°ê´€ì¢…ë³„(1)|||	
|ë³‘ì›|	65060724.0|
|ë³´ê±´ì†Œ|	5934208.0|
|ë³´ê±´ì˜ë£Œì›|	638740.0|
|ë³´ê±´ì§€ì†Œ|	3949565.0|
|ë³´ê±´ì§„ë£Œì†Œ|	4543564.0|
|ìƒê¸‰ì¢…í•©ë³‘ì›|	41275591.0|
|ìš”ì–‘ë³‘ì›|	3158237.0|
|ì˜ì›|	568961314.0|
|ì „ì²´|	962975033.0|
|ì¢…í•©ë³‘ì›|	72005122.0|
|ì¹˜ê³¼ë³‘ì›|	4613219.0|
|ì¹˜ê³¼ì˜ì›|	76061268.0|
|í•œë°©ë³‘ì›|	6798600.0|
|í•œì˜ì›|	113727539.0|


<br>

# Reference
- [[Pandas ê³µì‹ë¬¸ì„œ] - pandas.DataFrame.groupby](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.groupby.html)
- [[Pandas 0.23.1 ë¬¸ì„œ] - pandas.core.groupby.DataFrameGroupBy.agg](https://pandas.pydata.org/pandas-docs/version/0.23/generated/pandas.core.groupby.DataFrameGroupBy.agg.html)
- [[ë°ì‡ê±¸ì¦ˆ2] Pandas 10ë¶„ ì™„ì„± - 7. Grouping(ê·¸ë£¹í™”)](https://dataitgirls2.github.io/10minutes2pandas/)

<br>

***