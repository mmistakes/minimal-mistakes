---
title:  "Chapter 5-5. ì¸ë²¤í† ë¦¬ : ì•„ì´í…œ íšŒë³µ" 

categories:
  -  Unity Lesson 3 
tags:
  - [Game Engine, Unity]

toc: true
toc_sticky: true

date: 2020-10-05
last_modified_at: 2020-10-05
---

ì¸í”„ëŸ°ì— ìˆëŠ” ì¼€ì´ë””ë‹˜ì˜ **[ìœ ë‹ˆí‹° 3D] ì‹¤ì „! ìƒì¡´ê²Œì„ ë§Œë“¤ê¸° - Advanced** ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ í•„ê¸°ì…ë‹ˆë‹¤. ğŸ˜€  
[ğŸŒœ ê°•ì˜ ë“¤ìœ¼ëŸ¬ ê°€ê¸° Click](https://www.inflearn.com/course/unity-2#)
{: .notice--warning}


# Chapter 5. ì¸ë²¤í† ë¦¬

## ğŸš– í¬ì…˜ ì•„ì´í…œ ë§Œë“¤ê¸°

![image](https://user-images.githubusercontent.com/42318591/95030024-70866500-06e7-11eb-85c8-e1fca96c6886.png)

![image](https://user-images.githubusercontent.com/42318591/95030031-7e3bea80-06e7-11eb-9a74-fd9f82fdc2eb.png)


> ì´ë¦„ì€ `Potion Yellow Item`

- "Item" íƒœê·¸, ë ˆì´ì–´
- Box Collider 
- Rigidbody
- ğŸ“œItemPickUp
  - `Potion Yellow` item ë§Œë“¤ì–´ì„œ í• ë‹¹
    - ì•„ì´í…œ íƒ€ì…ì€ Used

<br>

## ğŸš– í¬ì…˜ ë¨¹ìœ¼ë©´ íšŒë³µí•˜ê²Œ í•˜ê¸°

ì¸ë²¤í† ë¦¬ì—ì„œ í•´ë‹¹ í¬ì…˜ì— ìš°í´ë¦­í•˜ë©´ ì†Œëª¨ë˜ë„ë¡ í•œë‹¤.

### ğŸ“œItemEffectDatabase.cs

> ë¹ˆ ì˜¤ë¸Œì íŠ¸ `Database`ë¥¼ ë§Œë“¤ê³  ğŸ“œItemEffectDatabase.cs ì„ ë¶™ì—¬ ì£¼ì—ˆë‹¤.

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

[System.Serializable]
public class ItemEffect
{
    public string itemName;  // ì•„ì´í…œì˜ ì´ë¦„(Keyê°’ìœ¼ë¡œ ì‚¬ìš©í•  ê²ƒ)
    [Tooltip("HP, SP, DP, HUNGRY, THIRSTY, SATISFY ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.")]
    public string[] part;  // íš¨ê³¼. ì–´ëŠ ë¶€ë¶„ì„ íšŒë³µí•˜ê±°ë‚˜ í˜¹ì€ ê¹ì„ í¬ì…˜ì¸ì§€. í¬ì…˜ í•˜ë‚˜ë‹¹ ë¯¸ì¹˜ëŠ” íš¨ê³¼ê°€ ì—¬ëŸ¬ê°œì¼ ìˆ˜ ìˆì–´ ë°°ì—´.
    public int[] num;  // ìˆ˜ì¹˜. í¬ì…˜ í•˜ë‚˜ë‹¹ ë¯¸ì¹˜ëŠ” íš¨ê³¼ê°€ ì—¬ëŸ¬ê°œì¼ ìˆ˜ ìˆì–´ ë°°ì—´. ê·¸ì— ë”°ë¥¸ ìˆ˜ì¹˜.
}

public class ItemEffectDatabase : MonoBehaviour
{
    [SerializeField]
    private ItemEffect[] itemEffects;

    private const string HP = "HP", SP = "SP", DP = "DP", HUNGRY = "HUNGRY", THIRSTY = "THIRSTY", SATISFY = "SATISFY";

    [SerializeField]
    private StatusController thePlayerStatus;
    [SerializeField]
    private WeaponManager theWeaponManager;

    public void UseItem(Item _item)
    {
        if (_item.itemType == Item.ItemType.Equipment)
        {
            // ì¥ì°©
            StartCoroutine(theWeaponManager.ChangeWeaponCoroutine(_item.weaponType, _item.itemName));
        }
        if (_item.itemType == Item.ItemType.Used)
        {
            for (int i = 0; i < itemEffects.Length; i++)
            {
                if (itemEffects[i].itemName == _item.itemName)
                {
                    for (int j = 0; j < itemEffects[i].part.Length; j++)
                    {
                        switch(itemEffects[i].part[j])
                        {
                            case HP:
                                thePlayerStatus.IncreaseHP(itemEffects[i].num[j]);
                                break;
                            case SP:
                                thePlayerStatus.IncreaseStamina(itemEffects[i].num[j]);
                                break;
                            case DP:
                                thePlayerStatus.IncreaseDP(itemEffects[i].num[j]);
                                break;
                            case THIRSTY:
                                thePlayerStatus.IncreaseThirsty(itemEffects[i].num[j]);
                                break;
                            case HUNGRY:
                                thePlayerStatus.IncreaseHungry(itemEffects[i].num[j]);
                                break;
                            case SATISFY:
                                break;
                            default:
                                Debug.Log("ì˜ëª»ëœ Status ë¶€ìœ„. HP, SP, DP, HUNGRY, THIRSTY, SATISFY ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.");
                                break;
                        }
                        Debug.Log(_item.itemName + " ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.");
                    }
                    return;
                }
            }
            Debug.Log("itemEffectDatabaseì— ì¼ì¹˜í•˜ëŠ” itemNameì´ ì—†ìŠµë‹ˆë‹¤.");
        }
    }
}

```

- ItemEffect í´ë˜ìŠ¤ ğŸ‘‰ í•œ ì•„ì´í…œì˜ íš¨ê³¼.
  - `[System.Serializable]`ë¡œ ì„ ì–¸ë˜ì–´ì„œ ì´ í´ë˜ìŠ¤ì˜ ë©¤ë²„ë“¤ì€ MonoBehaviour ì„ ìƒì† ë°›ëŠ” í´ë˜ìŠ¤ê°€ ì•„ë‹Œ ì¼ë°˜ C# í´ë˜ìŠ¤ì„ì—ë„ ë¶ˆêµ¬í•˜ê³  ìœ ë‹ˆí‹° ì¸ìŠ¤í™í„°ì— ë„ì›Œ ì—¬ê¸°ì„œ ê°’ì„ í• ë‹¹í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤.
  - `part`ì™€ `num` ì˜ ì¸ë±ìŠ¤ëŠ” ëŒ€ì‘ë˜ê²Œ í•  ê²ƒì´ë‹¤. part[2]ê°€ HUNGRY ë¼ë©´ num[2] ì˜ ì›ì†Œ ê°’ì€ HUNGRY ì— ëŒ€í•œ ìˆ˜ì¹˜ 
  - `itemName`ì— í•´ë‹¹í•˜ëŠ” í•˜ë‚˜ì˜ ì•„ì´í…œì€ `part` ë°°ì—´ì— ì†í•œ ë¶€ë¶„ë“¤ì— ëŒ€í•œ íš¨ê³¼ë¥¼ ê°€ì§„ë‹¤. ê·¸ì— ëŒ€ì‘í•˜ëŠ” íš¨ê³¼ ìˆ˜ì¹˜ëŠ” `num` ë°°ì—´ì— í•´ë‹¹. 
- `itemEffects` 
  - private ìœ¼ë¡œ ì„ ì–¸ë˜ì—ˆê¸° ë•Œë¬¸ì— ItemEffect í´ë˜ìŠ¤ê°€ `[System.Serializable]`ê¸´ í•˜ë”ë¼ë„ `SerializeField` í•´ì£¼ì–´ì•¼ ë¹„ë¡œì†Œ ìœ ë‹ˆí‹° ì¸ìŠ¤í™í„°ì— ëœ¨ê²Œ ëœë‹¤.
  - <u>ë°°ì—´ì´ë‹¤. ğŸ“œItemEffectDatabase.cs ì—ì„œ ì—¬ëŸ¬ í¬ì…˜ ì•„ì´í…œë“¤ì„ ì´ `itemEffects`  ë°°ì—´ ë©¤ë²„ì—ì„œ í•œë²ˆì— ê´€ë¦¬ í•˜ê²Œ ë¨.</u>
- *UseItem(Item _item)* ì•„ì´í…œ ì†Œëª¨ì‹œ ğŸ‘‰ ğŸ“œSlot.csì˜ ìš°í´ë¦­ ì´ë²¤íŠ¸ì—ì„œ ì²˜ë¦¬ í–ˆì—ˆëŠ”ë° ì„±ëŠ¥ì„ ìœ„í•´ ì´ ìŠ¤í¬ë¦½íŠ¸ë¡œ ì˜®ê²¼ë‹¤.
  - ì•„ì´í…œì´ ì¥ë¹„ë©´ ì¥ì°©í•˜ê³ 
    - ë•Œë¬¸ì— ğŸ“œWeaponManager.cs ê°€ í•„ìš” í•˜ë‹¤. 
      - ë‹¤ë§Œ `Slot`ê³¼ ë‹¤ë¥´ê²Œ `Database`ëŠ” í”„ë¦¬íŒ¹ì€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— FindObejctOfTypeì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì§ì ‘ í• ë‹¹í•´ì£¼ê¸°ë¡œ í•˜ì˜€ë‹¤. `[SerializeField]`.
  - ì•„ì´í…œì´ ì†Œëª¨í’ˆì´ë©´ ğŸ‘ˆ í¬ì…˜ì´ í•´ë‹¹ ë¨
    - í•´ë‹¹ ìˆ˜ì¹˜ì— ë§ê²Œ íš¨ê³¼ ì ìš©
      - ì¸ìˆ˜ë¡œ ë“¤ì–´ì˜¨ ì•„ì´í…œì˜ ì´ë¦„ì´ `itemEffects` ë°°ì—´ì— ìˆëŠ”ì§€ë¥¼ ì°¾ê³ 
      - ì°¾ì•˜ë‹¤ë©´ í•´ë‹¹ ì•„ì´í…œì˜ íš¨ê³¼ë“¤ì„ ğŸ“œStatusController.cs ì˜ í•¨ìˆ˜ë“¤ì„ í˜¸ì¶œí•˜ì—¬ ì ìš©í•œë‹¤.
        - *IncreaseHP* ë“±ë“±
      - ëª¨ë“  íš¨ê³¼ë¥¼ ì ìš©í–ˆë‹¤ë©´ ë°”ë¡œ ì¢…ë£Œ. `itemEffects` ë°°ì—´ì— ìˆëŠ”ì§€ë¥¼ ë” ì°¾ì„ í•„ìš”ê°€ ì—†ìœ¼ë¯€ë¡œ.



![image](https://user-images.githubusercontent.com/42318591/95029991-31f0aa80-06e7-11eb-93cd-a17e80b453cd.png)


- Potion Yellow ì•„ì´í…œì„ ì†Œë¹„ í•˜ë©´
  - SP ê°€ 500 ìœ¼ë¡œ ì¦ê°€í•˜ê³ 
  - HUNGRY ê°€ 100 ìœ¼ë¡œ ì¦ê°€í•˜ê³ 
  - THIRSTY ê°€ 100 ìœ¼ë¡œ ì¦ê°€í•˜ê²Œë” í•˜ì˜€ë‹¤.

<br>

### ğŸ“œSlot.cs

```c#
private ItemEffectDatabase theItemEffectDatabase;

    void Start()
    {
        baseRect = transform.parent.parent.GetComponent<RectTransform>().rect;

        theInputNumber = FindObjectOfType<InputNumber>();
        theItemEffectDatabase = FindObjectOfType<ItemEffectDatabase>();
    }

    // ë§ˆìš°ìŠ¤ í´ë¦­ ì´ë²¤íŠ¸
    public void OnPointerClick(PointerEventData eventData)
    {
        if(eventData.button == PointerEventData.InputButton.Right)
        {
            if (item != null)
            {
                theItemEffectDatabase.UseItem(item);

                if(item.itemType == Item.ItemType.Used)
                    SetSlotCount(-1);
            }
        }
    }
```

- `Slot`ì€ í”„ë¦¬íŒ¹ì´ê¸° ë•Œë¬¸ì— ë‹¤ë¥¸ ì˜¤ë¸Œì íŠ¸ë¥¼ *FindObjectOfType* ë¡œ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ë°–ì— ì—†ë‹¤. ë˜í•œ 20ê°œë‚˜ ë˜ê¸° ë•Œë¬¸ì— ì¸ë²¤í† ë¦¬ê°€ í™œì„±í™” ë˜ì–´ ìŠ¬ë¡¯ë„ í™œì„±í™” ë  ë•Œ, *Start()* ì—ì„œ ë„ˆë¬´ ë§ì€ ì»´í¬ë„ŒíŠ¸ë¥¼ ë¡œë”©í•œë‹¤ë©´ ì„±ëŠ¥ì— ë¬¸ì œê°€ ìƒê¸¸ ê²ƒì´ë‹¤.
  - ë”°ë¼ì„œ ğŸ“œSlot.cs ì˜ ğŸ“œWeaponManager.cs ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë¶€ë¶„ì„ ì§€ì› ë‹¤. ì•„ë˜ ì½”ë“œë¥¼ ì§€ìš°ê³  ìœ„ì™€ ê°™ì´ ê³ ì¹¨. ëŒ€ì‹  ì´ì™€ ê°™ì€ ê³¼ì •ì€ ğŸ“œItemEffectDatabase ì—ì„œ í•˜ë„ë¡ ì˜®ê²¼ë‹¤.
  - ìˆ˜ì • ì „ ğŸ“œSlot.cs
    ```c#
    public void OnPointerClick(PointerEventData eventData)
    {
        if(eventData.button == PointerEventData.InputButton.Right)
        {
            if (item != null)
            {
                if(item.itemType == Item.ItemType.Equipment) // ğŸ‘ˆğŸ‘ˆğŸ‘ˆğŸ‘ˆğŸ‘ˆğŸ‘ˆğŸ‘ˆ
                {
                    // ì¥ì°©
                    StartCoroutine(theWeaponManager.ChangeWeaponCoroutine(item.weaponType, item.itemName));
                }
                else // ğŸ‘ˆğŸ‘ˆğŸ‘ˆğŸ‘ˆğŸ‘ˆğŸ‘ˆğŸ‘ˆ
                {
                    // ì†Œë¹„
                    Debug.Log(item.itemName + " ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.");
                    SetSlotCount(-1);
                }
            }
        }
    }
    ```
  - ğŸ“œItemEffectDatabase.cs
    ```c#
    public void UseItem(Item _item)
    {
        if (_item.itemType == Item.ItemType.Equipment) // ğŸ‘ˆğŸ‘ˆğŸ‘ˆğŸ‘ˆğŸ‘ˆğŸ‘ˆğŸ‘ˆ
        {
            // ì¥ì°©
            StartCoroutine(theWeaponManager.ChangeWeaponCoroutine(_item.weaponType, _item.itemName));
        }
        if (_item.itemType == Item.ItemType.Used) // ğŸ‘ˆğŸ‘ˆğŸ‘ˆğŸ‘ˆğŸ‘ˆğŸ‘ˆğŸ‘ˆ
        {
            // ì†Œë¹„
            for (int i = 0; i < itemEffects.Length; i++)
            {
                if (itemEffects[i].itemName == _item.itemName)
                {
                    for (int j = 0; j < itemEffects[i].part.Length; j++)
                    {
                        switch(itemEffects[i].part[j])
                        {
                            case HP:
                                thePlayerStatus.IncreaseHP(itemEffects[i].num[j]);
                                break;
                            case SP:
                                thePlayerStatus.IncreaseStamina(itemEffects[i].num[j]);
                                break;
                            case DP:
                                thePlayerStatus.IncreaseDP(itemEffects[i].num[j]);
                                break;
                            case THIRSTY:
                                thePlayerStatus.IncreaseThirsty(itemEffects[i].num[j]);
                                break;
                            case HUNGRY:
                                thePlayerStatus.IncreaseHungry(itemEffects[i].num[j]);
                                break;
                            case SATISFY:
                                break;
                            default:
                                Debug.Log("ì˜ëª»ëœ Status ë¶€ìœ„. HP, SP, DP, HUNGRY, THIRSTY, SATISFY ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.");
                                break;
                        }
                        Debug.Log(_item.itemName + " ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.");
                    }
                    return;
                }
            }
            Debug.Log("itemEffectDatabaseì— ì¼ì¹˜í•˜ëŠ” itemNameì´ ì—†ìŠµë‹ˆë‹¤.");
        }
    }
    ```
- ìˆ˜ì • í›„ ğŸ“œSlot.cs
  - ë¬´ê¸°ë“  ì†Œëª¨í’ˆì´ë“ , ì•„ì´í…œ ì‚¬ìš©ì— ëŒ€í•œ ì²˜ë¦¬ë¥¼ ğŸ“œItemEffectDatabase.cs ì˜ *UseItem* í•¨ìˆ˜ì—ê²Œ ì „ì ìœ¼ë¡œ ë§¡ê¸°ê²Œ ë˜ì—ˆë‹¤.
    - ëŒ€ì‹  í•´ë‹¹ ì•„ì´í…œì´ ì†Œëª¨í’ˆì¼ ë• ì•„ì´í…œ ê°¯ìˆ˜ë¥¼ 1 ê°ì†Œì‹œí‚¤ëŠ” ì²˜ë¦¬ë¥¼ í•´ì£¼ì—ˆë‹¤. 
  ```c#
        if(eventData.button == PointerEventData.InputButton.Right)
        {
            if (item != null)
            {
                theItemEffectDatabase.UseItem(item);

                if(item.itemType == Item.ItemType.Used)
                    SetSlotCount(-1);
            }
        }
  ```


***
<br>

    ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš° 
    ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}