---
title:  "Chapter 12-4. ê¸°íƒ€ : ë¬¼ êµ¬í˜„í•˜ê¸°" 

categories:
  -  Unity Lesson 3 
tags:
  - [Game Engine, Unity]

toc: true
toc_sticky: true

date: 2020-12-14
last_modified_at: 2020-12-14
---

ì¸í”„ëŸ°ì— ìˆëŠ” ì¼€ì´ë””ë‹˜ì˜ **[ìœ ë‹ˆí‹° 3D] ì‹¤ì „! ìƒì¡´ê²Œì„ ë§Œë“¤ê¸° - Advanced** ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ í•„ê¸°ì…ë‹ˆë‹¤. ğŸ˜€  
[ğŸŒœ ê°•ì˜ ë“¤ìœ¼ëŸ¬ ê°€ê¸° Click](https://www.inflearn.com/course/unity-2#)
{: .notice--warning}


## ğŸš€ ìœ ë‹ˆí‹°ì—ì„œ ë¬¼ ë„£ëŠ” ë°©ë²•

1. ìš°í´ - Import Package - Environment
  - ìœ ë‹ˆí‹° ìì²´ì—ì„œ ì œê³µí•˜ëŠ” íŒ¨í‚¤ì§€ë¥¼ ì„í¬íŠ¸í•˜ë©´ ë¨. Waterë„ ê°™ì´ ì œê³µí•¨.
2. ìœ ë‹ˆí‹° ì—ì…‹ ìŠ¤í† ì–´ì—ì„œ ë¬¼ê³¼ ê´€ë ¨ëœê±° êµ¬ì…í•´ì„œ ì„í¬íŠ¸
3. âœ¨ ì§ì ‘ ë§Œë“¤ê¸°. ì•„ë˜ 3ê°œê°€ í•„ìš”í•¨.
  - 1ï¸âƒ£ ë¬¼ í‘œë©´ í…ìŠ¤ì²˜
  - 2ï¸âƒ£ ë¬¼ ì‰ì´ë”
  - 3ï¸âƒ£ ì‰ì´ë”ë¥¼ ì…í ë¬¼ ë¨¸í…Œë¦¬ì–¼

<br>

## ğŸš€ ë¬¼ êµ¬í˜„í•˜ê¸°

### ë¬¼ ë¨¸í…Œë¦¬ì–¼

![image](https://user-images.githubusercontent.com/42318591/102067761-e96c1080-3e3e-11eb-81ad-0108902a6062.png)

![image](https://user-images.githubusercontent.com/42318591/102067773-eec95b00-3e3e-11eb-9309-6c3596f5c7f6.png)


ì‰ì´ë” íŒŒì¼ì„ ë“œë˜ê·¸í•´ì„œ ë¨¸í…Œë¦¬ì–¼ì—ë‹¤ ë“œë¡­í•˜ë©´ ì´ë ‡ê²Œ ë¨¸í…Œë¦¬ì–¼ì— ì‰ì´ë”ë¥¼ ê°„ë‹¨í•˜ê²Œ ì…í ìˆ˜ ìˆë‹¤. (í•«í•‘í¬ ìƒíƒœëŠ” ì•„ì§ ë¨¸í…Œë¦¬ì–¼ì— ì‰ì´ë”ê°€ ì…í˜€ì§€ì§€ ì•Šì€ ìƒíƒœë¥¼ ì˜ë¯¸í•œë‹¤.)

![image](https://user-images.githubusercontent.com/42318591/102067930-1fa99000-3e3f-11eb-836c-bb9e8d4963e6.png)

<br>

### ë¬¼ ì˜¤ë¸Œì íŠ¸

![image](https://user-images.githubusercontent.com/42318591/102068229-8f1f7f80-3e3f-11eb-82a9-290591c5ab85.png)

ë¬¼ í‘œë©´ìœ¼ë¡œ ì“¸ `Plane` ì˜¤ë¸Œì íŠ¸ì— ë¬¼ ë¨¸í…Œë¦¬ì–¼ì„ ì…íŒë‹¤. `Plane`ì— ê¸°ë³¸ì ìœ¼ë¡œ ë¶™ì–´ìˆëŠ” Mesh Collider ëŠ” ì œê±°í•´ì¤€ë‹¤. ë¬¼ í‘œë©´ ìœ„ë¥¼ í”Œë ˆì´ì–´ê°€ ê±¸ì„ ìˆ˜ ìˆìœ¼ë©´ ì•ˆë˜ë‹ˆê¹Œ! ë¬¼ í‘œë©´ì„ ë°Ÿìœ¼ë©´ ë¬¼ì— ê´€í†µë˜ì–´ ë“¤ì–´ê°ˆ ìˆ˜ ìˆì–´ì•¼ í•˜ë¯€ë¡œ Colliderë¥¼ ì œê±°í•´ì£¼ëŠ” ê²ƒì´ë‹¤. ì‚¬ì‹¤ìƒ ë¬¼ í‘œë©´ì„ ì‹œê°ì ìœ¼ë¡œ ë³´ì—¬ì¤„ í‘œë©´ ì˜¤ë¸Œì íŠ¸ë§Œ ìˆê³  ë¬¼ ì†ì€ í……í…… ë¹„ì–´ìˆëŠ” ê²ƒì´ë‹¤! 

![image](https://user-images.githubusercontent.com/42318591/102069166-bd518f00-3e40-11eb-9c8d-55fb3f7cc331.png)

ì´ë ‡ê²Œ ë¬¼ í‘œë©´ `Plane` ì˜¤ë¸Œì íŠ¸ë¥¼ ì—¬ëŸ¬ê°œ ë§Œë“¤ì–´ ë¬¼ ì›…ë©ì´ë¡œ ë§Œë“¤ ê³µê°„ì„ ë®ì–´ì¤€ë‹¤. ê·¸ë¦¬ê³  ì´ë“¤ì„ `Water`ë¼ëŠ” ìì‹ë“¤ë¡œ í•˜ë‚˜ë¡œ ë¬¶ì–´ì¤€ë‹¤.

![image](https://user-images.githubusercontent.com/42318591/102069905-b8d9a600-3e41-11eb-83e6-bc47eb9c5da4.png)

ë¬¼ ì†ì— ë“¤ì–´ê°€ë©´ ë¬¼ ì†ì— ë“¤ì–´ê°„ì§€ë¥¼ ì•Œì•„ì•¼ í•˜ë¯€ë¡œ íŠ¸ë¦¬ê±°ê°€ ì²´í¬ëœ í° ì½œë¼ì´ë”ë¥¼ `Water`ì— ë¶™ì´ê³  ë¬¼ ì†ì— ë„£ì–´ì¤€ë‹¤. ì‚¬ì‹¤ìƒ ì´ ê³³ì€ ë¹ˆ ê³µê°„ì´ì§€ë§Œ ì½œë¼ì´ë”ì— ê´€í†µë˜ë©´ ì§„ì§œ ë¬¼ ì†ì— ìˆëŠ” ê²ƒì²˜ëŸ¼ í™”ë©´ì„ íŒŒë—ê²Œ í•´ì£¼ê³  ì €í•­ë ¥ì„ ë†’ì—¬ì£¼ëŠ” ë“±ë“± ê°–ê°€ì§€ íš¨ê³¼ë¥¼ ì¤„ê²ƒì´ë‹¤.

<br>

## ğŸš€ ë¬¼ ê´€ë ¨ ì‚¬ìš´ë“œ

![image](https://user-images.githubusercontent.com/42318591/102310526-797c9800-3fae-11eb-8607-4a3fa8ef80f5.png)

`SoundManager`ì— ë¬¼ê³¼ ê´€ë ¨ëœ ì‚¬ìš´ë“œ 3 ê°œë¥¼ ì¶”ê°€í•´ì£¼ì—ˆë‹¤. ì‚¬ìš´ë“œ ë§¤ë‹ˆì €ë¡œ ì¬ìƒì‹œí‚¬ê±°ë¼ì„œ..

<br>

## ğŸš€ ë¬¼ì— ë“¤ì–´ê°”ì„ ë•Œ

### ğŸ“œGameManager

```c#
    public static bool isNight = false;
    public static bool isWater = false;
```

- ë°¤ì¸ì§€, ë¬¼ì†ì¸ì§€ë„ ğŸ“œGameManagerë¡œ ê´€ë¦¬ë˜ê²Œ
  - ë°¤ì´ë©´ True
  - ë¬¼ ì†ì´ë©´ True

<br>


### ğŸ“œDayAndNight

ê¸°ì¡´ì˜ ë©¤ë²„ `isNight` ì§€ìš°ê³  ì „ë¶€ `GameManager.isNight`ë¡œ ëŒ€ì²´í•¨!

<br>

### ğŸ“œWater

> `Water`ì— ë¶™ì¸ë‹¤.

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class Water : MonoBehaviour
{
    [SerializeField] private float waterDrag; // ë¬¼ ì† ì €í•­ë ¥
    private float originDrag; // ë¬¼ ë°– ì„¸ìƒì˜ ì›ë˜ ì €í•­ë ¥

    private Color originColor; // ë¬¼ ë°– ì„¸ìƒì˜ ë‚®ì˜ ì›ë˜ Fog ìƒ‰ê¹”
    [SerializeField] private Color originNightColor;  // ë¬¼ ë°– ì„¸ìƒì˜ ë°¤ì˜ ì›ë˜ Fog ìƒ‰ê¹”

    [SerializeField] private Color waterColor; // ë‚®ì˜ ë¬¼ ì† Fog ìƒ‰ê¹”
    [SerializeField] private Color waterNightColor; // ë°¤ì˜ ë¬¼ ì† Fog ìƒ‰ê¹”

    [SerializeField] private float waterFogDensity; // ë‚®ì˜ ë¬¼ ì† íƒí•œ ì •ë„
    [SerializeField] private float waterNightFogDensity; // ë‚®ì˜ ë¬¼ ì† íƒí•œ ì •ë„

    private float originFogDensity; // ë¬¼ ë°– ì„¸ìƒì˜ ë‚®ì˜ íƒí•œ ì •ë„
    [SerializeField] private float originNightFogDensity; // ë¬¼ ë°– ì„¸ìƒì˜ ë°¤ì˜ íƒí•œ ì •ë„

    [SerializeField] private float breatheTime; 
    private float currentBreatheTime;

    [SerializeField] private GameObject thePlayer;

    [SerializeField] private string sound_WaterIn;
    [SerializeField] private string sound_WaterOut;
    [SerializeField] private string sound_WaterBreathe;

```

> ë¬¼ ì†ì¼ ë•ŒëŠ” Fog ìƒ‰ê¹”ì„ íŒŒë—ê²Œ í•˜ê³ , Fog ë°€ë„ë¥¼ ë” ë†’ì—¬ì£¼ì–´ì•¼ í•œë‹¤. 

ë‚®ê³¼ ë°¤ì¼ ë•Œì˜ ê°ê° ë¬¼ ì†ì˜ Fog ìƒ‰ê¹”ê³¼ ë°€ë„ê°€ ë‹¤ë¥´ë‹¤. 

```c#
    void Start()
    {
        originColor = RenderSettings.fogColor;
        originFogDensity = RenderSettings.fogDensity;

        originDrag = thePlayer.GetComponent<Rigidbody>().drag; 
    }

    void Update()
    {
        if (GameManager.isWater)
        {
            currentBreatheTime += Time.deltaTime;
            if (currentBreatheTime >= breatheTime)
            {
                SoundManager.instance.PlaySE(sound_WaterBreathe);
                currentBreatheTime = 0;
            }
        }
    }

    private void OnTriggerEnter(Collider other)
    {
        if (other.transform.tag == "Player")
            GetInWater(other);  // ë¬¼ì— ë“¤ì–´ê°
    }

    private void OnTriggerExit(Collider other)
    {
        if (other.transform.tag == "Player")
            GetOutWater(other);  // ë¬¼ì—ì„œ ë‚˜ì˜´
    }


    private void OnTriggerStay(Collider other)
    {
        if (other.transform.tag == "Player")
            SmoothColorChange();
    }

    private void SmoothColorChange()
    {
        if (!GameManager.isNight && RenderSettings.fogColor != waterColor)
            RenderSettings.fogColor = Color.Lerp(RenderSettings.fogColor, waterColor, 0.1f);

        if (GameManager.isNight && RenderSettings.fogColor != waterNightColor)
            RenderSettings.fogColor = Color.Lerp(RenderSettings.fogColor, waterNightColor, 0.1f);
    }

    private void GetInWater(Collider _player)
    {
        SoundManager.instance.PlaySE(sound_WaterIn);

        GameManager.isWater = true;
        _player.transform.GetComponent<Rigidbody>().drag = waterDrag;

        if (!GameManager.isNight) // ë‚®ì¼ë•Œ
        {
            RenderSettings.fogColor = waterColor;
            RenderSettings.fogDensity = waterFogDensity;
        }
        else // ë°¤ì¼ë•Œ
        {
            RenderSettings.fogColor = waterNightColor;
            RenderSettings.fogDensity = waterNightFogDensity;
        }
    }

    private void GetOutWater(Collider _player)
    {
        SoundManager.instance.PlaySE(sound_WaterOut);

        if (GameManager.isWater)
        {
            GameManager.isWater = false;
            _player.transform.GetComponent<Rigidbody>().drag = originDrag;

            if (!GameManager.isNight) // ë‚®ì¼ë•Œ
            {
                RenderSettings.fogColor = originColor;
                RenderSettings.fogDensity = originFogDensity;
            }
            else // ë°¤ì¼ë•Œ
            {
                RenderSettings.fogColor = originNightColor;
                RenderSettings.fogDensity = originNightFogDensity;
            }
        }
    }
}

```

- *Start*
  - ê²Œì„ì´ ì‹œì‘ë˜ë©´ ë‚®ì¼í…Œê¸° ë•Œë¬¸ì— ê°ê° `originColor`, `originFogDensity`ì—ëŠ” ë‚® ìƒíƒœì¼ë•Œì˜ ì•ˆê°œ ìƒ‰ê¹”, ì•ˆê°œ ë°€ë„ ê°’ì´ ë“¤ì–´ê°ˆ ê²ƒì´ë‹¤.
  - ë¬¼ ë°–ê³¼ ë¬¼ ì†ì˜ í”Œë ˆì´ì–´ì˜ ë¬¼ë¦¬ì  ì €í•­ë ¥ì´ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— `originDrag`ì— í”Œë ˆì´ì–´ì˜ ì €í•­ë ¥ì„ ê°€ì ¸ì™€ ì €ì¥í•œë‹¤.
- *Update*
  - anf thrdp dlTsms ehddksdpsms `breatheTime` ì‹œê°„ ê°„ê²©ë§ˆë‹¤ ë¬¼ ì†ì—ì„œ ìˆ¨ì‰¬ëŠ” íš¨ê³¼ìŒì„ ì¬ìƒí•œë‹¤.
- *OnTriggerEnter* ğŸ‘‰ ë¬¼ ì†ì„ ìë¦¬í•˜ëŠ” ê·¸ ì½œë¼ì´ë”
  - í”Œë ˆì´ì–´ê°€ ë¬¼ ì†ì— ë“¤ì–´ì˜¤ë©´ *GetInWater* í˜¸ì¶œ
- *GetInWater*
  - ì…ìˆ˜í•˜ëŠ” íš¨ê³¼ìŒ
  - ì €í•­ë ¥ì„ ë¬¼ì— ìˆì„ ë–„ì˜ ì €í•­ë ¥ìœ¼ë¡œ ì„¸íŒ…
  - ì•ˆê°œ ìƒ‰ê¹”ê³¼ ì•ˆê°œ ë°€ë„ë¥¼ ë‚®ì¸ì§€ ë°¤ì¸ì§€ì— ë”°ë¼ ê°ê° *ë‚®ì¼ë•Œì˜ ë¬¼*ì˜ ì•ˆê°œìƒ‰, ì•ˆê°œë°€ë„, *ë°¤ì¼ë•Œì˜ ë¬¼*ì˜ ì•ˆê°œìƒ‰, ì•ˆê°œë°€ë„ë¡œ ì„¸íŒ…í•œë‹¤.
- *OnTriggerExit* ğŸ‘‰ ë¬¼ ì†ì„ ìë¦¬í•˜ëŠ” ê·¸ ì½œë¼ì´ë”
  - í”Œë ˆì´ì–´ê°€ ë¬¼ ë°–ì— ë‚˜ê°€ë©´ *GetOutWater* í˜¸ì¶œ
- *GetOutWater*
  - *GetInWater*ì™€ ë°˜ëŒ€ë¡œ. ë¬¼ ë°– ì„¸ìƒì˜ ì—¬ëŸ¬ ë³€ìˆ˜ë“¤ì„ ë‚®ê³¼ ë°¤ì— ë”°ë¼ ì„¤ì •
- *OnTriggerStay* ğŸ‘‰ ë¬¼ ì†ì„ ìë¦¬í•˜ëŠ” ê·¸ ì½œë¼ì´ë”
  - í”Œë ˆì´ì–´ê°€ ë¬¼ ì†ì— ìˆëŠ” ë™ì•ˆ *SmoothColorChange* í˜¸ì¶œ
- *SmoothColorChange*
  - ë‚®ì¸ë° ì•„ì§ í˜„ì¬ ì•ˆê°œ ìƒ‰ê¹”ì´ ë‚®ì¼ë•Œì˜ ì•ˆê°œ ìƒ‰ê¹”ë¡œ ë³€í•˜ì§€ ì•Šì•˜ë‹¤ë©´ ì²œì²œíˆ Lerp ë¡œ ë¶€ë“œëŸ½ê²Œ ë°”ê¾¸ê²Œ í•˜ê¸°. ë°¤ì¼ ë• ê·¸ ë°˜ëŒ€.
  - ê°•ì˜ì—” ì—†ì—ˆëŠ”ë° ì¶”ê°€í•¨.

![image](https://user-images.githubusercontent.com/42318591/102078476-55a24080-3e4e-11eb-86e7-70930a6eafe7.png)

ì•ˆê°œ ìƒ‰ê¹”ì˜ ê²½ìš° ì•ŒíŒŒê°’ì„ ë†’ì—¬ì¤˜ì•¼ ë³´ì´ê²Œ ëœë‹¤. ë°¤ì—” ë¬¼ ì†ì— ìˆìœ¼ë©´ ë³´ë¼ìƒ‰ìœ¼ë¡œ ë³´ì´ê²Œë” í•˜ì˜€ë‹¤.

![image](https://user-images.githubusercontent.com/42318591/102078330-1a077680-3e4e-11eb-8e07-d16aecc94a39.png)

ë‚®ì— ë¬¼ ì†ì—ì„œ ë³´ëŠ” ì„¸ìƒ.

![image](https://user-images.githubusercontent.com/42318591/102078404-37d4db80-3e4e-11eb-896e-3345e787feb7.png)

ë°¤ì— ë¬¼ ì†ì—ì„œ ë³´ëŠ” ì„¸ìƒ.

***
<br>

    ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš° 
    ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}