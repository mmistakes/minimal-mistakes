---
title:  "Chapter 12-2. ê¸°íƒ€ : í¬íƒ‘(Defense Tower) ë§Œë“¤ê¸°" 

categories:
  -  Unity Lesson 3 
tags:
  - [Game Engine, Unity]

toc: true
toc_sticky: true

date: 2020-12-14
last_modified_at: 2020-12-14
---

ì¸í”„ëŸ°ì— ìˆëŠ” ì¼€ì´ë””ë‹˜ì˜ **[ìœ ë‹ˆí‹° 3D] ì‹¤ì „! ìƒì¡´ê²Œì„ ë§Œë“¤ê¸° - Advanced** ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ í•„ê¸°ì…ë‹ˆë‹¤. ğŸ˜€  
[ğŸŒœ ê°•ì˜ ë“¤ìœ¼ëŸ¬ ê°€ê¸° Click](https://www.inflearn.com/course/unity-2#)
{: .notice--warning}


## ğŸš€ í¬íƒ‘ ì˜¤ë¸Œì íŠ¸

![image](https://camo.githubusercontent.com/67453a7644f0fa1437622c8a0b9da833abc8ae58376f8f35b6700c25a4c93de0/68747470733a2f2f706f737466696c65732e707374617469632e6e65742f4d6a41794d4445794d545a664e4455672f4d4441784e6a41344d4467354f4449794f4445352e31337a6b6f464632475a35584c77355a6b4c59494d6c374a753047576744414d6d636861784e302d54476b672e572d7967594f3641466b796c446f6179396c67364962447a77632d6c576e4835327179723165354a366c41672e4749462e736f6879756e655f616e2f4749465f323032302d31322d31365f2545432539382541342545442539422538345f31322d33362d32382e6769663f747970653d77373733)

í‰ì†Œì—ëŠ” 360ë„ë¡œ í˜¼ì íšŒì „í•˜ë‹¤ê°€ í¬ì‹ ì´ í–¥í•˜ëŠ” ë°©í–¥ê³¼ í¬íƒ‘ì—ì„œ í”Œë ˆì´ì–´ë¥¼ í–¥í•˜ëŠ” ë°©í–¥ì´ ì¼ì¹˜í•˜ë©´ í”Œë ˆì´ì–´ë¥¼ ìœë‹¤. 

![image](https://user-images.githubusercontent.com/42318591/102056458-c128e580-3e2f-11eb-8678-a6e8b4964cee.png)

`TopGun`ì€ í¬ì‹ ì´ë‹¤. `Foundation`ì€ í¬íƒ‘ì˜ ëª¸ì²´ì´ë‹¤. `Foundation`ì€ í”Œë ˆì´ì–´ê°€ ê´€í†µí•˜ì§€ ëª»í•˜ë„ë¡ Colliderë¥¼ ë¶™ì—¬ì£¼ì—ˆë‹¤.

![image](https://user-images.githubusercontent.com/42318591/102058782-62fe0180-3e33-11eb-940d-86fbfee60dd6.png)

ì´ì˜ ë©”ì‹œê°€ ë˜ëŠ” `SubMachineGun2`ì€ ì›ë˜ ë•…ì— ëˆ•í˜€ì ¸ìˆë˜ ëª¨ì–‘ì´ ë””í´íŠ¸ì˜€ì–´ì„œ x ì¶• ì¤‘ì‹¬ìœ¼ë¡œ -90ë„ íšŒì „í•´ì£¼ì–´ ì¼ìœ¼ì¼°ë‹¤. ê·¸ë˜ì„œ ì´ë ‡ê²Œ í¬ì‹ ì˜ ì•(Zì¶•)ì´ í•˜ëŠ˜ì„ í–¥í•˜ëŠ” ëª¨ì–‘ìƒˆê°€ ë˜ì—ˆë‹¤. í¬ì‹ ì´ í–¥í•˜ëŠ” ë°©í–¥ê³¼ í¬íƒ‘ì—ì„œ í”Œë ˆì´ì–´ë¥¼ í–¥í•˜ëŠ” ë°©í–¥ì´ ì¼ì¹˜í•˜ë©´ í”Œë ˆì´ì–´ë¥¼ ì˜ê²Œ í•  ê²ƒì´ê¸° ë•Œë¬¸ì— <u>í¬ì‹ ì´ Z ì¶•ê³¼ ì¼ì¹˜í–ˆìœ¼ë©´ ì¢‹ê² ë‹¤.</u>

![image](https://user-images.githubusercontent.com/42318591/102058825-6e512d00-3e33-11eb-9059-07b43a40d798.png)

ê·¸ë˜ì„œ `SubMachineGun2`ì„ ë¹ˆ ì˜¤ë¸Œì íŠ¸ `GunHolder`ì˜ ìì‹ìœ¼ë¡œ ë„£ì–´ì£¼ì—ˆë‹¤. ì´ë¡œì¨ X = -90 íšŒì „ê°’ì„ ê°€ì§€ëŠ” `SubMachineGun2`ê°€ ë¶€ëª¨ì¸ `GunHolder`ì˜ X ì¶•ì„ ì¤‘ì‹¬ìœ¼ë¡œ -90ë„ íšŒì „í•œ ì…ˆì´ ë˜ì—ˆê¸° ë•Œë¬¸ì— `GunHolder`ì˜ íšŒì „ì¶•ì€ ë‹¤ìŒê³¼ ê°™ì´ ëœë‹¤. ì•„ì§ë„ `Z`ì¶•ì´ í¬ì‹ ê³¼ ì¼ì¹˜í•˜ì§€ ì•Šì•˜ë‹¤. ì—¬ê¸°ì„œ íšŒì „ ì¶• ìì²´ê°€ Y ì¶• ì¤‘ì‹¬ìœ¼ë¡œ 90ë„ ë” íšŒì „ë˜ì•¼ Z ì¶•ì´ í¬ì‹ ê³¼ ì¼ì¹˜í•œë‹¤. ë”°ë¼ì„œ Y ì¶•ì„ ì¤‘ì‹¬ìœ¼ë¡œ -90ë„ íšŒì „í•´ì£¼ê³  `TopGun` ë¹ˆ ì˜¤ë¸Œì íŠ¸ì˜ ìì‹ìœ¼ë¡œ ì´ë¥¼ ë˜ ë„£ì–´ì¤€ë‹¤. 

![image](https://user-images.githubusercontent.com/42318591/102058859-7ad58580-3e33-11eb-8bd1-1d792b18b8c3.png)

ê·¸ëŸ¬ë©´ Y = -90 íšŒì „ê°’ì„ ê°€ì§€ëŠ” `GunHolder`ê°€ ë¶€ëª¨ì¸ `TopGun`ì˜ Y ì¶•ì„ ì¤‘ì‹¬ìœ¼ë¡œ -90ë„ íšŒì „í•œ ì…ˆì´ ë˜ì—ˆê¸° ë•Œë¬¸ì— `TopGun`ì˜ íšŒì „ì¶•ì€ ìœ„ì™€ ê°™ì´ ëœë‹¤. ì´ì œ í¬ì‹ ì˜ ë°©í–¥ê³¼ Z ì¶•ì´ ì¼ì¹˜í•˜ê²Œ ë˜ì—ˆë‹¤.

<br>

## ğŸš€ í¬íƒ‘ ì• ë‹ˆë©”ì´ì…˜

### âœˆ ì• ë‹ˆë©”ì´ì…˜ í´ë¦½

![image](https://user-images.githubusercontent.com/42318591/102057361-25987480-3e31-11eb-9d5b-fb95fa4d179f.png)

ë°œí¬í•  ë•Œ ì• ë‹ˆë©”ì´ì…˜ì€ 6í”„ë ˆì„ ë™ì•ˆ ì‚´ì§ ì´ì´ ë’¤ë¡œ ë°€ë ¤ë‚˜ì™”ë‹¤ê°€ ë‹¤ì‹œ ì œìë¦¬ë¡œ ì˜¤ê²Œë”

![image](https://user-images.githubusercontent.com/42318591/102057407-35b05400-3e31-11eb-8b85-4d59d585d459.png)

ì •ì§€ ìƒíƒœ ì• ë‹ˆë©”ì´ì…˜

<br>

### âœˆ ì• ë‹ˆë©”ì´ì…˜ ì»¨íŠ¸ë¡¤ëŸ¬ 

![image](https://user-images.githubusercontent.com/42318591/102057530-62646b80-3e31-11eb-8548-0041009ea52b.png)

- í”Œë ˆì´ì–´ë¥¼ ë°œê²¬í•˜ë©´ ë°œì‚¬ ì• ë‹ˆë©”ì´ì…˜ ì¬ìƒ
  - "Fire" Trigger ë°œë™
- ë°œì‚¬ ì• ë‹ˆë©”ì´ì…˜ ì¬ìƒì´ ëë‚˜ë©´ ìì—°ìŠ¤ë ˆ ì •ì§€ ì• ë‹ˆë©”ì´ì…˜ ì¬ìƒ
  - ì „ì´ ì¡°ê±´ X, Has Exit Time ì²´í¬

<br>

## ğŸš€ í¬íƒ‘ ì‘ë™ì‹œí‚¤ê¸°

### ğŸ“œDefenseTower

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class DefenseTower : MonoBehaviour
{
    [SerializeField] private string towerName; // ë°©ì›Œíƒ€ì›Œì˜ ì´ë¦„
    [SerializeField] private float range; // ë°©ì–´íƒ€ì›Œì˜ ì‚¬ì •ê±°ë¦¬
    [SerializeField] private int damage; // ë°©ì–´ íƒ€ì›Œì˜ ê³µê²©ë ¥
    [SerializeField] private float rateOfAccuracy; // ì •í™•ë„(0ì— ê°€ê¹Œìš¸ ìˆ˜ë¡ ì •í™•ë„ ë†’ìŒ)
    [SerializeField] private float rateOfFire; // ì—°ì‚¬ì†ë„(rateOfFireì´ˆë§ˆë‹¤ ë°œì‚¬)
    private float currentRateOfFire; // ì—°ì‚¬ì†ë„ ê³„ì‚°(ê°±ì‹ ë¨)
    [SerializeField] private float viewAngle; // ì‹œì•¼ê°
    [SerializeField] private float spinSpeed; // í¬ì‹  íšŒì „ ì†ë„
    [SerializeField] private LayerMask layerMask; // ì›€ì§ì´ëŠ” ëŒ€ìƒë§Œ íƒ€ê²Ÿìœ¼ë¡œ ì§€ì •(í”Œë ˆì´ì–´ í˜¹ì€ ë™ë¬¼)
    [SerializeField] private Transform tf_TopGun; // í¬ì‹ 
    [SerializeField] private ParticleSystem particle_MuzzleFlash; // ì´êµ¬ ì„¬ê´‘
    [SerializeField] private GameObject go_HitEffect_Prefab; // ì ì¤‘ íš¨ê³¼ ì´í™íŠ¸

    private RaycastHit hitInfo;
    private Animator anim;
    private AudioSource theAudio;

    private bool isFindTarget = false; // ì  íƒ€ê²Ÿ ë°œê²¬ì‹œ True
    private bool isAttack = false; // ì •í™•íˆ íƒ€ê²Ÿì„ í–¥í•´ í¬ì‹  íšŒì „ ì™„ë£Œì‹œ True (ì´êµ¬ ë°©í–¥ê³¼ ì  ë°©í–¥ì´ ì¼ì¹˜í•  ë•Œ)

    private Transform tf_Target; // í˜„ì¬ ì„¤ì •ëœ íƒ€ê²Ÿì˜ íŠ¸ëœìŠ¤í¼

    [SerializeField] private AudioClip sound_Fire;


    void Start()
    {
        theAudio = GetComponent<AudioSource>();
        theAudio.clip = sound_Fire;
        anim = GetComponent<Animator>();
    }

    void FixedUpdate() // ì •í•´ì§„ ì´ˆë§ˆë‹¤ (!= í”„ë ˆì„ë§ˆë‹¤. updateë³´ë‹¤ ì¢€ ëŠë¦¬ê³  ì •í™•)
    {
        Spin();
        SearchEnemy();
        LookTarget();
        Attack();
    }
```

- `rateOfFire` ğŸ‘‰ ì—°ì‚¬ ì†ë„
  - `rateOfFire` ì‹œê°„ì— í•œë²ˆì”© ìœë‹¤. ì´ê²Œ ë°”ë¡œ ì—°ì‚¬ ì†ë„ê°€ ëœë‹¤. ì´ ê°’ì´ ì‘ì„ ìˆ˜ë¡ ì—°ì‚¬ê°€ ê°™ì€ ì‹œê°„ ì•ˆì— ë” ë§ì´ ì´ë£¨ì–´ì§„ë‹¤ëŠ” ì˜ë¯¸ì´ë¯€ë¡œ ì—°ì‚¬ ì†ë„ê°€ ë¹ ë¦„
    - `currentRateOfFire`ì„ í”„ë ˆì„ë§ˆë‹¤ ì¦ê°€ì‹œì¼œì„œ ì´ê²Œ `rateOfFire`ì— ë„ë‹¬í•  ë•Œ ë°œì‚¬í•˜ê³  `currentRateOfFire`ì€ 0 ìœ¼ë¡œ ê°±ì‹ í•˜ê³  ë‹¤ì‹œ ì¦ê°€. ì´ë¥¼ ë°˜ë³µ
- `rateOfAccuracy` ğŸ‘‰ ì •í™•ë„
  - ë°œì‚¬ ë°©í–¥ì„ í”Œë ˆì´ì–´ê°€ ì •í™•íˆ ìœ„ì¹˜í•œ ë°©í–¥ìœ¼ë¡œë¶€í„° `rateOfAccuracy`ë§Œí¼ ë²¡í„°ì˜ X, Y ë°©í–¥ê°’ì— ë”í•´ì¤„ ê²ƒì´ë‹¤.
    - ì¦‰ ìˆ˜ì§, ì¢Œìš°ë¡œ ì¢€ ë” íŠ€ê²Œ! 
    - Z ê°’ì—” ë”í•´ì£¼ì§€ ì•ŠëŠ”ë‹¤. Z ê°’ì— ë”í•´ì£¼ë©´ ì´ì•Œì´ ë’¤ë¡œ ë‚ ì•„ê°ˆ ìˆ˜ ìˆìŒ..
  - ë”°ë¼ì„œ ë†’ì„ìˆ˜ë¡ ì •í™•ë„ê°€ ë–¨ì–´ì§„ë‹¤.
- *FixedUpdate()*
  - ì–´ë–¤ ë§¤ ì‹œê°„ë§ˆë‹¤
    - 1ï¸âƒ£ *Spin()* ğŸ‘‰ 360ë„ë¡œ ê³„ì† ëº‘ê¸€ëº‘ê¸€ íšŒì „í•˜ë‹¤ê°€ 
    - 2ï¸âƒ£ *SearchEnemy()* ğŸ‘‰ ì‚¬ì • ê±°ë¦¬ë‚´ì—ì„œ íƒ€ê²Ÿì„ ì°¾ì•˜ë‹¤ë©´
    - 3ï¸âƒ£ *LookTarget()* ğŸ‘‰ íƒ€ê²Ÿì„ í–¥í•´ íšŒì „í•œë‹¤.
    - 4ï¸âƒ£ *Attack()* ğŸ‘‰ ê·¸ë¦¬ê³  ë°œì‚¬í•œë‹¤.

> `FixedUpdate`ì™€ `Update`ì˜ ì°¨ì´ì 

- **FixedUpdate**
  - í”„ë ˆì„ë§ˆë‹¤ í˜¸ì¶œë˜ì§€ ì•ŠëŠ”ë‹¤. ë…ë¦½ì ì¸ íƒ€ì´ë¨¸ê°€ ì¡´ì¬í•˜ì—¬ ì •í•´ì§„, ê³ ì •ì ì¸ ì‹œê°„ ê°„ê²©ìœ¼ë¡œ í˜¸ì¶œëœë‹¤.
    - í”„ë ˆì„ê³¼ ê´€ê³„ì—†ì´ ê·œì¹™ì ìœ¼ë¡œ í˜¸ì¶œë˜ë¯€ë¡œ ë¬¼ë¦¬ì ì¸ ì—°ì‚°ì„ í•  ë•Œ ì´ ê³³ì—ì„œ í•˜ëŠ”ê²Œ ì¢‹ë‹¤.
      - í”„ë ˆì„ì€ ì‹œìŠ¤í…œ í™˜ê²½ì„ ë”°ë¼ê°€ë¯€ë¡œ ì»´í“¨í„° í™˜ê²½ì´ ì¢‹ì§€ ì•Šìœ¼ë©´ ëŠë¦¬ê³  ë¶ˆê·œì¹™ì ìœ¼ë¡œ ë³€í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— Rigidbody ê°™ì€ ì–´ë–¤ ë¬¼ë¦¬ íš¨ê³¼ê°€ ì ìš©ëœ ì›€ì§ì„ ì²˜ë¦¬ë¥¼ *Update* ì•ˆì— êµ¬í˜„í•˜ëŠ”ê±´ ì¢‹ì§€ ì•Šë‹¤.
  - `TimeSCale`ì— ì˜ì¡´í•˜ê¸° ë•Œë¬¸ì— `Time.timeScale = 0;`ì´ ë  ë•Œ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤.
    - `Time.fixedDeltaTime`ë§ˆë‹¤ ì‹¤í–‰ëœë‹¤. ì´ëŠ” `0.02`ì´ˆë¡œ ê³ ì •ë˜ì–´ ìˆë‹¤.
- *Update*
  - í”„ë ˆì„ë§ˆë‹¤ í˜¸ì¶œëœë‹¤. 
  - `TimeSCale`ì— ì˜ì¡´í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— `Time.timeScale = 0;`ì´ ë  ë•Œë„ Update í•¨ìˆ˜ ìì²´ëŠ” ì‹¤í–‰ì´ ëœë‹¤.
    - ë‹¤ë§Œ ì´ ì•ˆì—ì„œ `deltaTime`ì„ ì‚¬ìš©í•˜ì—¬ ì›€ì§ì„ì„ ì œì–´í•œê²Œ ìˆì—ˆë‹¤ë©´ ë©ˆì¶”ê² ì§€! 

*Except for realtimeSinceStartup and fixedDeltaTime, timeScale affects all the time and delta time measuring variables of the Time class. If you lower timeScale it is recommended to <u>also lower Time.fixedDeltaTime by the same amount.</u> FixedUpdate functions will not be called when timeScale is set to zero.* <https://docs.unity3d.com/ScriptReference/Time-timeScale.html>

<br>

#### âœˆ í‰ì†Œì—” 360ë„ íšŒì „í•˜ê¸°

```c#
    private void Spin()
    {
        if (!isFindTarget && !isAttack)
        {
            Quaternion _spin = Quaternion.Euler(0f, tf_TopGun.eulerAngles.y + (1f * spinSpeed * Time.deltaTime), 0f);
            tf_TopGun.rotation = _spin;
        }
    }
```

íƒ€ê²Ÿì„ ì°¾ì€ ìƒíƒœë„ ì•„ë‹ˆê³  ê³µê²©í•´ì•¼í•˜ëŠ” ìƒíƒœë„ ì•„ë‹ˆë¼ë©´ *FixedUpdate* ì•ˆì—ì„œ Y ì¶•ì„ ì¤‘ì‹¬ìœ¼ë¡œ í˜„ì¬ íšŒì „ ê°’ì—ì„œ `spinSpeed * Time.deltaTime`ë§Œí¼ ë” íšŒì „í•œë‹¤. Z ì¶•ê³¼ í¬ì‹  ë°©í–¥ì„ ì¼ì¹˜í•´ì¤€ ìƒíƒœê¸° ë•Œë¬¸ì— í•˜ëŠ˜ì„ í–¥í•˜ëŠ” ì¶•ì€ Y ì¶•ì„. ë”°ë¼ì„œ Y ì¶•ì„ ì¤‘ì‹¬ìœ¼ë¡œ íšŒì „í•˜ë©´ ëœë‹¤.


<br>

#### âœˆ íƒ€ê²Ÿ ì°¾ê¸°

```c#
    private void SearchEnemy()
    {
        Collider[] _target = Physics.OverlapSphere(tf_TopGun.position, range, layerMask);

        for (int i = 0; i < _target.Length; i++)
        {
            Transform _targetTf = _target[i].transform; // ì´ê²Œ ë” ë¹ ë¥´ë‹¤

            if (_targetTf.name == "Player")
            {
                Vector3 _direction = (_targetTf.position - tf_TopGun.position).normalized;
                float _angle = Vector3.Angle(_direction, tf_TopGun.forward);
                
                if (_angle < viewAngle * 0.5f)
                {
                    tf_Target = _targetTf;
                    isFindTarget = true;

                    if (_angle < 5f) // ê±°ì˜ ì°¨ì´ ì•ˆë‚˜ë©´
                        isAttack = true;
                    else
                        isAttack = false;
                    
                    return;
                }
            }
        }
        // í”Œë ˆì´ì–´ ëª» ì°¾ìŒ
        tf_Target = null;
        isAttack = false;
        isFindTarget = false;
    }
```

- ë§¤ë²ˆ `_target[i].transform`ë¡œ ì ‘ê·¼ í•˜ëŠ” ê²ƒë³´ë‹¤ ë¯¸ë¦¬ `_target[i].transform`ì„ `_targetTf` *Transform _targetTf = _target[i].transform* ì´ë ‡ê²Œ ë³€ìˆ˜ì— ëŒ€ì… ì‹œì¼œë†“ê³  `_targetTf`ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë” ë¹ ë¥´ë‹¤. ë§¤ë²ˆ `_target[i].transform`ë¡œ ì‚¬ìš©í•˜ë©´ ê·¸ ì›ì†Œë¥¼ ì ‘ê·¼í•˜ëŠ”ë° ë“œëŠ” ì‹œê°„ë„ ë¬´ì‹œí•  ìˆ˜ ì—†ì„ ê²ƒì´ë‹¤. ë°°ì—´ í¬ê¸°ê°€ ì•„ë¬´ í¬ê³  ì¦ì€ ì ‘ê·¼ì„ í•œë‹¤ë©´.. 
- ì‚¬ì •ê±°ë¦¬ `range` ë‚´ì— ìˆëŠ” ëª¨ë“  `layerMask` ë ˆì´ì–´ë¥¼ ê°€ì§„ ì¶©ëŒì²´ë“¤ì„ `_target` ë°°ì—´ì— ë‹´ëŠ”ë‹¤. 
  - `_target` ë°°ì—´ì„ ë§¤ë²ˆ ìˆœíšŒí•´ ê²€ì‚¬í•˜ì—¬ "Player" í”Œë ˆì´ì–´ê°€ ë‹´ê¸´ ê²ƒì„ ì•Œê²Œ ëœë‹¤ë©´ ğŸ‘‰ í”Œë ˆì´ì–´ê°€ ì‚¬ì • ê±°ë¦¬ë‚´ì— ë“¤ì–´ì™”ë‹¤ëŠ” ëœ» 
    - ê·¸ ì´í›„ ì‹œì•¼ê° ì•ˆì— ë“¤ì–´ì˜¤ëŠ”ì§€ë¥¼ ì²´í¬í•œë‹¤.
      - í”Œë ˆì´ì–´ì™€ í¬íƒ‘ ì‚¬ì´ê°ì´ ì‹œì•¼ê°ì˜ ì ˆë°˜ ë³´ë‹¤ ì‘ë‹¤ë©´ ì´ì œ í”Œë ˆì´ì–´ë¥¼ í–¥í•´ í¬íƒ‘ ë°©í–¥ì„ í‹€ì–´ì•¼ í•˜ë¯€ë¡œ `isFindTarget`ì„ True ì‹œí‚¨ë‹¤.(*LookTarget()*ì—ì„œ í•  ê²ƒ)
      - ì‹œì•¼ê°ê³¼ 5ë„ ë¯¸ë§Œìœ¼ë¡œ ì°¨ì´ê°€ ë‚˜ë©´ ê·¸ëƒ¥ ë°”ë¡œ ê³µê²© ë•Œë¦¬ê²Œ *Attack()* 
      - ê·¸ë¦¬ê³  ë¦¬í„´í•´ë²„ë¦°ë‹¤.
  - forë¬¸ì„ ë¹ ì ¸ë‚˜ì™”ë‹¤ë©´ ì¶©ëŒ ë²”ìœ„ì— í”Œë ˆì´ì–´ê°€ ì—†ì–´ì„œ forë¬¸ ì•ˆì—ì„œ return ì„ ëª»ë§Œë‚œ ê²ƒì´ë¯€ë¡œ ëª»ì°¾ì€ê²ƒì´ë‹¤.


<br>

#### âœˆ íƒ€ê²Ÿì„ í–¥í•´ íšŒì „í•˜ê¸°

```c#
    private void LookTarget()
    {
        if (isFindTarget)
        {
            Vector3 _direction = (tf_Target.position - tf_TopGun.position).normalized;
            Quaternion _lookRotation = Quaternion.LookRotation(_direction);
            Quaternion _rotation = Quaternion.Lerp(tf_TopGun.rotation, _lookRotation, 0.2f);
            tf_TopGun.rotation = _rotation;
        }
    }
```

*SearchEnemy()* ì—ì„œ í”Œë ˆì´ì–´ë¥¼ ì‹œì•¼ê°ë‚´ì—ì„œ ì°¾ì•˜ë‹¤ë©´ `isFindTarget`ê°€ Trueì¸ ìƒíƒœê°€ ëœë‹¤. ì¦‰, íƒ€ê²Ÿì„ í–¥í•´ ì´ì œ íšŒì „ì‹œì¼œì•¼ í•œë‹¤. í¬íƒ‘ì´ í”Œë ˆì´ì–´ë¥¼ í–¥í•˜ëŠ” ë°©í–¥ì„ ë°”ë¼ë³´ê²Œ íšŒì „í•´ì•¼ í•œë‹¤. ì¦‰, `_lookRotation`ë§Œí¼ íšŒì „. Lerp ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¶€ë“œëŸ½ê²Œ íšŒì „ì‹œí‚¨ë‹¤.

- í”Œë ˆì´ì–´ìª½ìœ¼ë¡œ íšŒì „ì´ ì™„ë£Œë˜ì–´ ì‹œì•¼ê°ê³¼ í”Œë ˆì´ì–´ì™€ í¬íƒ‘ ì‚¬ì´ì˜ ê°ë„ê°€ 5 ë„ ë¯¸ë§Œìœ¼ë¡œ ì°¨ì´ë‚˜ë©´ *SearchEnemy()* ì—ì„œ `isAttack = true`ê°€ ë˜ì–´ ê³µê²©í•  ìˆ˜ ìˆëŠ” ìƒíƒœê°€ ëœë‹¤.


<br>

#### âœˆ ë°œì‚¬

```c#
    private void Attack()
    {
        if (isAttack)
        {
            currentRateOfFire += Time.deltaTime;
            if(currentRateOfFire >= rateOfFire)
            {
                currentRateOfFire = 0;
                anim.SetTrigger("Fire");
                theAudio.Play();
                particle_MuzzleFlash.Play();

                if (Physics.Raycast(tf_TopGun.position,
                                    tf_TopGun.forward + new Vector3(Random.Range(-1, 1f) * rateOfAccuracy, Random.Range(-1, 1f) * rateOfAccuracy, 0f),
                                    out hitInfo,
                                    range,
                                    layerMask)){
                    GameObject _HitEffect = Instantiate(go_HitEffect_Prefab, hitInfo.point, Quaternion.LookRotation(hitInfo.normal));
                    Destroy(_HitEffect, 1f);

                    if (hitInfo.transform.name == "Player")
                    {
                        hitInfo.transform.GetComponent<StatusController>().DecreaseHP(damage);
                    }
                }
            }
        }
    }
```

- `rateOfFire`ì´ˆ ê°„ê²©ìœ¼ë¡œ ë°œì‚¬í•œë‹¤. (ì—°ì‚¬ì†ë„)
- ë°œì‚¬ ì• ë‹ˆë©”ì´ì…˜ë„ ì¬ìƒí•˜ê³  ë°œì‚¬ íš¨ê³¼ìŒë„ ì¬ìƒí•œë‹¤.
- í”Œë ˆì´ì–´ê°€ ìˆëŠ” ë°©í–¥ìœ¼ë¡œ íšŒì „ì„ ì™„ë£Œí•œ í›„ (ê±°ì˜ 5ë„ ë¯¸ë§Œ ì°¨ì´) ì•ìœ¼ë¡œ (Zì¶•. í¬ì‹ ê³¼ ì¼ì¹˜í•˜ëŠ” ë°©í–¥) Raycast ë¥¼ ìœë‹¤. 
  - Raycast ë¥¼ ì˜ë˜ ì¢Œìš° ìˆ˜ì§ìœ¼ë¡œ ì´ì•Œì´ ì¢€ íŠ€ê²Œ í•œë‹¤. 
    - `foward` ì• ë°©í–¥ìœ¼ë¡œë¶€í„° ëœë¤í•˜ê²Œ [`-rateOfAccuracy`, `rateOfAccuracy`) ë²”ìœ„ì˜ ê°’ìœ¼ë¡œ X, Y ë°©í–¥ìœ¼ë¡œ ë” ì›€ì§ì¸ ê·¸ ë°©í–¥ìœ¼ë¡œ ìœë‹¤.
      - Z ë°©í–¥ì€.. ì•ë’¤ë¡œ ì–¼ë§ˆë‚˜ ë‚˜ê°€ëŠëƒì˜ ë¬¸ì œë‹ˆê¹Œ ë’¤ë¡œë„ ì´ì•Œì´ íŠˆ ìˆ˜ ìˆê²Œ ë¨. ì´ì•Œì´ ì•ìœ¼ë¡œ ë‚˜ê°€ëŠ”ê±´ ë‹¹ì—°í•˜ê³ ! ê·¸ë˜ì„œ Z ë°©í–¥ì€ ë³´ì •í•˜ì§€ ì•ŠëŠ”ë‹¤. 
  - ë§ì€ ìƒëŒ€ì—ê²Œ í”¼ê²©íš¨ê³¼ íŒŒí‹°í´ ì‹œìŠ¤í…œ ìƒì„±
  - Raycast ì¶©ëŒí•œê²Œ í”Œë ˆì´ì–´ë¼ë©´ HP ê¹ìŒ

![image](https://user-images.githubusercontent.com/42318591/102058527-f7b42f80-3e32-11eb-94c3-fd85d6138f3d.png)


***
<br>

    ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš° 
    ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}