---
title:  "Chapter 2-2. ë¬´ê¸° : ì´ êµ¬í˜„ 2ï¸âƒ£ (ì¬ì¥ì „, ì •ì¡°ì¤€, ë°˜ë™)" 

categories:
  -  Unity Lesson 3 
tags:
  - [Game Engine, Unity]

toc: true
toc_sticky: true

date: 2020-09-24
last_modified_at: 2020-09-24
---

ì¸í”„ëŸ°ì— ìˆëŠ” ì¼€ì´ë””ë‹˜ì˜ **[ìœ ë‹ˆí‹° 3D] ì‹¤ì „! ìƒì¡´ê²Œì„ ë§Œë“¤ê¸° - Advanced** ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ í•„ê¸°ì…ë‹ˆë‹¤. ğŸ˜€  
[ğŸŒœ ê°•ì˜ ë“¤ìœ¼ëŸ¬ ê°€ê¸° Click](https://www.inflearn.com/course/unity-2#)
{: .notice--warning}

<br>

# Chapter 2. ë¬´ê¸°
# ì´ êµ¬í˜„

## ğŸš– ì¬ì¥ì „

### ğŸ“œGun.cs

```c#
    public int reloadBulletCount;   // ì´ì˜ ì¬ì¥ì „ ê°œìˆ˜. ì¬ì¥ì „ í•  ë•Œ ëª‡ ë°œì”© ë ì§€. ì´ì˜ ì¢…ë¥˜ë§ˆë‹¤ ë‹¤ë¦„.
    public int currentBulletCount;  // í˜„ì¬ ì´ ì•ˆì˜ íƒ„ì°½ì— ë‚¨ì•„ìˆëŠ” ì´ì•Œì˜ ê°œìˆ˜.
    public int maxBulletCount;      // ì´ì•Œì„ ìµœëŒ€ ëª‡ ê°œê¹Œì§€ ì†Œìœ í•  ìˆ˜ ìˆëŠ”ì§€. 
    public int carryBulletCount;    // í˜„ì¬ ì´ ë°”ê¹¥ì—ì„œ ì†Œìœ í•˜ê³  ìˆëŠ” ì´ì•Œì˜ ì´ ê°œìˆ˜.
```

### ğŸ“œGunController.cs

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class GunController : MonoBehaviour
{
    [SerializeField]
    private Gun currentGun; // í˜„ì¬ ë“¤ê³  ìˆëŠ” ì´. ğŸ“œGun.cs ê°€ í• ë‹¹ ë¨.

    private float currentFireRate; // ì´ ê°’ì´ 0 ë³´ë‹¤ í° ë™ì•ˆì—ëŠ” ì´ì•Œì´ ë°œì‚¬ ë˜ì§€ ì•ŠëŠ”ë‹¤. ì´ˆê¸°ê°’ì€ ì—°ì‚¬ ì†ë„ì¸ ğŸ“œGun.csì˜ fireRate 

    private bool isReload = false;  // ì¬ì¥ì „ ì¤‘ì¸ì§€. ì¬ì¥ì „ ì¤‘ì´ ì•„ë‹Œ false ì¼ ë•Œë§Œ ë°œì‚¬ê°€ ì´ë£¨ì–´ ì ¸ì•¼ í•œë‹¤.

    private AudioSource audioSource;  // ë°œì‚¬ ì†Œë¦¬ ì¬ìƒê¸°

    void Start()
    {
        audioSource = GetComponent<AudioSource>();
    }

    void Update()
    {
        GunFireRateCalc();
        TryFire();
        TryReload();
    }

    private void GunFireRateCalc()
    {
        if (currentFireRate > 0)
            currentFireRate -= Time.deltaTime;  // ì¦‰, 1 ì´ˆì— 1 ì”© ê°ì†Œì‹œí‚¨ë‹¤.
    }

    private void TryFire()  // ë°œì‚¬ ì…ë ¥ì„ ë°›ìŒ
    {
        if(Input.GetButton("Fire1") && currentFireRate <= 0 && !isReload)
        {
            Fire();
        }
    }

    private void Fire()  // ë°œì‚¬ë¥¼ ìœ„í•œ ê³¼ì •
    {
        if (!isReload)
        {
            if (currentGun.currentBulletCount > 0)
                Shoot();
            else
                StartCoroutine(ReloadCoroutine());
        }
    }

    private void Shoot()  // ì‹¤ì œ ë°œì‚¬ ë˜ëŠ” ê³¼ì •
    {
        currentGun.currentBulletCount--;
        currentFireRate = currentGun.fireRate;  // ì—°ì‚¬ ì†ë„ ì¬ê³„ì‚°
        PlaySE(currentGun.fire_Sound);
        currentGun.muzzleFlash.Play();
        Debug.Log("ì´ì•Œ ë°œì‚¬ í•¨");
    }

    private void TryReload()
    {
        if (Input.GetKeyDown(KeyCode.R) && !isReload && currentGun.currentBulletCount < currentGun.reloadBulletCount)
        {
            StartCoroutine(ReloadCoroutine());
        }
    }

    IEnumerator ReloadCoroutine()
    {
        if(currentGun.carryBulletCount > 0)
        {
            isReload = true;
            currentGun.anim.SetTrigger("Reload");

            currentGun.carryBulletCount += currentGun.currentBulletCount;
            currentGun.currentBulletCount = 0;

            yield return new WaitForSeconds(currentGun.reloadTime);  // ì¬ì¥ì „ ì• ë‹ˆë©”ì´ì…˜ì´ ë‹¤ ì¬ìƒë  ë™ì•ˆ ëŒ€ê¸°

            if (currentGun.carryBulletCount >= currentGun.reloadBulletCount)
            {
                currentGun.currentBulletCount = currentGun.reloadBulletCount;
                currentGun.carryBulletCount -= currentGun.reloadBulletCount;
            }
            else
            {
                currentGun.currentBulletCount = currentGun.carryBulletCount;
                currentGun.carryBulletCount = 0;
            }

            isReload = false;
        }
        else
        {
            Debug.Log("ì†Œìœ í•œ ì´ì•Œì´ ì—†ìŠµë‹ˆë‹¤.");
        }
    }

    private void PlaySE(AudioClip _clip)  // ë°œì‚¬ ì†Œë¦¬ ì¬ìƒ
    {
        audioSource.clip = _clip;
        audioSource.Play();
    }
}
```

### ì¬ì¥ì „ í•˜ê³  ì‹¶ì„ ë•Œ ìˆ˜ë™ìœ¼ë¡œ ì¬ì¥ì „

> R í‚¤ë¥¼ ëˆ„ë¥´ë©´ ì¬ì¥ì „ í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.

- *TryReload()*
    - ğŸ‘‰ ë§¤ í”„ë ˆì„ë§ˆë‹¤ ì•„ë˜ì™€ ê°™ì€ 3 ê°€ì§€ ì¡°ê±´ì„ ê²€ì‚¬í•˜ê³  3 ê°€ì§€ ì¡°ê±´ì´ ëª¨ë‘ ë§Œì¡±í•  ë•Œë§Œ ì‹¤ì œ ì¬ì¥ì „ ì²˜ë¦¬ë¥¼ í•˜ëŠ” *ReloadCoroutine()* í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œí‚¨ë‹¤.
      - `R`í‚¤ ì…ë ¥ì´ ë“¤ì–´ì™€ì•¼ í•˜ê³ 
      - `isReload` ê°’ì´ False ì—¬ì•¼ í•˜ê³  (ì´ë¯¸ ì¬ì¥ì „ ì¤‘ì´ë¼ë©´ ì¬ì¥ì „ í•˜ë©´ ì•ˆëœë‹¤.) 
      - í˜„ì¬ íƒ„ì°½ ì•ˆì— ìˆëŠ” ì´ì•Œì˜ ê°œìˆ˜ì™€ ì¬ì¥ì „ ë˜ëŠ” ì´ì•Œì˜ ê°œìˆ˜ê°€ ê°™ë‹¤ë©´ ì¬ì¥ì „ ë˜ë©´ ì•ˆëœë‹¤. í˜„ì¬ íƒ„ì°½ ì•ˆì— ìˆëŠ” ì´ì•Œì˜ ê°œìˆ˜ ë³´ë‹¤ ì¬ì¥ì „ ë˜ëŠ” ì´ì•Œì˜ ê°œìˆ˜ê°€ í´ ë•Œë§Œ ì¬ì¥ì „ì´ ë˜ì—¬ í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ í˜„ì¬ íƒ„ì°½ì— 3ë°œ ìˆëŠ”ë° í•œë²ˆ ì¬ì¥ì „ ë  ë•Œ 40ë°œë¡œ ì±„ì›Œì§„ë‹¤ë©´ ì¬ì¥ì „ì´ ê°€ëŠ¥í•˜ë‹¤. ê·¼ë° í˜„ì¬ íƒ•ì°½ì— ì´ë¯¸ 40ë°œ ìˆë‹¤ë©´ ì¬ì¥ì „ ë  í•„ìš”ê°€ ì—†ë‹¤.
        ```c#
        currentGun.currentBulletCount < currentGun.reloadBulletCount)
        ```
- *ReloadCoroutine()*
  - ğŸ‘‰ ì‹¤ì œ ì¬ì¥ì „ì„ ì²˜ë¦¬í•˜ëŠ” ì½”ë£¨í‹´ í•¨ìˆ˜
    - `isReload`ë¥¼ True ë¡œ ì„¤ì •.
      - ì´ë¯¸ ì¬ì¥ì „ ì¤‘ì¼ë• ë˜ ì¬ì¥ì „ í•˜ë©´ ì•ˆë˜ê¸° ë•Œë¬¸ì— ì´ëŸ° boolean ë©¤ë²„ ë³€ìˆ˜ê°€ í•„ìš” í•˜ë‹¤.
    - ì¬ì¥ì „ ì• ë‹ˆë©”ì´ì…˜ì„ ì¬ìƒí•œë‹¤.
      - ì´ í•¨ìˆ˜ê°€ ì½”ë£¨í‹´ì¸ ì´ìœ ! ì¬ì¥ì „ ì• ë‹ˆë©”ì´ì…˜ì´ ë‹¤ ì¬ìƒë  ë•Œê¹Œì§€ ëŒ€ê¸°í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì—. ëŒ€ì¶© `reloadTime` ë™ì•ˆ.
        ```c#
        yield return new WaitForSeconds(currentGun.reloadTime);
        ```
    - íƒ„ì°½ì— ìˆëŠ” ì´ì•Œ ì œì™¸í•˜ê³ , í˜„ì¬ ì†Œìœ í•˜ê³  ìˆëŠ” ì´ì•Œì˜ ê°œìˆ˜ì—ë‹¤ê°€ í˜„ì¬ íƒ„ì°½ì— ìˆëŠ” ì´ì•Œì„ ë”í•´ì¤€ë‹¤. ê·¸ë¦¬ê³  í˜„ì¬ íƒ„ì°½ì— ìˆëŠ” ì´ì•Œì„ 0 ìœ¼ë¡œ ë§Œë“¤ì–´ ì¤€ë‹¤.
      - ì˜ˆë¥» ë“¤ì–´ í˜„ì¬ íƒ„ì°½ì— 3ë°œ ìˆê³  í˜„ì¬ ì†Œìœ í•˜ê³  ìˆëŠ” ì´ì•Œì´ 7ë°œì´ë¼ë©´, í˜„ì¬ íƒ„ì°½ì„ 0 ë°œë¡œ ë§Œë“¤ê³  í˜„ì¬ ì†Œìœ í•˜ê³  ìˆëŠ” ì´ì•Œì„ 10 ë°œë¡œ ë§Œë“ ë‹¤. 
      - ì´ë¯¸ íƒ„ì°½ì•ˆì— ì´ì•Œì´ ìˆëŠ” ìƒíƒœì—ì„œ ì¬ì¥ì „ í•  ê²½ìš°ë¥¼ ëŒ€ë¹„í•˜ì—¬ ì´ëŸ° ì‘ì—…ì„ í•´ì£¼ëŠ” ê²ƒì´ë‹¤. ê¸°ì¡´ì— íƒ„ì°½ ì•ˆì— ìˆë˜ ì´ì•Œì€ ì´ì•Œ ì†Œìœ ë¶„ìœ¼ë¡œ ì˜®ê²¨ì£¼ê³  ì¬ì¥ì „ í•  ìˆ˜ ìˆëŠ” íƒ„ì°½ ìˆ˜ë§Œí¼ ë” í•´ì£¼ë©´ ê¸°ì¡´ì— íƒ„ì°½ ì•ˆì— ìˆë˜ ì´ì•Œì´ ë‚ ë¼ê°€ì§€ ì•ŠëŠ”ë‹¤. í˜„ì¬ íƒ„ì°½ 14/20 ìƒíƒœì—ì„œ 20ë°œ ì¬ì¥ì „ í•œë‹¤ë©´ 14ë°œì€ ì´ì•Œ ì†Œìœ ë¶„ì— ë”í•´ì£¼ê³  20/20 ìœ¼ë¡œ ë§Œë“¤ì–´ ì£¼ì–´ 14 ë°œì„ ë‚ ë¼ê°€ì§€ ì•Šê²Œ ë³´ì¡´í•œë‹¤.
        ```c#
        currentGun.carryBulletCount += currentGun.currentBulletCount;
        currentGun.currentBulletCount = 0;
        ```
    - í˜„ì¬ ì†Œìœ í•˜ê³  ìˆëŠ” ì´ì•Œì—ì„œ ì¬ì¥ì „ í•  ì´ì•Œë“¤ì„ ëŒì–´ì˜¤ê¸° ë•Œë¬¸ì—
      - (í˜„ì¬ ì†Œìœ í•˜ê³  ìˆëŠ” ì´ì•Œ >= ì¬ì¥ì „ ì´ì•Œ ê°œìˆ˜) ë¼ë©´
        - íƒ„ì°½ì— ìˆëŠ” ì´ì•Œì„ ì¬ì¥ì „ ì´ì•Œ ê°œìˆ˜ ë§Œí¼ ë„£ì–´ ì£¼ê³ 
          - ìœ„ì˜ ê³¼ì • ë•Œë¬¸ì— íƒ„ì°½ì— ìˆëŠ” ì´ì•Œì€ 0 ì¸ ìƒíƒœ. 0/20 ì—ì„œ 20/20 ì´ ëœë‹¤.
        - í˜„ì¬ ì†Œìœ í•˜ê³  ìˆëŠ” ì´ì•Œì—ì„œ ì¬ì¥ì „ í•œ ì´ì•Œ ê°œìˆ˜ë§Œí¼ ì°¨ê°í•œë‹¤.
      - (í˜„ì¬ ì†Œìœ í•˜ê³  ìˆëŠ” ì´ì•Œ < ì¬ì¥ì „ ì´ì•Œ ê°œìˆ˜) ë¼ë©´
        - íƒ„ì°½ì— ìˆëŠ” ì´ì•Œì„ í˜„ì¬ ì†Œìœ í•˜ê³  ìˆëŠ” ì´ì•Œ ê°œìˆ˜ë§Œí¼ ë„£ì–´ ì£¼ê³ 
        - í˜„ì¬ ì†Œìœ í•˜ê³  ìˆëŠ” ì´ì•Œ ê°œìˆ˜ë¥¼ 0 ìœ¼ë¡œ ë§Œë“¤ì–´ ì¤€ë‹¤.
    - ì¬ì¥ì „ ì²˜ë¦¬ê°€ ëë‚¬ìœ¼ë‹ˆ `isReload` ë¥¼ ë‹¤ì‹œ False ë¡œ ë§Œë“¤ì–´ ì¤€ë‹¤.
  

<br>

### ë°œì‚¬ë¥¼ ì‹œë„ í•  ë•Œ ì¬ì¥ì „

> ì´ì„ ë°œì‚¬ë¥¼ í•˜ë ¤ëŠ”ë° í˜„ì¬ íƒ„ì°½ì— ìˆëŠ” ì´ì•Œì´ í•˜ë‚˜ë„ ì—†ë‹¤ë©´ ìë™ìœ¼ë¡œ ì¬ì¥ì „ì„ í•˜ë„ë¡ í•œë‹¤.

- *TryFire()*
  - ë°œì‚¬ê°€ ê°€ëŠ¥í•œì§€ë¥¼ ì²´í¬í•˜ëŠ” í•¨ìˆ˜
  - ì¬ì¥ ì „ì´ ì•„ë‹ ë•Œë§Œ ë°œì‚¬ê°€ ê°€ëŠ¥í•´ì•¼ í•œë‹¤.
    - ì¡°ê±´ì—ì„œ `!isReload`ì¸ì§€ë¥¼ ì²´í¬í•¨.
- *Fire()*
  - ì¬ì¥ì „ ì•„ë‹ ë•Œë§Œ ë°œì‚¬ê°€ ì´ë£¨ì–´ ì ¸ì•¼ í•œë‹¤.
    - í˜„ì¬ íƒ„ì°½ ì•ˆì— ì´ì•Œì´ ìˆì„ ë•Œë§Œ *Shoot()* ì‹¤ì œ ë°œì‚¬ ì²˜ë¦¬ë¥¼ í•˜ê³ 
    - í˜„ì¬ íƒ„ì°½ ì•ˆì— ì´ì•Œì´ ì•„ì˜ˆ ì—†ì„ ë• *ReloadCoroutine()* ì‹¤ì œ ì¬ì¥ì „ ì²˜ë¦¬ë¥¼ í•œë‹¤.
- *Shoot()*
  - ì‹¤ì œ ë°œì‚¬ë¥¼ ì²˜ë¦¬í•˜ëŠ” í•¨ìˆ˜
  - ë°œì‚¬ê°€ ë˜ë©´ í˜„ì¬ íƒ„ì°½ ì•ˆì— ìˆëŠ” ì´ì•Œì„ 1 ê°ì†Œì‹œì¼œì•¼ í•œë‹¤.
  - ì¬ì¥ì „ê³¼ ìƒê´€ ì—†ëŠ” ì–˜ê¸°ì§€ë§Œ ì—°ì‚¬ ì†ë„ë¥¼ ë¦¬ì…‹í•˜ëŠ” ë¶€ë¶„ì„ ê·¸ëƒ¥ *Shoot()* ì•ˆì—ë¡œ ì˜®ê²¨ ì£¼ì—ˆë‹¤.

![image](https://user-images.githubusercontent.com/42318591/94139280-59a07100-fea4-11ea-976e-367e51839bee.png)

`SubMachineGun1`ì˜ ğŸ“œGun.cs ì— ì¬ì¥ì „ ê´€ë ¨ ë©¤ë²„ í•¨ìˆ˜ ê°’ í• ë‹¹.

<br>

## ğŸš– ì •ì¡°ì¤€

### ì •ì¡°ì¤€ ì• ë‹ˆë©”ì´ì…˜

![image](https://user-images.githubusercontent.com/42318591/94223145-2a344780-ff2a-11ea-92b6-110e99cece76.png)

- íŒŒë¼ë¯¸í„°ë¡œ Bool íƒ€ì…ì˜ `FindSightMode` ë¥¼ ì¶”ê°€í•œë‹¤.
  - `Reload`ì²˜ëŸ¼ Triggerê°€ ì•„ë‹Œ ì´ìœ ëŠ”, ì¬ì¥ì „ì€ ì—°ì†ì ì´ ì•„ë‹Œ ë”± í•œë²ˆë§Œ ì´ë£¨ì–´ì ¸ì•¼ í•˜ê¸° ë•Œë¬¸ Triggerë¡œ ì• ë‹ˆë©”ì´ì…˜ì„ ì¬ìƒì‹œí‚¤ëŠ”ê²Œ ì í•©í•˜ë‹¤.
  - ë°˜ë©´ì— ì •ì¡°ì¤€ì€ í•œë²ˆ ìš°í´ì„ ëˆŒëŸ¬ ì •ì¡°ì¤€ ìƒíƒœê°€ ë˜ë©´ ì •ì¡°ì¤€ ìƒíƒœë¥¼ ìœ ì§€í•´ì•¼ í•œë‹¤. ë‹¤ì‹œ ìš°í´ì„ ë˜ ëˆŒëŸ¬ ì •ì¡°ì¤€ì„ í•´ì œí•˜ì§€ ì•ŠëŠ” ì´ìƒ! ë”°ë¼ì„œ Boolean ì´ ì í•©í•˜ë‹¤.
    - ë”°ë¼ì„œ `Any Stage` ğŸ‘‰ `Gun0_FindSightMode` ë˜í•œ ì í•©í•˜ì§€ ì•Šë‹¤. `FindSightMode`ê°€ Boolean íƒ€ì…ì´ê¸° ë•Œë¬¸ì— í•œë²ˆ True ë¡œ ë³€ê²½ë˜ë©´ ìˆ˜ë™ì ìœ¼ë¡œ ë°”ê¿”ì£¼ì§€ ì•ŠëŠ” í•œ True ë¥¼ ìœ ì§€í•˜ê¸° ë•Œë¬¸ì— ì–´ë–¤ ìƒíƒœì´ë“ ê°„ì— `Any Stage` ğŸ‘‰ `Gun0_FindSightMode` ì´ ë¬´í•œì ìœ¼ë¡œ ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì´ë‹¤. 
- `Gun0_FindSightMode` ğŸ‘‰ `Gun0_Idle`
  - ì¡°ê±´
    - `FindSightMode` ê°’ì´ True ê°€ ë˜ë©´ ë°œë™í•œë‹¤.
    - ì¦‰ì‹œ ì¬ìƒí•˜ê²Œ Hax Exit Time ì²´í¬ í•´ì œ
    - Translation Duration ì€ 0.1
- `Gun0_Idle` ğŸ‘‰ `Gun0_FindSightMode`
  - ì¡°ê±´
    - `FindSightMode` ê°’ì´ False ê°€ ë˜ë©´ ë°œë™í•œë‹¤.
    - ì¦‰ì‹œ ì¬ìƒí•˜ê²Œ Hax Exit Time ì²´í¬ í•´ì œ
    - Translation Duration ì€ 0.1
- `Gun0_Walk` ğŸ‘‰ `Gun0_FindSightMode`
  - ì¡°ê±´
    - `FindSightMode` ê°’ì´ True ê°€ ë˜ë©´ ë°œë™í•œë‹¤.
    - ì¦‰ì‹œ ì¬ìƒí•˜ê²Œ Hax Exit Time ì²´í¬ í•´ì œ
    - Translation Duration ì€ 0.1
    - `Gun0_FindSightMode` ğŸ‘‰ `Gun0_Walk` ì€ ì—†ì–´ë„ ëœë‹¤. 


<br>

### ğŸ“œGunController.cs

```c#
// ì¶”ê°€í•œ ë©¤ë²„ ë³€ìˆ˜

    private bool isFindSightMode = false; // ì •ì¡°ì¤€ ì¤‘ì¸ì§€.

    [SerializeField]
    private Vector3 originPos;  // ì›ë˜ ì´ì˜ ìœ„ì¹˜(ì •ì¡°ì¤€ í•´ì œí•˜ë©´ ë‚˜ì¤‘ì— ëŒì•„ì™€ì•¼ í•˜ë‹ˆê¹Œ)

```
```c#
    void Update()
    {
        GunFireRateCalc();
        TryFire();
        TryReload();
        TryFindSight();
    }

    private void TryFindSight()
    {
        if(Input.GetButtonDown("Fire2"))
        {
            FindSight();
        }
    }

    private void FindSight()
    {
        isFindSightMode = !isFindSightMode;
        currentGun.anim.SetBool("FindSightMode", isFindSightMode);
        
        if(isFindSightMode)
        {
            StopAllCoroutines();
            StartCoroutine(FindSightActivateCoroutine());
        }
        else
        {
            StopAllCoroutines();
            StartCoroutine(FindSightDeActivateCoroutine());
        }
    }

    IEnumerator FindSightActivateCoroutine()
    {
        while(currentGun.transform.localPosition != currentGun.findSightOriginPos)
        {
            currentGun.transform.localPosition = Vector3.Lerp(currentGun.transform.localPosition, currentGun.findSightOriginPos, 0.2f);
            yield return null;
        }
    }

    IEnumerator FindSightDeActivateCoroutine()
    {
        while (currentGun.transform.localPosition != originPos)
        {
            currentGun.transform.localPosition = Vector3.Lerp(currentGun.transform.localPosition, originPos, 0.2f);
            yield return null;
        }
    }
```

- <u>ë§¤ í”„ë ˆì„ë§ˆë‹¤</u>
  - ğŸš— **TryFindSight()**
    - ë§ˆìš°ìŠ¤ ìš°í´ë¦­ ì…ë ¥ì´ ë“¤ì–´ì˜¤ëŠ”ì§€ë¥¼ ê²€ì‚¬í•˜ê³  ë§ˆìš°ìŠ¤ ìš°í´ ì…ë ¥ì´ ë“¤ì–´ì˜¤ë©´ **FindSight()** í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œí‚¨ë‹¤.
  - ğŸš— **FindSight()**
    - ì •ì¡°ì¤€ ì¤‘ì´ì˜€ë‹¤ë©´ ì •ì¡°ì¤€ì„ í•´ì œí•˜ê³ , ì •ì¡°ì¤€ ì•ˆëœ ìƒíƒœì˜€ë‹¤ë©´ ì •ì¡°ì¤€ì„ í•œë‹¤. ì¦‰, ìš°í´ í•œë²ˆ ëˆ„ë¥¸ í›„ì— ì •ì¡°ì¤€ ìƒíƒœë¥¼ ìœ ì§€í•˜ê³  ìš°í´ì„ ë‹¤ì‹œ ëˆ„ë¥´ë©´ ì •ì¡°ì¤€ì„ í•´ì œ í•˜ê²Œ í•œë‹¤.
      ```c#
      isFindSightMode = !isFindSightMode;
      ```
    - `FindSightMode` íŒŒë¼ë¯¸í„° ê°’ì„ `isFindSightMode`ê°’ìœ¼ë¡œ ì„¤ì •í•œë‹¤. Trueë©´ `FindSightMode = True` ì¡°ê±´ì— ë”°ë¥¸ ì •ì¡°ì¤€ ì• ë‹ˆë©”ì´ì…˜ì´ ì¬ìƒë˜ê³  `FindSightMode = False` ë¼ë©´ ì •ì¡°ì¤€ ì• ë‹ˆë©”ì´ì…˜ì´ ë” ì´ìƒ ì¬ìƒë˜ì§€ ì•ŠëŠ”ë‹¤.
    - ì •ì¡°ì¤€ í•´ì•¼ í•œë‹¤ë©´ (ìš°í´ í™€ìˆ˜ë²ˆì§¸ í´ë¦­)
      - ìš°ì„  í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ ì½”ë£¨í‹´ í•¨ìˆ˜ë¥¼ ëª¨ë‘ ì¤‘ë‹¨í•œë‹¤.
        - ì¤‘ë‹¨ í•˜ëŠ” ì´ìœ 
          - ë°‘ì— í›„ìˆ í•  2 ê°œì˜ ì½”ë£¨í‹´ í•¨ìˆ˜ëŠ” ê°ê° ë‹¤ìŒê³¼ ê°™ì€ ì¼ì„ í•œë‹¤.  
            - ì •ì¤‘ì•™ ìœ„ì¹˜ë¡œ ì´(ìê¸° ìì‹ )ì˜ ìœ„ì¹˜ë¥¼ ì„¤ì •, 
            - ì •ì¡°ì¤€ í•´ì œë¥¼ ìœ„í•´ ì›ë˜ì˜ ìœ„ì¹˜ë¡œ ì´(ìê¸° ìì‹ )ì˜ ìœ„ì¹˜ë¥¼ ì„¤ì •.
          - ìœ„ì¹˜ë¥¼ ë³€í•˜ê²Œ í•  ë•Œ while ë¬¸ ì•ˆì—ì„œ Lerp í•¨ìˆ˜ë¥¼ í†µí•´ ë³´ê°„í•˜ë©° ë¶€ë“œëŸ½ê²Œ ì ì  ë³€í™”ì‹œí‚¬ ê²ƒì¸ë°, [ì´ì „ í¬ìŠ¤íŠ¸](https://ansohxxn.github.io/unity%20lesson%203/ch1-2/#%EB%B6%80%EB%93%9C%EB%9F%BD%EA%B2%8C-%EC%95%89%EA%B1%B0%EB%82%98-%EC%84%9C%EA%B8%B0)ì—ì„œ ë°°ì› ë“¯ì´ ë³´ê°„ì€ ë”± ë–¨ì–´ì ¸ì„œ ë˜ì§€ ì•ŠëŠ” ê²½ìš°ê°€ ëŒ€ë‹¤ìˆ˜ë‹¤. ê·¸ë˜ì„œ ë³€í™”ë¥¼ ë§ˆì¹˜ê³  ì›í•˜ëŠ” ìœ„ì¹˜ë¡œ ë”± ì •í™•í•˜ê²Œ ì¼ì¹˜í•  ë•Œê¹Œì§€ ë°˜ë³µì‹œí‚¨ë‹¤ëŠ” ê·¸ whileë¬¸ ì¡°ê±´ì„ ë§Œì¡±í•˜ê¸°ê°€ í˜ë“¤ë‹¤.
          - ë”°ë¼ì„œ whileë¬¸ì´ ì˜ì›íˆ ëë‚˜ì§€ ì•Šì•„ ë‘ ì½”ë£¨í‹´ í•¨ìˆ˜ê°€ ë‚´ë‚´ ëë‚˜ì§€ ì•Šê³  ë‘ ì½”ë£¨í‹´ í•¨ìˆ˜ê°€ ë³‘í–‰í•´ì„œ ê³„ì† while ë¬¸ì— ê°‡í˜€ ë³´ê°„ì„ ë¬´í•œ ë°˜ë³µí•˜ê³  ìˆëŠ” ìƒíƒœê°€ ë˜ì–´ ë‘ í•¨ìˆ˜ê°€ ê³„ì† ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì— ì´(ìê¸° ìì‹ )ì˜ ìœ„ì¹˜ëŠ” ê³„ì†í•´ì„œ ë³€í•œë‹¤. 
          - ì´ëŸ° ìƒí™©ì—ì„œ ë˜ ìš°í´ ì…ë ¥ì´ ë“¤ì–´ì™€ ì •ì¡°ì¤€ì„ í•´ì•¼ í•˜ë©´ ë³€í™” ì¤‘ì¸ ìœ„ì¹˜ì—ì„œë¶€í„° ë˜ ë³´ê°„ì„ ì‹œì‘í•˜ê¸° ë•Œë¬¸ì— ì •ì¡°ì¤€ì´ ì œëŒ€ë¡œ ë˜ì§€ ì•ŠëŠ”ë‹¤. ì¤‘ì•™ì´ ì•„ë‹Œ ì—‰ëš±í•œ ê³³ìœ¼ë¡œ ì´ì´ ì›€ì§ì¼ ê²ƒì´ë‹¤. 
          - ë”°ë¼ì„œ!!!!!!! ì •ì¡°ì¤€ì„ ìœ„í•œ ìœ„ì¹˜ ì„¤ì • or ì›ë˜ ìœ„ì¹˜ë¡œ ì„¤ì • ì‘ì—…ì„ í•˜ê¸° ì „ì— ê¸°ì¡´ì— ì‹¤í–‰ì¤‘ì´ë˜ ì½”ë£¨í‹´ í•¨ìˆ˜ë“¤ì´ ìˆë‹¤ë©´ ë‹¤ ì¤‘ë‹¨ì„ ì‹œì¼œì•¼ ì •í™•í•˜ê²Œ ìœ„ì¹˜í•˜ê²Œ í•  ìˆ˜ ìˆë‹¤! 
      - **FindSightActivateCoroutine()** í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œë‹¤.
        - ì •ì¡°ì¤€ì„ í•˜ê¸° ìœ„í•´ì„œ í˜„ì¬ ì´(ìê¸° ìì‹ )ì˜ ìœ„ì¹˜ë¥¼ ì •ì¡°ì¤€ì‹œ ì´ì˜ ìœ„ì¹˜ì¸ ğŸ“œGun.csì˜ `findSightOriginPos`ë¡œ ë³€í™”ì‹œí‚¤ëŠ”ë°, ì´ë¥¼ ë¶€ë“œëŸ½ê²Œ ì—…ëƒí•˜ëŠ” ì¼ì„ ìˆ˜í–‰í•œë‹¤. 
          - **FindSightActivateCoroutine()** í•¨ìˆ˜
            - í˜„ì¬ ìœ„ì¹˜ê°€ ì •ì¡°ì¤€ì‹œ ì´ì´ ìœ„ì¹˜ê°€ ë  ë•Œê¹Œì§€ í˜„ì¬ ìœ„ì¹˜ë¥¼ ì—…ë°ì´íŠ¸ í•˜ê³  í•œ í”„ë ˆì„ ì‰¬ê¸°ë¥¼ ê³„ì† ë°˜ë³µí•œë‹¤. 
            - ë¶€ë“œëŸ½ê²Œ 5 ë²ˆ ë³´ê°„ë˜ì–´ ì—…ëƒëœë‹¤. 
    - ì •ì¡°ì¤€ì„ í•´ì œí•´ì•¼ í•œë‹¤ë©´ (ìš°í´ ì§ìˆ˜ë²ˆì§¸ í´ë¦­)
      - ìš°ì„  í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ ì½”ë£¨í‹´ í•¨ìˆ˜ë¥¼ ëª¨ë‘ ì¤‘ë‹¨í•œë‹¤.
        - ì´ìœ  ìœ„ì™€ ë™ì¼
      - **FindSightDeActivateCoroutine()** í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œë‹¤.
        - ì •ì¡°ì¤€ í•´ì œë¥¼ í•˜ê¸° ìœ„í•´ì„œ í˜„ì¬ ì´(ìê¸° ìì‹ )ì˜ ìœ„ì¹˜ë¥¼ ì›ë˜ì˜ ì´ì˜ ìœ„ì¹˜ì¸ `originPos`ë¡œ ë³€í™”ì‹œí‚¤ëŠ”ë°, ì´ë¥¼ ë¶€ë“œëŸ½ê²Œ ì—…ëƒí•˜ëŠ” ì¼ì„ ìˆ˜í–‰í•œë‹¤. 
  
![image](https://user-images.githubusercontent.com/42318591/94227472-85b80280-ff35-11ea-93b5-c393c1f24abb.png)

ğŸ“œGun.cs `findSightOriginPos` ì •ì¡°ì¤€ì‹œ ì´ì´ ìˆì–´ì•¼í•  ìœ„ì¹˜ë¥¼ (0.55, 0.335, -0.586) ìœ¼ë¡œ ì„¤ì •í•œë‹¤. ì´ì´ ë”± ì •ì¤‘ì•™ìœ¼ë¡œ ì˜¤ëŠ” ìœ„ì¹˜ë‹¤.
 
![image](https://user-images.githubusercontent.com/42318591/94227629-e0e9f500-ff35-11ea-8e4e-3a7c3debfc78.png)

ğŸ“œGunController.cs `originPos`ëŠ” ê·¸ëŒ€ë¡œ (0, 0, 0)ìœ¼ë¡œ ë‘”ë‹¤. `SubMachineGun1`ì˜ ì›ë˜ ìœ„ì¹˜(LocalPosition)ê°€ (0, 0, 0) ì´ê¸° ë•Œë¬¸ì—.

<br>

## ğŸš– ë°˜ë™

### ğŸ“œGunController.cs

```c#
    IEnumerator RetroActionCoroutine()
    {
        Vector3 recoilBack = new Vector3(currentGun.retroActionForce, originPos.y, originPos.z);     // ì •ì¡°ì¤€ ì•ˆ í–ˆì„ ë•Œì˜ ìµœëŒ€ ë°˜ë™
        Vector3 retroActionRecoilBack = new Vector3(currentGun.retroActionFineSightForce, currentGun.fineSightOriginPos.y, currentGun.fineSightOriginPos.z);  // ì •ì¡°ì¤€ í–ˆì„ ë•Œì˜ ìµœëŒ€ ë°˜ë™

        if(!isFineSightMode)  // ì •ì¡°ì¤€ì´ ì•„ë‹Œ ìƒíƒœ
        {
            currentGun.transform.localPosition = originPos;

            // ë°˜ë™ ì‹œì‘
            while(currentGun.transform.localPosition.x <= currentGun.retroActionForce - 0.02f)
            {
                currentGun.transform.localPosition = Vector3.Lerp(currentGun.transform.localPosition, recoilBack, 0.4f);
                yield return null;
            }

            // ì›ìœ„ì¹˜
            while (currentGun.transform.localPosition != originPos)
            {
                currentGun.transform.localPosition = Vector3.Lerp(currentGun.transform.localPosition, originPos, 0.1f);
                yield return null;
            }
        }
        else  // ì •ì¡°ì¤€ ìƒíƒœ
        {
            currentGun.transform.localPosition = currentGun.fineSightOriginPos;

            // ë°˜ë™ ì‹œì‘
            while(currentGun.transform.localPosition.x <= currentGun.retroActionFineSightForce - 0.02f)
            {
                currentGun.transform.localPosition = Vector3.Lerp(currentGun.transform.localPosition, retroActionRecoilBack, 0.4f);
                yield return null;
            }

            // ì›ìœ„ì¹˜
            while (currentGun.transform.localPosition != currentGun.fineSightOriginPos)
            {
                currentGun.transform.localPosition = Vector3.Lerp(currentGun.transform.localPosition, currentGun.fineSightOriginPos, 0.1f);
                yield return null;
            }
        }
    }


    private void Shoot()  // ì‹¤ì œ ë°œì‚¬ ë˜ëŠ” ê³¼ì •
    {
        currentGun.currentBulletCount--;
        currentFireRate = currentGun.fireRate;  // ì—°ì‚¬ ì†ë„ ì¬ê³„ì‚°
        PlaySE(currentGun.fire_Sound);
        currentGun.muzzleFlash.Play();

        // ì´ê¸° ë°˜ë™ ì½”ë£¨í‹´ ì‹¤í–‰
        StopAllCoroutines();
        StartCoroutine(RetroActionCoroutine());

        Debug.Log("ì´ì•Œ ë°œì‚¬ í•¨");
    }
```

![image](https://user-images.githubusercontent.com/42318591/94232797-bc941580-ff41-11ea-9e2a-84c5654eca1f.png)

êµ¬í˜„í•˜ë ¤ëŠ” ë°˜ë™ì€ ì´ì´ ì˜¬ë¼ê°€ëŠ” ìˆ˜ì§ ë°˜ë™ì´ ì•„ë‹ˆë¼ ì´ì„ ë°œì‚¬ í•  ë•Œë§ˆë‹¤ ì´ì´ ì• ë’¤ë¡œ ì™”ë‹¤ ê°”ë‹¤ í•˜ëŠ” ë°˜ë™ì„ êµ¬í˜„í•  ê²ƒì´ë‹¤. `GunHolder`ë¥¼ Y ì¶•ìœ¼ë¡œ 90 ë„ íšŒì „í–ˆì—ˆë˜ íƒ“ì—, ì´ì˜ ì•,ë’¤ ì´ë™ ì¶•ì€ Z ì¶•ì´ ì•„ë‹Œ X ì¶•ì´ ë˜ì—ˆë‹¤. ì‚¬ì§„ì—ì„œ í™”ì‚´í‘œ ë°©í–¥, ì¦‰ í”Œë ˆì´ì–´ ìª½ìœ¼ë¡œ ì´ì´ ë‹¹ê²¨ì§€ëŠ” ìª½ì´ X ì¶• positive ë°©í–¥ì´ë‹¤. **ë°œì‚¬í•  ë•Œë§ˆë‹¤ ì´ì˜ X ì¶• ë°©í–¥ìœ¼ë¡œ ì´ë™ê°’ì„ ì£¼ì–´ì„œ ë°˜ë™ì‹œí‚¤ê³  ë‹¤ì‹œ ì›ë˜ ìœ„ì¹˜ë¡œ ë˜ëŒì•„ê°€ëŠ” ì‹ìœ¼ë¡œ ë°˜ë™ì„ í‘œí˜„í•œë‹¤.** <u>X ë°©í–¥ Position ê°’ë§Œ ë³€ê²½í•´ì£¼ë©´ ëœë‹¤.</u> ì •ì¡°ì¤€ í•˜ê³  ìˆì„ ë•Œì™€ ì •ì¡°ì¤€ ì•ˆí•˜ê³  ì‡ì„ ë•Œ ì´ë ‡ê²Œ ë‘ ì¼€ì´ìŠ¤ë¡œ ë‚˜ëˆˆë‹¤.

- `recoilBack`
  - ì •ì¡°ì¤€ ì•ˆ í–ˆì„ ë•Œì˜ ìµœëŒ€ ë°˜ë™.
  - ì¦‰ X ë°©í–¥ìœ¼ë¡œ ğŸ“œGun.csì˜ `retroActionForce`(ì •ì¡°ì¤€ ì•ˆ í–ˆì„ ë•Œì˜ ë°˜ë™ ì„¸ê¸°) ìœ„ì¹˜ë¡œ ì´ë™ì‹œí‚¨ë‹¤. (ë¸íƒ€ê°’ ì•„ë‹˜. ì ˆëŒ€ì ì¸ x ë°©í–¥ ì¢Œí‘œê°’ì„)
    - í˜„ì¬ ìœ„ì¹˜ë¡œë¶€í„° Vector3(`retroActionForce`, ì›ë˜Yìœ„ì¹˜, ì›ë˜Zìœ„ì¹˜) ë¡œ Lerp ë³´ê°„í•˜ì—¬ ë¶€ë“œëŸ½ê²Œ ì—…ëƒì‹œí‚¬ ê²ƒì´ë‹¤. X ìœ„ì¹˜ ê°’ë§Œ ë³€í™”ë¥¼ ì¤€ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
      ```c#
      Vector3 recoilBack = new Vector3(currentGun.retroActionForce, originPos.y, originPos.z);
      ```
- `retroActionRecoilBack`
  - ì •ì¡°ì¤€ í–ˆì„ ë•Œì˜ ìµœëŒ€ ë°˜ë™.
  - ì¦‰ X ë°©í–¥ìœ¼ë¡œ ğŸ“œGun.csì˜ `retroActionFineSightForce`(ì •ì¡°ì¤€ í–ˆì„ ë•Œì˜ ë°˜ë™ ì„¸ê¸°) ìœ„ì¹˜ë¡œ ì´ë™ì‹œí‚¨ë‹¤. (ë¸íƒ€ê°’ ì•„ë‹˜. ì ˆëŒ€ì ì¸ x ë°©í–¥ ì¢Œí‘œê°’ì„)
    - í˜„ì¬ ìœ„ì¹˜ë¡œë¶€í„° Vector3(`retroActionFineSightForce`, ì •ì¡°ì¤€ì‹œYìœ„ì¹˜, ì •ì¡°ì¤€ì‹œZìœ„ì¹˜) ë¡œ Lerp ë³´ê°„í•˜ì—¬ ë¶€ë“œëŸ½ê²Œ ì—…ëƒì‹œí‚¬ ê²ƒì´ë‹¤. X ìœ„ì¹˜ ê°’ë§Œ ë³€í™”ë¥¼ ì¤€ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
      ```c#
      Vector3 retroActionRecoilBack = new Vector3(currentGun.retroActionFineSightForce, currentGun.fineSightOriginPos.y, currentGun.fineSightOriginPos.z);
      ```
- ì •ì¡°ì¤€ì´ ì•„ë‹Œ ìƒíƒœì¼ ë•Œ
  - ë°˜ë™ì´ ì´ë£¨ì–´ì§€ê³  ìˆëŠ” ìƒíƒœì—ì„œ ë˜ ë°˜ë™ì´ ë“¤ì–´ì˜¤ë©´(ë˜ ë°œì‚¬ê°€ ë“¤ì–´ ì˜¤ë©´) ì¤‘ë³µ ì²˜ë¦¬ê°€ ë˜ê¸° ë•Œë¬¸ì—(ì½”ë£¨í‹´ í•¨ìˆ˜ë¼ ë³‘ë ¬ì ìœ¼ë¡œ ì‹¤í–‰í•˜ëŠ”ê²Œ ê°€ëŠ¥í•˜ë¯€ë¡œ) ë°˜ë™ì„ ì‹œì‘í•˜ê³  ì› ìœ„ì¹˜ë¡œ ë˜ëŒë¦¬ëŠ” ì´ì²´ì ì¸ ë°˜ë™ ì‘ì—…ì„ ì‹œì‘ í•˜ê¸°ì— ì•ì„œ ì´ ìœ„ì¹˜ë¥¼ ì •ì¡°ì¤€ì´ ì•„ë‹Œ ì›ë˜ ìœ„ì¹˜ì—ì„œ ì‹œì‘í•˜ê²Œë” í•œë‹¤.
    ```c#
    currentGun.transform.localPosition = originPos;
    ```
  - 1ï¸âƒ£ ë°˜ë™ì„ ì‹œì‘í•œë‹¤. ğŸ‘‰ ì´ì˜ í˜„ì¬ ì ˆëŒ€ ìœ„ì¹˜ ê°’ì„ ì‹œì‘ìœ¼ë¡œ `recoilBack` Vector3 ê°’ì„ ëª©í‘œë¡œ ì´ì˜ í˜„ì¬ ìœ„ì¹˜ ê°’ì„ ë¶€ë“œëŸ½ê²Œ ì—…ëƒ í•´ë‚˜ê°„ë‹¤.   
    - ë¶€ë“œëŸ½ê²Œ ë³´ê°„í•˜ëŠ” ì‘ì—…ì€ ì´ì˜ X ë°©í–¥ ìœ„ì¹˜ê°€ `recoilBack` ë³´ë‹¤ ì»¤ì§ˆ ë•Œê¹Œì§€(ë°˜ë³µ ì¢…ë£Œì¡°ê±´) ë°˜ë³µí•œë‹¤. ë‹¨, ë³´ê°„ ë•Œë¬¸ì— ì˜ì›íˆ ì´ë ‡ê²Œ ì•ˆë  ìˆ˜ë„ ìˆì–´ì„œ `recoilBack`ì—ì„œ 0.02 ë¥¼ ë¹¼ì¤€ê°’ ë³´ë‹¤ ì»¤ì§ˆ ë•Œê¹Œì§€ë§Œ ë°˜ë³µí•˜ë„ë¡ ì‚´ì§ ë³´ì •í•´ì£¼ì—ˆë‹¤.
      - í˜„ì¬ ìœ„ì¹˜ê°€ `recoilBack` ìœ„ì¹˜ë¡œ ë  ë•Œê¹Œì§€ 40 í¼ì„¼íŠ¸ ë¹„ìœ¨ë¡œ ë³´ì •í•œë‹¤.
      - í•œ í”„ë ˆì„ì”© ì‰°ë‹¤.
  - 2ï¸âƒ£ ì› ìœ„ì¹˜ë¡œ ëŒì•„ê°„ë‹¤. ğŸ‘‰ í•œë²ˆ `recoilBack` Vector3 ê·¼ì²˜ê¹Œì§€ ë‹¹ê²¨ì¡Œì—ˆìœ¼ë©´ ë‹¤ì‹œ ì›ë˜ ìœ„ì¹˜ë¡œ ëŒì•„ ê°€ì•¼ í•œë‹¤. ì´ì˜ í˜„ì¬ ìœ„ì¹˜ ê°’ì„ ì‹œì‘ìœ¼ë¡œ ì›ë˜ ìœ„ì¹˜ì¸ `originPos` Vector3 ê°’ì„ ëª©í‘œë¡œ ì´ì˜ í˜„ì¬ ìœ„ì¹˜ ê°’ì„ ë¶€ë“œëŸ½ê²Œ ì—…ëƒ í•´ë‚˜ê°„ë‹¤.   
    - ë¶€ë“œëŸ½ê²Œ ë³´ê°„í•˜ëŠ” ì‘ì—…ì€ ì´ì˜ í˜„ì¬ ìœ„ì¹˜ê°€ ì›ë˜ ìœ„ì¹˜ì™€ ì¼ì¹˜í•˜ê²Œ ë  ë•Œê¹Œì§€ ! (ì‚¬ì‹¤ ì´ê²ƒë„ ë³´ê°„ ë•Œë¬¸ì— ë¬´í•œ ë£¨í”„ì— ë¹ ì§ˆ ìˆ˜ ìˆëŠ” ë¶€ë¶„ì¸ë° ë‚˜ì¤‘ì— ì½”ë£¨í‹´ ì¤‘ì§€í•˜ëŠ” ì‘ì—…ì„ í•´ì¤„ê±°ë¼ì„œ ê´œì°®ë‹¤.)
      - í˜„ì¬ ìœ„ì¹˜ê°€ `originPos` ìœ„ì¹˜ë¡œ ë  ë•Œê¹Œì§€ 10 í¼ì„¼íŠ¸ ë¹„ìœ¨ë¡œ ë³´ì •í•œë‹¤. (ë°˜ë™ ë•Œë³´ë‹¤ëŠ” ì¢€ ë” ëŠë¦¬ê²Œ ëŒì•„ì˜¤ê²Œë”)
      - í•œ í”„ë ˆì„ì”© ì‰°ë‹¤.
- ì •ì¡°ì¤€ ìƒíƒœì¼ ë•Œ
  - ìœ„ì™€ ë°©ì‹ì´ ë™ì¼í•˜ë‹¤. ë°˜ë™ ê°’ì€ `retroActionRecoilBack`, ì›ë˜ ìœ„ì¹˜ëŠ” ì´ì˜ ì •ì¡°ì¤€ ìœ„ì¹˜ì¸ `currentGun.fineSightOriginPos`ìœ¼ë¡œ ì“°ëŠ” ê²ƒ ë¹¼ê³ ëŠ” ê°™ë‹¤.


![image](https://user-images.githubusercontent.com/42318591/94230111-332e1480-ff3c-11ea-8723-d08c9af0bf1f.png)

- ì •ì¡°ì¤€ì´ ì•„ë‹ ë•Œ ì´ì˜ ìœ„ì¹˜ëŠ” (0, 0, 0) 
  - ë°œì‚¬ì‹œ ë°˜ë™ìœ¼ë¡œ (0.3, 0, 0) ì— ê·¼ì ‘í•´ì¡Œë‹¤ê°€ ë‹¤ì‹œ (0, 0, 0)ìœ¼ë¡œ ëŒì•„ì˜¨ë‹¤.
- ì •ì¡°ì¤€ ì¤‘ ì¼ ë•Œ ì´ì˜ ìœ„ì¹˜ëŠ” (0.55, 0.33, -0.557)
  - ë°œì‚¬ì‹œ ë°˜ë™ìœ¼ë¡œ (1.25, 0.33, -0.557) ì— ê·¼ì ‘í•´ì¡Œë‹¤ê°€ ë‹¤ì‹œ (0.55, 0.33, -0.557)ìœ¼ë¡œ ëŒì•„ì˜¨ë‹¤.  (0.55 + 0.7 = 1.250)


<br>

## ğŸš” ê·¸ ë°–ì˜ ê°œì„ 

### ì¬ì¥ì „ í•˜ëŠ” ë„ì¤‘ì— ìš°í´(ì •ì¡°ì¤€) í•˜ê³  ë‚˜ë©´ ë°œì‚¬ê°€ ì•ˆë˜ëŠ” ë²„ê·¸ 

> ì´ëŸ° ë²„ê·¸ê°€ ë‚˜íƒ€ë‚˜ëŠ” ì´ìœ 

  - ì¬ì¥ì „ ì• ë‹ˆë©”ì´ì…˜ì„ ì‹¤í–‰í•˜ëŠ” ë„ì¤‘ì—, ì¦‰, ReloadCoroutine() ì½”ë£¨í‹´ í•¨ìˆ˜ì—ì„œ *currentGun.anim.SetTrigger("Reload");* ì¬ì¥ì „ ì• ë‹ˆë©”ì´ì…˜ì„ ì¬ìƒí•˜ê³  *yield return new WaitForSeconds(currentGun.reloadTime);* `reloadTime`ë™ì•ˆ ëŒ€ê¸° ì‹œê°„ì„ ê°€ì§€ëŠ” ë™ì•ˆì— 
  - ìœ„ ëŒ€ê¸° ì‹œê°„ ë™ì•ˆ ìš°í´ ì…ë ¥ì´ ë“¤ì–´ì™€ ì •ì¡°ì¤€ì„ í•˜ê²Œ ë˜ì–´ì„œ ì¬ì¥ì „ ì• ë‹ˆë©”ì´ì…˜ì„ ì¬ìƒí•˜ëŠ” ëŒ€ê¸° ì‹œê°„ë™ì•ˆ FindSight() í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ê³ , StopAllcoroutines() ì‹¤í–‰ì„ ë§Œë‚˜ê¸° ë•Œë¬¸ì´ë‹¤.
    - ë”°ë¼ì„œ `isReload`ê°€ ë‹¤ì‹œ False ê°€ ë˜ê¸° ì „ì— ReloadCoroutine() ì½”ë£¨í‹´ í•¨ìˆ˜ê°€ ì¤‘ë‹¨ì´ ë˜ì–´ ë²„ë ¤ì„œ `isReload`ëŠ” True ì¸ ìƒíƒœë¡œ ë‚¨ê²Œ ë˜ì–´ì„œ ë°œì‚¬ê°€ ë¶ˆê°€ëŠ¥í•´ì§„ ê²ƒì´ë‹¤. `!isReload` ì¬ì¥ì „ ì¤‘ì´ ì•„ë‹ ë•Œë§Œ ë°œì‚¬ê°€ ê°€ëŠ¥í•˜ë¯€ë¡œ.

#### ğŸ“œGunController.cs

> ë”°ë¼ì„œ ReloadCoroutine() ì‹¤í–‰ ì¤‘ì¼ ë•Œ ReloadCoroutine() í•¨ìˆ˜ëŠ” StopAllcoroutines() ì‹¤í–‰ìœ¼ë¡œ ì¤‘ë‹¨ë˜ì§€ ì•Šë„ë¡ í•´ì•¼ í•œë‹¤. <u>ì¬ì¥ì „ ì¤‘ì¼ ë• ì •ì¡°ì¤€/ì •ì¡°ì¤€í•´ì œ ê°€ ì´ë£¨ì–´ì§€ë©´ ì•ˆëœë‹¤.</u>


```c#
    private void TryFindSight()
    {
        if(Input.GetButtonDown("Fire2") && !isReload)
        {
            FindSight();
        }
    }
```

ì •ì¡°ì¤€ì€ ì¬ì¥ì „ ì¤‘ì´ ì•„ë‹ ë•Œë§Œ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤. 

```c#
    private void CancelFineSight()
    {
        if (isFineSightMode)
            FineSight();
    }

    private void TryReload()
    {
        if (Input.GetKeyDown(KeyCode.R) && !isReload && currentGun.currentBulletCount < currentGun.reloadBulletCount)
        {
            CancelFineSight();
            StartCoroutine(ReloadCoroutine());
        }
    }

    private void Fire()  // ë°œì‚¬ë¥¼ ìœ„í•œ ê³¼ì •
    {
        if (!isReload)
        {
            if (currentGun.currentBulletCount > 0)
                Shoot();
            else
            {
                CancelFineSight();
                StartCoroutine(ReloadCoroutine());
            }       
        }
    }
```

ì •ì¡°ì¤€ ìƒíƒœì—ì„œ ì¬ì¥ì „ ìš°í´ ì…ë ¥ì´ ë“¤ì–´ì˜¨ë‹¤ë©´ ì •ì¡°ì¤€ì„ ì·¨ì†Œí•œë‹¤.

- *CancelFineSight() í•¨ìˆ˜*
  - ì •ì¡°ì¤€ ì¤‘ì´ë¼ë©´ *FineSight()* í•œë²ˆ ë” ì‹¤í–‰í•˜ì—¬ ì •ì¡°ì¤€ì„ í•´ì œì‹œí‚¨ë‹¤.
- ì¬ì¥ì „ í•˜ê¸° ì „ì— *CancelFineSight() í•¨ìˆ˜*ë¥¼ í•œë²ˆ ì‹¤í–‰í•˜ì—¬ ì •ì¡°ì¤€ ìƒíƒœë¼ë©´ í•´ì œì‹œí‚¨ë‹¤.
  - ì¬ì¥ì „ ì‹¤í–‰ì‹œí‚¤ëŠ” ê³³
    - *TryReload()*
    - *Fire()* ë°œì‚¬í•˜ë ¤ëŠ”ë° íƒ„ì°½ì´ ë¹„ì–´ìˆì„ ë•Œ

<br>

### ì •ì¡°ì¤€ ìƒíƒœì—ì„œ ë›°ë©´ ì •ì¡°ì¤€ í•´ì œ ì‹œí‚¤ê¸°

#### ğŸ“œPlayController.cs

```c#
// ì¶”ê°€í•œ ë©¤ë²„ ë³€ìˆ˜
private GunController theGunController;
```
```c#
    void Start()
    {
        ...
        
        theGunController = FindObjectOfType<GunController>();

        ...
    }

    private void Running()
    {
        if (isCrouch)
            Crouch();

        theGunController.CancelFineSight();

        isRun = true;
        applySpeed = runSpeed;
    }
```

- ğŸ“œGunController.cs ì˜ *CancelFineSight()* í•¨ìˆ˜ë¥¼ publicìœ¼ë¡œ ë°”ê¾¼ í›„
- ğŸ“œPlayController.cs ì˜ Running() í•¨ìˆ˜ì—ì„œ ì´ë¥¼ ì‹¤í–‰.
  - ë‹¬ë¦¬ëŠ” ì¤‘ì— ì •ì¡°ì¤€ ì¤‘ì¸ ìƒíƒœë¼ë©´ ì´ë¥¼ í•´ì œ í•˜ë„ë¡

<br>

## ğŸš” ì—¬ê¸°ê¹Œì§€ ìŠ¤í¬ë¦½íŠ¸ ì •ë¦¬

### ğŸ“œPlayController.cs

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class PlayerController : MonoBehaviour
{
    // ìŠ¤í”¼ë“œ ì¡°ì • ë³€ìˆ˜
    [SerializeField]
    private float walkSpeed;
    [SerializeField]
    private float runSpeed;
    [SerializeField]
    private float crouchSpeed;
    private float applySpeed;

    [SerializeField]
    private float jumpForce;

    // ìƒíƒœ ë³€ìˆ˜
    private bool isRun = false;
    private bool isGround = true;
    private bool isCrouch = false;

    // ì•‰ì•˜ì„ ë•Œ ì–¼ë§ˆë‚˜ ì•‰ì„ì§€ ê²°ì •í•˜ëŠ” ë³€ìˆ˜
    [SerializeField]
    private float crouchPosY;
    private float originPosY;
    private float applyCrouchPosY;

    // ë¯¼ê°ë„
    [SerializeField]
    private float lookSensitivity;  

    // ì¹´ë©”ë¼ í•œê³„
    [SerializeField]
    private float cameraRotationLimit;  
    private float currentCameraRotationX; 

    // í•„ìš”í•œ ì»´í¬ë„ŒíŠ¸
    [SerializeField]
    private Camera theCamera; 
    private Rigidbody myRigid;
    private CapsuleCollider capsuleCollider;
    private GunController theGunController;

    void Start()
    {
        // ì»´í¬ë„ŒíŠ¸ í• ë‹¹
        capsuleCollider = GetComponent<CapsuleCollider>();
        myRigid = GetComponent<Rigidbody>();
        applySpeed = walkSpeed;
        theGunController = FindObjectOfType<GunController>();

        originPosY = theCamera.transform.localPosition.y;
        applyCrouchPosY = originPosY;
    }

    void Update()  
    {
        IsGround();
        TryJump();
        TryRun();
        TryCrouch();
        Move();
        CameraRotation();
        CharacterRotation();
    }

    // ì§€ë©´ ì²´í¬
    private void IsGround()
    {
        isGround = Physics.Raycast(transform.position, Vector3.down, capsuleCollider.bounds.extents.y + 0.1f);
    }

    // ì í”„ ì‹œë„
    private void TryJump()
    {
        if (Input.GetKeyDown(KeyCode.Space) && isGround)
        {
            Jump();
        }
    }

    // ì í”„
    private void Jump()
    {
        if (isCrouch)
            Crouch();

        myRigid.velocity = transform.up * jumpForce;
    }

    // ë‹¬ë¦¬ê¸° ì‹œë„
    private void TryRun()
    {
        if (Input.GetKey(KeyCode.LeftShift))
        {
            Running();
        }
        if (Input.GetKeyUp(KeyCode.LeftShift))
        {
            RunningCancel();
        }
    }

    // ë‹¬ë¦¬ê¸°
    private void Running()
    {
        if (isCrouch)
            Crouch();

        theGunController.CancelFineSight();

        isRun = true;
        applySpeed = runSpeed;
    }

    // ë‹¬ë¦¬ê¸° ì·¨ì†Œ
    private void RunningCancel()
    {
        isRun = false;
        applySpeed = walkSpeed;
    }

    // ì•‰ê¸° ì‹œë„
    private void TryCrouch()
    {
        if (Input.GetKeyDown(KeyCode.LeftControl))
        {
            Crouch();
        }
    }

    // ì•‰ê¸° ë™ì‘
    private void Crouch()
    {
        isCrouch = !isCrouch;
        if (isCrouch)
        {
            applySpeed = crouchSpeed;
            applyCrouchPosY = crouchPosY;
        }
        else
        {
            applySpeed = walkSpeed;
            applyCrouchPosY = originPosY;
        }

        StartCoroutine(CrouchCoroutine());
    }

    // ë¶€ë“œëŸ¬ìš´ ì•‰ê¸° ë™ì‘
    IEnumerator CrouchCoroutine()
    {
        float _posY = theCamera.transform.localPosition.y;
        int count = 0;

        while(_posY != applyCrouchPosY)
        {
            count++;
            _posY = Mathf.Lerp(_posY, applyCrouchPosY, 0.2f);
            theCamera.transform.localPosition = new Vector3(0, _posY, 0);
            if(count > 15)
                break;
            yield return null;
        }
        theCamera.transform.localPosition = new Vector3(0, applyCrouchPosY, 0);
    }

    private void Move()
    {
        float _moveDirX = Input.GetAxisRaw("Horizontal"); 
        float _moveDirZ = Input.GetAxisRaw("Vertical"); 

        Vector3 _moveHorizontal = transform.right * _moveDirX;
        Vector3 _moveVertical = transform.forward * _moveDirZ; 

        Vector3 _velocity = (_moveHorizontal + _moveVertical).normalized * applySpeed; 

        myRigid.MovePosition(transform.position + _velocity * Time.deltaTime);
    }

    private void CameraRotation() 
    {
        float _xRotation = Input.GetAxisRaw("Mouse Y"); 
        float _cameraRotationX = _xRotation * lookSensitivity;

        currentCameraRotationX -= _cameraRotationX;
        currentCameraRotationX = Mathf.Clamp(currentCameraRotationX, -cameraRotationLimit, cameraRotationLimit);

        theCamera.transform.localEulerAngles = new Vector3(currentCameraRotationX, 0f, 0f);
    }

    private void CharacterRotation()
    {
        float _yRotation = Input.GetAxisRaw("Mouse X");
        Vector3 _characterRotationY = new Vector3(0f, _yRotation, 0f) * lookSensitivity;
        myRigid.MoveRotation(myRigid.rotation * Quaternion.Euler(_characterRotationY)); 
    }
}



```

### ğŸ“œGunController.cs

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class GunController : MonoBehaviour
{
    [SerializeField]
    private Gun currentGun; // í˜„ì¬ ë“¤ê³  ìˆëŠ” ì´. ğŸ“œGun.cs ê°€ í• ë‹¹ ë¨.

    private float currentFireRate; // ì´ ê°’ì´ 0 ë³´ë‹¤ í° ë™ì•ˆì—ëŠ” ì´ì•Œì´ ë°œì‚¬ ë˜ì§€ ì•ŠëŠ”ë‹¤. ì´ˆê¸°ê°’ì€ ì—°ì‚¬ ì†ë„ì¸ ğŸ“œGun.csì˜ fireRate 

    private bool isReload = false;  // ì¬ì¥ì „ ì¤‘ì¸ì§€. 
    private bool isFineSightMode = false; // ì •ì¡°ì¤€ ì¤‘ì¸ì§€.

    [SerializeField]
    private Vector3 originPos;  // ì›ë˜ ì´ì˜ ìœ„ì¹˜(ì •ì¡°ì¤€ í•´ì œí•˜ë©´ ë‚˜ì¤‘ì— ëŒì•„ì™€ì•¼ í•˜ë‹ˆê¹Œ)

    private AudioSource audioSource;  // ë°œì‚¬ ì†Œë¦¬ ì¬ìƒê¸°

    void Start()
    {
        audioSource = GetComponent<AudioSource>();
    }

    void Update()
    {
        GunFireRateCalc();
        TryFire();
        TryReload();
        TryFineSight();
    }

    private void GunFireRateCalc()
    {
        if (currentFireRate > 0)
            currentFireRate -= Time.deltaTime;  // ì¦‰, 1 ì´ˆì— 1 ì”© ê°ì†Œì‹œí‚¨ë‹¤.
    }

    private void TryFire()  // ë°œì‚¬ ì…ë ¥ì„ ë°›ìŒ
    {
        if(Input.GetButton("Fire1") && currentFireRate <= 0 && !isReload)
        {
            Fire();
        }
    }

    private void Fire()  // ë°œì‚¬ë¥¼ ìœ„í•œ ê³¼ì •
    {
        if (!isReload)
        {
            if (currentGun.currentBulletCount > 0)
                Shoot();
            else
            {
                CancelFineSight();
                StartCoroutine(ReloadCoroutine());
            }       
        }
    }

    private void Shoot()  // ì‹¤ì œ ë°œì‚¬ ë˜ëŠ” ê³¼ì •
    {
        currentGun.currentBulletCount--;
        currentFireRate = currentGun.fireRate;  // ì—°ì‚¬ ì†ë„ ì¬ê³„ì‚°
        PlaySE(currentGun.fire_Sound);
        currentGun.muzzleFlash.Play();

        // ì´ê¸° ë°˜ë™ ì½”ë£¨í‹´ ì‹¤í–‰
        StopAllCoroutines();
        StartCoroutine(RetroActionCoroutine());

        Debug.Log("ì´ì•Œ ë°œì‚¬ í•¨");
    }

    private void TryReload()
    {
        if (Input.GetKeyDown(KeyCode.R) && !isReload && currentGun.currentBulletCount < currentGun.reloadBulletCount)
        {
            CancelFineSight();
            StartCoroutine(ReloadCoroutine());
        }
    }

    IEnumerator ReloadCoroutine()
    {
        if(currentGun.carryBulletCount > 0)
        {
            isReload = true;
            currentGun.anim.SetTrigger("Reload");

            currentGun.carryBulletCount += currentGun.currentBulletCount;
            currentGun.currentBulletCount = 0;

            yield return new WaitForSeconds(currentGun.reloadTime);  // ì¬ì¥ì „ ì• ë‹ˆë©”ì´ì…˜ì´ ë‹¤ ì¬ìƒë  ë™ì•ˆ ëŒ€ê¸°

            if (currentGun.carryBulletCount >= currentGun.reloadBulletCount)
            {
                currentGun.currentBulletCount = currentGun.reloadBulletCount;
                currentGun.carryBulletCount -= currentGun.reloadBulletCount;
            }
            else
            {
                currentGun.currentBulletCount = currentGun.carryBulletCount;
                currentGun.carryBulletCount = 0;
            }

            isReload = false;
        }
        else
        {
            Debug.Log("ì†Œìœ í•œ ì´ì•Œì´ ì—†ìŠµë‹ˆë‹¤.");
        }
    }

    private void TryFineSight()
    {
        if(Input.GetButtonDown("Fire2") && !isReload)
        {
            FineSight();
        }
    }

    public void CancelFineSight()
    {
        if (isFineSightMode)
            FineSight();
    }

    private void FineSight()
    {
        isFineSightMode = !isFineSightMode;
        currentGun.anim.SetBool("FineSightMode", isFineSightMode);
        
        if(isFineSightMode)
        {
            StopAllCoroutines();
            StartCoroutine(FineSightActivateCoroutine());
        }
        else
        {
            StopAllCoroutines();
            StartCoroutine(FineSightDeActivateCoroutine());
        }
    }

    IEnumerator FineSightActivateCoroutine()
    {
        while(currentGun.transform.localPosition != currentGun.fineSightOriginPos)
        {
            currentGun.transform.localPosition = Vector3.Lerp(currentGun.transform.localPosition, currentGun.fineSightOriginPos, 0.2f);
            yield return null;
        }
    }

    IEnumerator FineSightDeActivateCoroutine()
    {
        while (currentGun.transform.localPosition != originPos)
        {
            currentGun.transform.localPosition = Vector3.Lerp(currentGun.transform.localPosition, originPos, 0.2f);
            yield return null;
        }
    }

    IEnumerator RetroActionCoroutine()
    {
        Vector3 recoilBack = new Vector3(currentGun.retroActionForce, originPos.y, originPos.z);     // ì •ì¡°ì¤€ ì•ˆ í–ˆì„ ë•Œì˜ ìµœëŒ€ ë°˜ë™
        Vector3 retroActionRecoilBack = new Vector3(currentGun.retroActionFineSightForce, currentGun.fineSightOriginPos.y, currentGun.fineSightOriginPos.z);  // ì •ì¡°ì¤€ í–ˆì„ ë•Œì˜ ìµœëŒ€ ë°˜ë™

        if(!isFineSightMode)  // ì •ì¡°ì¤€ì´ ì•„ë‹Œ ìƒíƒœ
        {
            currentGun.transform.localPosition = originPos;

            // ë°˜ë™ ì‹œì‘
            while(currentGun.transform.localPosition.x <= currentGun.retroActionForce - 0.02f)
            {
                currentGun.transform.localPosition = Vector3.Lerp(currentGun.transform.localPosition, recoilBack, 0.4f);
                yield return null;
            }

            // ì›ìœ„ì¹˜
            while (currentGun.transform.localPosition != originPos)
            {
                currentGun.transform.localPosition = Vector3.Lerp(currentGun.transform.localPosition, originPos, 0.1f);
                yield return null;
            }
        }
        else  // ì •ì¡°ì¤€ ìƒíƒœ
        {
            currentGun.transform.localPosition = currentGun.fineSightOriginPos;

            // ë°˜ë™ ì‹œì‘
            while(currentGun.transform.localPosition.x <= currentGun.retroActionFineSightForce - 0.02f)
            {
                currentGun.transform.localPosition = Vector3.Lerp(currentGun.transform.localPosition, retroActionRecoilBack, 0.4f);
                yield return null;
            }

            // ì›ìœ„ì¹˜
            while (currentGun.transform.localPosition != currentGun.fineSightOriginPos)
            {
                currentGun.transform.localPosition = Vector3.Lerp(currentGun.transform.localPosition, currentGun.fineSightOriginPos, 0.1f);
                yield return null;
            }
        }
    }

    private void PlaySE(AudioClip _clip)  // ë°œì‚¬ ì†Œë¦¬ ì¬ìƒ
    {
        audioSource.clip = _clip;
        audioSource.Play();
    }
}

```

***
<br>

    ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš° 
    ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}