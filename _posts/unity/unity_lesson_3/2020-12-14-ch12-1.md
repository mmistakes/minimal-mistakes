---
title:  "Chapter 12-1. ê¸°íƒ€ : íŠ¸ë© ë§Œë“¤ê¸°" 

categories:
  -  Unity Lesson 3 
tags:
  - [Game Engine, Unity]

toc: true
toc_sticky: true

date: 2020-12-14
last_modified_at: 2020-12-14
---

ì¸í”„ëŸ°ì— ìˆëŠ” ì¼€ì´ë””ë‹˜ì˜ **[ìœ ë‹ˆí‹° 3D] ì‹¤ì „! ìƒì¡´ê²Œì„ ë§Œë“¤ê¸° - Advanced** ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ í•„ê¸°ì…ë‹ˆë‹¤. ğŸ˜€  
[ğŸŒœ ê°•ì˜ ë“¤ìœ¼ëŸ¬ ê°€ê¸° Click](https://www.inflearn.com/course/unity-2#)
{: .notice--warning}

## ğŸš€ ë‹¨ìˆœí•œ íŠ¸ë© ë§Œë“¤ê¸°

### íŠ¸ë© ì˜¤ë¸Œì íŠ¸

![image](https://user-images.githubusercontent.com/42318591/102032906-65456900-3dfd-11eb-91b9-19e0277c4c16.png)

![image](https://user-images.githubusercontent.com/42318591/102033637-49db5d80-3dff-11eb-9564-83f8d6cdb5b3.png)

ì´ 3 ê°€ì§€ ì˜¤ë¸Œì íŠ¸ë¥¼ ì¡°í•©í•´ì„œ íŠ¸ë©ì„ ë§Œë“ ë‹¤. Rigidbody ë¥¼ ë¶™ì—¬ì¤„ ë•Œ ì¤‘ë ¥ê³¼ ë¬¼ë¦¬ë¥¼ êº¼ì¤€ë‹¤. ê³ ê¸°ì— Trigger ì¶©ëŒì´ ë°œë™í•˜ë©´ ë‚˜ë¬´ì™€ ë‚˜ë­‡ê°€ì§€ì˜ ì¤‘ë ¥ê³¼ ë¬¼ë¦¬ë¥¼ í™œì„±í™”í•˜ì—¬ ì“°ëŸ¬ì§€ê²Œ í•  ê²ƒì´ë‹¤.

- ë„¤ëª¨ ë‚˜ë¬´, ë‚˜ë­‡ê°€ì§€
  - Box Collider
  - Rigidbody (Use Gravity í•´ì œ, Is Kinematic ì²´í¬)
- ì „ì²´ `SimpleTrap` ë¶€ëª¨ ì˜¤ë¸Œì íŠ¸ì—ê²Œ Box Collider ë¶™ì´ê³  Is Triggerì²´í¬. ê³ ê¸° ìª½ì— ë¶™ì¸ë‹¤.
  - ë ˆì´ì–´ëŠ” "Building"
  - AudioSource ë¥¼ ë¶™ì¸ë‹¤.
  - ğŸ“œSimpleTrap ì´ ë¶™ì„ ê²ƒ


<br>

### ğŸ“œSimpleTrap

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class SimpleTrap : MonoBehaviour
{
    private Rigidbody[] rigid; // Twig, Board ì˜ Rigidbody ê°€ì§€ê³  ì˜¬ ê²ƒ
    [SerializeField] private GameObject go_Meat;  // íŠ¸ë©ì— ê±¸ë¦¬ë©´ ê³ ê¸°ê°€ ì‚¬ë¼ì§€ê²Œ
    [SerializeField] private int damage; // í”Œë ˆì´ì–´ì—ê²Œ ì…í ë°ë¯¸ì§€

    private bool isActivated = false; // íŠ¸ë©ì´ ë°œë™ë˜ë©´ true

    private AudioSource theAudio;
    [SerializeField] private AudioClip sound_Activate; // íŠ¸ë© ë°œë™ ì‚¬ìš´ë“œ

    void Start()
    {
        rigid = GetComponentsInChildren<Rigidbody>();
        theAudio = GetComponent<AudioSource>();
    }

    private void OnTriggerEnter(Collider other)
    {
        if (!isActivated)
        {
            if (other.transform.tag != "Untagged")
            {
                isActivated = true;
                theAudio.clip = sound_Activate;
                theAudio.Play();

                Destroy(go_Meat);

                for (int i = 0; i < rigid.Length; i++)
                {
                    rigid[i].useGravity = true;
                    rigid[i].isKinematic = false;
                }

                if (other.transform.name == "Player")
                    other.transform.GetComponent<StatusController>().DecreaseHP(damage);
            }
        }
    }
}

```

- Terrain ì˜ íƒœê·¸ëŠ” "Untagged"ì´ë‹¤. ì´ íƒœê·¸ê°€ ì•„ë‹Œ í”Œë ˆì´ì–´, ë™ë¬¼AI ë“±ë“± ëª¨ë“  ê²ƒì´ ë‹¿ìœ¼ë©´ 
  - íŠ¸ë© ì‚¬ìš´ë“œ ì¬ìƒ
  - ê³ ê¸° ì—†ì• ê¸°
  - Twigì™€ Boardì˜ ì¤‘ë ¥, ë¬¼ë¦¬ í™œì„±í™”í•˜ì—¬ ë„˜ì–´ì§€ê²Œ í•˜ê¸°
  - í”Œë ˆì´ì–´ì˜ ë°ë¯¸ì§€ ì…íˆê¸°

![image](https://user-images.githubusercontent.com/42318591/102033692-67102c00-3dff-11eb-8482-706ea5a0c2d3.png)

í”Œë ˆì´ì–´ê°€ ê³ ê¸°ì— ë‹¿ìœ¼ë©´ íŠ¸ë©ì˜ ì¤‘ë ¥ê³¼ ë¬¼ë¦¬ê°€ ë°œë™í•˜ì—¬ ë¬´ë„ˆì§€ê²Œ ë˜ê³  í”Œë ˆì´ì–´ì˜ ì²´ë ¥ì´ ê¹ì´ê²Œ ëœë‹¤.

<br>

## ğŸš€ ì¢€ ë” ì‹¬í™”ì ì¸ íŠ¸ë© ë§Œë“¤ê¸°

### âœˆ íŠ¸ë© ì˜¤ë¸Œì íŠ¸

![image](https://user-images.githubusercontent.com/42318591/102042899-58813f00-3e16-11eb-8536-8cb14e80c602.png)

![image](https://user-images.githubusercontent.com/42318591/102043030-ba41a900-3e16-11eb-812a-77e4d97de448.png)

ê°€ì¥ ë°‘ì—ìˆëŠ” ë‚˜ë­‡ ê°€ì§€ì— í”Œë ˆì´ì–´ê°€ ë‹¿ìœ¼ë©´ ì—°í•„ ê°™ì´ ìƒê¸´ ë‚˜ë¬´ê°€ ë–¨ì–´ì§€ê³  ì´ ë‚˜ë¬´ì— ë§ìœ¼ë©´ ë°ë¯¸ì§€ë¥¼ ì…ê²Œ í•  ê²ƒì´ë‹¤! ë°ë¯¸ì§€ëŠ” ì§€ì† ë°ë¯¸ì§€ëŠ” ì•„ë‹ˆê³  ë”± í•œë²ˆë§Œ ì…ëŠ”ë‹¤. 

- ë¶€ëª¨ `DeadTrap`
  - íƒœê·¸ "Trap", ë ˆì´ì–´ "Building"
  - ğŸ“œDeapTrap ë¶ˆì¼ ê²ƒ
  - Box Collider 2 ê°œ (ğŸ“œDeamTrap ì—ì„œ ê°€ì ¸ì˜¬ ê²ƒ)
    - í•˜ë‚˜ëŠ” ê°€ìš´ë° 
      - ë©”ì¸ ì¹´ë©”ë¼ì˜ Raycast ì¶©ëŒì„ ë°›ì•„ ì•¡ì…˜ í…ìŠ¤íŠ¸ ë„ìš¸ ê²ƒ 
    - ë‹¤ë¥¸ í•˜ë‚˜ëŠ” ì–‡ì€ ë‚˜ë­‡ ê°€ì§€ ìˆëŠ” ë°”ë‹¥ 
      - ì´ ê³³ì— ê²¹ì¹˜ë©´ íŠ¸ë©ì´ ë°œë™í•˜ê²Œ í• ê²ƒ
        - `IsTrigger` ì²´í¬
      - ë©”ì¸ ì¹´ë©”ë¼ì˜ Raycast ì¶©ëŒì„ ë°›ì•„ ì•¡ì…˜ í…ìŠ¤íŠ¸ ë„ìš¸ ê²ƒ
  - Animator 
  - Audio Source
- í”Œë ˆì´ì–´ê°€ ë¶€ë”ªì¹˜ë©´ ê´€í†µ ì•ˆë˜ê³  ë°€ë ¤ë‚  ìˆ˜ ìˆë„ë¡ ëª¨ë“  ìì‹ ì˜¤ë¸Œì íŠ¸ë“¤ì—ê²Œ Box Collider ë¶™ì—¬ì£¼ê¸° 
  - ë‹¨, í”Œë ˆì´ì–´ê°€ ë§ì•„ì„œ ë°ë¯¸ì§€ë¥¼ ì…í ì € ì—°í•„ ëª¨ì–‘ì˜ ë‚˜ë¬´(`WoodWall`)ëŠ” `IsTrigger`ê°€ ì²´í¬ëœ Box Collider ë¥¼ í•œë²ˆ ê¸°ì¡´ Box Collider ë°”ê¹¥ì— ì…í˜€ì§€ë„ë¡ í•˜ë‚˜ ë” ì¶”ê°€í•´ì¤€ë‹¤.
  - ğŸ“œTrapDamage ë¶™ì¼ ê²ƒ
    - OnTriggerEnter ì´ë²¤íŠ¸ì‹œ í”Œë ˆì´ì–´ì—ê²Œ ë°ë¯¸ì§€ ì…íˆëŠ” ì²˜ë¦¬
  - Rigidbody 
    - í”Œë ˆì´ì–´ê°€ ë§ìœ¼ë©´ íŠ•ê²¨ë‚˜ê°€ë„ë¡ ì§ˆëŸ‰ì„ 1000ìœ¼ë¡œ ë¬´ê²ê²Œ
    - ì¤‘ë ¥ ë„ê³  ë¬¼ë¦¬ ì²˜ë¦¬ ë„ê³ 


<br>

### âœˆ íŠ¸ë© ì• ë‹ˆë©”ì´ì…˜

#### íŠ¸ë© ì• ë‹ˆë©”ì´ì…˜ í´ë¦½

##### íŠ¸ë©ì´ í™œì„±í™” ë  ë•Œ

![image](https://camo.githubusercontent.com/65145dbc39c066db537c175d6805b0f16f328122a7deb04b21b65423d7113d2e/68747470733a2f2f706f737466696c65732e707374617469632e6e65742f4d6a41794d4445794d5452664d5445322f4d4441784e6a41334f54497a4d5451774f4455302e48546a686f5f53746630574b4e5741584e36777277445f566c3152453731776c6c705f494e58706c4f654d672e6c7576445632366d2d4c7450676a59437351795a69465f5a7a4770564f76654a43656f67464b6c69724f30672e4749462e736f6879756e655f616e2f4749465f323032302d31322d31345f2545432539382541342545442539422538345f322d31372d34352e6769663f747970653d77373733)

- "DeadTrap_Activate" ì• ë‹ˆë©”ì´ì…˜ í´ë¦½
  - íŠ¸ë©ì´ í™œì„±í™”ë˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì• ë‹ˆë©”ì´ì…˜ì´ ì¬ìƒë  ìˆ˜ ìˆë„ë¡ ë…¹í™”í•˜ì—¬ í‚¤ë“¤ì„ ë§Œë“¤ì—ˆë‹¤.

##### íŠ¸ë©ì´ ë¹„í™œì„±í™” ìƒíƒœì¼ ë–„

![image](https://user-images.githubusercontent.com/42318591/102045769-2f17e180-3e1d-11eb-8b4b-bff74902f2ab.png)

- "DeadTrap_Deactivate" ì• ë‹ˆë©”ì´ì…˜ í´ë¦½
  - ê·¸ëƒ¥ ì •ì§€í•´ìˆì„ ë•Œ.

<br>

#### íŠ¸ë© ì• ë‹ˆë©”ì´ì…˜ ì»¨íŠ¸ë¡¤ëŸ¬

![image](https://user-images.githubusercontent.com/42318591/102045815-51116400-3e1d-11eb-8d38-f517b9e947b8.png)

- `DeadTrap`ì˜ Animator ì»´í¬ë„ŒíŠ¸ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ì— í• ë‹¹í•´ì¤€ë‹¤.
- Trigger íŒŒë¼ë¯¸í„°ë¥¼ ìœ„ì™€ ê°™ì´ ì¶”ê°€í•´ì¤€ë‹¤.
- ê° Triggerê°€ ë°œë™í•  ë•Œ í•´ë‹¹ Transitionì´ ì¼ì–´ë‚˜ë„ë¡ í•œë‹¤.
  - Has Exit Time ì€ ì²´í¬ í•´ì œ. ê·¸ëƒ¥ ì• ë‹ˆë©”ì´ì…˜ ì¬ìƒì´ ëë‚˜ë©´ ì¦‰ê° ëë‚´ë„ë¡!

<br>

### âœˆ íŠ¸ë© ì‘ë™ì‹œí‚¤ê¸°

#### ğŸ“œDeadTrap

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class DeadTrap : MonoBehaviour
{
    private Animator anim;
    private AudioSource theAudio;

    private bool isActivated = false;

    [SerializeField] private AudioClip sound_Activate;
    [SerializeField] private TrapDamage theTrapDamage;

    void Start()
    {
        anim = GetComponent<Animator>();
        theAudio = GetComponent<AudioSource>();
    }

    private void OnTriggerEnter(Collider other)
    {
        if (!isActivated)
        {
            if (other.transform.tag != "Untagged" && other.transform.tag != "Trap")
            {
                StartCoroutine(theTrapDamage.ActivatedTrapCoroutine());
                isActivated = true;
                anim.SetTrigger("Activate");
                theAudio.clip = sound_Activate;
                theAudio.Play();
            }
        }
    }
}

```

> `DeadTrap`ì— ë¶™ëŠ”ë‹¤. ì•„ë« ë‚˜ë­‡ ê°€ì§€ë¥¼ ë°Ÿìœ¼ë©´ íŠ¸ë©ì„ ì‘ë™ì‹œí‚¨ë‹¤.

- *OnTriggerEnter*
  - `DeadTrap`ì˜ Box Collider ì¤‘ í•˜ë‚˜ì¸ ì–‡ì€ ë‚˜ë­‡ê°€ì§€ ë¶€ë¶„! ê·¸ ë¶€ë¶„ì€ `Is Trigger`ê°€ ì²´í¬ë˜ì–´ ìˆìœ¼ë©°, ê·¸ ë¶€ë¶„ì„ ë°Ÿìœ¼ë©´ íŠ¸ë©ì´ ì‘ë™ë˜ê²Œ í•  ê²ƒì´ë‹¤. 
    - ë°Ÿì€ ëŒ€ìƒì´ ì§€í˜•ì´ ì•„ë‹ˆê³ ("Untagged") ìê¸° ìì‹ ì´ ì•„ë‹ˆë¼ë©´("Trap")
      - ë°‘ì— í›„ìˆ í•  ğŸ“œTrapDamage ì˜ *ActivatedTrapCoroutine* ì‹¤í–‰í•˜ì—¬ ë°ë¯¸ì§€ ì…íˆëŠ” ì²˜ë¦¬
        - `isActivated` trueë¡œ í•´ì•¼ ë°ë¯¸ì§€ë¥¼ ì…ì„ ìˆ˜ ìˆë‹¤.
      - íŠ¸ë© ì• ë‹ˆë©”ì´ì…˜ ì¬ìƒ
      - íŠ¸ë© í™œì„± íš¨ê³¼ìŒ ì¬ìƒ

![image](https://user-images.githubusercontent.com/42318591/102045848-6090ad00-3e1d-11eb-9460-a5ec49bd122d.png)

ğŸ“œTrapDamage ê°€ ë¶™ì–´ìˆëŠ” `WoodWall` í™œë‹¹.


<br>

#### ğŸ“œTrapDamage

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class TrapDamage : MonoBehaviour
{
    [SerializeField] private int damage;
    [SerializeField] private float finishTime;

    private bool isHurt = false; // false ì¼ ë•Œë§Œ ë°ë¯¸ì§€ ì…ê²Œ
    private bool isActivated = false;

    public IEnumerator ActivatedTrapCoroutine()
    {
        isActivated = true;

        yield return new WaitForSeconds(finishTime);
        isActivated = false;
        isHurt = false;
    }

    private void OnTriggerEnter(Collider other)
    {
        if (isActivated)
        {
            if (!isHurt)
            {
                isHurt = true;

                if (other.transform.name == "Player")
                    other.transform.GetComponent<StatusController>().DecreaseHP(damage);
            }
        }
    }
}

```

> `WoodWall`ì— ë¶™ëŠ”ë‹¤. ì›€ì§ì´ëŠ” ì´ ì˜¤ë¸Œì íŠ¸ì™€ ì¶©ëŒì´ ì¼ì–´ë‚˜ì•¼ë§Œ ë°ë¯¸ì§€ë¥¼ ì…ê²Œ í•  ê²ƒì´ë‹¤.

- íŠ¸ë©ì´ í™œì„±í™”ë˜ë©´ ğŸ“œDeadTrapì—ì„œ *ActivatedTrapCoroutine*ì„ ì‹¤í–‰í•˜ì—¬ `isActivated`ê°€ Trueê°€ ëœë‹¤. ê·¸ë¦¬ê³  `finishTime` ì´ ì‹œê°„ë™ì•ˆ ëŒ€ê¸°ë¥¼ í•œ í›„ ë‹¤ì‹œ `isActivated`ì„ Falseë¡œ ë§Œë“ ë‹¤.
  - ë”°ë¼ì„œ ì´ë ‡ê²Œ íŠ¸ë©ì´ í™œì„±í™” ëœ í›„ `finishTime` ì´ ì‹œê°„ë™ì•ˆì—ë§Œ `WoodWall`ì™€ ì¶©ëŒ *OnTriggerEnter* ì´ ì¼ì–´ë‚  ë•Œ ë°ë¯¸ì§€ë¥¼ ì…ì„ ìˆ˜ ìˆê²Œ ëœë‹¤. 
  - ê·¸ë¦¬ê³  `isHurt`ë¥¼ í†µí•´ `finishTime`ì‹œê°„ ë‹¹ 1 íšŒë§Œ ì…ì„ ìˆ˜ ìˆë‹¤. 
  - ì½”ë£¨í‹´ í•¨ìˆ˜ëŠ” ë³‘ë ¬ì ìœ¼ë¡œ ì‹¤í–‰ì´ ë˜ê¸° ë–„ë¬¸ì— *ActivatedTrapCoroutine* ì‹¤í–‰ ì¤‘ì—, ì¦‰ ëŒ€ê¸° ì‹œê°„ì„ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘ì— *OnTriggerEnter* ê°€ ì‹¤í–‰ ë  ìˆ˜ ìˆë‹¤.
- í”Œë ˆì´ì–´ì˜ ë°ë¯¸ì§€ ê¹ê¸°

![image](https://user-images.githubusercontent.com/42318591/102045879-6e463280-3e1d-11eb-9d23-bed2212da5e9.png)


<br>

### âœˆ íŠ¸ë©ì˜ ì‘ë™ì´ ëë‚˜ê³ ë‚˜ë©´ ì¬ì„¤ì¹˜

#### ğŸ“œDeadTrap

```c#
    public bool GetIsActivated()
    {
        return isActivated;
    }

    public void ReInstall()
    {
        isActivated = false;
        anim.SetTrigger("Deactivate");
    }
```

ì¬ì„¤ì¹˜ í•  ìˆ˜ ìˆë„ë¡ í•¨ìˆ˜ ë§Œë“¬. "Deactivate" ì• ë‹ˆë©”ì´ì…˜ ì¬ìƒ. ë‹¨, ì¬ì„¤ì¹˜ëŠ” `isActivated`ê°€ True ì¸ ìƒíƒœì—ì„œë§Œ ì´ë£¨ì–´ì ¸ì•¼ í•œë‹¤.

<br>

#### ğŸ“œActionController

```c#
    private void TryAction()
    {
        if(Input.GetKeyDown(KeyCode.E))
        {
            CheckAction();
            CanPickUp();
            CanMeat();
            CanDropFire();
            CanComputerPowerOn();
            CanArchemyTableOpen();
            CanReInstallTrap();
        }
    }
    
    private void CheckAction()
    {
        if (Physics.Raycast(transform.position, transform.forward, out hitInfo, range, layerMask))
        {
            if (hitInfo.transform.tag == "Item")
                ItemInfoAppear();
            else if (hitInfo.transform.tag == "Weak_Animal")
                MeatInfoAppear();
            else if (hitInfo.transform.tag == "Fire")
                FireInfoAppear();
            else if (hitInfo.transform.tag == "Computer")
                ComputerInfoAppear();
            else if (hitInfo.transform.tag == "ArchemyTable")
                ArchemyInfoAppear();
            else if (hitInfo.transform.tag == "Trap")
                TrapInfoAppear();
            else
                InfoDisappear();
        }
        else
            InfoDisappear();
    }

    private void TrapInfoAppear()
    {
        if (hitInfo.transform.GetComponent<DeadTrap>().GetIsActivated())
        {
            Reset();
            lookActivatedTrap = true;
            actionText.gameObject.SetActive(true);
            actionText.text = "í•¨ì • ì¬ì„¤ì¹˜ " + "<color=yellow>" + "(E)" + "</color>";
        }
    }

    private void InfoDisappear()
    {
        pickupActivated = false;
        dissolveActivated = false;
        firedLookActivated = false;
        lookComputer = false;
        lookArchemyTable = false;
        lookActivatedTrap = false;
        actionText.gameObject.SetActive(false);
    }

    private void CanReInstallTrap()
    {
        if (lookActivatedTrap)
        {
            if (hitInfo.transform != null)
            {
                hitInfo.transform.GetComponent<DeadTrap>().ReInstall();
                InfoDisappear();
            }
        }
    }
```

íŠ¸ë© í™œì„±í™” í›„ `DeadTrap`(ë ˆì´ì–´ "Building"ì´ë©° `layerMask`ì—ëŠ” ì´ ë ˆì´ì–´ê°€ ë“±ë¡ ë˜ì–´ ìˆìŒ)ì˜ Box Collider ë¥¼ ì³ë‹¤ë³´ë©´ ì•¡ì…˜ í…ìŠ¤íŠ¸ í™œì„±í™”, ê·¸ë¦¬ê³ ë‚˜ì„œ `E` ëˆ„ë¥´ë©´ ì¬ì„¤ì¹˜ í•˜ê²Œë”.


***
<br>

    ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš° 
    ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}