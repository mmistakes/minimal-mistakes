---
title:  "Chapter 12-5. ê¸°íƒ€ : ìˆ˜ì˜í•˜ê¸° (í˜¸í¡ ì‹œìŠ¤í…œ)" 

categories:
  -  Unity Lesson 3 
tags:
  - [Game Engine, Unity]

toc: true
toc_sticky: true

date: 2020-12-14
last_modified_at: 2020-12-14
---

ì¸í”„ëŸ°ì— ìˆëŠ” ì¼€ì´ë””ë‹˜ì˜ **[ìœ ë‹ˆí‹° 3D] ì‹¤ì „! ìƒì¡´ê²Œì„ ë§Œë“¤ê¸° - Advanced** ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ í•„ê¸°ì…ë‹ˆë‹¤. ğŸ˜€  
[ğŸŒœ ê°•ì˜ ë“¤ìœ¼ëŸ¬ ê°€ê¸° Click](https://www.inflearn.com/course/unity-2#)
{: .notice--warning}

## ğŸš€ ìˆ˜ì˜ 

### ğŸ“œPlayerController

```c#
    [SerializeField] private float swimSpeed;
    [SerializeField] private float swimFastSpeed;
    [SerializeField] private float upSwimSpeed;
    private float applySpeed;
```

- `swimSpeed` : ìˆ˜ì˜ì‹œ ì†ë„
- `swimSpeed` : ìˆ˜ì˜ì‹œ `Shift` í‚¤ ëˆŒë €ì„ ë•Œ ì†ë„
- `swimFastSpeed` : ìˆ˜ì˜ì‹œ `Space` í‚¤ë¡œ ìœ„ë¡œ ë– ì˜¤ë¥¼ ë•Œ ì†ë„

```c#
    void Update()  
    {
        if (isActivated && GameManager.canPlayerMove)
        {
            WaterCheck();
            IsGround();
            TryJump();
            if (!GameManager.isWater) // ë‹¬ë¦¬ê¸°ëŠ” ìˆ˜ì˜ ì¤‘ì´ ì•„ë‹ ë•Œë§Œ
                TryRun();
            TryCrouch();
            Move();
            MoveCheck();
            CameraRotation();
            CharacterRotation();
        }
    }

    private void WaterCheck()
    {
        if(GameManager.isWater) // ë¬¼ ì† ì¼ ë•Œ
        {
            if (Input.GetKeyDown(KeyCode.LeftShift)) // Shift í‚¤ ëˆ„ë¥´ë©´ swimFastSpeed ì†ë„ë¡œ.
                applySpeed = swimFastSpeed;
            else // ì•„ë‹ˆë¼ë©´ swimSpeed ì†ë„ë¡œ.
                applySpeed = swimSpeed;
        }
    }

    private void TryJump()
    {
        if (Input.GetKeyDown(KeyCode.Space) && isGround && !GameManager.isWater && theStatusController.GetCurrentSP() > 0) 
            Jump();
        else if (Input.GetKey(KeyCode.Space) && GameManager.isWater)
            UpSwim(); // ìŠ¤í˜ì´ìŠ¤ í‚¤ë¥¼ ê¾¹ ëˆ„ë¥´ëŠ” ì¤‘ì´ê³  ë¬¼ ì†ì´ë¼ë©´ 
    }

    private void UpSwim()
    {
        myRigid.velocity = transform.up * upSwimSpeed;
    }
```

![image](https://user-images.githubusercontent.com/42318591/102083618-322fc380-3e57-11eb-803a-5e82c22824da.png)


<br>

### ğŸ“œWeaponManager

```c#
    public IEnumerator WeaponInCoroutine() // ë¬´ê¸° ì§‘ì–´ë„£ê¸°
    {
        isChangeWeapon = true;
        currentWeaponAnim.SetTrigger("Weapon_Out");

        yield return new WaitForSeconds(changeweaponDelayTime);

        currentWeapon.gameObject.SetActive(false);
    }

    public void WeaponOut() // ë¬´ê¸° êº¼ë‚´ê¸°
    {
        isChangeWeapon = false;
        currentWeapon.gameObject.SetActive(true);
    }
```

ë¬¼ ì†ì¼ ë• ë¬´ê¸° ì§‘ì–´ë„£ê¸° ìœ„í•´ ë§Œë“  í•¨ìˆ˜. ë¬¼ ë°–ìœ¼ë¡œ ë‚˜ì˜¬ ë• ìë™ìœ¼ë¡œ í˜„ì¬ ë¬´ê¸° ë‹¤ì‹œ êº¼ëƒ„.

<br>

### ğŸ“œGameManager

```c#
    private WeaponManager theWeaponManager;
    private bool flag = false;

    void Start()
    {
        Cursor.lockState = CursorLockMode.Locked;
        Cursor.visible = false;

        theWeaponManager = FindObjectOfType<WeaponManager>();
    }

    void Update()
    {
        if (isOpenInventory || isOpenCraftManual || isOnComputer || isOpenArchemyTable)
        {
            Cursor.lockState = CursorLockMode.None;
            Cursor.visible = true;

            canPlayerMove = false;
        }
        else
        {
            Cursor.lockState = CursorLockMode.Locked;
            Cursor.visible = false;

            canPlayerMove = true;
        }

        if (isWater)
        {
            if (!flag)
            {
                StopAllCoroutines();
                StartCoroutine(theWeaponManager.WeaponInCoroutine());
                flag = true; // 1ë²ˆë§Œ ì‹¤í–‰ë˜ê²Œ flag ì‚¬ìš©
            }
        }
        else
        {
            if (flag)
            {
                theWeaponManager.WeaponOut();
                flag = false;
            }
        }
    }
```

ê²Œì„ ë§¤ë‹ˆì €ì—ì„œ ë¬¼ ì†ì¼ ê²½ìš° ë¬´ê¸°ë¥¼ ì§‘ì–´ë„£ê²Œ(í•œë²ˆë§Œ), ë¬¼ ë°–ì¼ ê²½ìš° ë¬´ê¸°ë¥¼ êº¼ë‚´ê²Œ í•˜ê¸°.


<br>

### ğŸ“œCrossHair

`if (!GameManager.isWater)`ì¼ ë•Œë§Œ ì—¬ëŸ¬ ì• ë‹ˆë©”ì´ì…˜ë“¤ ì¬ìƒ


<br>

## ğŸš€ í˜¸í¡ ê²Œì´ì§€

### âœˆ í˜¸í¡ ê²Œì´ì§€ UI

![image](https://user-images.githubusercontent.com/42318591/102084046-e16c9a80-3e57-11eb-91b9-ae11796869e8.png)

![image](https://user-images.githubusercontent.com/42318591/102084018-d44fab80-3e57-11eb-9019-134ef1133ac6.png)

![image](https://user-images.githubusercontent.com/42318591/102084080-efbab680-3e57-11eb-90de-a448ecd2d872.png)


`Base_UI`ëŠ” í…Œë‘ë¦¬ê°€ ë˜ëŠ” ë°°ê²½ ì´ë¯¸ì§€ì´ë‹¤. `Gauge`ëŠ” ê°€ìš´ë° ì§„í•œ ì´ˆë¡ìƒ‰ ì´ë¯¸ì§€ì¸ë° ì´ë¯¸ì§€ íƒ€ì…ì„ `Filled`ë¡œ í•˜ì—¬ ìˆ˜í‰ìœ¼ë¡œ ê²Œì´ì§€ ê°’ì— ë”°ë¼ ì±„ì›Œì§€ê²Œë” í•  ê²ƒì´ë‹¤. ìŠ¬ë¼ì´ë”ì²˜ëŸ¼! í‰ì†Œì—” ë¹„í™œì„±í™” í•´ë‘”ë‹¤. ìˆ˜ì˜í•  ë•Œë§Œ í™œì„±í™” í•  ê²ƒì´ê¸° ë–„ë¬¸ì´ë‹¤.


### ğŸ“œWater

```c#
    [SerializeField] private float totalOxygen; // 100
    private float currentOxygen;
    private float temp;

    [SerializeField] private GameObject go_BaseUI;
    [SerializeField] private Text text_TotalOxygen;
    [SerializeField] private Text text_currentOxygen;
    [SerializeField] private Image image_gauge;
```
```c#
    void Start()
    {
        originColor = RenderSettings.fogColor;
        originFogDensity = RenderSettings.fogDensity;

        originDrag = thePlayer.GetComponent<Rigidbody>().drag;

        currentOxygen = totalOxygen; // ì²˜ìŒì—” 100ì—ì„œ ì¶œë°œ. ì—¬ê¸°ì„œ ì ì  ê°ì†Œë  ê²ƒ.
        text_TotalOxygen.text = totalOxygen.ToString();
    }

    void Update()
    {
        if (GameManager.isWater)
        {
            currentBreatheTime += Time.deltaTime;
            if (currentBreatheTime >= breatheTime)
            {
                SoundManager.instance.PlaySE(sound_WaterBreathe);
                currentBreatheTime = 0;
            }
        }

        DecreaseOxygen(); 
    }

    private void DecreaseOxygen()
    {
        if(GameManager.isWater) // ë¬¼ ì†ì¼ë• currentOxygen 1ì´ˆì— 1ì”© ê°ì†Œ
        {
            currentOxygen -= Time.deltaTime;
            text_currentOxygen.text = Mathf.RoundToInt(currentOxygen).ToString(); // ì •ìˆ˜ë¡œ í…ìŠ¤íŠ¸UIì— ì €ì¥
            image_gauge.fillAmount = currentOxygen / totalOxygen; // %

            if (currentOxygen <= 0) // í˜¸í¡ ê²Œì´ì§€ê°€ 0 ì´í•˜ë©´ 1ì´ˆì— í•œë²ˆì”© HPë¥¼ 1ì”© ë‹¬ê²Œí•œë‹¤.
            {
                temp += Time.deltaTime;
                if (temp >= 1)
                {
                    thePlayer.GetComponent<StatusController>().DecreaseHP(1); // 1ì´ˆì— 1ì”© ë‹¬ê²Œ
                    temp = 0;
                }
            }
        }
    }

    private void GetInWater(Collider _player)
    {
        SoundManager.instance.PlaySE(sound_WaterIn);

        go_BaseUI.SetActive(true); // í˜¸í¡ ê²Œì´ì§€ UI í™œì„±í™”

        // ...

    private void GetOutWater(Collider _player)
    {
        SoundManager.instance.PlaySE(sound_WaterOut);

        if (GameManager.isWater)
        {
            go_BaseUI.SetActive(false); // í˜¸í¡ ê²Œì´ì§€ UI ë¹„í™œì„±í™”
            // ...
```

![image](https://user-images.githubusercontent.com/42318591/102084109-006b2c80-3e58-11eb-95f6-61f8daee3725.png)


![image](https://user-images.githubusercontent.com/42318591/102084211-2b558080-3e58-11eb-9157-ab0c9b40709d.png)

ë¬¼ ì†ì— ìˆì„ ë• í˜¸í¡ ê²Œì´ì§€ê°€ ì ì  ì¤„ì–´ë“ ë‹¤. 0 ì´í•˜ë¡œ ë–¨ì–´ì§€ë©´ ì²´ë ¥ë„ 1ì´ˆì— 1ì”© ë‹¬ê²Œ ëœë‹¤.

***
<br>

    ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš° 
    ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}