---
title:  "Chapter 13-10. ë¯¸ë‹ˆ RPG : ë ˆë²¨ì—…" 

categories:
  -  Unity Lesson 2
tags:
  - [Game Engine, Unity]

toc: true
toc_sticky: true

date: 2021-01-15
last_modified_at: 2021-01-15
---

ì¸í”„ëŸ°ì— ìˆëŠ” Rookissë‹˜ì˜ **[C#ê³¼ ìœ ë‹ˆí‹°ë¡œ ë§Œë“œëŠ” MMORPG ê²Œì„ ê°œë°œ ì‹œë¦¬ì¦ˆ] Part3: ìœ ë‹ˆí‹° ì—”ì§„** ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ í•„ê¸°ì…ë‹ˆë‹¤. ğŸ˜€  
[ğŸŒœ ê°•ì˜ ë“¤ìœ¼ëŸ¬ ê°€ê¸° Click](https://www.inflearn.com/course/MMORPG-ìœ ë‹ˆí‹°)
{: .notice--warning}


# Chapter 13. ë¯¸ë‹ˆ RPG ë§Œë“¤ê¸°

## ğŸš€ ë ˆë²¨ì—…

### âœˆ ìŠ¤íƒ¯ ë°ì´í„°

#### ğŸ“„StatData.json

```json
{
  "stats": [
    {
      "level": "1",
      "maxHp": "200",
      "attack": "20",
      "totalExp": "0"
    },
    {
      "level": "2",
      "maxHp": "250",
      "attack": "25",
      "totalExp": "10"
    },
    {
      "level": "3",
      "maxHp": "300",
      "attack": "30",
      "totalExp": "20"
    }
  ]
} 
```

ê° ë ˆë²¨ì—ì„œì˜ ê¸°ë³¸ ìŠ¤íƒ¯

<br>

#### ğŸ“œStat

```c#
	[Serializable]
	public class Stat
	{
		public int level;
		public int maxHp;
		public int attack;
		public int totalExp;
	}
```

`json`íŒŒì¼ì˜ ë‚´ìš©ê³¼ ë©¤ë²„ë³€ìˆ˜ ì´ë¦„ ì¼ì¹˜ì‹œì¼œì£¼ê¸°

<br>

### âœˆ ë ˆë²¨ì—… ì²˜ë¦¬

#### ğŸ“œPlayerStat

```c#
public class PlayerStat : Stat
{
    [SerializeField]
	  protected int _exp;
    [SerializeField]
	  protected int _gold;

	  public int Exp { 
		  get { return _exp; } 
		  set 
      { 
			      _exp = value;
			      // ë ˆë²¨ì—… ì²´í¬
			      int level = Level;
			      while (true)
            {
				        Data.Stat stat;
				        if (Managers.Data.StatDict.TryGetValue(level + 1, out stat) == false) // ë§Œë ™ì´ë©´ 
					          break;
				        if (_exp < stat.totalExp) // _expê°€ í˜„ì¬ ë ˆë²¨ì—ì„œì˜ totalExp ë³´ë‹¤ ì ìœ¼ë©´ ì´ì œ ë ˆë²¨ ì¦ê°€ í•„ìš” ì—†ìœ¼ë¯€ë¡œ ê·¸ë§Œ!
					          break;
				        level++;
            }

			      if (level != Level)
            {
				        Debug.Log("Level Up!");
				        Level = level;
				        SetStat(Level);
            }
		  } 
	  }
	
  public int Gold { get { return _gold; } set { _gold = value; } }
```

í”Œë ˆì´ì–´ì˜ ê²½í—˜ì¹˜ë¥¼ ì„¸íŒ…í•´ì¤„ ë•Œ ê³ ë ¤í•´ì•¼í•˜ëŠ” ì ì€, ê²½í—˜ì¹˜ë¡œ ì¸í•œ ë ˆë²¨ ìƒìŠ¹ì´ë‹¤. ê²½í—˜ì¹˜ê°€ ì—„~ì²­ ë§ìœ¼ë©´ `level`ì´ 1 ë§Œ ì¦ê°€í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ë” ë›°ì–´ ë„˜ì„ ìˆ˜ë„ ìˆë‹¤. ì´ ë ˆë²¨ ì—… ê³¼ì •ì„ *while* ë¬¸ ë‚´ì—ì„œ í•´ì£¼ëŠ” ê²ƒì´ë‹¤. 

<u>ìœ„ ê³¼ì •ì„ ê²½í—˜ì¹˜ ì„¸íŒ…ì‹œë§ˆë‹¤ í•´ì¤˜ì•¼í•˜ë‹ˆê¹Œ ì•„ì‹¸ë¦¬ ê²½í—˜ì¹˜ í”„ë¡œí¼í‹°ì˜ set ì—ì„œ í•´ì£¼ëŠ” ê²ƒì´ë‹¤.</u>


```c#
	private void Start()
	{
		_level = 1;
		_exp = 0;
		_defense = 5;
		_moveSpeed = 5.0f;
		_gold = 0;

		SetStat(_level);
	}

	public void SetStat(int level)
    {
		Dictionary<int, Data.Stat> dict = Managers.Data.StatDict;
		Data.Stat stat = dict[level]; // levelì„ Keyë¡œ ì‚¬ìš©í•˜ê¸°ë¡œ ì•½ì†í–ˆì—ˆë‹¤. ë ˆë²¨ë§ˆë‹¤ ìŠ¤íƒ¯ì´ ë‹¬ë¼ì§€ë‹ˆê¹Œ!

		_hp = stat.maxHp;
		_maxHp = stat.maxHp;
		_attack = stat.attack;
	}

	protected override void OnDead(Stat attacker)
	{
		Debug.Log("Player Dead");
	}
```

<br>


#### ğŸ“œStat

```c#
    public virtual void OnAttacked(Stat _attacker)
    {
        int damage = Mathf.Max(0, _attacker.Attack - Defense);
        Hp -= damage;
        if (Hp <= 0)
        {
            Hp = 0;
            OnDead(_attacker);
        }
    }

    protected virtual void OnDead(Stat attacker)
    {
        PlayerStat playerStat = attacker as PlayerStat;
        if (playerStat != null)
        {
            playerStat.Exp += 100;
        }
        Managers.Game.Despawn(gameObject);
    }
```

ëª¬ìŠ¤í„°ê°€ í”Œë ˆì´ì–´í•œí…Œ ì£½ìœ¼ë©´ í”Œë ˆì´ì–´ì˜ ê²½í—˜ì¹˜ë¥¼ 100ë§Œí¼ ì˜¬ë ¤ì¤€ë‹¤! 


***
<br>

    ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš° 
    ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}