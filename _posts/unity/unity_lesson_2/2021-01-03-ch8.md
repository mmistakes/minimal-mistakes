---
title:  "Chapter 8. Scene Manager" 

categories:
  -  Unity Lesson 2
tags:
  - [Game Engine, Unity]

toc: true
toc_sticky: true

date: 2021-01-03
last_modified_at: 2021-01-03
---

ì¸í”„ëŸ°ì— ìˆëŠ” Rookissë‹˜ì˜ **[C#ê³¼ ìœ ë‹ˆí‹°ë¡œ ë§Œë“œëŠ” MMORPG ê²Œì„ ê°œë°œ ì‹œë¦¬ì¦ˆ] Part3: ìœ ë‹ˆí‹° ì—”ì§„** ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ í•„ê¸°ì…ë‹ˆë‹¤. ğŸ˜€  
[ğŸŒœ ê°•ì˜ ë“¤ìœ¼ëŸ¬ ê°€ê¸° Click](https://www.inflearn.com/course/MMORPG-ìœ ë‹ˆí‹°)
{: .notice--warning}

# Chapter 8. Scene Manager

## ğŸš€ êµ¬ì¡°ë„

ì—¬íƒœê¹Œì§€ëŠ” ğŸ“œPlayerControllerì— `Manager`ë¡œë¶€í„° GameManager ìŠ¤ëŸ¬ìš´ ì¼ë“¤ì„ ì‹¤í–‰ì‹œì¼°ëŠ”ë°, í”Œë ˆì´ì–´ë„ ì”¬ì— ë™ì ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ì¡´ì¬ë¼ë©´ ğŸ“œPlayerControllerì— `Manager`ë¥¼ í˜¸ì¶œí•˜ëŠ” ê²ƒì€ ë°”ëŒì§í•˜ì§€ ì•Šì„ ê²ƒì´ë‹¤. ê²Œì„ ì‹¤í–‰ ä¸­ ë‚´ë‚´ ì‚´ì•„ìˆëŠ” ì„ ë´‰ëŒ€ ì—­í• ì„ í•  ì¡´ì¬ë¥¼ ë§Œë“¤ê³  ê·¸ì—ê²Œ  `Manager`ë¥¼ í˜¸ì¶œí•˜ëŠ” ì¼ì„ ë§¡ê²¨ì•¼ í•œë‹¤. <u>ì´ ì„ ë´‰ëŒ€ ì—­í• ì„ ğŸ“œScene ì—ì„œ í•  ê²ƒ</u>

- ì”¬ë“¤. ê°ê° ì”¬ë“¤ë§Œì˜ í•¨ìˆ˜
  - ğŸ“œBaseScene
    - ğŸ“œGameScene
    - ğŸ“œLoginScene
- ì—¬ëŸ¬ ì”¬ë“¤ í•œêº¼ë²ˆì— ê´€ë¦¬ ğŸ‘‰ ğŸ“œSceneManager

ë¹ˆ ì˜¤ë¸Œì íŠ¸ `@Scene` ë§Œë“¤ì–´ì„œ ê·¸ ê³³ì— Scene ì¢…ë¥˜ê°€ ë˜ëŠ” ìŠ¤í¬ë¦½íŠ¸(ğŸ“œGameScene í˜¹ì€ ğŸ“œLoginScene) ë¶™ì„. ì´ `@Scene`ëŠ” ë™ì ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ì¡´ì¬ê°€ ì•„ë‹ˆê²Œ í•  ê²ƒ.

![image](https://user-images.githubusercontent.com/42318591/103475480-c9ea5700-4df0-11eb-8d1c-739044ec560d.png)


ê·¸ë¦¬ê³  <u>ì”¬ ì „í™˜ì„ í•˜ë ¤ë©´ ì”¬ë“¤ì´ ë°˜ë“œì‹œ Build Setting ì— ë“±ë¡ì´ ë˜ì–´ ìˆì–´ì•¼ í•œë‹¤.</u>

![image](https://user-images.githubusercontent.com/42318591/103476658-1fc3fc80-4dfb-11eb-9958-6addc4a64a4c.png)

ë¡œê·¸ì¸ì”¬ì—ì„œ ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ í›„ ì´ë¥¼ ì„œë²„ì— ë³´ë‚´ì„œ ì„œë²„ë¡œë¶€í„° OK ì‚¬ì¸ì„ ë°›ìœ¼ë©´ ì´ì œ ì¸ê²Œì„ ì”¬ìœ¼ë¡œ ë„˜ì–´ê°€ëŠ” ì´ëŸ°ì‹ìœ¼ë¡œ êµ¬í˜„í•˜ë©´ ëœë‹¤.

<br>

### ğŸ“œDefine

```c#
    public enum Scene
    {
        Unknown, // ë””í´íŠ¸
        Login, // ë¡œê·¸ì¸ í™”ë©´ ì”¬
        Lobby, // ë¡œë¹„ ì”¬
        Game, // ì¸ê²Œì„ ì”¬
    }
```

<br>


### ğŸ“œBaseScene

> ì—¬ëŸ¬ê°€ì§€ ì¢…ë¥˜ì˜ ì”¬ë“¤ì´ ìƒì†ë°›ì„ ìŠ¤í¬ë¦½íŠ¸. ì¦‰, ì”¬ë“¤ì´ ê³µí†µì ìœ¼ë¡œ ê°–ê³  ìˆì„ ë¶€ë¶„ ëª¨ìŒ

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.EventSystems;

public abstract class BaseScene : MonoBehaviour
{
    public Define.Scene SceneType { get; protected set; } = Define.Scene.Unknown; // ë””í´íŠ¸ë¡œ Unknow ì´ë¼ê³  ì´ˆê¸°í™”

	void Awake()
	{
		Init();
	}

	protected virtual void Init()
    {
        Object obj = GameObject.FindObjectOfType(typeof(EventSystem));
        if (obj == null)
            Managers.Resource.Instantiate("UI/EventSystem").name = "@EventSystem";
    }

    public abstract void Clear();
}

```

- `SceneType` 
  - ì´ ì”¬ì€ ì–´ë–¤ íƒ€ì…ì˜ ì”¬ì¸ì§€ë¥¼ ì•Œë ¤ì¤„ ì •ë³´ (from ğŸ“œDefineì˜ `Scene` enum)
  - ìì‹ ì”¬ë“¤ì—ê²Œ ìƒì†
  - **get ì€ ScreenType í”„ë¡œí¼í‹°ì˜ ì ‘ê·¼ì§€ì •ì ë”°ë¼ public í•˜ê²Œ, set ì€ protected í•œ í”„ë¡œí¼í‹°ë¡œ ì„¤ì •**
- *Init*  
  - ê°€ìƒ í•¨ìˆ˜ë¡œ ìì‹ ì”¬ë“¤ì—ì„œ `base.Init()`ìœ¼ë¡œ ë¶€ë¶„ì ìœ¼ë¡œ ê³µí†µì ìœ¼ë¡œ ì‹¤í–‰ì‹œì¼œì•¼ í•˜ëŠ” ë¶€ë¶„ë“¤ì„ ì •ì˜  
    - UIëŠ” ë°˜ë“œì‹œ `EventSystem`ì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— ê¼­! ë§Œë“¤ì–´ì£¼ì–´ì•¼ í•œë‹¤. `EventSystem`ì„ ë§Œë“¤ì–´ì£¼ëŠ” ì‘ì—….
    - `EventSystem`ë„ ê·¸ëƒ¥ í”„ë¦¬íŒ¹ìœ¼ë¡œ ë§Œë“¤ì–´ë²„ë¦¬ê³  ì´ë¥¼ ìƒì„±ì‹œí‚¤ê¸°

      ![image](https://user-images.githubusercontent.com/42318591/103475562-7c221e80-4df1-11eb-8520-7400596889ed.png)

- *Clear*
  - ì¶”ìƒ í•¨ìˆ˜ë¡œ Clear ë‚´ìš©ì€ ì „ì ìœ¼ë¡œ ìì‹ ì”¬ë“¤ì—ê²Œ ë§¡ê¹€
  - ìì‹ë“¤ë§ˆë‹¤ ë‹¤ ê°ìì˜ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ì˜¤ë²„ë¼ì´ë”©


> Start ëŒ€ì‹  <u>Awake ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ </u>

AwkaeëŠ” Startë³´ë‹¤ ë¨¼ì € ì‹¤í–‰ë˜ë©°, ìŠ¤í¬ë¦½íŠ¸ê°€ êº¼ì ¸ìˆì–´ë„ ì‹¤í–‰ëœë‹¤. ì˜¤ë¸Œì íŠ¸ë§Œ í™œì„±í™”ë˜ì–´ ìˆë‹¤ë©´! 

ì´ Awake ëŠ” ìì‹ë“¤ì—ê²Œ ìƒì†ëœë‹¤. 

<br>

### ğŸ“œ GameScene

> "GameScene" ì”¬ì˜ `@Scene` ì˜¤ë¸Œì íŠ¸ì— ë¶™ëŠ”ë‹¤.

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class GameScene : BaseScene
{
	protected override void Init() // ìƒì† ë°›ì€ Awake() ì•ˆì—ì„œ ì‹¤í–‰ë¨. "GameScene"ì”¬ ì´ˆê¸°í™”
    {
        base.Init(); // ğŸ“œBaseSceneì˜ Init()

        SceneType = Define.Scene.Game; // ğŸ“œGameSceneì˜ ì”¬ ì¢…ë¥˜ëŠ” GameScene

        Managers.UI.ShowSceneUI<UI_Inven>(); // ì¸ë²¤í† ë¦¬ UI ìƒì„±

		for (int i = 0; i < 5; i++) // ğŸ“œGameSceneì˜ ì”¬ ì´ˆê¸°í™”ì‹œ UnityChan í”„ë¦¬íŒ¹ì„ 5ê°œ ìƒì„±í•œë‹¤! 
			Managers.Resource.Instantiate("UnityChan");
	}

    public override void Clear()
    {
        
    }
}

```

<br>

### ğŸ“œ LoginScene

> "LoginScene" ì”¬ì˜ `@Scene` ì˜¤ë¸Œì íŠ¸ì— ë¶™ëŠ”ë‹¤.

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.SceneManagement;

public class LoginScene : BaseScene
{
    protected override void Init()  // ìƒì† ë°›ì€ Awake() ì•ˆì—ì„œ ì‹¤í–‰ë¨. "LoginScene"ì”¬ ì´ˆê¸°í™”
    {
        base.Init();

        SceneType = Define.Scene.Login; // ğŸ“œLoginSceneì˜ ì”¬ ì¢…ë¥˜ëŠ” LoginScene

        List<GameObject> list = new List<GameObject>();

        for (int i = 0; i < 5; i++)
            list.Add(Managers.Resource.Instantiate("UnityChan"));

        foreach (GameObject obj in list)
        {
            Managers.Resource.Destroy(obj);
        }
    }

    private void Update() 
    {
        if (Input.GetKeyDown(KeyCode.Q))
        {
            Managers.Scene.LoadScene(Define.Scene.Game);
        }
    }

    public override void Clear()
    {
        Debug.Log("LoginScene Clear!");
    }
}

```

- *Update*
  - `Q`ì…ë ¥ì´ ë“¤ì–´ì˜¤ë©´ ğŸ“œSceneManagerEx(ë°‘ì— ì°¸ê³ )ì˜ *LoadScene* í•¨ìˆ˜ë¡œ "GameScene" ì”¬ì„ ë¡œë“œí•˜ë„ë¡ í•œë‹¤.


<br>

## ğŸš€ SceneManager

### ğŸ“œSceneManagerEx

ì´ë¯¸ SceneManager ê°€ ìœ ë‹ˆí‹°ì—”ì§„ì— ìˆê¸° ë•Œë¬¸ì— Ex ë¶™ì—¬ì„œ êµ¬ë¶„í•´ì¤Œ..

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.SceneManagement;

public class SceneManagerEx
{
    public BaseScene CurrentScene { get { return GameObject.FindObjectOfType<BaseScene>(); } }

    string GetSceneName(Define.Scene type)
    {
        string name = System.Enum.GetName(typeof(Define.Scene), type); // C#ì˜ Reflection. Scene enumì˜ 
        return name;
    }

	public void LoadScene(Define.Scene type)
    {
        Managers.Clear();

        SceneManager.LoadScene(GetSceneName(type)); // SceneManagerëŠ” UnityEngineì˜ SceneManager
    }

    public void Clear()
    {
        CurrentScene.Clear();
    }
}

```

`CurrentScene`ëŠ” ê·¸ì € *GameObject.FindObjectOfType\<BaseScene>();* ë¦¬í„´ ê°’ì„ ë°›ìœ¼ë©´ ë•¡! ğŸ“œGameScene í˜¹ì€ ğŸ“œLoginSceneì´ í• ë‹¹ ë  ê²ƒì´ë‹¤. ë‘˜ ë‹¤ ğŸ“œBaseSceneì˜ ìì‹ë“¤ì´ê¸° ë•Œë¬¸ì—.

<br>

### ğŸ“œManager

```c#
SceneManagerEx _scene = new SceneManagerEx();
public static SceneManagerEx Scene { get { return Instance._scene; } }
```

***
<br>

    ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš° 
    ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}