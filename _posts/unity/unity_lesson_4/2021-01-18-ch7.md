---
title:  "Ch 7. ìŠ¤í…Œì´ì§€ êµ¬í˜„(+ Snap Settings)" 

categories:
  -  Unity Lesson 4
tags:
  - [Game Engine, Unity]

toc: true
toc_sticky: true

date: 2021-01-18
last_modified_at: 2020-01-18
---

ì¼€ì´ë””ë‹˜ì˜ **[ìœ ë‹ˆí‹° ê°•ì¢Œ] ë¦¬ë“¬ ê²Œì„** ìœ íŠœë¸Œ ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ í•„ê¸°ì…ë‹ˆë‹¤. ğŸ˜€  
[ğŸŒœ ê°•ì˜ ë“¤ìœ¼ëŸ¬ ê°€ê¸° Click](https://www.youtube.com/watch?v=eLdiOCWPfPc&list=PLUZ5gNInsv_MCnum4bOQRI72LdGkIY3tY&index=2&t=231s)
{: .notice--warning}

## ğŸš€ ìŠ¤í…Œì´ì§€ êµ¬í˜„

ë‚©ì‘í•œ íë¸Œ ë§Œë“¤ì–´ì„œ í…ìŠ¤ì²˜ ì…íˆê¸°

### âœˆ ë¨¸í…Œë¦¬ì–¼ì— í…ìŠ¤ì²˜ ì…íˆê¸°

![image](https://user-images.githubusercontent.com/42318591/104877599-891c4180-599d-11eb-93e1-ccfbaabac9bf.png)

![image](https://user-images.githubusercontent.com/42318591/104877658-a51fe300-599d-11eb-9203-aaf1ab9a926c.png)


ë¨¸í…Œë¦¬ì–¼ì— í…ìŠ¤ì²˜ë¥¼ ì…íˆë ¤ë©´ ë¨¸í…Œë¦¬ì–¼ì˜ `Albedo` ì™¼ìª½ì— ìˆëŠ” ì¡°ê·¸ë§ˆí•œ ë„¤ëª¨ì— í…ìŠ¤ì²˜ íŒŒì¼ì„ ë“œë˜ê·¸ ì•¤ ë“œë¡­ í•˜ë©´ ëœë‹¤. ì´ ë¨¸í…Œë¦¬ì–¼ì„ íë¸Œì— ì…í˜€ í”Œë ˆì´íŠ¸ í”„ë¦¬íŒ¹ì„ ë§Œë“ ë‹¤.

<br>

### âœˆ Gird and Snap Settings

![image](https://user-images.githubusercontent.com/42318591/104877752-e0221680-599d-11eb-909e-06bd16ecb22f.png)

ì˜¤ë¸Œì íŠ¸ë¥¼ ì •ë°€í•˜ê²Œ ë§ê³  ì–´ë–¤ ë‹¨ìœ„ë¡œ ë”±ë”± ì´ë™ì‹œí‚¤ë ¤ë©´ `Ctrl`ì„ ëˆ„ë¥¸ ìƒíƒœì—ì„œ ì˜¤ë¸Œì íŠ¸ë¥¼ ì´ë™ì‹œí‚¤ë©´ ëœë‹¤. (ì´ê±¸ Snap ì´ë¼ê³  í•˜ëŠ” ê²ƒ ê°™ë‹¤.) ìœ„ í”Œë ˆì´íŠ¸ì˜ ê¸¸ì´ëŠ” 1 ì´ê¸° ë•Œë¬¸ì— í”Œë ˆì´íŠ¸ ì˜¤ë¸Œì íŠ¸ë“¤ì„ ì˜®ê²¨ì„œ ë°°ì¹˜í•˜ë ¤ê³  í•  ë–„ `Ctrl`ì„ ëˆ„ë¥¸ ìƒíƒœì—ì„œ 1 ì”© ì´ë™ë˜ê²Œë” í•˜ê³  ì‹¶ë‹¤ë©´ 

![image](https://user-images.githubusercontent.com/42318591/104877871-28d9cf80-599e-11eb-8123-04c457dde7be.png)

Edit - Grid and Snap Settings ì—ì„œ Move ë¶€ë¶„ì„ 1 ë¡œ ì„¤ì •í•´ì£¼ë©´ ëœë‹¤. ì´ì œ ìŠ¤ëƒ…ìœ¼ë¡œ ì˜¤ë¸Œì íŠ¸ë¥¼ ì´ë™ì‹œí‚¬ ë•Œ 1 ë‹¨ìœ„ë¡œ ì›€ì§ì´ê²Œ í•˜ê¸° ë–„ë¬¸ì— ë°°ì¹˜í•˜ê¸°ê°€ í¸í•´ì§„ë‹¤.

<br>

![image](https://user-images.githubusercontent.com/42318591/104877954-56267d80-599e-11eb-96c3-088dee700817.png)

- `Stage` ğŸ‘‰ ğŸ“œStageManager
  - `Stage1`, `Stage2`... ğŸ‘‰ ğŸ“œStage (Stage ë“¤)
    - ê° ìŠ¤í…Œì´ì§€ì— ì†í•œ `Plate`ë“¤ ğŸ‘‰ğŸ“œBasicPlate, íƒœê·¸ë„ "BasicPlate"

<br>

## ğŸš€ ìŠ¤í…Œì´ì§€ ìŠ¤í¬ë¦½íŠ¸

<br>

### ğŸ“œBasicPlate

```c#
public class BasicPlate : MonoBehaviour
{
    public bool flag = true;
}
```

ì´ë¯¸ ë°Ÿì•˜ë˜ í”Œë ˆì´íŠ¸ë¼ë©´ `false`ë¡œ ë°”ê¿€ ê²ƒ.

![image](https://user-images.githubusercontent.com/42318591/104878642-abaf5a00-599f-11eb-9520-b6c4619bdb08.png)


ì²« ë²ˆì§¸ í”Œë ˆì´íŠ¸ëŠ” ì‹œì‘ í”Œë ˆì´íŠ¸ë‹ˆê¹Œ `false`ë¡œ.

<br>


### ğŸ“œStage

```c#
public class Stage : MonoBehaviour
{
    public Transform[] plates;
}
```

í•œ ìŠ¤í…Œì´ì§€ë§ˆë‹¤ ì €ì¥í•´ë‘˜ "ê²Œì„ ì¤‘ ë°Ÿìœ¼ë©´ í™œì„±í™” ìƒíƒœë¡œ ë°”ê¿€" í”Œë ˆì´íŠ¸ë“¤ `plated`

![image](https://user-images.githubusercontent.com/42318591/104878597-99352080-599f-11eb-91a9-3b0ea8626561.png)


<br>


### ğŸ“œ StageManager

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class StageManager : MonoBehaviour
{
    [SerializeField] GameObject stage = null;
    Transform[] stagePlates;

    [SerializeField] float offsetY = -3;    // í”Œë ˆì´íŠ¸ í™œì„±í™”ì‹œ ë°‘ì—ì„œ ì˜¬ë¼ì˜¤ê²Œ í• ê±°ë¼..
    [SerializeField] float plateSpeed = 10; // í”Œë ˆì´íŠ¸ í™œì„±í™”ì‹œ ì˜¬ë¼ì˜¤ëŠ” ì†ë„

    int stepCount = 0;
    int totalPlateCount = 0; // stepCountê°€ stagePlates.Lengthë¥¼ ë„˜ìœ¼ë©´ ì•ˆëœë‹¤.(ë°°ì—´ ì¸ë±ìŠ¤ ë²”ìœ„ ì´ˆê³¼ ì—ëŸ¬ ë§‰ê¸° ìœ„í•´)

    void Start()
    {
        stagePlates = stage.GetComponent<Stage>().plates;
        totalPlateCount = stagePlates.Length;

        // í”Œë ˆì´íŠ¸ë“¤ ë°‘ì—ì„œ ì˜¬ë¼ì˜¤ë©´ì„œ í™œì„±í™” ë˜ë„ë¡ offset ë§Œí¼ ë°‘ì— ìœ„ì¹˜í•˜ë„ë¡ ì„¸íŒ… (í˜„ì¬ ë¹„í™œì„±í™” ìƒíƒœ)
        for (int i = 0; i < totalPlateCount; i++)
        {
            stagePlates[i].position = new Vector3(stagePlates[i].position.x, 
                                                  stagePlates[i].position.y + offsetY, 
                                                  stagePlates[i].position.z);
        }
    }

    public void ShowNextPlate()
    {
        if (stepCount < totalPlateCount)
            StartCoroutine(MovePlateCo(stepCount++));
    }

    // í”Œë ˆì´íŠ¸ë¥¼ í™œì„±í™” í•˜ê³  ì½”ë£¨í‹´ìœ¼ë¡œ ì²œì²œíˆ ë¶€ë“œëŸ½ê²Œ ìœ„ë¡œ ì˜¬ë¼ ì˜¤ê²Œ í•¨
    IEnumerator MovePlateCo(int p_num)
    {
        stagePlates[p_num].gameObject.SetActive(true);
        Vector3 t_destPos = new Vector3(stagePlates[p_num].position.x,
                                        stagePlates[p_num].position.y - offsetY,
                                        stagePlates[p_num].position.z);
        while(Vector3.SqrMagnitude(stagePlates[p_num].position - t_destPos) >= 0.001f)
        {
            stagePlates[p_num].position = Vector3.Lerp(stagePlates[p_num].position, t_destPos, plateSpeed * Time.deltaTime);
            yield return null;
        }
        stagePlates[p_num].position = t_destPos;
    }
}

```

![image](https://user-images.githubusercontent.com/42318591/104878681-b833b280-599f-11eb-96a9-4b0901e786f0.png)


<br>

### ğŸ“œ PlayerController

```c#
public Vector3 destPos = new Vector3();

    void Update()
    {
        if (Input.GetKeyDown(KeyCode.A) || Input.GetKeyDown(KeyCode.D) ||
            Input.GetKeyDown(KeyCode.W) || Input.GetKeyDown(KeyCode.S))
        {
            if (canMove)
            {
                Calc();

                // íŒì • ì²´í¬ : Perfect, Cool, Good, Bad ì¼ ë•Œë§Œ True
                if (theTimingManager.CheckTiming())
                {
                    StartAction();
                }
            }
        }
    }

    void Calc()
    {
        // íë¸Œì˜ xì¶• -> ìœ„ ì•„ë˜   íë¸Œì˜ zì¶• -> ì˜¤ë¥¸ìª½, ì™¼ìª½
        dir.Set(Input.GetAxisRaw("Vertical"), 0, Input.GetAxisRaw("Horizontal"));

        // ì´ë™ ëª©í‘œê°’ ê²Œì‚°
        destPos = transform.position + new Vector3(-dir.x, 0, dir.z);

        // íšŒì „ ëª©í‘œê°’ ê³„ì‚°
        rotDir = new Vector3(-dir.z, 0f, -dir.x);
        fakeCube.RotateAround(transform.position, rotDir, spinSpeed); //ê³µì „
        destRot = fakeCube.rotation;
    }

    void StartAction()
    {
        StartCoroutine(MoveCo());
        StartCoroutine(SpinCo());
        StartCoroutine(RecoilCo());
        StartCoroutine(theCam.ZoomCam());
    }
```

<br>

### ğŸ“œ TimingManager

```c#
    StageManager theStage;
    PlayerController thePlayer;

    theStage = FindObjectOfType<StageManager>();
    thePlayer = FindObjectOfType<PlayerController>();

    // ì´ í•¨ìˆ˜ê°€ True ë¥¼ ë¦¬í„´í•  ë•Œ í”Œë ˆì´íŠ¸ë¥¼ í™œì„±í™” í•˜ê³  ì ìˆ˜ë¥¼ ì¦ê°€ì‹œí‚¬ ê²ƒ!
    // í”Œë ˆì´ì–´ì˜ ëª©í‘œ ìœ„ì¹˜ì— ì´ë¯¸ í”Œë ˆì´íŠ¸ê°€ ìˆë‹¤ë©´(Raycast ê±¸ë¦¬ëŠ”ê²Œ BasicPlateë¼ë©´) flag ë¥¼ True ë¡œ ë§Œë“¤ê³  true ë¦¬í„´.
    bool CheckCanNextPlate()
    {
        if (Physics.Raycast(thePlayer.destPos, Vector3.down, out RaycastHit t_hitInfo, 1.1f))
        {
            if (t_hitInfo.transform.CompareTag("BasicPlate"))
            {
                BasicPlate t_plate = t_hitInfo.transform.GetComponent<BasicPlate>();
                if (t_plate.flag)
                {
                    t_plate.flag = false;
                    return true;
                }
            }
        }
        return false;
    }

    public bool CheckTiming()
    {
        //...

                    if (CheckCanNextPlate())
                    {
                        theScoreManager.IncreaseScore(j);  // ì ìˆ˜ ì¦ê°€
                        theStage.ShowNextPlate(); // ë‹¤ìŒ í”Œë ˆì´íŠ¸ í˜¸ì¶œ
                        theEffect.JudgementEffect(j);
                    }
                    else
                    {
                        // Normal ì´ë¯¸ì§€ ëœ¨ê²Œë”. ì ìˆ˜ ë°˜ì˜ë„ X
                        theEffect.JudgementEffect(5);
                    }
                        
                    return true;
                }
            }
        }
```

<br>

***
<br>

    ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš° 
    ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}