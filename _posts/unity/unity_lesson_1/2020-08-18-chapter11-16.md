---
title:  "Unity Chapter 11-16. ì¢€ë¹„ TPS ê²Œì„ ë§Œë“¤ê¸° : Enemy" 

categories:
  -  Unity Lesson 1 
tags:
  - [Game Engine, Unity]

toc: true
toc_sticky: true

date: 2020-08-18
last_modified_at: 2020-08-18
---

ì¸í”„ëŸ°ì— ìˆëŠ” ì´ì œë¯¼ë‹˜ì˜ **ë ˆíŠ¸ë¡œì˜ ìœ ë‹ˆí‹° C# ê²Œì„ í”„ë¡œê·¸ë˜ë° ì—ì„¼ìŠ¤** ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ í•„ê¸°ì…ë‹ˆë‹¤. ğŸ˜€  
[ğŸŒœ [ë ˆíŠ¸ë¡œì˜ ìœ ë‹ˆí‹° C# ê²Œì„ í”„ë¡œê·¸ë˜ë° ì—ì„¼ìŠ¤] ê°•ì˜ ë“¤ìœ¼ëŸ¬ ê°€ê¸°!](https://www.inflearn.com/course/%EC%9C%A0%EB%8B%88%ED%8B%B0-%EA%B2%8C%EC%9E%84-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D-%EC%97%90%EC%84%BC%EC%8A%A4)
{: .notice--warning}

<br>

# Chapter 11. ì¢€ë¹„ TPS ê²Œì„ ë§Œë“¤ê¸° 

## ğŸ“œEnemy.cs

> `Zombie`ì— ë¶™ì—¬ì¤€ë‹¤.

- ì¢€ë¹„ ìºë¦­í„°ì˜ <u>ìƒëª…ì²´ë¡œì„œì˜ ë™ì‘</u>ì„ ë‹´ë‹¹
  - <u>LivingEntityë¥¼ ìƒì† ë°›ì•„ ìƒì† ë°›ì€ ìƒëª…ì²´ë¡œì„œì˜ ê¸°ë³¸ ë™ì‘ ê·¸ ìœ„ì— ì¢€ë¹„ë§Œì˜ ë™ì‘ì„ êµ¬í˜„í•  ê²ƒì´ë‹¤.</u>
    - LivingEntity ìœ„ì—ì„œ í™•ì¥ë§Œ í•˜ë©´ ë¨

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.AI;

#if UNITY_EDITOR
using UnityEditor;
#endif

public class Enemy : LivingEntity
{
    private enum State
    {
        Patrol,
        Tracking,
        AttackBegin,
        Attacking
    }

    private State state;

    private NavMeshAgent agent; // ê²½ë¡œê³„ì‚° AI ì—ì´ì „íŠ¸
    private Animator animator; // ì• ë‹ˆë©”ì´í„° ì»´í¬ë„ŒíŠ¸

    public Transform attackRoot;
    public Transform eyeTransform;

    private AudioSource audioPlayer; // ì˜¤ë””ì˜¤ ì†ŒìŠ¤ ì»´í¬ë„ŒíŠ¸
    public AudioClip hitClip; // í”¼ê²©ì‹œ ì¬ìƒí•  ì†Œë¦¬
    public AudioClip deathClip; // ì‚¬ë§ì‹œ ì¬ìƒí•  ì†Œë¦¬

    private Renderer skinRenderer; // ë Œë”ëŸ¬ ì»´í¬ë„ŒíŠ¸

    public float runSpeed = 10f;
    [Range(0.01f, 2f)] public float turnSmoothTime = 0.1f;
    private float turnSmoothVelocity;

    public float damage = 30f;
    public float attackRadius = 2f;
    private float attackDistance;

    public float fieldOfView = 50f;
    public float viewDistance = 10f;
    public float patrolSpeed = 3f;

    [HideInInspector] public LivingEntity targetEntity; // ì¶”ì í•  ëŒ€ìƒ
    public LayerMask whatIsTarget; // ì¶”ì  ëŒ€ìƒ ë ˆì´ì–´


    private RaycastHit[] hits = new RaycastHit[10];
    private List<LivingEntity> lastAttackedTargets = new List<LivingEntity>();

    private bool hasTarget => targetEntity != null && !targetEntity.dead;


#if UNITY_EDITOR

    private void OnDrawGizmosSelected()
    {
        if (attackRoot != null)
        {
            Gizmos.color = new Color(1f, 0f, 0f, 0.5f);
            Gizmos.DrawSphere(attackRoot.position, attackRadius);
        }

        var leftRayRotation = Quaternion.AngleAxis(-fieldOfView * 0.5f, Vector3.up);
        var leftRayDirection = leftRayRotation * transform.forward;
        Handles.color = new Color(1f, 1f, 1f, 0.2f);
        Handles.DrawSolidArc(eyeTransform.position, Vector3.up, leftRayDirection, fieldOfView, viewDistance);
    }

#endif

    private void Awake()
    {
        agent = GetComponent<NavMeshAgent>();
        animator = GetComponent<Animator>();
        audioPlayer = GetComponent<AudioSource>();
        skinRenderer = GetComponentInChildren<Renderer>();

        attackDistance = Vector3.Distance(transform.position,
                             new Vector3(attackRoot.position.x, transform.position.y, attackRoot.position.z)) +
                         attackRadius;

        attackDistance += agent.radius;

        agent.stoppingDistance = attackDistance;
        agent.speed = patrolSpeed;
    }

    // ì  AIì˜ ì´ˆê¸° ìŠ¤í™ì„ ê²°ì •í•˜ëŠ” ì…‹ì—… ë©”ì„œë“œ
    public void Setup(float health, float damage,
        float runSpeed, float patrolSpeed, Color skinColor)
    {
        // ì²´ë ¥ ì„¤ì •
        this.startingHealth = health;
        this.health = health;

        // ë‚´ë¹„ë©”ì‰¬ ì—ì´ì „íŠ¸ì˜ ì´ë™ ì†ë„ ì„¤ì •
        this.runSpeed = runSpeed;
        this.patrolSpeed = patrolSpeed;

        this.damage = damage;

        // ë Œë”ëŸ¬ê°€ ì‚¬ìš©ì¤‘ì¸ ë¨¸í…Œë¦¬ì–¼ì˜ ì»¬ëŸ¬ë¥¼ ë³€ê²½, ì™¸í˜• ìƒ‰ì´ ë³€í•¨
        skinRenderer.material.color = skinColor;

        agent.speed = patrolSpeed;
    }

    private void Start()
    {
        // ê²Œì„ ì˜¤ë¸Œì íŠ¸ í™œì„±í™”ì™€ ë™ì‹œì— AIì˜ ì¶”ì  ë£¨í‹´ ì‹œì‘
        StartCoroutine(UpdatePath());
    }

    private void Update()
    {
        if (dead) return;

        if (state == State.Tracking &&
            Vector3.Distance(targetEntity.transform.position, transform.position) <= attackDistance)
        {
            BeginAttack();
        }


        // ì¶”ì  ëŒ€ìƒì˜ ì¡´ì¬ ì—¬ë¶€ì— ë”°ë¼ ë‹¤ë¥¸ ì• ë‹ˆë©”ì´ì…˜ì„ ì¬ìƒ
        animator.SetFloat("Speed", agent.desiredVelocity.magnitude);
    }

    private void FixedUpdate()
    {
        if (dead) return;


        if (state == State.AttackBegin || state == State.Attacking)
        {
            var lookRotation =
                Quaternion.LookRotation(targetEntity.transform.position - transform.position);
            var targetAngleY = lookRotation.eulerAngles.y;

            transform.eulerAngles = Vector3.up * Mathf.SmoothDampAngle(transform.eulerAngles.y, targetAngleY,
                                        ref turnSmoothVelocity, turnSmoothTime);
        }

        if (state == State.Attacking)
        {
            var direction = transform.forward;
            var deltaDistance = agent.velocity.magnitude * Time.deltaTime;

            var size = Physics.SphereCastNonAlloc(attackRoot.position, attackRadius, direction, hits, deltaDistance,
                whatIsTarget);

            for (var i = 0; i < size; i++)
            {
                var attackTargetEntity = hits[i].collider.GetComponent<LivingEntity>();

                if (attackTargetEntity != null && !lastAttackedTargets.Contains(attackTargetEntity))
                {
                    var message = new DamageMessage();
                    message.amount = damage;
                    message.damager = gameObject;

                    if(hits[i].distance <= 0f)
                    {
                        message.hitPoint = attackRoot.position;
                    }
                    else
                    {
                        message.hitPoint = hits[i].point;
                    }

                    message.hitNormal = hits[i].normal;

                    attackTargetEntity.ApplyDamage(message);

                    lastAttackedTargets.Add(attackTargetEntity);
                    break;
                }
            }
        }
    }

    // ì£¼ê¸°ì ìœ¼ë¡œ ì¶”ì í•  ëŒ€ìƒì˜ ìœ„ì¹˜ë¥¼ ì°¾ì•„ ê²½ë¡œë¥¼ ê°±ì‹ 
    private IEnumerator UpdatePath()
    {
        // ì‚´ì•„ìˆëŠ” ë™ì•ˆ ë¬´í•œ ë£¨í”„
        while (!dead)
        {
            if (hasTarget)
            {
                if (state == State.Patrol)
                {
                    state = State.Tracking;
                    agent.speed = runSpeed;
                }

                // ì¶”ì  ëŒ€ìƒ ì¡´ì¬ : ê²½ë¡œë¥¼ ê°±ì‹ í•˜ê³  AI ì´ë™ì„ ê³„ì† ì§„í–‰
                agent.SetDestination(targetEntity.transform.position);
            }
            else
            {
                if (targetEntity != null) targetEntity = null;

                if (state != State.Patrol)
                {
                    state = State.Patrol;
                    agent.speed = patrolSpeed;
                }

                if (agent.remainingDistance <= 1f)
                {
                    var patrolPosition = Utility.GetRandomPointOnNavMesh(transform.position, 20f, NavMesh.AllAreas);
                    agent.SetDestination(patrolPosition);
                }

                // 20 ìœ ë‹›ì˜ ë°˜ì§€ë¦„ì„ ê°€ì§„ ê°€ìƒì˜ êµ¬ë¥¼ ê·¸ë ¸ì„ë•Œ, êµ¬ì™€ ê²¹ì¹˜ëŠ” ëª¨ë“  ì½œë¼ì´ë”ë¥¼ ê°€ì ¸ì˜´
                // ë‹¨, whatIsTarget ë ˆì´ì–´ë¥¼ ê°€ì§„ ì½œë¼ì´ë”ë§Œ ê°€ì ¸ì˜¤ë„ë¡ í•„í„°ë§
                var colliders = Physics.OverlapSphere(eyeTransform.position, viewDistance, whatIsTarget);

                // ëª¨ë“  ì½œë¼ì´ë”ë“¤ì„ ìˆœíšŒí•˜ë©´ì„œ, ì‚´ì•„ìˆëŠ” LivingEntity ì°¾ê¸°
                foreach (var collider in colliders)
                {
                    if (!IsTargetOnSight(collider.transform)) continue;

                    var livingEntity = collider.GetComponent<LivingEntity>();

                    // LivingEntity ì»´í¬ë„ŒíŠ¸ê°€ ì¡´ì¬í•˜ë©°, í•´ë‹¹ LivingEntityê°€ ì‚´ì•„ìˆë‹¤ë©´,
                    if (livingEntity != null && !livingEntity.dead)
                    {
                        // ì¶”ì  ëŒ€ìƒì„ í•´ë‹¹ LivingEntityë¡œ ì„¤ì •
                        targetEntity = livingEntity;

                        // forë¬¸ ë£¨í”„ ì¦‰ì‹œ ì •ì§€
                        break;
                    }
                }
            }

            // 0.05 ì´ˆ ì£¼ê¸°ë¡œ ì²˜ë¦¬ ë°˜ë³µ
            yield return new WaitForSeconds(0.05f);
        }
    }

    // ë°ë¯¸ì§€ë¥¼ ì…ì—ˆì„ë•Œ ì‹¤í–‰í•  ì²˜ë¦¬
    public override bool ApplyDamage(DamageMessage damageMessage)
    {
        if (!base.ApplyDamage(damageMessage)) return false;

        if (targetEntity == null)
        {
            targetEntity = damageMessage.damager.GetComponent<LivingEntity>();
        }

        EffectManager.Instance.PlayHitEffect(damageMessage.hitPoint, damageMessage.hitNormal, transform, EffectManager.EffectType.Flesh);
        audioPlayer.PlayOneShot(hitClip);

        return true;
    }

    public void BeginAttack()
    {
        state = State.AttackBegin;

        agent.isStopped = true;
        animator.SetTrigger("Attack");
    }

    public void EnableAttack()
    {
        state = State.Attacking;

        lastAttackedTargets.Clear();
    }

    public void DisableAttack()
    {
        if(hasTarget)
        {
            state = State.Tracking;
        }
        else
        {
            state = State.Patrol;
        }

        agent.isStopped = false;
    }

    private bool IsTargetOnSight(Transform target)
    {
        RaycastHit hit;

        var direction = target.position - eyeTransform.position;

        direction.y = eyeTransform.forward.y;

        if (Vector3.Angle(direction, eyeTransform.forward) > fieldOfView * 0.5f)
        {
            return false;
        }

        direction = target.position - eyeTransform.position;

        if (Physics.Raycast(eyeTransform.position, direction, out hit, viewDistance, whatIsTarget))
        {
            if (hit.transform == target) return true;
        }

        return false;
    }

    // ì‚¬ë§ ì²˜ë¦¬
    public override void Die()
    {
        // LivingEntityì˜ Die()ë¥¼ ì‹¤í–‰í•˜ì—¬ ê¸°ë³¸ ì‚¬ë§ ì²˜ë¦¬ ì‹¤í–‰
        base.Die();

        // ë‹¤ë¥¸ AIë“¤ì„ ë°©í•´í•˜ì§€ ì•Šë„ë¡ ìì‹ ì˜ ëª¨ë“  ì½œë¼ì´ë”ë“¤ì„ ë¹„í™œì„±í™”
        GetComponent<Collider>().enabled = false;

        // AI ì¶”ì ì„ ì¤‘ì§€í•˜ê³  ë‚´ë¹„ë©”ì‰¬ ì»´í¬ë„ŒíŠ¸ë¥¼ ë¹„í™œì„±í™”
        agent.enabled = false;

        // ì‚¬ë§ ì• ë‹ˆë©”ì´ì…˜ ì¬ìƒ
        animator.applyRootMotion = true;
        animator.SetTrigger("Die");

        // ì‚¬ë§ íš¨ê³¼ìŒ ì¬ìƒ
        if (deathClip != null) audioPlayer.PlayOneShot(deathClip);
    }
}
```

<br>

### ì‹œì‘í•˜ê¸° ì•ì„œ

#### UnityEngine.AI

```c#
using UnityEngine.AI
```

- ë„¤ë¹„ê²Œì´ì…˜ ì‹œìŠ¤í…œì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„  `UnityEngine.AI` ì„ ì¸í´ë£¨ë”© í•´ì¤˜ì•¼ í•œë‹¤.

<br>

#### ì „ì²˜ë¦¬ê¸°

```c#
#if UNITY_EDITOR
using UnityEditor;
#endif
```

> UnityEditor ì˜ ê¸°ëŠ¥ë“¤ì„ ì‚¬ìš©í•  ë•ŒëŠ” `using UnityEditor`ë§Œ í•´ì£¼ë©´ ì•ˆë˜ê³  ë°˜ë“œì‹œ ì „ì²˜ë¦¬ê¸° `#if UNITY_EDITOR`, `#endif` ì•ˆì— ë„£ì–´ì„œ ì„ ì–¸í•´ì£¼ì–´ì•¼ í•œë‹¤.

- <u>ì˜¤ì§ ìœ ë‹ˆí‹° ì—ë””í„°ì—ì„œë§Œ</u> `UnityEditor` ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê² ë‹¤ê³  ì„ ì–¸.
  - ìœ ë‹ˆí‹° ì—ë””í„° ë‚´ì—ì„œë§Œ ë™ì‘í•  ë¿ `UnityEditor` ë„¤ì„ìŠ¤í˜ì´ìŠ¤ê°€ ë¹Œë“œ ë˜ì§€ëŠ” ì•ŠëŠ”ë‹¤.
    - ê²Œì„ ê°œë°œì´ ì™„ì„±ëœ í›„ ë‚˜ì¤‘ì— ìœˆë„ìš°ìš©, ë§¥OS, ì•ˆë“œë¡œì´ë“œ ë“±ë“± ì´ëŸ° ë‹¤ì–‘í•œ í”Œë«í¼ìœ¼ë¡œì„œ ë¹Œë“œ í•  ë•Œ ì´ ë¶€ë¶„ì€ ë¹Œë“œì—ì„œ ë¹ ì§€ê²Œ ëœë‹¤. ìœ ë‹ˆí‹° ì—ë””í„°ì—ì„œë§Œ ë˜ë‹ˆê¹Œ!
  - ì˜¤ë¡œì§€ ìœ ë‹ˆí‹° ì—ë””í„°ì—ì„œë§Œ ì¢€ë¹„ê°€ í”Œë ˆì´ì–´ë¥¼ ì¸ì‹í•  ìˆ˜ ìˆëŠ” ì˜ì—­ì„ ì‹œê°ì ìœ¼ë¡œ ë³´ì—¬ì£¼ê¸° ìœ„í•´ì„œ ì´ì— ëŒ€í•œ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” `UnityEditor` ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë˜ ì˜¤ì§ ìœ ë‹ˆí‹° ì—ë””í„°ì—ì„œë§Œ ì‚¬ìš©!

> **ì „ì²˜ë¦¬ê¸°** ğŸ‘‰ íŠ¹ì • ìƒí™©ì— ë”°ë¼ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì»´íŒŒì¼í• ì§€ ë§ì§€ ê²°ì •í•  ìˆ˜ ìˆë‹¤.

- ìœ ë‹ˆí‹°ëŠ” ì—¬ëŸ¬ í”Œë«í¼ì„ ë¹Œë“œí•  ìˆ˜ ìˆë‹¤. iOS, ì•ˆë“œë¡œì´ë“œ, ìœˆë„ìš°, ë§¥OS ë“±ë“±..
  - í”Œë«í¼ì— ë”°ë¥¸ ê°ê°ì˜ ì½”ë“œë“¤ì„ ë§Œë“¤ ë•Œ <u>íŠ¹ì • í”Œë«í¼ì—ë§Œ ì»´íŒŒì¼ ë˜ëŠ” ì „ì²˜ë¦¬ê¸°ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤.</u>
  - ì˜ˆë¥¼ë“¤ì–´ iOS ì „ì²˜ë¦¬ê¸° ë¶€ë¶„ì€ ê²Œì„ ê°œë°œì´ ì™„ì„±ëœ í›„ iOSë¡œ ë¹Œë“œë  ë•Œë§Œ í¬í•¨ëœë‹¤. ì•ˆë“œë¡œì´ë“œë¡œ ë¹Œë“œ ë  ë•ŒëŠ” ì´ ë¶€ë¶„ì˜ ì½”ë“œê°€ ë¹Œë“œì— í¬í•¨ë˜ì§€ ì•ŠëŠ”ë‹¤.

 ```c#
    #if UNITY_EDITOR 
      Debug.Log("Unity Editor");  // ìœ ë‹ˆí‹° ì—ë””í„°ì—ì„œë§Œ ë‚˜ì˜¤ëŠ” ë¡œê·¸
    #endif
    
    #if UNITY_IOS
      Debug.Log("Iphone");   // iOS ì—ì„œë§Œ ë‚˜ì˜¤ëŠ” ë¡œê·¸. iOSë¡œ ë¹Œë“œí•  ë•Œë§Œ ë¹Œë“œ ëœë‹¤.
    #endif

    #if UNITY_STANDALONE_OSX
    Debug.Log("Stand Alone OSX");   // ë§¥ OS ì—ì„œë§Œ ë‚˜ì˜¤ëŠ” ë¡œê·¸. ë§¥ OSë¡œ ë¹Œë“œí•  ë•Œë§Œ ë¹Œë“œ ëœë‹¤.
    #endif

    #if UNITY_STANDALONE_WIN
      Debug.Log("Stand Alone Windows");  // ìœˆë„ìš°ì—ì„œë§Œ ë‚˜ì˜¤ëŠ” ë¡œê·¸. ìœˆë„ìš°ë¡œ ë¹Œë“œí•  ë•Œë§Œ ë¹Œë“œ ëœë‹¤.
    #endif
```

<br>

### ë©¤ë²„ ë³€ìˆ˜/í”„ë¡œí¼í‹°

> LivingEntityë¥¼ ìƒì† ë°›ì•˜ìœ¼ë¯€ë¡œ <u>LivingEntityì˜ ë©¤ë²„ ë³€ìˆ˜ë“¤ë„ ê°€ì§€ê³  ìˆë‹¤ëŠ” ê²ƒ ìŠì§€ ë§ê¸°!</u>

```c#
    private enum State  // ì¢€ë¹„ ìƒíƒœ
    {
        Patrol,      // ëŒì•„ë‹¤ë‹ˆëŠ” ìƒíƒœ
        Tracking,    // í”Œë ˆì´ì–´ë¥¼ ì¶”ê²©í•˜ëŠ” ìƒíƒœ
        AttackBegin, // ê³µê²© ì‹œì‘
        Attacking    // ê³µê²©
    }

    private State state;  // ì¢€ë¹„ ìƒíƒœ

    private NavMeshAgent agent; // NavMeshAgent ê²½ë¡œê³„ì‚° AI ì—ì´ì „íŠ¸
    private Animator animator; // ì¢€ë¹„ ì• ë‹ˆë©”ì´ì…˜ì„ í‘œí˜„í•  ì• ë‹ˆë©”ì´í„° ì»´í¬ë„ŒíŠ¸

    public Transform attackRoot;  
    public Transform eyeTransform;

    private AudioSource audioPlayer; // ì˜¤ë””ì˜¤ ì†ŒìŠ¤ ì»´í¬ë„ŒíŠ¸. ì†Œë¦¬ ì¬ìƒê¸°
    public AudioClip hitClip; // í”¼ê²©ì‹œ ì¬ìƒí•  ì†Œë¦¬
    public AudioClip deathClip; // ì‚¬ë§ì‹œ ì¬ìƒí•  ì†Œë¦¬

    private Renderer skinRenderer; // ë Œë”ëŸ¬ ì»´í¬ë„ŒíŠ¸

    public float runSpeed = 10f;  // ì¢€ë¹„ ì´ë™ ì†ë„
    [Range(0.01f, 2f)] public float turnSmoothTime = 0.1f;  // ì¢€ë¹„ê°€ ë°©í–¥ì„ ìŠ¤ë¬´ìŠ¤í•˜ê²Œ íšŒì „í•  ë•Œ ì‚¬ìš©í•  ì§€ì—°ì‹œê°„. smoothDamp ì— ì‚¬ìš©í• ê²ƒ. 
    private float turnSmoothVelocity; // smoothDamp ì— ì‚¬ìš©í• ê²ƒ. ìŠ¤ë¬´ìŠ¤í•˜ê²Œ íšŒì „í•˜ëŠ” ì‹¤ì‹œê°„ ë³€í™”ëŸ‰

    public float damage = 30f;  // ê³µê²©ë ¹
    public float attackRadius = 2f; // ê³µê²© ë°˜ê²½(ë°˜ì§€ë¦„)
    private float attackDistance; // ê³µê²©ì„ ì‹œë„í•˜ëŠ” ê±°ë¦¬

    public float fieldOfView = 50f;  // ì¢€ë¹„ì˜ ì‹œì•¼ ê°
    public float viewDistance = 10f; // ì¢€ë¹„ê°€ ë³¼ ìˆ˜ ìˆëŠ” ê±°ë¦¬
    public float patrolSpeed = 3f; // ì¢€ë¹„ê°€ ëŒì•„ë‹¤ë‹ˆëŠ” ê±°ë¦¬(Patrol ìƒíƒœì¼ ë•Œ)

    [HideInInspector] public LivingEntity targetEntity; // ì¶”ì í•  ëŒ€ìƒ. 
    public LayerMask whatIsTarget; // ì¶”ì  ëŒ€ìƒ ë ˆì´ì–´


    private RaycastHit[] hits = new RaycastHit[10];
    private List<LivingEntity> lastAttackedTargets = new List<LivingEntity>();

    private bool hasTarget => targetEntity != null && !targetEntity.dead;
```

- í•„ê¸° ì•ˆí•œê±´ ì£¼ì„ ì°¸ê³ 
- `attackRoot`
  - **Transform**
  - ì¢€ë¹„ ì˜¤ë¸Œì íŠ¸ê°€ ê³µê²©ì„ í•˜ëŠ” Pivot í¬ì¸íŠ¸. 
  - ì´ `attackRoot`ì„ ì¤‘ì‹¬ìœ¼ë¡œ ë°˜ì§€ë¦„ì„ ì§€ì •í•´ì„œ ì´ ë°˜ê²½ ë‚´ì— ìˆëŠ” í”Œë ˆì´ì–´ê°€ ê³µê²©ì„ ë‹¹í•˜ë„ë¡ í•  ê²ƒì´ë‹¤.
- `eyeTransform`
  - **Transform**
  - ì‹œì•¼ì˜ ê¸°ì¤€ì . 'ëˆˆì˜ ìœ„ì¹˜'ê°€ ë  ì–´ë–¤ ê²Œì„ ì˜¤ë¸Œì íŠ¸ì˜ Trnasform
  - ì´ `eyeTransform`ì„ ê¸°ì¤€ìœ¼ë¡œ ì–´ë–¤ ì˜ì—­ì„ ì§€ì •í•´ì„œ í”Œë ˆì´ì–´ë‚˜ ì  AIë¥¼ ê°ì§€í•  ìˆ˜ ìˆê²Œ í•  ê²ƒì´ë‹¤.
- `skinRenderer`
  - **Renderer**
  - ì¢€ë¹„ì˜ í”¼ë¶€ìƒ‰ì— ë”°ë¼ì„œ ê³µê²©ë ¥ì„ ë‹¤ë¥´ê²Œ í•´ì¤„ ê²ƒ
    - ê·¸ë•Œ ì‚¬ìš©í•  í”¼ë¶€ìƒ‰!
- `targetEntity`
  - **LivingEntity**
  - ì¢€ë¹„ê°€ ì¶”ì í•  ëŒ€ìƒ. 
  - í”Œë ˆì´ì–´ ìºë¦­í„° ì˜¤ë¸Œì íŠ¸ê°€ ì´ ê³³ì— í• ë‹¹ ë  ê²ƒ! 
  - LivingEntity íƒ€ì…ì´ë¼ë©´ ì–´ë–¤ ê²ƒì´ë“ ì§€ ì´ ê³³ì— í• ë‹¹ ê°€ëŠ¥.
  - `[HideInInspector]` ë¼ì„œ ìœ ë‹ˆí‹° ì¸ìŠ¤í™í„° ì°½ì—ì„  ë³´ì´ì§€ ì•ŠìŒ. publicì¸ë°ë„ ë¶ˆêµ¬í•˜ê³ !
    - ì½”ë“œë¡œ í• ë‹¹ í•  ê²ƒì´ë¼ì„œ ìˆ¨ê²¼ë‹¤.
- `whatIsTarget`
  - **LayerMask**
  - ì ì„ ê°ì§€í•  ë•Œ ì‚¬ìš©í•  ë ˆì´ì–´ í•„í„°
- `hits`
  - 10 ì‚¬ì´ì¦ˆì˜ <u>RaycastHit ë°°ì—´</u>ì´ë‹¤.
    - ë°°ì—´ì„ ì‚¬ìš©í•œ ì´ìœ 
      - ì¢€ë¹„ì˜ ê³µê²©ì„ ë²”ìœ„ ê¸°ë°˜ì˜ ê³µê²©ìœ¼ë¡œ êµ¬í˜„í•  ê²ƒì´ë¼ì„œ ë²”ìœ„ ê¸°ë°˜ìœ¼ë¡œ í•˜ë©´ ì—¬ëŸ¬ê°œì˜ Ray ì¶©ëŒ ì§€ì ì´ ìƒê¸°ê¸° ë•Œë¬¸.
- `lastAttackedTargets`
  - LivingEntity íƒ€ì…ì˜ ì›ì†Œë“¤ì´ ë“¤ì–´ê°€ ë¦¬ìŠ¤íŠ¸
    - ê³µê²©ì„ ì‹œì‘í•  ë•Œë§ˆë‹¤ ì´ˆê¸°í™” ë  ë¦¬ìŠ¤íŠ¸
    - ê³µê²© ë„ì¤‘ì— <u>ì§ì „ í”„ë ˆì„ê¹Œì§€ ê³µê²©ì´ ì ìš©ëœ ëŒ€ìƒë“¤ì„ ëª¨ì•„ë‘˜ ë¦¬ìŠ¤íŠ¸</u>
      - ê³µê²©ì€ ì‹œê°„ì„ ë“¤ì—¬ì„œ ì§„í–‰ ë˜ëŠ”ë°, <u>ê³µê²©ì´ ë˜‘ê°™ì€ ëŒ€ìƒì—ê²Œ ë‘ë²ˆ ì´ìƒ ì ìš©ë˜ì§€ ì•Šë„ë¡ í•˜ê¸° ìœ„í•˜ì—¬</u> ì´ ë¦¬ìŠ¤íŠ¸ì— í¬í•¨ëœ ì˜¤ë¸Œì íŠ¸ë“¤ì€ ê³µê²© ëŒ€ìƒì—ì„œ ì œì™¸í•  ê²ƒì´ë‹¤.
        - ê³µê²©ì´ ëë‚˜ê³  ë‚˜ë©´ ë¦¬ìŠ¤íŠ¸ë¥¼ ë¹„ì›€
- `hasTarget`
  - ì¶”ì í•  ëŒ€ìƒì´ ì¡´ì¬í•˜ëŠ”ì§€ì˜ ì—¬ë¶€
  - ëŒë‹¤ í•¨ìˆ˜ë¡œ ì •ì˜ëœ í”„ë¡œí¼í‹°
    - *targetEntity != null && !targetEntity.dead*
      - ì¶”ì í•  ìƒëŒ€ë°©ì´ ì¡´ì¬í•˜ê³  ì¶”ì í•  ìƒëŒ€ë°©ì´ ì£½ì€ ìƒíƒœê°€ ì•„ë‹ˆë¼ë©´
  

<br>

### ë©¤ë²„ í•¨ìˆ˜

#### private void OnDrawGizmosSelected()

> `Zombie` ì˜¤ë¸Œì íŠ¸ì˜ <u>ì‹œì•¼ì™€ ê³µê²© ë²”ìœ„</u>ë¥¼ ìœ ë””í„° ì—ë””í„° ë‚´ì—ì„œë§Œ, ì”¬ ìƒì—ì„œë§Œ ê·¸ë¦¬ëŠ” ì—­í• ì„ í•œë‹¤.

```c#
#if UNITY_EDITOR

    private void OnDrawGizmosSelected()
    {
        if (attackRoot != null)
        {
            Gizmos.color = new Color(1f, 0f, 0f, 0.5f);
            Gizmos.DrawSphere(attackRoot.position, attackRadius);
        }
        
        var leftRayRotation = Quaternion.AngleAxis(-fieldOfView * 0.5f, Vector3.up);
        var leftRayDirection = leftRayRotation * transform.forward;
        Handles.color = new Color(1f, 1f, 1f, 0.2f);
        Handles.DrawSolidArc(eyeTransform.position, Vector3.up, leftRayDirection, fieldOfView, viewDistance);
    }

#endif
```

- ì „ì²˜ë¦¬ê¸° `#if` `#endif`ë¡œ ë¬¶ì—¬ìˆë‹¤.
  - `UNITY_EDITOR` ìœ ë‹ˆí‹° ì—ë””í„° ë‚´ì—ì„œë§Œ ì´ ì½”ë“œê°€ ì¡´ì¬í•˜ê²Œ ë˜ë©° ìµœì¢…ì ì¸ ì‹¤ì œ ê²Œì„ ë¹Œë“œì—ì„œëŠ” ë¹ ì§€ê²Œ ëœë‹¤. 
- **OnDrawGizmosSelected()** ëŠ” ì´ë²¤íŠ¸ í•¨ìˆ˜ë‹¤.
  - `OnDrawGizmos()` ğŸ‘‰ ì´ í•¨ìˆ˜ê°€ ì†Œì†ëœ ìŠ¤í¬ë¦½íŠ¸ê°€ ì»´í¬ë„ŒíŠ¸ë¡œì„œ ë¶™ì€ ì˜¤ë¸Œì íŠ¸ê°€ Scene í™”ë©´ ìƒì—ì„œ í•­ìƒ ë³´ì´ë„ë¡ í•˜ëŠ” ì´ë²¤íŠ¸ í•¨ìˆ˜.
  - `OnDrawGizmosSeleced()` ğŸ‘‰ ì´ í•¨ìˆ˜ê°€ ì†Œì†ëœ ìŠ¤í¬ë¦½íŠ¸ê°€ ì»´í¬ë„ŒíŠ¸ë¡œì„œ ë¶™ì€ ì˜¤ë¸Œì íŠ¸ê°€ ì„ íƒëì„ë•Œë§Œ ë³´ì´ë„ë¡ í•˜ëŠ” ì´ë²¤íŠ¸ í•¨ìˆ˜.
  - ì”¬ìƒì— ì¡´ì¬í•˜ê¸°ëŠ” í•˜ë‚˜ ì•„ì§ ë³´ì´ì§€ëŠ” ì•ŠëŠ” ê·¸ëŸ° ì˜¤ë¸Œì íŠ¸ë“¤ì„ ê¸°ì¦ˆëª¨ë¥¼ í†µí•´ ë³´ì—¬ì¤Œìœ¼ë¡œì„œ ìœ„ì¹˜ ì¡°ì •ì„ ì‰½ê²Œ í•´ì£¼ëŠ” ë“±ë“± ê°œë°œì í¸ì˜ë¥¼ ë•ëŠ”ë‹¤. 
- `Zombie`ì˜ ë¹¨ê°„ìƒ‰ **ê³µê²© ë°˜ê²½** ê·¸ë¦¬ê¸° ğŸ”ˆ *ì”¬ ìƒì—ì„œë§Œ ê·¸ë ¤ì§„ë‹¤.*
  - *if (attackRoot != null)*
    - `attackRoot` ê³µê²©ì˜ ê¸°ì¤€ì ì´ ì¡´ì¬í•  ë•Œë§Œ ê³µê²© ë°˜ê²½ì„ ê·¸ë¦´ ìˆ˜ ìˆìœ¼ë¯€ë¡œ.
    - ê¸°ì¦ˆëª¨ì˜ ìƒ‰ê¹”ì„ ë¹¨ê°„ìƒ‰ìœ¼ë¡œ ë³€ê²½í•´ì¤€ë‹¤. 
      - ë ˆë“œë¥¼ `1.0f` 100 % ë¡œ.
    - ê³µê²© ë°˜ê²½ì„ êµ¬ë¡œ ê·¸ë ¤ì¤€ë‹¤.
      - ì¤‘ì‹¬ì  `attackRoot.position`
      - ë°˜ì§€ë¦„ `attackRadius`
- `Zombie`ì˜ ë¹¨ê°„ìƒ‰ **ì‹œì•¼ ë²”ìœ„** ê·¸ë¦¬ê¸° ğŸ”ˆ *ì”¬ ìƒì—ì„œë§Œ ê·¸ë ¤ì§„ë‹¤.*
  - í”¼ì ëª¨ì–‘ì˜ 'í˜¸'(Arc) í˜•íƒœë¡œ ê·¸ë¦´ ê²ƒì´ë‹¤. 
  - ![image](https://user-images.githubusercontent.com/42318591/91793934-a5b91680-ec54-11ea-8053-37fc58828b87.png){: width="70%" height="70%"}{: .align-center}
    - ê°ˆìƒ‰ í”¼ìëª¨ì–‘ì´ ì¢€ë¹„ ì‹œì•¼ê°ì„ í‘œí˜„í•œ ê²ƒì´ë‹¤. ì´ê²ƒì„ ì”¬ìƒì—ì„œ ê·¸ë¦´ ê²ƒ!
      - ë§Œì•½ `fieldOfView` ì¦‰, ì¢€ë¹„ì˜ ì‹œì•¼ê°ì´ 60 ë„ë¼ë©´ `-fieldOfView * 0.5f`ì€ -30 ë„ê°€ ë˜ë¯€ë¡œ `transform.forward` ì¶•ì„ ê¸°ì¤€ìœ¼ë¡œ ì™¼ìª½ìœ¼ë¡œ 30ë„ ë§Œí¼ íšŒì „í•œ ìƒíƒœë¥¼ ì‹œì‘ì ìœ¼ë¡œ í•´ì„œ ì˜¤ë¥¸ìª½ìœ¼ë¡œ 60ë„ë§Œí¼ ì›ì„ ê·¸ë ¤(í”¼ìëª¨ì–‘) ì‹œì•¼ê°ì„ í‘œí˜„í•  ê²ƒì´ë‹¤.
  - `leftRayRotation` **ì™¼ìª½ ëì§€ì ìœ¼ë¡œ í–¥í•˜ëŠ” íšŒì „ê°’(ì¿¼í„°ë‹ˆì–¸)**
    - `Vector3.up` ìœ„ìª½ ë°©í–¥(yì¶•)ì„ ì¤‘ì‹¬ìœ¼ë¡œ í•˜ì—¬ `fieldOfView * 0.5f` ê°ë„ë§Œí¼ ì™¼ìª½ìœ¼ë¡œ `-` íšŒì „ì‹œí‚¨ ê²ƒ (ìµœì¢…ì ìœ¼ë¡œ `fieldOfView * 0.5f`) ì„ ì¿¼í„°ë‹ˆì–¸ìœ¼ë¡œ í‘œí˜„í•œ ê²ƒ.
    - í•„ê¸° ê·¸ë¦¼ ìƒì—ì„œ ë…¸ë€ ê°ë„ ë¶€ë¶„
  - `leftRayDirection` **ì™¼ìª½ ëì§€ì ìœ¼ë¡œ í–¥í•˜ëŠ” ë°©í–¥**
    - `leftRayRotation * transform.forward`
      - ìœ„ì—ì„œ êµ¬í•œ ì¿¼í„°ë‹ˆì–¸ì¸ `leftRayRotation` ë§Œí¼ ì•ìª½ ë°©í–¥ìœ¼ë¡œ íšŒì „í•œ ì²˜ë¦¬ê°€ ëœë‹¤. 
      - `leftRayRotation`ìœ¼ë¡œë¶€í„° `lefRayDirection`ì„ êµ¬í•¨!
      - í•„ê¸° ê·¸ë¦¼ ìƒì—ì„œ ë…¸ë€ ê°ë„ë¥¼ forward(zì¶•)ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í•œ ê³¼ì •
  - ì´ë ‡ê²Œ í”¼ìëª¨ì–‘ì˜ í˜¸(Arc)ë¥¼ ê·¸ë¦´ ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì€ `Gizmos`ì—ëŠ” ì—†ì–´ì„œ ì—¬ëŸ¬ê°€ì§€ ê·¸ë¦¬ê¸° ìš”ì†Œê°€ ë‹´ê²¨ìˆëŠ” `unityEditor`ì˜ `Handles` í´ë˜ìŠ¤ì˜ í•¨ìˆ˜ *DrawSolidArc* ë¥¼ í†µí•´ ê·¸ë¦´ ê²ƒì´ë‹¤.
    - ìƒ‰ê¹”ì€ ì¡°ê¸ˆ íˆ¬ëª…í•œ í•˜ì–€ìƒ‰ *new Color(1f, 1f, 1f, 0.2f);*
    - í•„ê¸° ê·¸ë¦¼ ìƒì—ì„œ í•«í•‘í¬ ìƒ‰ (`leftRayDirection`)ì„ ì‹œì‘ì  ìœ¼ë¡œ ì˜¤ë¥¸ìª½ìœ¼ë¡œ `fieldOfview` ê°ë„(ë…¸ë€ìƒ‰ì˜ 2 ë°°) ë§Œí¼ì˜ ë¶€ì±„ê¼´ Arcë¥¼ ê·¸ë¦°ë‹¤.
    - *Handles.DrawSolidArc(eyeTransform.position, Vector3.up, leftRayDirection, fieldOfView, viewDistance);*
      - ì‹œì•¼ ê°ì´ ê·¸ë ¤ì§€ëŠ” ìœ„ì¹˜ì¸ `eyeTransform.position` ì—ì„œ ê·¸ë ¤ì§€ë©°
      - `Vector3.up` ì¶•ì„ ê¸°ì¤€ìœ¼ë¡œ íšŒì „í•œ ë¶€ì±„ê¼´
      - `leftRayDirection` ì„ ë¶€ì±„ê¼´ ì‹œì‘ì ìœ¼ë¡œ (from)
      - ì˜¤ë¥¸ìª½ìœ¼ë¡œ `fieldOfview` ê°ë„ë§Œí¼ íšŒì „í•œ
      - ì¤‘ì‹¬ìœ¼ë¡œë¶€í„° í˜¸ê°€ ê·¸ë ¤ì§€ëŠ” ê¸¸ì´ëŠ”, ì¦‰ ë°˜ì§€ë¦„ì´ `viewDistance` (ì¢€ë¹„ê°€ ë³¼ ìˆ˜ ìˆëŠ” ê±°ë¦¬)ì¸ Arcë¥¼ ê·¸ë¦°ë‹¤. 

##### Eye, AttackRoot ì¶”ê°€

- ë¹ˆ ê²Œì„ ì˜¤ë¸Œì íŠ¸ì¸ `Eye`ë¥¼ `Zombie`ì˜ ìì‹ìœ¼ë¡œ ì¶”ê°€í•´ì¤€ë‹¤.
  - ì¢€ë¹„ì˜ ëˆˆì˜ ìœ„ì¹˜ê°€ ë  ê²ƒì´ë‹¤.
  - ![image](https://user-images.githubusercontent.com/42318591/91795883-d0f23480-ec59-11ea-9217-47d3b6c8ca6d.png){: width="30%" height="30%"}{: .align-center}
  - Trnasform ê°’ì€ (0, 1.6, 0.12) ë¡œ í•´ì¤€ë‹¤.
  - <u>ğŸ“œEnemy.cs ì˜ `eyeTransform` ìŠ¬ë¡¯ì— ë“œë˜ê·¸ ì•¤ ë“œë¡­ í•´ì¤€ë‹¤.</u>
- ë¹ˆ ê²Œì„ ì˜¤ë¸Œì íŠ¸ì¸ `Attack Root`ë¥¼ `Zombie`ì˜ ìì‹ìœ¼ë¡œ ì¶”ê°€í•´ì¤€ë‹¤.
  - ì¢€ë¹„ì˜ ê³µê²© ë°˜ê²½ì´ ëœë‹¤.
  - ![image](https://user-images.githubusercontent.com/42318591/91796015-229abf00-ec5a-11ea-9235-51361af7d721.png){: width="50%" height="50%"}{: .align-center}
    - ì¢€ë¹„ì˜ ì•ìª½ì— ìœ„ì¹˜í•œ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. ì¢€ë¹„ì™€ ì´ `Attack Root` ê±°ë¦¬ê°€ ê³µê²© ë°˜ê²½ êµ¬ì˜ ë°˜ì§€ë¦„ì´ ë  ê±°ì´ë‹¤.
  - Trnasform ê°’ì€ (0, 1.2, 0.5) ë¡œ í•´ì¤€ë‹¤.
  - <u>ğŸ“œEnemy.cs ì˜ `attackRoot` ìŠ¬ë¡¯ì— ë“œë˜ê·¸ ì•¤ ë“œë¡­ í•´ì¤€ë‹¤.</u>
- ![image](https://user-images.githubusercontent.com/42318591/91796176-7f967500-ec5a-11ea-9665-bf0bf769b4ba.png){: width="70%" height="70%"}{: .align-center}
  - `Zombie`ë¥¼ í´ë¦­í–ˆì„ ë•Œ Scene ìƒì—ì„œ ë‹¤ìŒê³¼ ê°™ì´ ë¹¨ê°„ ê³µê²© ë°˜ê²½ êµ¬ì™€ ì‹œì•¼ ë²”ìœ„ê°€ Arcë¡œ ê·¸ë ¤ì§€ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.


<br>

#### private void Awake()

> í•„ìš”í•œ ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ë“¤ì„ ê°€ì ¸ì™€ì„œ ë©¤ë²„ ë³€ìˆ˜ì— í• ë‹¹

```c#
    private void Awake()
    {
        // ì»´í¬ë„ŒíŠ¸ë“¤ ê°€ì ¸ì˜¤ê¸°
        agent = GetComponent<NavMeshAgent>(); // Zombieì˜ NavMeshAgent ì»´í¬ë„ŒíŠ¸ ê°€ì ¸ì˜¤ê¸°
        animator = GetComponent<Animator>(); // Zombieì˜ Animator ì»´í¬ë„ŒíŠ¸ ê°€ì ¸ì˜¤ê¸°
        audioPlayer = GetComponent<AudioSource>(); // Zombieì˜ AudioSource ì»´í¬ë„ŒíŠ¸ ê°€ì ¸ì˜¤ê¸°
        skinRenderer = GetComponentInChildren<Renderer>();  // Zombieì˜ ìì‹ ì˜¤ë¸Œì íŠ¸ë“¤ ì¤‘ì—ì„œ Rederer ì»´í¬ë„ŒíŠ¸ë¥¼ ê°€ì§„ ì˜¤ë¸Œì íŠ¸ë¥¼ Reneerer íƒ€ì…ìœ¼ë¡œ ê°€ì ¸ì˜¤ê¸°

        // 
        attackDistance = Vector3.Distance(transform.position, new Vector3(attackRoot.position.x, transform.position.y, attackRoot.position.z)) + attackRadius;

        attackDistance += agent.radius;

        agent.stoppingDistance = attackDistance;
        agent.speed = patrolSpeed;
    }
```

- `skinRenderer`
  - Zombieì˜ ìì‹ ì˜¤ë¸Œì íŠ¸ë“¤ ì¤‘ì—ì„œ Rederer ì»´í¬ë„ŒíŠ¸ë¥¼ ê°€ì§„ ì˜¤ë¸Œì íŠ¸ë¥¼ Reneerer íƒ€ì…ìœ¼ë¡œ ê°€ì ¸ì˜¤ê¸°
  - ì¢€ë¹„ì˜ ìƒ‰ìƒ(Renderer)ëŠ” ë°”ë¡œ `Zombie`ì˜ ì»´í¬ë„ŒíŠ¸ë¡œ ì¶”ê°€ë˜ëŠ”ê²Œ ì•„ë‹ˆë¼ `Zombie`ì˜ ìì‹ ì˜¤ë¸Œì íŠ¸ì¸ `LowMan`ì— **Skinned Mesh Renderer**ë¡œ ë¶™ì–´ ìˆê¸° ë•Œë¬¸ì— GetComponentInChildren í•¨ìˆ˜ë¡œ ê°€ì ¸ì˜¤ëŠ” ê²ƒì´ë‹¤.
- `attackDistance` ê³µê²©ì„ ì‹œë„í•˜ëŠ” ê±°ë¦¬ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë©¤ë²„ ë³€ìˆ˜. í”Œë ˆì´ì–´ì™€ ì  ì‚¬ì´ì˜ ê±°ë¦¬ê°€ `attackDistance`ë³´ë‹¤ ì‘ê±°ë‚˜ ê°™ë‹¤ë©´ ì ì´ í”Œë ˆì´ì–´ì—ê²Œ ê³µê²©ì„ ì‹œë„.
  - ![image](https://user-images.githubusercontent.com/42318591/91799399-eb301080-ec61-11ea-9f28-5bc540e64a5f.png){: width="70%" height="70%"}{: .align-center}
  - `transform.position` ì (ì¢€ë¹„ì¸ ìê¸° ìì‹ )ì˜ ìœ„ì¹˜ë¡œë¶€í„°
  - ê³µê²© ë°˜ê²½ ì¤‘ì‹¬ì ì´ ë˜ëŠ” `attackRoot` ì‚¬ì´ì˜ ê±°ë¦¬ì—ë‹¤ê°€ 
    - ì ì˜ Trnasformì€ ì ì˜ ë°œì„ ê¸°ì¤€ìœ¼ë¡œ í•˜ê¸° ë•Œë¬¸ì— `attackRoot`ê°€ `transform.position`ë³´ë‹¤ ë” ë†’ì´ ìœ„ì¹˜í•œë‹¤.
    - ìˆ˜í‰ ë°©í–¥ìœ¼ë¡œë§Œ ë”°ì§ˆê±°ë¼ì„œ ë°”ë¡œ `transform.position`ì™€ `attackRoot` ì‚¬ì´ì˜ ê±°ë¦¬ë¥¼ ë°”ë¡œ êµ¬í•˜ëŠ”ê²Œ ì•„ë‹ˆë¼ x, z ìœ„ì¹˜ê°’ì€ `attackRoot`ë¥¼ ë”°ë¥´ê³  y ìœ„ì¹˜ê°’ì€ `transform.position`ì™€ ì¼ì¹˜í•œ ë²¡í„°ë¥¼ ë”í•´ì¤€ë‹¤.
  - ì´ ê±°ë¦¬ì— ê³µê²© ë°˜ê²½(`attackRadius`)ì„ ë”í•´ì£¼ë©´ `attackDistance` ì™„ì„±
- `stoppingDistance` 
  - ğŸ‘‰ NavMeshAgentì˜ ë³€ìˆ˜ë¡œ AI Agentê°€ ë„ì°©ì§€ë¡œë¶€í„° ì´ `stoppingDistance` ê°’ì˜ ê±°ë¦¬ë‚´ì— ë“¤ë©´ ì†ë„ë¥¼ ê°ì†í•˜ì—¬ ì„œì„œíˆ ë©ˆì¶˜ë‹¤. ì¦‰ AIê°€ ëª©í‘œë¥¼ ì¶”ì í•˜ë‹¤ê°€ ëª©í‘œ ìœ„ì¹˜ì— ê°€ê¹Œì›Œì¡Œì„ì‹œ ì •ì§€í•˜ëŠ” ê·¼ì ‘ ê±°ë¦¬.
  - ì¢€ë¹„ê°€ í”Œë ˆì´ì–´ë¥¼ ë§‰ ì¶”ì í•˜ë‹¤ê°€ ê³µê²© ì‚¬ì •ê±°ë¦¬(`attackDistance`) ì•ˆì— ë“¤ë©´ í”Œë ˆì´ì–´ë¥¼ ê³µê²©í•´ì•¼ í•œë‹¤. ì´ ë•Œ í”Œë ˆì´ì–´ì—ê²Œ ê³µê²© í–‰ë™ì„ í•˜ê¸° ìœ„í•´ì„  ì¢€ë¹„ê°€ ë©ˆì¶°ì•¼ í•œë‹¤. ì¢€ë¹„ê°€ ë©ˆì¶”ê³  ê³µê²©ì„ í•´ì•¼ í•¨. ë”°ë¼ì„œ  `stoppingDistance`ì„ `attackDistance`ë¡œ ì´ˆê¸°í™” í•´ë‘ .
- `speed`
  - ğŸ‘‰ NavMeshAgentì˜ ë³€ìˆ˜ë¡œ AI Agentê°€ ëª©í‘œ(í”Œë ˆì´ì–´)ë¥¼ ì¶”ì í•˜ëŠ” ì†ë„
  - ì²˜ìŒì—” ìˆœì°° ì†ë„ë¡œ ì´ˆê¸°í™” *agent.speed = patrolSpeed*


<br>

#### public void Setup(float health, float damage, float runSpeed, float patrolSpeed, Color skinColor)

> `Zombie`ê°€ ìƒì„±ë  ë•Œ, `Zombie`ì˜ ìŠ¤í™(ì²´ë ¥, ê³µê²©ë ¥, ë›°ëŠ” ì†ë„, ì •ì°° ì†ë„, ìƒ‰ê¹”)ì„ ê²°ì •í•´ì¤€ë‹¤.

- ì¸ìˆ˜ëŠ” ë‚˜ì¤‘ì— ìŠ¤í¬ë„ˆì—ì„œ ê²°ì •í•  ê²ƒì´ë‹¤.
- ì´ í•¨ìˆ˜ì˜ ì—­í• ì€ ë“¤ì–´ì˜¨ ì¸ìˆ˜ë¡œ `Zombie`ì˜ ìŠ¤í™ì„ ì„¤ì •í•˜ëŠ” ì—­í• ë§Œ ìˆ˜í–‰.

```c#
    // ì  AIì˜ ì´ˆê¸° ìŠ¤í™ì„ ê²°ì •í•˜ëŠ” ì…‹ì—… ë©”ì„œë“œ
    public void Setup(float health, float damage,
        float runSpeed, float patrolSpeed, Color skinColor)
    {
        // ì²´ë ¥ ì„¤ì •
        this.startingHealth = health; // ì´ˆê¸° ì‹œì‘ ì²´ë ¥
        this.health = health;  // ì²´ë ¥

        // ë‚´ë¹„ë©”ì‰¬ ì—ì´ì „íŠ¸ì˜ ì´ë™ ì†ë„ ì„¤ì •
        this.runSpeed = runSpeed;
        this.patrolSpeed = patrolSpeed;

        this.damage = damage;  // ê³µê²©ë ¥

        // ë Œë”ëŸ¬ê°€ ì‚¬ìš©ì¤‘ì¸ ë¨¸í…Œë¦¬ì–¼ì˜ ì»¬ëŸ¬ë¥¼ ë³€ê²½, ì™¸í˜• ìƒ‰ì´ ë³€í•¨
        skinRenderer.material.color = skinColor;

        agent.speed = patrolSpeed; // ìœ„ì—ì„œ ë³€ê²½ëœ patrolSpeedë¡œ ë‹¤ì‹œ ì ìš©
    }
```

<br>

#### private void Start()

```c#
    private void Start()
    {
        // ê²Œì„ ì˜¤ë¸Œì íŠ¸ í™œì„±í™”ì™€ ë™ì‹œì— AIì˜ ì¶”ì  ë£¨í‹´ ì‹œì‘
        StartCoroutine(UpdatePath());
    }
```

- ê²Œì„ì´ ì‹œì‘ë˜ìë§ˆì **private IEnumerator UpdatePath()** í•¨ìˆ˜ë¥¼ ì½”ë£¨í‹´ìœ¼ë¡œ ì‹¤í–‰ì‹œí‚¤ê³  ìˆë‹¤.
  - [ë°‘ì— ì°¸ê³ ](#private-ienumerator-updatepath)

<br>

#### private void Update()

> ë§¤ í”„ë ˆì„ë§ˆë‹¤ ì¶”ì  ëŒ€ìƒê³¼ì˜ ê±°ë¦¬ë¥¼ ë”°ì ¸ì„œ ê³µê²©ì„ ì‹¤í–‰í• ì§€ ê²€ì‚¬í•˜ê³  í˜„ì¬ ìƒíƒœì— ë”°ë¼ ì¬ìƒí•  ì• ë‹ˆë©”ì´ì…˜ì„ ê²°ì •í•œë‹¤.

```c#
    private void Update()
    {
        if (dead) return;

        // ì¶”ì  ëŒ€ìƒê³¼ì˜ ê±°ë¦¬ë¥¼ ë”°ì ¸ì„œ ê³µê²©ì„ ì‹¤í–‰í• ì§€ ê²€ì‚¬
        if (state == State.Tracking &&
            Vector3.Distance(targetEntity.transform.position, transform.position) <= attackDistance)
        {
            BeginAttack();
        }


        // ì¶”ì  ëŒ€ìƒì˜ ì¡´ì¬ ì—¬ë¶€ì— ë”°ë¼ ë‹¤ë¥¸ ì• ë‹ˆë©”ì´ì…˜ì„ ì¬ìƒ
        animator.SetFloat("Speed", agent.desiredVelocity.magnitude);
    }
```

- `Zombie`ê°€ ì£½ì—ˆë‹¤ë©´ Update í•¨ìˆ˜ ì¢…ë£Œ
- ë§¤ í”„ë ˆì„ë§ˆë‹¤ ì¶”ì  ëŒ€ìƒê³¼ì˜ ê±°ë¦¬ë¥¼ ë”°ì ¸ì„œ <u>ê³µê²©ì„ ì‹¤í–‰í• ì§€ ê²€ì‚¬</u>
  - ì¶”ì  ìƒíƒœ + ì¶”ì  ëŒ€ìƒê³¼ ë‚˜ ì‚¬ì´ì˜ ê±°ë¦¬ê°€ ê³µê²© ì‚¬ì •ê±°ë¦¬ ì´í•˜ë¼ë©´ 
    - ğŸ‘‰ ê³µê²©í•˜ê¸° ! `BeginAttack()` ê³µê²©ì„ ì‹œì‘í•˜ëŠ” ë©”ì†Œë“œ
      - ì´ê³¼ ë‹¤ë¥´ê²Œ ì§ì ‘ ê³µê²©ì„ í•˜ëŠ” ëª¨ì…˜ì€ ì‹œì‘ê³¼ ëì´ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì— ê³µê²©ì„ ì‹œì‘í•˜ëŠ” ë©”ì†Œë“œ, ëë‚´ëŠ” ë©”ì†Œë“œ ë”°ë¡œ ì§€ì •í•´ì•¼ í•œë‹¤.
- ë§¤ í”„ë ˆì„ë§ˆë‹¤ í˜„ì¬ ìƒíƒœì— ë”°ë¼ <u>ì¬ìƒí•  ì• ë‹ˆë©”ì´ì…˜ì„ ê²°ì •</u>
  - ì• ë‹ˆë©”ì´ì…˜ì— ë„˜ê¸¸ ì†ë„ íŒŒë¼ë¯¸í„°("Speed") ê°’ìœ¼ë¡œëŠ” `agent.desiredVelocity.magnitude`
    - NavMeshAgent(ì¢€ë¹„)ì˜ `desiredVelocity`ì€ ìŒ ëª©ì ì§€ë¡œ í–¥í•˜ëŠ” ëª©í‘œ ì†ë„ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. ì‹¤ì œ ì†ë„ëŠ” ì•„ë‹˜! í˜„ì¬ ì†ë„ë¡œ ì„¤ì •í•˜ê³  ì‹¶ì€ ì›í•˜ëŠ” ì†ë„ ê°’. `desiredVelocity` ì†ë„ë¡œ ì›€ì§ì´ê²Œ í•˜ê³  ì‹¶ì§€ë§Œ ì‹¤ì œë¡  ê´€ì„±ì´ë‚˜ ì–´ë–¤ ì¥ì• ë¬¼ì— ì˜í•´ ì‹¤ì œ ì†ë„ì™€ëŠ” ì°¨ì´ê°€ ë‚  ìˆ˜ ìˆë‹¤.
      - ì˜ˆë¥¼ ë“¤ì–´ ìš°ë¦¬ê°€ ì›í•˜ëŠ” ì†ë„ê°€ 50ì¸ë° í˜„ì¬ ìºë¦­í„°ê°€ ì¥ì• ë¬¼ì— ë§‰í˜€ ì œìë¦¬ì—ì„œ ë›°ê³  ìˆë‹¤ë©´ ì†ë„ëŠ” ì‹¤ì œë¡œëŠ” 0 ì´ë‹¤.
      - ì´ë™í•˜ë ¤ê³  í•˜ëŠ” ì†ë„ê°€ ì•„ë‹ˆë¼ ì‹¤ì œ ì´ë™ ì†ë„ë¥¼ ì ìš©í•˜ê³  ì‹¶ë‹¤ë©´ ê·¸ëƒ¥ `agent.velocity`
    - ê·¸ ì†ë„ì˜ `magnitude` ìŠ¤ì¹¼ë¼ í¬ê¸°.

<br>

#### private void FixedUpdate()

- Fixedupdate()
  - <u>Update()ì²˜ëŸ¼ ë§¤ë²ˆ ë°˜ë³µ ì‹¤í–‰</u>ë˜ë‚˜ í”„ë ˆì„ì— ê¸°ë°˜í•˜ì§€ ì•Šê³  ì–´ë–¤ ê³ ì •ì ì´ê³  ë™ì¼í•œ ì‹œê°„ì— ê¸°ë°˜í•˜ì—¬ ì‹¤í–‰ëœë‹¤.
    - ê¸°ë³¸ì ìœ¼ë¡œ 0.02ì´ˆë§ˆë‹¤ ì‹¤í–‰ë¨.
  - í”„ë ˆì„ í™˜ê²½ì— ìƒê´€ì—†ì´ ë¬´ì¡°ê±´ ì‹¤í–‰ íšŸìˆ˜ë¥¼ ì§€í‚¨ë‹¤.

```c#
    private void FixedUpdate()
    {
        if (dead) return;


        if (state == State.AttackBegin || state == State.Attacking)
        {
            var lookRotation =
                Quaternion.LookRotation(targetEntity.transform.position - transform.position);
            var targetAngleY = lookRotation.eulerAngles.y;

            transform.eulerAngles = Vector3.up * Mathf.SmoothDampAngle(transform.eulerAngles.y, targetAngleY,
                                        ref turnSmoothVelocity, turnSmoothTime);
        }

        if (state == State.Attacking)
        {
            var direction = transform.forward;
            var deltaDistance = agent.velocity.magnitude * Time.deltaTime;

            var size = Physics.SphereCastNonAlloc(attackRoot.position, attackRadius, direction, hits, deltaDistance,
                whatIsTarget);

            for (var i = 0; i < size; i++)
            {
                var attackTargetEntity = hits[i].collider.GetComponent<LivingEntity>();

                if (attackTargetEntity != null && !lastAttackedTargets.Contains(attackTargetEntity))
                {
                    var message = new DamageMessage();
                    message.amount = damage;  // ê³µê²©ì–‘
                    message.damager = gameObject;  // ê³µê²©ì„ ê°€í•˜ëŠ” ì‚¬ëŒì€ ì¢€ë¹„ ìê¸° ìì‹ 

                    // ê³µê²©ì´ ë“¤ì–´ê°„ ì§€ì 
                    if(hits[i].distance <= 0f)
                    {
                        message.hitPoint = attackRoot.position;
                    }
                    else
                    {
                        message.hitPoint = hits[i].point;
                    }

                    // ê³µê²©ì´ ë“¤ì–´ê°€ëŠ” ë°©í–¥
                    message.hitNormal = hits[i].normal;

                    attackTargetEntity.ApplyDamage(message);

                    // ì´ë¯¸ ê³µê²©ì„ ê°€í•œ ìƒëŒ€ë°©ì´ë¼ëŠ” ëœ»ì—ì„œ
                    lastAttackedTargets.Add(attackTargetEntity);
                    
                    break;  // ê³µê²© ëŒ€ìƒì„ ì°¾ì•˜ìœ¼ë‹ˆ forë¬¸ ì¢…ë£Œ
                }
            }
        }
    }
```

> í˜„ì¬ ìƒíƒœì— ë”°ë¼ì„œ ê³µê²© ë²”ìœ„ì— ê²¹ì¹œ ìƒëŒ€ë°©ì˜ Colliderë¥¼ í†µí•´ <u>ìƒëŒ€ë°©ì„ ê°ì§€í•˜ê³  ë°ë¯¸ì§€ë¥¼ ì£¼ëŠ” ì²˜ë¦¬ë¥¼ í•  ê²ƒì´ë‹¤.</u>

- `Zombie`ê°€ ì£½ì—ˆë‹¤ë©´ FixedUpdate í•¨ìˆ˜ ì¢…ë£Œ
- ì´ì œ ë§‰ ê³µê²©ì„ ì‹œì‘í•˜ëŠ” ìƒíƒœ(`AttackBegin`)ì´ê±°ë‚˜ ê³µê²©ì´ í•œì°½ ì´ë£¨ì–´ì§€ëŠ” ì¤‘(`Attacking`)ì—ëŠ” ë‚˜(ì¢€ë¹„) ìì‹ ì´ <u>íšŒì „ê°’ì„ íƒ€ê²Ÿì„ í–¥í•œ ë°©í–¥ìœ¼ë¡œ ë³€ê²½í•œë‹¤. ì¦‰, ì¢€ë¹„ê°€ ê³µê²©í•˜ëŠ” ëŒ€ìƒì¸ íƒ€ê²Ÿì„ í–¥í•˜ì—¬ ë³´ë„ë¡</u>
  - `lookRotation` ğŸ‘‰ í˜„ì¬ `Zombie`ê°€ ë°”ë¼ë³´ê³  ìˆëŠ” ë°©í–¥
    - *Quaternion.LookRotation(targetEntity.transform.position - transform.position, Vector3.up);*
      - ì¸ìˆ˜ë¡œ ë„£ì€ Vector3 ì˜ ë°©í–¥ì„ ë°”ë¼ë³´ê²Œë” íšŒì „í•œ ê°’
      - ì¸ìˆ˜ ğŸ‘‰ (íƒ€ê²Ÿ ìœ„ì¹˜ - ìê¸° ìì‹ ì˜ ìœ„ì¹˜ = **íƒ€ê²Ÿì„ ë°”ë¼ë³´ëŠ” ë°©í–¥**)
  - `targetAngleY` ğŸ‘‰ í˜„ì¬ `Zombie`ê°€ ë°”ë¼ë³´ê³  ìˆëŠ” ë°©í–¥ìœ¼ë¡œ LookRotation í•  ë•Œ y ì¶• íšŒì „ ë°©í–¥.
    - *targetAngleY = lookRotation.eulerAngles.y;*
      - `eulerAngles`ëŠ” ì¿¼í„°ë‹ˆì–¸(`lookRotation`)ì„ ì˜¤ì¼ëŸ¬ê°ìœ¼ë¡œ ë³€í™˜ì‹œí‚¨ë‹¤. ì¦‰ Vector3ë¡œ ë³€í™˜í•œë‹¤.
      - xì¶•, zì¶• ì¦‰ í‰ë©´ì˜ íšŒì „ ê°’ë§Œ ë³€í•˜ëŠ” y ì¶• ì¤‘ì‹¬ì˜ íšŒì „ ë°©í–¥ë§Œ ê³ ë ¤í•  ê²ƒ
  - ë‚´ Vector3 íšŒì „ ê°’(`transform.eulerAngles`)ì„ `Vector3.up * targeAngleY`ë¡œ ì„¤ì •í•´ì£¼ë©´ ë˜ëŠ”ë°, ì´ë¥¼ ìŠ¤ë¬´ìŠ¤ í•˜ê²Œ ì„¤ì •í•˜ì. `transform.eulerAngles.y` ê°’ì´ `targetAngleY`ë¡œ ìŠ¤ë¬´ìŠ¤ í•˜ê²Œ ë³€í•  ìˆ˜ ìˆë„ë¡.
    - *Mathf.SmoothDampAngle(transform.eulerAngles.y, targetAngleY, ref turnSmoothVelocity, turnSmoothTime);*
- ê³µê²©ì´ ì‹¤í–‰ë˜ìë§ˆì ë°”ë¡œ ê³µê²© ì²˜ë¦¬ê°€ ë“¤ì–´ê°€ê²Œ í•˜ì§€ ì•Šê³  ê³µê²© ì• ë‹ˆë©”ì´ì…˜ì´ ëë‚˜ê°ˆë•Œ, ì¦‰ ì¢€ë¹„ê°€ ê³µê²©í•˜ê¸° ìœ„í•´ íŒ”ì„ ë»—ëŠ” ì• ë‹ˆë©”ì´ì…˜ì„ ì¶©ë¶„íˆ ë‹¤ ì·¨í•˜ê³ ë‚œ í›„ì— ê³µê²© ì²˜ë¦¬ë¥¼ í•  ê²ƒì´ë‹¤. 
  - ë”°ë¼ì„œ `AttackBegin` ìƒíƒœì—ëŠ” ê³µê²© ì• ë‹ˆë©”ì´ì…˜ì„ ì¬ìƒí•˜ê³  í•œì°½ ê³µê²© ì• ë‹ˆë©”ì´ì…˜ì´ ì¶©ë¶„íˆ ì¬ìƒë˜ê³  ë‚œ í›„ì¸ `Attacking` ìƒíƒœì¼ ë•Œ ê³µê²© ì²˜ë¦¬(ê°ì§€í•˜ê³  ë°ë¯¸ì§€ ì£¼ê¸° ë“±ë“±)ë¥¼ í•  ê²ƒì´ë‹¤.
    - *if (state == `State.Attacking`)* ê³µê²© ì²˜ë¦¬ ì‹œì‘
      - 1ï¸âƒ£ `attackRoot` ì¤‘ì‹¬ìœ¼ë¡œ êµ¬ë¥¼ ê·¸ë ¤ì„œ í•´ë‹¹ êµ¬ì— ê²¹ì¹˜ëŠ” Colliderë“¤ì„ ê°ì§€. 
        - â­ ë‹¨, **Physics.OverlapSphere** í•¨ìˆ˜ë¡œ  Colliderë¥¼ ê°ì§€ í•˜ì§€ ì•Šê³  **Physics.SphereCastNonAlloc** í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ê²ƒì´ë‹¤.
          - **Physics.OverlapSphere** í•¨ìˆ˜
            - ![image](https://user-images.githubusercontent.com/42318591/92209296-b8875180-eec7-11ea-8fb3-9c20ab7d623c.png){: width="70%" height="70%"}{: .align-center}
            - ì‹¤í–‰ê³¼ ì‹¤í–‰ ê·¸ ì‚¬ì´(ë‹¤ìŒ FixedUpdate())ì˜ ìˆœê°„ì—ì„œ ì¢€ë¹„ë‚˜ ê³µê²© ëŒ€ìƒì´ ë„ˆë¬´ ë¹ ë¥´ê²Œ ì›€ì§ì—¬ë²„ë ¤ì„œ ê°ì§€ê°€ ëì–´ì•¼ ë§ëŠ”ë° ê·¸ë¦¼ì²˜ëŸ¼ ê°ì§€ê°€ ì•ˆë˜ëŠ” ìƒí™©ì´ ìƒê¸¸ ìˆ˜ ìˆë‹¤.
            - `Collider []` ë°°ì—´ì„ ë¦¬í„´í•œë‹¤.
          - **Physics.SphereCastNonAlloc** í•¨ìˆ˜
            - ![image](https://user-images.githubusercontent.com/42318591/92210583-f5544800-eec9-11ea-9da2-403c5f25d02e.png){: width="70%" height="70%"}{: .align-center}
            - ìœ„ì™€ ê°™ì€ ìƒí™©ì„ ë°©ì§€í•˜ê³ ì Physics.SphereCastNonAlloc í•¨ìˆ˜ë¥¼ ì“¸ ê²ƒì´ë‹¤. 
              - ì´ í•¨ìˆ˜ëŠ” ì¸ìˆ˜ë¡œ ë°©í–¥ê³¼ ê±°ë¦¬ë¥¼ ë„˜ê²¨ì£¼ë©´ êµ¬ê°€ í•´ë‹¹ ë°©í–¥ê³¼ ê±°ë¦¬ë¡œ <u>ì´ë™í•œ âœ¨ê¶¤ì âœ¨ì— ê²¹ì¹˜ëŠ” Colliderê°€ ìˆëŠ”ì§€ë¥¼ ê²€ì‚¬í•œë‹¤.</u> ì´ê²Œ ë°”ë¡œ <u>Castê³„ì—´ í•¨ìˆ˜ë“¤ì˜ íŠ¹ì„±</u>
            - `Collider`ê°€ ë“¤ì–´ìˆëŠ” ê²ƒì´ ì•„ë‹Œ `Raycast`ì— ê±¸ë¦° ì›ì†Œë“¤ì´ ë“¤ì–´ ìˆëŠ” `hit` ë°°ì—´ì˜ í¬ê¸°ë¥¼ ë¦¬í„´í•œë‹¤.
        - `direction` ğŸ‘‰ ì¢€ë¹„ê°€ ë³´ëŠ” ì•ìª½ ë°©í–¥ `transform.forward`
        - `deltaDistance` ğŸ‘‰ ì¢€ë¹„(AI agent)ê°€ ë‹¤ìŒ FixedUpdate() ì‹¤í–‰ê¹Œì§€ì˜ ì‚¬ì‡ ì‹œê°„ì¸ `Time.fixedDeltaTime` ë™ì•ˆ ì´ë™í•œ ê±°ë¦¬(ìŠ¤ì¹¼ë¼)ê°€ ëœë‹¤. (ì†ë„ í¬ê¸°ë¥¼ ê³±í•´ì£¼ë©´ ë¨!)
          - ê·¸ëŸ°ë° `Time.fixedDeltaTime`ê°€ ì•„ë‹Œ `Time.deltaTime`ì„ ì“´ ì´ìœ ëŠ” [ë°‘ì— ì°¸ê³ ](#timefixeddeltatime)
        - `size` ğŸ‘‰ Physics.SphereCastNonAlloc í•¨ìˆ˜ì˜ ë¦¬í„´ê°’ìœ¼ë¡œ `hit` ë°°ì—´ì˜ í¬ê¸°. ì¦‰, êµ¬ ê¶¤ì ì— ê±¸ë¦° ëª¨ë“  RaycastHit ë“¤ì´ ëª‡ê°œì¸ì§€ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. 
          - ì–´ì°¨í”¼ ê°ì§€ë  í”Œë ˆì´ì–´ëŠ” í•œëª…ì¸ë° `size`ê°€ 1 ë³´ë‹¤ í´ ìˆ˜ ìˆëŠ” ì´ìœ . ì¦‰ `RaycastHi` ê²°ê³¼ ì¶©ëŒí•œ Colliderë“¤ì´ ì—¬ëŸ¬ê°œì¼ ìˆ˜ ìˆëŠ” ì´ìœ  
            - í”Œë ˆì´ì–´ëŠ” í•œëª…ì´ì§€ë§Œ `Ray` ì¶©ëŒ í¬ì¸íŠ¸ëŠ” ë‹¤ìˆ˜ê°€ ì¡´ì¬í•  ìˆ˜ ìˆë‹¤.
            - í”Œë ˆì´ì–´ëŠ” í•˜ë‚˜ë¼ë„ í”Œë ˆì´ì–´ì—ê²Œ í• ë‹¹ëœ ì½œë¼ì´ë”ëŠ” ì—¬ëŸ¬ê°œê°€ ì¡´ì¬í•  ìˆ˜ ìˆìœ¼ë©° ë˜í•œ í”Œë ˆì´ì–´ë‘ ë¶€ë”ªì¹˜ëŠ” ë¬¼ì²´ë„ ì—¬ëŸ¬ê°œê°€ ì¡´ì¬í•  ìˆ˜ ìˆë‹¤.
          - Physics.SphereCastNonAlloc í•¨ìˆ˜ì— ëŒ€í•œ ìì„¸í•œ ì„¤ëª…ì€ [ë°”ë¡œ ì•„ë˜](#physicsspherecastnonalloc-í•¨ìˆ˜ì˜-íŠ¹ì§•)ì— í•„ê¸°í•¨
      - 2ï¸âƒ£ ê°ì§€ëœ ê²ƒë“¤ì´ ëª¨ì—¬ìˆëŠ” `hit` ë°°ì—´ì—ì„œ `Player Character`ì¸ ê²ƒ(`whatIsTarget` ë ˆì´ì–´ì—ë‹¤ê°€ `LivingEntity`ë¥¼ ê°€ì§€ê³  ìˆëŠ” ê²ƒ)ì„ forë¬¸ìœ¼ë¡œ ìˆœíšŒí•˜ë©° ì°¾ì•„ ê³µê²©ì„ ì²˜ë¦¬í•´ì¤€ë‹¤. ì°¾ìœ¼ë©´ ìˆœíšŒ ëëƒ„ break
        - `hit.size()`ë§Œí¼ ëŒë©´ ì•ˆë˜ê³  `size`ë§Œí¼ë§Œ ëŒì•„ì•¼ í•œë‹¤. ë§Œì•½ ì¶©ëŒì²´ë“¤ì´ 3 ê°œì˜€ë‹¤ë©´ `hit` ë°°ì—´ í¬ê¸°ëŠ” 10ì´ë¯€ë¡œ (ë©¤ë²„ ë³€ìˆ˜ ì„ ì–¸ ë•Œ 10 í¬ê¸°ë¡œ ì„ ì–¸í–ˆì—ˆë‹¤) 3 ê°œì˜ ì¶©ëŒì²´ì™€ í•¨ê»˜ ê·¸ ë’¤ì˜ 7 ê°œëŠ” ì´ì „ í”„ë ˆì„ì˜ ì¶©ëŒì²´ ì •ë³´ë¥¼ ë‹´ê³  ìˆê²Œ ëœë‹¤. ë”°ë¼ì„œ 10 ë§Œí¼ ëŒë©´ ì•ˆë˜ê³  ë”± 3 ë§Œí¼ìœ¼ë¡œ ë°˜ë³µë¬¸ì„ ëŒì•„ì•¼ í•¨!
        - <u>ê°ì§€ëœ ê²ƒë“¤ ì¤‘ `LivingEntity`ì´ë©° lastAttackedTargets ë¦¬ìŠ¤íŠ¸ì— ì†Œì†ë˜ëŠ” ê²ƒì´ ì•„ë‹Œ ê²½ìš°(ê³µê²© ë„ì¤‘ì— ë˜ ê³µê²©ì´ ë“¤ì–´ê°€ë©´ ì•ˆë˜ë¯€ë¡œ)ì—ë§Œ ê³µê²© ì²˜ë¦¬ë¥¼ í•´ì•¼ í•œë‹¤.</u>
          - ê³µê²©ëŸ‰, ê³µê²©í–‰ìœ„ì(ìê¸°ìì‹ ), ê³µê²©ê±°ë¦¬, ê³µê²©ë°©í–¥ ë“±ì„ `message`ì— ì„¤ì •í•œ í›„ ê³µê²©ì„ ê°œì‹œí•œë‹¤.
          - `lastAttackedTargets`ë¦¬ìŠ¤íŠ¸ì— ê³µê²©ëŒ€ìƒì„ ì¶”ê°€í•´ì¤€ë‹¤.
          

##### Physicsì˜ Castê³„ì—´ í•¨ìˆ˜ì˜ íŠ¹ì§•

> [ì°¸ê³  ë¸”ë¡œê·¸](https://wergia.tistory.com/74)

- ìœ ë‹ˆí‹°ì—ì„œ Colliderë¥¼ ì°¾ì•„ë‚´ëŠ” ë°©ë²•ì€ í¬ê²Œ 4 ê°€ì§€ê°€ ìˆë‹¤. `Ray`, `Box`, `Sphere`, `Capsule` ë“±ë“± ì´ëŸ° í˜•íƒœì˜ Collider ì»´í¬ë„ŒíŠ¸ë¥¼ ì˜¤ë¸Œì íŠ¸ì— ë‹¬ì•„ì„œ OnTriggerë‚˜ OnCollision ê°™ì€ ì´ë²¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ í•´ë‹¹ í˜•íƒœì— ê²¹ì¹˜ëŠ” Colliderë¥¼ ì°¾ì•„ë‚´ê¸°ë„ í•œë‹¤.
  - ê·¸ëŸ¬ë‚˜ ì´ëŸ° ë°©ë²•ì˜ ê²½ìš° ë§¤ í”„ë ˆì„ ì‹¤í–‰ë˜ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— ìˆœê°„ì ìœ¼ë¡œ ë”± í•œë²ˆë§Œ Colliderë¥¼ ì°¾ì•„ë‚´ë ¤ê³  í•˜ëŠ” ê²½ìš°ì—ëŠ” ì„±ëŠ¥ìƒ ë¶€ì ì ˆí•  ìˆ˜ ìˆë‹¤. ë§¤ í”„ë ˆì„ ì‹¤í–‰ë˜ë¯€ë¡œ ì ë‹¹íˆ ëª¨ì–‘ì„ ìœ ì§€í•˜ëŠ” ê²½ìš°ì—ëŠ” ì‚¬ìš©í•˜ê¸° ê´œì°®ì§€ë§Œ ê·¸ ìˆœê°„ì˜ ê²¹ì¹˜ëŠ” Colliderë¥¼ ì¡ì•„ë‚´ì•¼ í•˜ëŠ” ê²½ìš°ì—ëŠ” í˜ë“¤ê¸° ë•Œë¬¸!   
- **Physicsì˜ Castê³„ì—´ í•¨ìˆ˜** ë“¤ì€ ì›€ì§ì´ë ¤ëŠ” ê¶¤ì ì— ì¶©ëŒí•˜ëŠ”ì§€ë¥¼ ê²€ì‚¬í•˜ê¸° ë•Œë¬¸ì— ìœ„ì™€ê°™ì´ í”„ë ˆì„ê°„ ì‚¬ì´ì—ì„œ ë¹ ë¥´ê²Œ ë³€í™”í•˜ì—¬ ê°ì§€ë˜ì§€ ëª»í•  ìˆ˜ ìˆëŠ” ê²ƒë“¤ë„ ê°ì§€í•  ìˆ˜ ìˆë„ë¡ í•´ì¤€ë‹¤.
  - ì¢…ë¥˜
    - `Cast` 
      - ğŸ‘‰ ì°¾ì•„ë‚¸ ì¶©ëŒì²´ í•˜ë‚˜ë§Œì„ êµ¬ì¡°ì²´ë¡œ ë°˜í™˜í•œë‹¤. ê°€ì¥ ì²˜ìŒì— ì¶©ëŒí•œ ë¬¼ì²´ë§Œ ë°˜í™˜í•œë‹¤.
    - `CastAll` 
      - ğŸ‘‰ ì°¾ì•„ë‚¸ ì¶©ëŒì²´ ì „ë¶€ë¥¼ ë¦¬í„´í•œë‹¤. `RaycastHit []` ë°°ì—´ë¡œ ë¦¬í„´í•œë‹¤.
    - `CastNonAlloc` 
      - ğŸ‘‰ ì¶©ëŒì²´ë“¤ì„ ë¦¬í„´ì´ ì•„ë‹Œ ì¸ìˆ˜ë¡œ ë„˜ê¸´ `RaycastHit` ë°°ì—´ì— ë‹´ì•„ì¤€ë‹¤. ë”°ë¼ì„œ `CastAll`ë³´ë‹¤ëŠ” ì„±ëŠ¥ì´ ë” ì¢‹ì„ ìˆ˜ ìˆë‹¤. ë‹¤ë§Œ ì°¾ì•„ë‚¸ ì¶©ëŒì²´ë“¤ì˜ ìˆ˜ê°€ ì¸ìˆ˜ë¡œ ë„˜ê¸´ ë°°ì—´ì˜ ì‚¬ì´ì¦ˆë³´ë‹¤ ì ì„ ìˆ˜ë„ ë§ì„ ìˆ˜ë„ ìˆë‹¤ëŠ” ê²ƒì— ì£¼ì˜í•˜ì—¬ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
        - ì§ì „ í”„ë ˆì„ê¹Œì§€ ì–´ë–¤ `RaycastHit` ì •ë³´ê°€ ìˆì—ˆëŠ”ì§€ë¥¼ ì•Œ ìˆ˜ ìˆë‹¤.
      - ë¦¬í„´ì€ `int`ë¡œ ì¸ìˆ˜ë¡œ ë„˜ê¸´ ë°°ì—´ì´ ì±„ì›Œì§„ ì‚¬ì´ì¦ˆ, ì¦‰ ì¶©ëŒì²´ë“¤ì˜ ê°œìˆ˜ë¥¼ ë¦¬í„´í•œë‹¤.
  - <u>ì›€ì§ì´ë ¤ê³  í•˜ìë§ˆì, ì¦‰ ê¶¤ì ì„ ê·¸ë¦¬ê¸°ë„ ì „ì— ë°”ë¡œ Colliderê°€ ê±¸ë¦° ìƒíƒœë¼ë©´ ì²«ë²ˆì§¸ë¡œ ê°ì§€ëœ ì´ Colliderì˜ pointëŠ” ì œë¡œ í¬ì¸íŠ¸ë‹¤.</u>
    - ê°€ìƒì˜ êµ¬ *(SphereCastNonAllocì„ ì˜ˆë¡œ ë“¤ìë©´)* ê°€ ì›€ì§ì´ê¸°ë„ ì „ì— ì²˜ìŒë¶€í„° ê²¹ì³ìˆì—ˆë˜ ê²ƒ(`hits[0]`)ì´ ìˆë‹¤ë©´ ê·¸ Colliderì˜ `point`(ì¶©ëŒ ìœ„ì¹˜)ëŠ” ì œë¡œ í¬ì¸íŠ¸ê°€ ëœë‹¤.
      - `hits[0].point`ëŠ” (0, 0, 0) 
      - ë”°ë¼ì„œ ì´ëŸ° ê²½ìš°ì—” distanceë„ 0 ìœ¼ë¡œ ë‚˜ì˜¤ê²Œ ëœë‹¤.

```c#
var size = Physics.SphereCastNonAlloc(attackRoot.position, attackRadius, direction, hits, deltaDistance, whatIsTarget);
```

- **SphereCastNonAlloc** í•¨ìˆ˜
  - `attackRadius` ë°˜ê²½ì„ ê°€ì§„ êµ¬ê°€ `attackRoot.position`ì— ìœ„ì¹˜ë¡œë¶€í„° `direction` ë°©í–¥ìœ¼ë¡œ `deltaDistance` ê±°ë¦¬ë§Œí¼ ì´ë™í•˜ë©´ì„œ ìƒê¸´ ê¶¤ì (ì—°ì†ì„ ìƒ)ì— ê²¹ì¹˜ëŠ” Colliderë“¤ ì¤‘ì—ì„œ `whatIsTarget` LayerMaskë¥¼ ê°€ì§„ Colliderê°€ ìˆë‹¤ë©´ ê·¸ê²ƒì„ `hits` ë°°ì—´ì— ë‹´ê³  ê·¸ ë°°ì—´ì˜ í¬ê¸°ë¥¼ ë¦¬í„´í•œë‹¤.
  - `out hits` í˜¹ì€ `ref hits` ì´ë ‡ê²Œ ë ˆí¼ëŸ°ìŠ¤ë¡œ ë„˜ê¸°ì§€ ì•Šì€ ì´ìœ ëŠ” `hits` ë°°ì—´ ì´ë¦„ì´ ê·¸ ìì²´ë¡œ ë ˆí¼ëŸ°ìŠ¤ê°€ ë˜ê¸° ë•Œë¬¸ì´ë‹¤. ë”°ë¼ì„œ ê·¸ëƒ¥ `hits`ë¡œ ì¸ìˆ˜ ë„˜ê¸°ë©´ ë¨.  
    - ë°°ì—´ì´ ì•„ë‹ˆë¼ ê·¸ëƒ¥ `RaycastHit` ìì²´ë¥¼ ë„˜ê¸°ëŠ” ê²ƒì´ì˜€ìœ¼ë©´ valueì´ë¯€ë¡œ `out hit` ì´ëŸ°ì‹ìœ¼ë¡œ ë„˜ê²¨ì•¼ í•œë‹¤.


##### Time.fixedDeltaTime

- **FixedUpdate()** í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ëŠ” ê·¸ ì‚¬ì´ì˜ ì‹œê°„. ë‹¤ìŒ **FixedUpdate()** í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ê¸°ê¹Œì§€ì˜ ì‹œê°„. 
- **FixedUpdate()** í•¨ìˆ˜ëŠ” ë””í´íŠ¸ë¡œ 1/50ì´ˆì¸ 0.02ì´ˆë¥¼ ì£¼ê¸°ë¡œ ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì— ë””í´íŠ¸ë¡  `Time.fixedDeltaTime` ê°’ì€ `0.02`ì´ë‹¤.
- <u>FixedUpdate() í•¨ìˆ˜ ì•ˆì—ì„œ ì‚¬ìš©í•  ë•Œ Time.fixedDeltaTimeê°€ ì•„ë‹Œ ê·¸ëƒ¥ Time.deltaTime ë¥¼ ì‚¬ìš©í•  ê²ƒì„ ê¶Œì¥í•œë‹¤.</u>
  - ìë™ìœ¼ë¡œ `Time.deltaTime`ì´ **FixedUpdate()** í•¨ìˆ˜ ì•ˆì—ì„œ ì“°ì´ë©´ ì•Œì•„ì„œ `Time.fixedDeltaTime` ìœ¼ë¡œ ë¦¬í„´í•˜ê¸° ë•Œë¬¸ì´ë‹¤. 
    - `Time.deltaTime`ì€ ì•Œì•„ì„œ **Update()** í•¨ìˆ˜ì—ì„œëŠ” í”„ë ˆì„ê°„ì˜ ì‚¬ì‡ ì‹œê°„ìœ¼ë¡œì„œ ë™ì‘í•˜ê³   **FixedUpdate()** í•¨ìˆ˜ ì•ˆì—ì„œ ì“°ì´ë©´ ì•Œì•„ì„œ ê³ ì •ëœ í”„ë ˆì„ì¸ `Time.fixedDeltaTime` (0.02ì´ˆ) ìœ¼ë¡œ ì“°ì¸ë‹¤.
- `Time.timeScale`ì„ í†µí•´ ì‹œê°„ì´ í˜ëŸ¬ê°€ëŠ” ì†ë„ë¥¼ ë³€ê²½í•œë‹¤ë©´ `Time.fixedDeltaTime`ë„ ê·¸ì— ë§ê²Œ ë³€ê²½í•´ì¤„ ê²ƒì„ ê¶Œì¥í•œë‹¤.
  - `Time.fixedDeltaTime = 0.02f * Time.timeScale`
  - `Time.timeScale`ì´ 2.0fì´ë©´ ë””í´íŠ¸ì— ë¹„í•´ ë‘ë°°ë¡œ ì‹œê°„ì´ ë¹¨ë¦¬ í˜ëŸ¬ê°„ë‹¤ëŠ” ì˜ë¯¸ê³  0.0fë©´ ì‹œê°„ì´ ì•„ì˜ˆ íë¥´ì§€ ì•Šê³  ì •ì§€ ìƒíƒœë¼ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.

<br>

#### private IEnumerator UpdatePath()

> ì½”ë£¨í‹´ í•¨ìˆ˜

> ì¢€ë¹„ AI ê°€ ì£¼ê¸°ì ìœ¼ë¡œ ì¶”ì í•  ëŒ€ìƒì˜ ìœ„ì¹˜ë¥¼ ì°¾ì•„ <u>ê²½ë¡œë¥¼ ê°±ì‹ </u>

- ì¢€ë¹„ê°€ ì‚´ì•„ìˆëŠ” ë™ì•ˆ ê³„ì† ë°˜ë³µí•œë‹¤. ë¬´í•œ ë£¨í”„

```c#
    private IEnumerator UpdatePath()
    {
        // ì‚´ì•„ìˆëŠ” ë™ì•ˆ ë¬´í•œ ë£¨í”„
        while (!dead)
        {
            if (hasTarget)
            {
                if (state == State.Patrol)
                {
                    state = State.Tracking;
                    agent.speed = runSpeed;
                }

                // ì¶”ì  ëŒ€ìƒ ì¡´ì¬ : ê²½ë¡œë¥¼ ê°±ì‹ í•˜ê³  AI ì´ë™ì„ ê³„ì† ì§„í–‰
                agent.SetDestination(targetEntity.transform.position);
            }
            else
            {
                if (targetEntity != null) targetEntity = null;

                // ì •ì°° ìƒíƒœê°€ ì•„ë‹ˆì˜€ë‹¤ë©´ ì´ì œ ë‹¤ì‹œ ì •ì°° ìƒíƒœë¡œ ë³€ê²½
                if (state != State.Patrol)
                {
                    state = State.Patrol;
                    agent.speed = patrolSpeed;
                }

                // ì¼ë‹¨ ì‹œì•¼ë¥¼ í†µí•´ ê°ì§€í•˜ê¸° ì „ì— NavMesh ìœ„ì˜ ì–´ë–¤ ì„ì˜ì˜ ì§€ì ìœ¼ë¡œ ì´ë™í•˜ê²Œ í•œë‹¤.
                if (agent.remainingDistance <= 1f)
                {
                    var patrolPosition = Utility.GetRandomPointOnNavMesh(transform.position, 20f, NavMesh.AllAreas);
                    agent.SetDestination(patrolPosition);
                }

                // 20 ìœ ë‹›ì˜ ë°˜ì§€ë¦„ì„ ê°€ì§„ ê°€ìƒì˜ êµ¬ë¥¼ ê·¸ë ¸ì„ë•Œ, êµ¬ì™€ ê²¹ì¹˜ëŠ” ëª¨ë“  ì½œë¼ì´ë”ë¥¼ ê°€ì ¸ì˜´
                // ë‹¨, whatIsTarget ë ˆì´ì–´ë¥¼ ê°€ì§„ ì½œë¼ì´ë”ë§Œ ê°€ì ¸ì˜¤ë„ë¡ í•„í„°ë§
                var colliders = Physics.OverlapSphere(eyeTransform.position, viewDistance, whatIsTarget);

                // ëª¨ë“  ì½œë¼ì´ë”ë“¤ì„ ìˆœíšŒí•˜ë©´ì„œ, ì‚´ì•„ìˆëŠ” LivingEntity ì°¾ê¸°
                foreach (var collider in colliders)
                {
                    if (!IsTargetOnSight(collider.transform)) continue;

                    var livingEntity = collider.GetComponent<LivingEntity>();

                    // LivingEntity ì»´í¬ë„ŒíŠ¸ê°€ ì¡´ì¬í•˜ë©°, í•´ë‹¹ LivingEntityê°€ ì‚´ì•„ìˆë‹¤ë©´,
                    if (livingEntity != null && !livingEntity.dead)
                    {
                        // ì¶”ì  ëŒ€ìƒì„ í•´ë‹¹ LivingEntityë¡œ ì„¤ì •
                        targetEntity = livingEntity;

                        // forë¬¸ ë£¨í”„ ì¦‰ì‹œ ì •ì§€
                        break;
                    }
                }
            }

            // 0.05 ì´ˆ ì‹œê°„ ê°„ê²©ì„ ë‘ë©´ì„œ ì‚´ì•„ ìˆëŠ” ë™ì•ˆ ë¬´í•œ ë£¨í”„ ë°˜ë³µ ì²˜ë¦¬
            yield return new WaitForSeconds(0.05f);
        }
    }
```

- **while (!dead)** ì‚´ì•„ìˆëŠ” ë™ì•ˆ ë¬´í•œ ë£¨í”„ë¡œ ì¶”ì  ëŒ€ìƒì˜ ìœ„ì¹˜ë¥¼ ì°¾ì•„ ê²½ë¡œë¥¼ ê°±ì‹ í•œë‹¤.
  - **if (hasTarget)** <u>ì¶”ì  ëŒ€ìƒì´ ì¡´ì¬í•œë‹¤ë©´ </u>
    - `agent.SetDestination(targetEntity.transform.position);`
      - ì¶”ì  ëŒ€ìƒì˜ ìœ„ì¹˜ë¥¼ agentì˜ ëª©í‘œ ìœ„ì¹˜ë¡œ ì‚¼ê³  ê·¸ì— ë”°ë¼ ê²½ë¡œë¥¼ ê°±ì‹ í•˜ê³  AI ì´ë™ì„ ê³„ì† ì§„í–‰
      - `SetDestination` 
        - ğŸ‘‰ NavMeshAgent ì»´í¬ë„ŒíŠ¸ì˜ í•¨ìˆ˜ë¡œ ëª©ì ì§€ë¥¼ ì¸ìˆ˜ë¡œ ë„˜ê²¨ í•´ë‹¹ ëª©ì ì§€ë¡œ ë§¤ í”„ë ˆì„ë§ˆë‹¤ agentë¡œ í•˜ì—¬ê¸ˆ ì´ë™í•˜ê²Œ í•˜ëŠ” í•¨ìˆ˜ë‹¤.
    - ì¶”ì  ëŒ€ìƒì´ ì¡´ì¬í•˜ëŠ”ë° ì§€ê¸ˆ ì •ì°° ìƒíƒœì˜€ë‹¤ë©´ `if (state == State.Patrol)` 
      - ì´ì œ ë” ì´ìƒ ì •ì°°í•˜ì§€ ì•Šê³  ì¶”ì  ëŒ€ìƒì„ í–¥í•´ ë›°ì–´ê°€ë„ë¡ ìƒíƒœë¥¼ `Tracking`ìœ¼ë¡œ ë°”ê¿” ì£¼ê³ 
      - ì†ë„ë„ `runSpeed`ë¡œ ë°”ê¿”ì¤€ë‹¤.
  - **else** <u>ì¶”ì  ëŒ€ìƒì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´</u>  (í”Œì—ì´ì–´ê°€ ì£½ì—ˆê±°ë‚˜ ì—†ëŠ” ìƒíƒœ)
    - ì£¼ë³€ì„ ì •ì°°í•˜ë©´ì„œ í”Œë ˆì´ì–´ë¥¼ ì°¾ì•„ì•¼ í•¨.
      - 1ï¸âƒ£ `targetEntity`ê°€ nullì´ ì•„ë‹Œë° `hasTarget`ì´ nullì¸ ê²½ìš°ëŠ” í”Œë ˆì´ì–´ê°€ ì‚¬ë§í•œ ìƒíƒœì´ë‹¤. ë‚˜ì¤‘ì— ë§Œì•½ ì´ ê²Œì„ì„ ì˜¨ë¼ì¸ ê²Œì„ìœ¼ë¡œ í™•ì¥í•´ì„œ ì‚¬ë§í•œ í”Œë ˆì´ì–´ ë§ê³  ì´ì œ ì¢€ë¹„ë“¤ì´ ë‹¤ë¥¸ í”Œë ˆì´ì–´ë¥¼ ì¶”ì í•˜ê²Œë” í•˜ë ¤ê³  í•œë‹¤ë©´ `targetEntity`ë¥¼ nullë¡œ ë³€ê²½í•´ì£¼ì–´ì•¼ í•œë‹¤.
      - 2ï¸âƒ£ ì •ì°° ìƒíƒœê°€ ì•„ë‹ˆì˜€ë‹¤ë©´ ì´ì œ ë‹¤ì‹œ ì •ì°° ìƒíƒœë¡œ ë³€ê²½í•´ì£¼ì–´ì•¼ í•œë‹¤. ì¶”ì  ëŒ€ìƒì´ ì—†ì–´ì§„ê±°ë‹ˆê¹Œ.
        - ìƒíƒœì™€ ì†ë„ë¥¼ `Patrol`ì— ë§ê²Œ ë³€ê²½
      - 3ï¸âƒ£ ìƒˆë¡œìš´ ì •ì°° ì‹œì‘ ìœ„ì¹˜ ê²°ì •í•˜ê¸°
        - ì‹œì•¼ë¥¼ í†µí•´ì„œ ê°ì§€í•˜ê¸° ì „ì— ë¨¼ì € `Zombie`ì—ê²Œ <u>NavMesh ìœ„ì˜ ì„ì˜ì˜ ìœ„ì¹˜ë¡œ ì°ì–´ì¤˜ì„œ</u> ê·¸ ìœ„ì¹˜ë¡œ ì´ë™í•˜ê²Œë” í•´ì¤€ë‹¤.
          - ì´ ë¬´í•œë£¨í”„ëŠ” 0.2ì´ˆë§ˆë‹¤ ì‹¤í–‰ì´ ë˜ê³  ìˆìœ¼ë¯€ë¡œ ì•„ì§ ê·¸ ìœ„ì¹˜ë¡œ ì´ë™ì„ ì™„ë£Œ í•˜ì§€ë„ ì•Šì•˜ëŠ”ë° ë§¤ë²ˆ ìƒˆë¡œìš´ ì •ì°° ìœ„ì¹˜ë¥¼ ê²°ì •í•˜ë©´ ì´ìƒí•˜ê²Œ ë³´ì¼ ê²ƒì´ë‹¤. ë”°ë¼ì„œ ìƒˆë¡œìš´ ì •ì°° ìœ„ì¹˜ì¸ `patrolPosition`ì— ê±°ì˜ ë‹¤ë‹¤ë¥¸ ë‹¤ìŒì—, ì¦‰ ê±°ì˜ ì´ë™ì„ ì™„ë£Œí•  ë•Œì¯¤ì—, ì°¾ìœ¼ë ¤ëŠ” ëŒ€ìƒì´ ì—†ìœ¼ë©´ ê·¸ì œì„œì•¼ ìƒˆë¡œìš´ ì •ì°° ìœ„ì¹˜ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.
            - *if (agent.`remainingDistance` <= 1f)*
              - ì¸ê³µì§€ëŠ¥ agentê°€ ëª©í‘œì§€ì ê¹Œì§€ì˜ ë‚¨ì€ ê±°ë¦¬ê°€ 1 ì´í•˜ì¼ ë•Œë§Œ. ì¦‰, ê±°ì˜ ë‹¤ ì™”ì„ ë•Œë§Œ ì‹¤í–‰í•˜ë„ë¡.
          - var `patrolPosition` = *Utility.GetRandomPointOnNavMesh(transform.position, 20f, NavMesh.AllAreas);*
            - ğŸ“œUtility.csì— êµ¬í˜„ë˜ì–´ ìˆëŠ” *GetRandomPointOnNavMesh* í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ NavMesh ìœ„ì—ì„œ ì–´ë–¤ ìœ„ì¹˜ì™€ ë°˜ê²½ì„ ê¸°ì¤€ìœ¼ë¡œ ëœë¤í•œ ìœ„ì¹˜ ë¦¬í„´
            - í˜„ì¬ ìœ„ì¹˜ì—ì„œ 20 ë§Œí¼ì˜ ë°˜ê²½ ë‚´ì˜ `NavMesh.AllAreas`ì—ì„œ ëœë¤í•œ ìœ„ì¹˜ ì°ìŒ.
          - *agent.SetDestination(patrolPosition);* 
            - ê·¸ ìœ„ì¹˜ë¡œ ì´ë™ì‹œí‚´ 
      - 4ï¸âƒ£ ì‹œì•¼ë¥¼ í†µí•´ ì ì„ ê°ì§€
        - ![image](https://user-images.githubusercontent.com/42318591/92107235-6dfeca00-ee20-11ea-924c-843de1262af1.png){: width="70%" height="70%"}{: .align-center}
          - ì‹œì•¼ ê° ë‚´ì— ìˆëŠ” ëª¨ë“  Colliderë“¤ì„ ë°°ì—´ì— ë‹´ëŠ”ë‹¤.
            - *var colliders = Physics.OverlapSphere(eyeTransform.position, viewDistance, whatIsTarget);*
              - ì¢€ë¹„ì˜ ëˆˆì˜ ìœ„ì¹˜ `eyeTransform.position` ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì‹œì•¼ ì‚¬ì •ê±°ë¦¬ `viewDistance`ì„ êµ¬ì˜ ë°˜ê²½ìœ¼ë¡œ ì‚¼ì•˜ì„ ë•Œ `whatIsTarget` layMaskì— í•´ë‹¹í•˜ëŠ” Collider ë“¤ì„ `colliders`ì— ë¦¬í„´í•œë‹¤.
                - `colliders`ì€ Collider [] ë°°ì—´ 
          - ëª¨ë“  Colliderë“¤ì„ ìˆœíšŒí•˜ë©´ì„œ ì‚´ì•„ìˆëŠ” Living Entity ì°¾ê¸°.
            - ë‹¨, ì‹œì•¼ ê° ë‚´ì— ìˆëŠ” ëª¨ë“  ê²ƒë“¤ì—ê²Œ `Zombie`ì˜ ëˆˆì—ì„œ <u>Raycastë¥¼ ìˆì„ ë•Œ ìƒëŒ€ë°©ì—ê²Œ ë¬´ì‚¬íˆ ë„ì°© í–ˆëŠ”ì§€ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ê±¸ëŸ¬ë‚¼ ê²ƒ.</u> ì‹œì•¼ê° ë‚´ì— ìˆë”ë¼ë„ ì¥ì• ë¬¼ ë’¤ì— ìˆëŠ” ëŒ€ìƒì´ë¼ë©´ ê°ì§€ í•  ìˆ˜ ì—†ëŠ” ëŒ€ìƒìœ¼ë¡œì„œ ê±¸ëŸ¬ë‚´ì•¼ í•œë‹¤. <u>ì¢€ë¹„ê°€ ë³¼ ìˆ˜ ìˆëŠ” ê²ƒë“¤ì— ëŒ€í•´ì„œë§Œ ê°ì§€í•´ì•¼ í•œë‹¤</u>
              - *if (!IsTargetOnSight(collider.transform)) continue;*
                - ì¢€ë¹„ê°€ ë³¼ ìˆ˜ ì—†ëŠ” ëŒ€ìƒì´ë¼ë©´ ìŠ¤í‚µ! ë‹¤ìŒ collider ê²€ì‚¬í•˜ëŸ¬ ê°€ê¸°.
                - `IsTargetOnSight` í•¨ìˆ˜ 
                  - ğŸ‘‰ [ë°‘ì—ì„œ](#private-bool-istargetonsighttransform-target) ì„¤ëª… ë˜ì–´ìˆëŠ” í•¨ìˆ˜. 
                  - ì¸ìˆ˜ë¡œ ë„˜ê¸´ colliderì˜ ìœ„ì¹˜ê°€ ì¢€ë¹„ê°€ ë³¼ ìˆ˜ ìˆëŠ” ìœ„ì¹˜ì¸ì§€ë¥¼ Raycastë¡œ ê²€ì‚¬í•˜ì—¬ True, Falseë¡œ ë¦¬í„´í•˜ëŠ” í•¨ìˆ˜ë‹¤.
            - LivingEntity ì»´í¬ë„ŒíŠ¸ê°€ ì¡´ì¬í•˜ë©°, í•´ë‹¹ LivingEntityê°€ ì‚´ì•„ìˆë‹¤ë©´
              - ì¶”ì  ëŒ€ìƒì„ í•´ë‹¹ LivingEntityë¡œ ì„¤ì •
              - ì°¾ì•˜ìœ¼ë‹ˆ ë” ì´ìƒ colliderëŠ” ìˆœíšŒí•˜ì§€ ì•Šê³  forë¬¸ì„ ë¹ ì ¸ë‚˜ì˜¨ë‹¤.
  - ìœ„ ê³¼ì •ì„ 0.05 ì´ˆ ì‹œê°„ ê°„ê²©ì„ ë‘ë©´ì„œ ì‚´ì•„ ìˆëŠ” ë™ì•ˆ ë¬´í•œ ë°˜ë³µ.


##### ğŸ“œUtility.cs

```c#
using UnityEngine;
using UnityEngine.AI;

public static class Utility
{
    // NavMesh ìœ„ì—ì„œ ì–´ë–¤ ìœ„ì¹˜ì™€ ë°˜ê²½ì„ ê¸°ì¤€ìœ¼ë¡œ ëœë¤í•œ ìœ„ì¹˜ ë¦¬í„´
    public static Vector3 GetRandomPointOnNavMesh(Vector3 center, float distance, int areaMask)  // ì¸ìˆ˜ ğŸ‘‰ ì¤‘ì‹¬ ìœ„ì¹˜, ë°˜ê²½ ê±°ë¦¬, ê²€ìƒ‰í•  Area (ë‚´ë¶€ì ìœ¼ë¡œ int)
    {
        var randomPos = Random.insideUnitSphere * distance + center;  // centerë¥¼ ì¤‘ì ìœ¼ë¡œ í•˜ì—¬ ë°˜ì§€ë¦„(ë°˜ê²½) distance ë‚´ì— ëœë¤í•œ ìœ„ì¹˜ ë¦¬í„´. *Random.insideUnitSphere*ì€ ë°˜ì§€ë¦„ 1 ì§œë¦¬ì˜ êµ¬ ë‚´ì—ì„œ ëœë¤í•œ ìœ„ì¹˜ë¥¼ ë¦¬í„´í•´ì£¼ëŠ” í”„ë¡œí¼í‹°ë‹¤.
        
        NavMeshHit hit;  // NavMesh ìƒ˜í”Œë§ì˜ ê²°ê³¼ë¥¼ ë‹´ì„ ì»¨í…Œì´ë„ˆ. Raycast hit ê³¼ ë¹„ìŠ·
        
        NavMesh.SamplePosition(randomPos, out hit, distance, areaMask);  // areaMaskì— í•´ë‹¹í•˜ëŠ” NavMesh ì¤‘ì—ì„œ randomPosë¡œë¶€í„° distance ë°˜ê²½ ë‚´ì—ì„œ randomPosì— *ê°€ì¥ ê°€ê¹Œìš´* ìœ„ì¹˜ë¥¼ í•˜ë‚˜ ì°¾ì•„ì„œ ê·¸ ê²°ê³¼ë¥¼ hitì— ë‹´ìŒ. 
        
        return hit.position;  // ìƒ˜í”Œë§ ê²°ê³¼ ìœ„ì¹˜ì¸ hit.position ë¦¬í„´
    }
    
    // ì´ì „ í¬ìŠ¤íŠ¸ì—ì„œ í•œë²ˆ ì‚¬ìš©í•œì  ìˆìŒ! 
    public static float GetRandomNormalDistribution(float mean, float standard)
    {
        var x1 = Random.Range(0f, 1f);
        var x2 = Random.Range(0f, 1f);
        return mean + standard * (Mathf.Sqrt(-2.0f * Mathf.Log(x1)) * Mathf.Sin(2.0f * Mathf.PI * x2));
    }
}
```

- ëœë¤í•œ ìœ„ì¹˜ `randomPos` ìƒì„±
  - *var randomPos = Random.insideUnitSphere * distance + center;*
    - centerë¥¼ ì¤‘ì ìœ¼ë¡œ í•˜ì—¬ ë°˜ì§€ë¦„(ë°˜ê²½) distance ë‚´ì— ëœë¤í•œ ìœ„ì¹˜ ë¦¬í„´. 
    - *Random.insideUnitSphere*ì€ ë°˜ì§€ë¦„ 1 ì§œë¦¬ì˜ êµ¬ ë‚´ì—ì„œ ëœë¤í•œ ìœ„ì¹˜ë¥¼ ë¦¬í„´í•´ì£¼ëŠ” í”„ë¡œí¼í‹°ë‹¤.
- NavMeshì¸ `areaMask` ì´ë©´ì„œ + `distance` ë‚´ì—ì„œ, `randomPos`ì— ê°€ì¥ ê°€ê¹Œìš´ ìœ„ì¹˜ ìƒì„±
  - *NavMesh.SamplePosition(randomPos, out hit, distance, areaMask);* 
    - areaMaskì— í•´ë‹¹í•˜ëŠ” NavMesh ì¤‘ì—ì„œ randomPosë¡œë¶€í„° distance ë°˜ê²½ ë‚´ì—ì„œ randomPosì— <u>ê°€ì¥ ê°€ê¹Œìš´ ìœ„ì¹˜ë¥¼ í•˜ë‚˜ ì°¾ì•„ì„œ ê·¸ ê²°ê³¼ë¥¼ hitì— ë‹´ìŒ.</u>
- `hit.posiion`ì´ ìµœì¢… ê²°ê³¼ê°€ ë¨.
  - NavMesh ìœ„ì—ì„œ ì–´ë–¤ ìœ„ì¹˜ì™€ ë°˜ê²½ì„ ê¸°ì¤€ìœ¼ë¡œ ëœë¤í•œ ìœ„ì¹˜ 

<br>

#### public override bool ApplyDamage(DamageMessage damageMessage)

> ğŸ“œLivingEntity.cs ì˜ **ApplyDamage** ì˜¤ë²„ë¼ì´ë”©

```c#
    // ì¢€ë¹„ê°€ ì´ ë§ì•„ì„œ ë°ë¯¸ì§€ë¥¼ ì…ì—ˆì„ë•Œ ì‹¤í–‰í•  ì²˜ë¦¬
    public override bool ApplyDamage(DamageMessage damageMessage)
    {
        if (!base.ApplyDamage(damageMessage)) return false;  // ë°ë¯¸ì§€ ì²˜ë¦¬

        if (targetEntity == null)
        {
            targetEntity = damageMessage.damager.GetComponent<LivingEntity>();
        }

        EffectManager.Instance.PlayHitEffect(damageMessage.hitPoint, damageMessage.hitNormal, transform, EffectManager.EffectType.Flesh);  // íƒ€ê²© íŒŒí‹°í´íš¨ê³¼ ì‹¤í–‰
        audioPlayer.PlayOneShot(hitClip);  // ì˜¤ë””ì˜¤ ì¬ìƒ

        return true;
    }
```

> ì¢€ë¹„ê°€ ë§ì•˜ì„ ë•Œ

- *if (!base.ApplyDamage(damageMessage)) return false;*
  - ğŸ“œLivingEntity.cs ì˜ **ApplyDamage**ì„ ë¨¼ì € ì‹¤í–‰í•˜ê³  
    - `base.ApplyDamage(damageMessage)`
  - ì´ë•Œ ì„±ê³µì ìœ¼ë¡œ ë°ë¯¸ì§€ ì²˜ë¦¬ê°€ ì´ë£¨ì–´ì§ˆ ìˆ˜ ì—†ì–´ Falseê°€ ë¦¬í„´ ë˜ì—ˆë‹¤ë©´ ğŸ“œEnemy.csì˜ ì´ **ApplyDamage** í•¨ìˆ˜ë„ `return false` í•œë‹¤.
  - <u>ë°ë¯¸ì§€ ì²˜ë¦¬ëŠ” ë¶€ëª¨ í´ë˜ìŠ¤ì¸ ğŸ“œLivingEntity.csì˜ ApplyDamage í•¨ìˆ˜ì—ì„œ ì´ë£¨ì–´ì§„ë‹¤.</u>
    - ì¦‰, ì´ ifë¬¸ì—ì„œ ë°ë¯¸ì§€ ì²˜ë¦¬ê°€ ìˆ˜í–‰ëœë‹¤.
    - LivingEntityì˜ ìì‹ì¸ ğŸ“œPlayerHealth.cs ìŠ¤í¬ë¦½íŠ¸ë‚˜ ğŸ“œEnemy.cs ìŠ¤í¬ë¦½íŠ¸ë‚˜, ë°ë¯¸ì§€ë¥¼ ì…ëŠ” ë¡œì§ì€ ë™ì¼í•˜ê¸° ë•Œë¬¸ì— `base.ApplyDamage(damageMessage)`ë¡œ ì²˜ë¦¬ í•˜ëŠ” ê²ƒì´ë‹¤.
      - ê³µê²©ì„ ë‹¹í•˜ê³  ë‚œ í›„ì— ìˆ˜í–‰í•  í–‰ë™ì´ë¼ë˜ê°€ íŒŒí‹°í´ íš¨ê³¼ ê°™ì€ ê²ƒì€ ì¢€ë¹„ë‘ í”Œë ˆì´ì–´ ìºë¦­í„°ê°€ ì„œë¡œ ë‹¤ë¥´ê²Œ ì¼ì–´ë‚˜ë¯€ë¡œ ì´ ë¶€ë¶„ë§Œ ì˜¤ë²„ë¼ì´ë”©ëœ **ApplyDamage** í•¨ìˆ˜ì— ë§ë¶™ì—¬ ì£¼ë©´ ë˜ëŠ” ê²ƒì´ë‹¤.
- *if (targetEntity == null)* 
  - ì•„ì§ ì¶”ì í•  ëŒ€ìƒì„ ëª» ì°¾ì•˜ëŠ”ë° ê³µê²©ì„ ë‹¹í–ˆë‹¤ë©´ ìì‹ í•  ê³µê²©í•œ ì‚¬ëŒì„ `targetEntity`ì— í• ë‹¹í•œë‹¤.
  - <u>ê³µê²© ë‹¹í•˜ëŠ” ìˆœê°„ì— ê³µê²© í•œ ì‚¬ëŒì„ ì•Œì•„ë³´ë„ë¡.</u>
- íŒŒí‹°í´ íš¨ê³¼ ì¬ìƒ
  - ì¬ìƒ ìœ„ì¹˜, ë°©í–¥ ë“±ë“± ì¸ìˆ˜ë¡œ ë„˜ê²¨ì¤€ë‹¤.
  - í”¼ê°€ íŠ€ëŠ” íš¨ê³¼
- íš¨ê³¼ìŒ ì¬ìƒ

<br>

#### public void BeginAttack()

> ì½”ë“œìƒì—ì„œ(*ì´ í•¨ìˆ˜ëŠ” Update í•¨ìˆ˜ ë‚´ì—ì„œ ì‹¤í–‰ë¨*) ëª…ì‹œì ìœ¼ë¡œ ê³µê²©ì„ ì‹œì‘í•  ë•Œ ì‚¬ìš©. 

- ê³µê²© ì• ë‹ˆë©”ì´ì…˜ì´ ì‹œì‘ë˜ì§€ë§Œ ë°ë¯¸ì§€ë¥¼ ì…íˆëŠ” ì‹œì ì€ ì•„ë‹˜


```c#
    public void BeginAttack()
    {
        state = State.AttackBegin;

        agent.isStopped = true;
        animator.SetTrigger("Attack");
    }
```

- ìƒíƒœë¥¼ `State.AttackBegin` ìœ¼ë¡œ ì„¤ì •.
- AI agent ì ì‹œ ì¶”ì ì„ ì •ì§€.  
  - *agent.isStopped = true;*
- ê³µê²© ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
  - *animator.SetTrigger("Attack");*

<br>

#### public void EnableAttack()

> ì‹¤ì œë¡œ ë°ë¯¸ì§€ê°€ ë“¤ì–´ê°€ê¸° ì‹œì‘í•˜ëŠ” ì§€ì  (`State.Attacking` ìƒíƒœê°€ ë˜ì–´ *FixedUpdate* í•¨ìˆ˜ì—ì„œ ë°ë¯¸ì§€ ì²˜ë¦¬ ì‹¤í–‰)

- ì½”ë“œ ìƒì—ì„œ ì‹¤í–‰ë˜ëŠ” ë©”ì†Œë“œê°€ ì•„ë‹Œ<u>ì• ë‹ˆë©”ì´ì…˜ ì´ë²¤íŠ¸</u>ë¥¼ í†µí•´ ì‹¤í–‰í•  ë©”ì†Œë“œë‹¤.
  - ê³µê²© ì• ë‹ˆë©”ì´ì…˜ì˜ ì¬ìƒ ì¤‘ê°„ ì¯¤ì— ì‹¤í–‰í•  ê²ƒì´ë¼ì„œ

```c#
    public void EnableAttack()
    {
        state = State.Attacking;

        lastAttackedTargets.Clear();
    }
```

- ìƒíƒœë¥¼ `State.Attacking` ìœ¼ë¡œ ë³€ê²½.
- ì´ì „ê¹Œì§€ ê³µê²©í•œ ëŒ€ìƒë“¤ì´ ë‹´ê²¨ìˆëŠ” `lastAttackedTargets` ë¦¬ìŠ¤íŠ¸ ë¹„ì›€

<br>

#### public void DisableAttack()

> ê³µê²©ì´ ëë‚˜ëŠ” ì§€ì . ë°ë¯¸ì§€ë¥¼ ì…íˆëŠ” ì²˜ë¦¬ê°€ ëë‚¬ì„ ë•Œ.

- ì½”ë“œ ìƒì—ì„œ ì‹¤í–‰ë˜ëŠ” ë©”ì†Œë“œê°€ ì•„ë‹Œ <u>ì• ë‹ˆë©”ì´ì…˜ ì´ë²¤íŠ¸</u>ë¥¼ í†µí•´ ì‹¤í–‰í•  ë©”ì†Œë“œë‹¤.
  - ê³µê²© ì• ë‹ˆë©”ì´ì…˜ì´ ì–¼ì¶” ëë‚˜ê°ˆ ë•Œ ì‹¤í–‰í•  ê²ƒì´ë¼ì„œ

```c#
    public void DisableAttack()
    {
      if(hasTarget)
        {
            state = State.Tracking;
        }
        else
        {
            state = State.Patrol;
        }

        agent.isStopped = false;
    }
```

- íƒ€ê²Ÿì´ ì—¬ì „íˆ ë‚¨ì•„ìˆë‹¤ë©´ ìƒíƒœë¥¼ `State.Tracking`ë¡œ ë˜ëŒë¦¼.
- íƒ€ê²Ÿì´ ì´ì œ ì—†ë‹¤ë©´ ìƒíƒœë¥¼ `State.Patrol`ë¡œ ë˜ëŒë¦¼.
  - ìœ„ì™€ ê°™ì´ ë‘ê°œì˜ ì¼€ì´ìŠ¤ë¡œ ë‚˜ëˆ„ì–´ì£¼ì§€ ì•Šê³  `State.Tracking`ë¥¼ í•´ë²„ë¦¬ë©´ ë‚˜ì¤‘ì— `targetEntity`ëŠ” nullì´ ë˜ë²„ë¦¬ë¯€ë¡œ `targetEntity`ì™€ì˜ ê±°ë¦¬ë¥¼ ì¬ë ¤ëŠ” ì²˜ë¦¬ë¥¼ í•  ë•Œ ëŸ°íƒ€ì„ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤. 
- AI Agentê°€ ë‹¤ì‹œ ì›€ì§ì´ë„ë¡ *agent.isStopped = false*

<br>

##### ì• ë‹ˆë©”ì´ì…˜ ì´ë²¤íŠ¸ í•¨ìˆ˜

> ğŸ“¢ ì´ ì• ë‹ˆë©”ì´ì…˜ì´ ì ìš©ë˜ëŠ” ì˜¤ë¸Œì íŠ¸ì— ë¶™ì–´ìˆëŠ” ë˜ ë‹¤ë¥¸ ìŠ¤í¬ë¦½íŠ¸ í˜¹ì€ ì»´í¬ë„ŒíŠ¸ì— í•´ë‹¹ í•¨ìˆ˜ê°€ ì¡´ì¬í•´ì•¼ í•œë‹¤.

- `Zombie`ì˜ **Animator** ì˜ ì• ë‹ˆë©”ì´í„° ì»¨íŠ¸ë¡¤ëŸ¬ì— ë³´ë©´ ìƒíƒœë„ì— `Bite`ë¼ëŠ” ì´ë¦„ì˜ ì• ë‹ˆë©”ì´ì…˜ ìƒíƒœê°€ ìˆë‹¤. `Bite`ëŠ” ê³µê²© ì• ë‹ˆë©”ì´ì…˜ì„ ì·¨í•˜ëŠ” ìƒíƒœì´ë‹¤.
- `Bite` ìƒíƒœì— í• ë‹¹ë˜ì–´ ìˆëŠ” ì• ë‹ˆë©”ì´ì…˜ í´ë¦½ì¸ ğŸ“‚Assets/Animations/Zombie Clips ì— ìœ„ì¹˜í•œ `ZombieBite` ë¼ëŠ” ì• ë‹ˆë©”ì´ì…˜ í´ë¦½ì„ ë”ë¸” í´ë¦­ í•´ë³´ì.
  - ![image](https://user-images.githubusercontent.com/42318591/92289806-ca5f0800-ef4c-11ea-9f37-0d2b1a849355.png){: width="100%" height="100%"}{: .align-center}
  - ![image](https://user-images.githubusercontent.com/42318591/92289832-ebbff400-ef4c-11ea-8928-96c8e8d47b08.png){: width="100%" height="100%"}{: .align-center}
  - `ZombieBite` ì• ë‹ˆë©”ì´ì…˜ í´ë¦½ì˜ ì¬ìƒ íë¦„ì¸ë° ìƒë‹¨ì„ ë³´ë©´ ì¤‘ê°„ì— í•˜ì–€ ë„¤ëª¨ê°€ ë‘ê°œê°€ ìˆëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. ì´ê²ƒë“¤ì´ í•˜ë‚˜ëŠ” **EnableAttack()** í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ëŠ”, ë‹¤ë¥¸ í•˜ë‚˜ëŠ” **DisableAttack()** í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ëŠ” ì´ë²¤íŠ¸ì„ì„ ì•Œ ìˆ˜ ìˆë‹¤.
    - ë¬´ê¸°ë¥¼ íœ˜ë‘ë£¨ëŠ” ì‹œì ì—ì„œ ë°ë¯¸ì§€ê°€ ë“¤ì–´ê°€ëŠ” ê²ƒì´ ì•„ë‹Œ ì–¼ì¶” íœ˜ë‘ë¥´ê³  ë‚œ ì• ë‹ˆë©”ì´ì…˜ ì¬ìƒ ì¤‘ê°„ ì‹œì ë¶€í„° ë°ë¯¸ì§€ê°€ ë“¤ì–´ê°€ê²Œ í•˜ê¸° ìœ„í•´ ì• ë‹ˆë©”ì´ì…˜ í´ë¦½ ì¤‘ê°„ ì¦ˆìŒì— ë‘ í•¨ìˆ˜ê°€ ì‹¤í–‰ëœëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

###### ì• ë‹ˆë©”ì´ì…˜ í´ë¦½ì— í•¨ìˆ˜ë¥¼ ì´ë²¤íŠ¸ë¡œ ë“±ë¡í•˜ëŠ” ë°©ë²•

> `write` ê¶Œí•œì´ ìˆëŠ” ì• ë‹ˆë©”ì´ì…˜ í´ë¦½ì—ë§Œ ì ìš©í•  ìˆ˜ ìˆë‹¤.

3D ëª¨ë¸ íŒŒì¼ ë‚´ë¶€ì— í¬í•¨ë˜ì–´ ìˆëŠ” ì• ë‹ˆë©”ì´ì…˜ í´ë¦½ê°™ì€ ê²½ìš° ìœ ë‹ˆí‹° ì—”ì§„ì—ì„œ `write` ì“°ê¸° ê¶Œí•œì´ ì—†ê¸° ë•Œë¬¸ì— ì´ëŸ° í´ë¦½ë“¤ì—” í•¨ìˆ˜ë¥¼ ì´ë²¤íŠ¸ë¡œ ë“±ë¡í•  ìˆ˜ê°€ ì—†ë‹¤. ğŸ“‚Assets í´ë”ì— ë³„ê°œì˜ ì• ë‹ˆë©”ì´ì…˜ í´ë¦½ìœ¼ë¡œì„œ ë…ë¦½ì ìœ¼ë¡œ ì¡´ì¬í•˜ëŠ” ê·¸ëŸ° ì• ë‹ˆë©”ì´ì…˜ í´ë¦½ë“¤ì—ë§Œ ì ìš©ì´ ê°€ëŠ¥í•˜ë‹¤. 

1. ì• ë‹ˆë©”ì´ì…˜ í´ë¦½ì„ ë”ë¸” í´ë¦­í•´ì„œ ì—°ë‹¤.
2. ì´ë²¤íŠ¸ í•¨ìˆ˜ë¥¼ ì¶”ê°€í•  ì‹œì ì„ ì„ íƒ(í•˜ì–€ ì§ì„ ì´ ìƒê¸´ë‹¤)í•˜ì—¬ í´ë¦­í•œ í›„ 
  - ![image](https://user-images.githubusercontent.com/42318591/92290176-1fe7e480-ef4e-11ea-8523-ce85a3d933cb.png){: width="40%" height="40%"}{: .align-center}
3. í•˜ì–€ ë„¤ëª¨ ì¶”ê°€ ë²„íŠ¼, ì¦‰ ì´ë²¤íŠ¸ ì¶”ê°€ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ë©´ í•´ë‹¹ ì‹œì ì— í•˜ì–€ ë„¤ëª¨ê°€ ì¶”ê°€ëœë‹¤.
  - ![image](https://user-images.githubusercontent.com/42318591/92290125-f8911780-ef4d-11ea-8788-1d600959c5d6.png){: width="70%" height="70%"}{: .align-center}
4. Inspector ì°½ì„ ë³´ë©´ ì´ ì‹œì ì— ì¶”ê°€í•  ì´ë²¤íŠ¸ë¥¼ ì‘ì„±í•  ìˆ˜ ìˆëŠ” í¼ì´ ëœ¬ë‹¤. í•´ë‹¹ ì‹œì ì— ì›í•˜ëŠ” í•¨ìˆ˜ì˜ ì´ë¦„ì„ ì¨ì£¼ë©´ ë¨.
  - ![image](https://user-images.githubusercontent.com/42318591/92290282-9258c480-ef4e-11ea-80b2-b073d05d611b.png){: width="70%" height="70%"}{: .align-center}

- íŒ! ì• ë‹ˆë©”ì´ì…˜ í´ë¦½ ì°½ì˜ ì•„ë˜ì— ìˆëŠ” ê°€ë¡œ ìŠ¤í¬ë¡¤ë°”ì˜ ì–‘ ì˜†ì— ì»¤ì„œë¥¼ ë†“ìœ¼ë©´ ê°€ë¡œ í™”ì‚´í‘œê°€ ëœ¨ëŠ”ë° ì´ë¥¼ ë“œë˜ê·¸ í•˜ì—¬ ì¤Œ ì•¤ ì¤Œì•„ì›ƒ í•  ìˆ˜ ìˆë‹¤. ë§ˆìš°ìŠ¤ íœ  ìŠ¤í¬ë¡¤ë¡œë„ ê°€ëŠ¥í•˜ë‹¤.
  -  ![image](https://user-images.githubusercontent.com/42318591/92289875-14e08480-ef4d-11ea-906c-e2009ea75cad.png){: width="70%" height="70%"}{: .align-center}

<br>

#### private bool IsTargetOnSight(Transform target)

> ì¸ìˆ˜ë¡œ ë„˜ê¸´ ìœ„ì¹˜ê°€ ì¢€ë¹„ê°€ ë³¼ ìˆ˜ ìˆëŠ” ìœ„ì¹˜ì¸ì§€ë¥¼ Raycastë¡œ ê²€ì‚¬í•˜ì—¬ True, Falseë¡œ ë¦¬í„´í•˜ëŠ” í•¨ìˆ˜ë‹¤.


```c#
    private bool IsTargetOnSight(Transform target)
    {
        RaycastHit hit;

        var direction = target.position - eyeTransform.position;

        direction.y = eyeTransform.forward.y;

        // 1ï¸âƒ£ ê·¸ ê´‘ì„ ì´ ì‹œì•¼ê°ì„ ë²—ì–´ë‚˜ì„  ì•ˆë˜ë©° 
        if (Vector3.Angle(direction, eyeTransform.forward) > fieldOfView * 0.5f)
        {
            return false;
        }

        direction = target.position - eyeTransform.position;

        // 2ï¸âƒ£ ì‹œì•¼ê° ë‚´ì— ì¡´ì¬ í•˜ë”ë¼ë„ ê´‘ì„ ì´ ì¥ì• ë¬¼ì— ë¶€ë”ªì¹˜ì§€ ì•Šê³  ëª©í‘œì— ì˜ ë‹¿ì•„ì•¼ í•¨
        if (Physics.Raycast(eyeTransform.position, direction, out hit, viewDistance, whatIsTarget))
        {
            if (hit.transform == target) return true;
        }

        return false;
    }
```

- `hit` 
  - Raycast ê²°ê³¼ ì •ë³´ê°€ ë‹´ê¸¸ ì»¨í…Œì´ë„ˆ
- `direction`
  - ëˆˆì˜ ìœ„ì¹˜(ì‹œì‘)ë¡œë¶€í„° íƒ€ê²Ÿ ìœ„ì¹˜(ëª©í‘œ)ë¡œ í–¥í•˜ëŠ” ë°©í–¥
    - ë°©í–¥ = ëˆˆì˜ ìœ„ì¹˜ - íƒ€ê²Ÿ ìœ„ì¹˜
  - ë‹¤ë§Œ, ìˆ˜í‰ì ì¸ ê°ë„ë§Œ ë”°ì§ˆ ê²ƒì´ë¯€ë¡œ 1ï¸âƒ£ ì¡°ê±´ì„ ë”°ì§ˆ ë•Œ ìˆ˜ì§ ë°©í–¥ì€ ê³ ë ¤í•˜ì§€ ì•Šê¸° ìœ„í•´ì„œ y ê°’ì€ ëˆˆì˜ ìœ„ì¹˜ì™€ ë˜‘ê°™ê²Œ.
    - *direction.y = eyeTransform.forward.y;*
- ì¢€ë¹„ì˜ ëˆˆì˜ ìœ„ì¹˜ì—ì„œ Raycast ê´‘ì„ ì„ ìˆì„ ë•Œ 
  - 1ï¸âƒ£ ê·¸ ê´‘ì„ ì´ ì‹œì•¼ê°ì„ ë²—ì–´ë‚˜ì§€ ì•Šê³  
    - ì¢€ë¹„ ëˆˆì—ì„œ íƒ€ê²Ÿ ìœ„ì¹˜ë¡œ í–¥í•˜ëŠ” ë°©í–¥ê³¼ ëˆˆì˜ ì•ìª½ ë°©í–¥ì˜ ì‚¬ì´ê°ì´ ì¢€ë¹„ê°€ ë³¼ ìˆ˜ ìˆëŠ” ì‹œì•¼ ê°ì˜ ì ˆë°˜ ë³´ë‹¤ í¬ë‹¤ë©´ ë³¼ ìˆ˜ ì—†ëŠ” íƒ€ê²Ÿì„.
      - ![image](https://user-images.githubusercontent.com/42318591/92111144-d355b980-ee26-11ea-8502-9bd1d11d9780.png){: width="70%" height="70%"}{: .align-center}
  - 2ï¸âƒ£ ê´‘ì„ ì´ ì¥ì• ë¬¼ì— ë¶€ë”ªì¹˜ì§€ ì•Šê³  ëª©í‘œì— ì˜ ë‹¿ì•„ì•¼ í•¨ 
    - `eyeTransform.position` ëˆˆì—ì„œ `direction` ë°©í–¥ìœ¼ë¡œ ê´‘ì„  ì´ì„œ `viewDistance` ê±°ë¦¬ ë‚´ì— `whatIsTarget` ë ˆì´ë§ˆìŠ¤í¬ì¸ ê²ƒê³¼ ì¶©ëŒí•˜ëŠ” ê²ƒì´ ìˆë‹¤ë©´ `hit`ì— ë‹´ëŠ”ë‹¤.
      - *if (hit.transform == target) return true;*
        - ì›ë˜ `target`ê³¼ Raycastì˜ ê²°ê³¼ì™€ ê°™ë‹¤ë©´ ì¥ì• ë¬¼ì— ë¶€ë”ªì¹˜ëŠ”ê²Œ ì—†ì—ˆë˜ ê²ƒì´ë‹ˆ true ë¦¬í„´
    - *direction = target.position - eyeTransform.position;*
      - 2ï¸âƒ£ í•˜ê¸°ì „ì— ì´ë ‡ê²Œ ë‹¤ì‹œ ì´ˆê¸°í™” í•´ì¤€ ì´ìœ ëŠ” Raycastë¥¼ ì‹¤í–‰í•˜ê¸° ì „ yë°©í–¥ì„ ì›ë˜ ë°©í–¥ëŒ€ë¡œ ë˜ëŒë ¤ë†“ê¸° ìœ„í•´ì„œ
- 1ï¸âƒ£2ï¸âƒ£ ë¥¼ ë§Œì¡±í•˜ì§€ ì•Šìœ¼ë©´ ì¢€ë¹„ê°€ ë³¼ ìˆ˜ ì—†ëŠ” ê²ƒì´ë‹ˆ False ë¦¬í„´
- ë‘˜ ë‹¤ ë§Œì¡±í•˜ë©´ True ë¦¬í„´

<br>

#### public override void Die()

> ğŸ“œLivingEntity.cs ì˜ **ApplyDamage** ì˜¤ë²„ë¼ì´ë”©

```c#
    // ì‚¬ë§ ì²˜ë¦¬
    public override void Die()
    {
        // LivingEntityì˜ Die()ë¥¼ ì‹¤í–‰í•˜ì—¬ ê¸°ë³¸ ì‚¬ë§ ì²˜ë¦¬ ì‹¤í–‰
        base.Die();

        // ë‹¤ë¥¸ AIë“¤ì„ ë°©í•´í•˜ì§€ ì•Šë„ë¡ ìì‹ ì˜ ëª¨ë“  ì½œë¼ì´ë”ë“¤ì„ ë¹„í™œì„±í™”
        GetComponent<Collider>().enabled = false;

        // AI ì¶”ì ì„ ì¤‘ì§€í•˜ê³  ë‚´ë¹„ë©”ì‰¬ ì»´í¬ë„ŒíŠ¸ë¥¼ ë¹„í™œì„±í™”
        agent.enabled = false;

        // ì‚¬ë§ ì• ë‹ˆë©”ì´ì…˜ ì¬ìƒ
        animator.applyRootMotion = true;
        animator.SetTrigger("Die");

        // ì‚¬ë§ íš¨ê³¼ìŒ ì¬ìƒ
        if (deathClip != null) audioPlayer.PlayOneShot(deathClip);
    }
}
```

- ğŸ“œLivingEntity.cs ì˜ **Die()**ì„ ë¨¼ì € ì‹¤í–‰í•˜ì—¬ ìƒëª…ì²´ë¡œì„œì˜ ê¸°ë³¸ ì‚¬ë§ ì²˜ë¦¬ë¥¼ í•œë‹¤.
    - `base.Die()`
  - <u>ê¸°ë³¸ì ì¸ ì‚¬ë§ ì²˜ë¦¬ëŠ” ë¶€ëª¨ í´ë˜ìŠ¤ì¸ ğŸ“œLivingEntity.csì˜ Die() í•¨ìˆ˜ì—ì„œ ì´ë£¨ì–´ì§„ë‹¤.</u>
    - LivingEntityì˜ ìì‹ì¸ ğŸ“œPlayerHealth.cs ìŠ¤í¬ë¦½íŠ¸ë‚˜ ğŸ“œEnemy.cs ìŠ¤í¬ë¦½íŠ¸ë‚˜,  ê³µí†µì ì¸ ìƒëª…ì²´ë¡œì„œì˜ ì‚¬ë§ ë¡œì§ì€ ë™ì¼í•˜ê¸° ë•Œë¬¸ì— `base.Die()`ë¡œ ì²˜ë¦¬ í•˜ëŠ” ê²ƒì´ë‹¤.
      - ì‚¬ë§ í•˜ê³  ë‚œ í›„ì— ìˆ˜í–‰í•  í–‰ë™ì´ë¼ë˜ê°€ ì• ë‹ˆë©”ì´ì…˜ ê°™ì€ ê²ƒì€ ì¢€ë¹„ë‘ í”Œë ˆì´ì–´ ìºë¦­í„°ê°€ ì„œë¡œ ë‹¤ë¥´ê²Œ ì¼ì–´ë‚˜ë¯€ë¡œ ì´ ë¶€ë¶„ë§Œ ì˜¤ë²„ë¼ì´ë”©ëœ **Die** í•¨ìˆ˜ì— ë§ë¶™ì—¬ ì£¼ë©´ ë˜ëŠ” ê²ƒì´ë‹¤.
- ë‹¤ë¥¸ AIë“¤ì„ ë°©í•´í•˜ì§€ ì•Šë„ë¡, ì˜ˆë¥¼ ë“¤ì–´ ê¸¸ë§‰í•˜ì§€ ì•Šë„ë¡ ìì‹ ì˜ ëª¨ë“  ì½œë¼ì´ë”ë“¤ì„ ë¹„í™œì„±í™”
  - `GetComponent<Collider>().enabled = false;`
    - ìê¸° ìì‹ ì˜ Collider ì»´í¬ë„ŒíŠ¸ë¥¼ ëˆë‹¤.
- AI ì¶”ì ì„ ì¤‘ì§€í•˜ê³  ë‚´ë¹„ë©”ì‰¬ ì»´í¬ë„ŒíŠ¸ë¥¼ ë¹„í™œì„±í™”
  - `agent.isStopped = true` í•˜ëŠ” ë°©ë²•ë„ ìˆëŠ”ë° ë‹¤ë§Œ ì´ ë°©ë²•ì€ ë³¸ì¸ì˜ ì¶”ì ì„ ë©ˆì¶”ëŠ” ê²ƒì¼ ë¿ ë¹„í™œì„±í™”ëœ AgentëŠ” ì•„ë‹ˆë‹¤. <u>Nav Mesh Agentë“¤ë¼ë¦¬ëŠ” ë‚´ë¹„ê²Œì´ì…˜ ì¶”ì ì— ìˆì–´ ì„œë¡œë¥¼ ì¥ì• ë¬¼ë¡œ ì¸ì‹í•˜ê³  í”¼í•˜ê³  ë‹¤ë‹ˆê¸° ë•Œë¬¸ì— ì•„ì˜ˆ ë¹„í™œì„±í™” í•´ì£¼ëŠ” ê²ƒì´ë‹¤.</u>
    - ì¦‰, í™œì„±í™” ë˜ìˆë‹¤ë©´ ë‚˜ì¤‘ì— ì¢€ë¹„ê°€ ë§ì´ ì£½ì—ˆì„ ë•Œ ì“¸ë°ì—†ì´ í¬ê²Œ ëŒì•„ì™€ì•¼ í•˜ê³  ê·¸ë ‡ê¸° ë•Œë¬¸ ğŸ˜¢
    - ì‚¬ë§í•œ ì¢€ë¹„ëŠ” ë°Ÿê³  ë‹¤ë‹ ìˆ˜ ìˆê²Œë” í•´ì£¼ì.
- ì‚¬ë§ ì• ë‹ˆë©”ì´ì…˜ ì¬ìƒ
  - Animator ì»´í¬ë„ŒíŠ¸ì˜ `applyRootMotion`ë¥¼ Trueë¡œ í•˜ì—¬ ë£¨íŠ¸ ëª¨ì…˜ì„ ì¼œì¤€ë‹¤.
    - ì‚¬ë§ ì• ë‹ˆë©”ì´ì…˜ ìœ„ì¹˜ ê°™ì€ ê²ƒì„ ì• ë‹ˆë©”ì´ì…˜ì— ì˜í•´ í†µì œë˜ê²Œ í•˜ëŠ” ê²ƒì´ ë” ìì—°ìŠ¤ëŸ½ê¸° ë•Œë¬¸.
    - ì–´ì°¨í”¼ ì£½ì—ˆê¸° ë•Œë¬¸ì— ì½”ë“œë¡œ í†µì œí•˜ëŠ”ê²ƒ ë³´ë‹¤ëŠ” ì• ë‹ˆë©”ì´ì…˜ìœ¼ë¡œ í†µì œí•˜ëŠ” ê²ƒì´ ë” ìì—°ìŠ¤ëŸ½ë‹¤.
  - Die ì• ë‹ˆë©”ì´ì…˜ ì¬ìƒ
- ì‚¬ë§ íš¨ê³¼ìŒ ì¬ìƒ
  

<br>

## ğŸ”” ì»´í¬ë„ŒíŠ¸ ì„¤ì •

![image](https://user-images.githubusercontent.com/42318591/92291829-5aa14b00-ef55-11ea-84cc-de9f58253a30.png){: width="60%" height="60%"}{: .align-center}

- ì‚¬ë§, ë°ë¯¸ì§€ ì• ë‹ˆë©”ì´ì…˜ í´ë¦½ì„ ìœ„ì™€ ê°™ì´ í• ë‹¹í•´ì¤€ë‹¤.
- `attackRadius` ê°’ì„ 0.5ë¡œ ì¡°ê¸ˆ ì¤„ì˜€ë‹¤!
  - ![image](https://user-images.githubusercontent.com/42318591/92291946-e2875500-ef55-11ea-8da6-abecd20c27bd.png){: width="60%" height="60%"}{: .align-center}
- ì›ë˜ `targetEntity`ëŠ” `[HideInInspector]` ì†ì„±ì´ì—¬ì„œ ìŠ¬ë¡¯ì´ ì•ˆì—´ë¦¬ê³  ì•ˆë³´ì´ëŠ”ê²Œ ë§ëŠ”ë°, ì¼ë‹¨ ì½”ë“œ ìƒì—ì„œ `[HideInInspector]`ë¥¼ ì§€ì›Œ ì ì‹œ ì—´ì–´ë‘ì—ˆë‹¤. ğŸ‘‰ ì´ëŸ¬ë©´ ì¢€ë¹„ëŠ” íƒ€ê²Ÿì´ ëˆ„êµ°ì§€ ì•Œê¸° ë•Œë¬¸ì— ê²Œì„ ì‹œì‘í•˜ë©´ í”Œë ˆì´ì–´ì—ê²Œ ê·¸ëƒ¥ ë°”ë¡œ ë©€ë¦¬ì„œë„ ë‹¬ë ¤ì˜¨ë‹¤! ì´ê²ƒì„ ë³¸ í›„ ë‹¤ì‹œ ì›ë˜ëŒ€ë¡œ `[HideInInspector]`ì„ ë¶™ì—¬ ìˆ˜ì •í–ˆë‹¤. `targetEntity`ëŠ” `Player Character` ì˜¤ë¸Œì íŠ¸ê°€ ì¢€ë¹„ì˜ ì‹œì•¼ê°ì— ë“¤ì–´ì˜¬ ë•Œ **SphereCastNonAlloc** í•¨ìˆ˜ë¥¼ í†µí•´ ê°ì§€ë˜ê³  í• ë‹¹ëœë‹¤.
  - `Player Character` ì˜¤ë¸Œì íŠ¸ë¥¼ í• ë‹¹í•œë‹¤. 
    - ğŸ“œLivingEntity.cs ë¥¼ ìƒì† í•˜ëŠ” ğŸ“œPlayerHealth.cs ìŠ¤í¬ë¦½íŠ¸ë¥¼ ê°€ì§€ê³  ìˆê¸°ì— `LivingEntity` íƒ€ì…ì¸ `targetEntity`ì— í• ë‹¹ì´ ê°€ëŠ¥í•˜ë‹¤.
- `whatIsTarget` ë ˆì´ì–´ë§ˆìŠ¤í¬ëŠ” `Player`ë¡œ ì„¤ì •í•´ì¤€ë‹¤.

### í”„ë¦¬íŒ¹

![image](https://user-images.githubusercontent.com/42318591/92292634-30ea2300-ef59-11ea-87cc-35c938619efa.png){: width="60%" height="60%"}{: .align-center}

- `PlayerCharacter`ì˜ ë³€ê²½ ì‚¬í•­ì„ ëª¨ë‘ Overrides í•˜ì—¬ Apply all í•´ì¤€ë‹¤.
- `Zombie` ë˜í•œ ë³€ê²½ ì‚¬í•­ì„ ëª¨ë‘ Overrides í•˜ì—¬ Apply all í•´ì¤€ë‹¤.


***
<br>

    ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš° 
    ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}

<br>