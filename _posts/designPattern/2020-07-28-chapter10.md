---
title:  "Chapter 10. ë¹Œë” íŒ¨í„´(Builder Pattern)" 

categories:
  -  Design Pattern
tags:
  - [Game Engine, Unity, Design Pattern]

toc: true
toc_sticky: true

date: 2020-07-28
last_modified_at: 2020-07-28
---

ì¸í”„ëŸ°ì— ìˆëŠ” ì´ì¬í™˜ë‹˜ì˜ ê°•ì˜ **ê²Œì„ ë””ìì¸ íŒ¨í„´ with Unity** ë¥¼ ë“£ê³  ì •ë¦¬í•œ í•„ê¸°ì…ë‹ˆë‹¤. ğŸ˜€  
{: .notice--warning}

# Chapter 10. Builder Pattern

## ğŸ”” ê°œë…

> ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ, ê·¸ <u>ê°ì²´ë¥¼ êµ¬ì„±í•˜ëŠ” ë¶€ë¶„ ë¶€ë¶„ì„ ë‹¨ê³„ë³„ë¡œ ë¨¼ì € ìƒì„±í•˜ê³  ì´ë¥¼ ì¡°í•©</u>í•¨ìœ¼ë¡œì¨ ê°ì²´ ì „ì²´ë¥¼ ìƒì„±í•œë‹¤.

- ë³µì¡í•© ìœ í˜•ì˜ ì˜¤ë¸Œì íŠ¸ë¥¼ ì‘ì„±í•  ë•Œ ë„ì›€ëœë‹¤.
- ìƒì„±í•  ê°ì²´ì˜ ì¢…ë¥˜ë¥¼ ì†ì‰½ê²Œ ì¶”ê°€, í™•ì¥ì´ ê°€ëŠ¥í•œ ì„¤ê³„.
- í”Œë ˆì´ì–´ ìºë¦­í„° ë³„ê°œì˜ ì˜·, ë¬´ê¸° ë“±ë“±ì„ ì¡°í•©í•˜ê³  ì¥ì°©í•˜ëŠ” ë“±ë“± ì—¬ëŸ¬ê°€ì§€ ê²½ìš°ì— ìƒìš”ë  ìˆ˜ ìˆë‹¤. 

### ë¹Œë” íŒ¨í„´ Vs. ì¶”ìƒ íŒ©í† ë¦¬ íŒ¨í„´

- **Builder**
  - ë³µì¡í•œ ê°ì²´ì˜ <u>ë‹¨ê³„ë³„ ìƒì„±</u>ì— ì¤‘ì ì„ ë‘ê³  ìˆëŠ” íŒ¨í„´
  - <u>ë§ˆì§€ë§‰ ë‹¨ê³„ì—ì„œ ìƒì„±í•œ ì œí’ˆì„ ë¦¬í„´</u>í•œë‹¤.
- **Abstract Factory**
  - ì œí’ˆì˜ ìœ ì‚¬êµ°ë“¤ì´ ì¡´ì¬í•˜ëŠ” ê²½ìš° ìœ ì—°í•œ ì„¤ê³„ì— ì¤‘ì ì„ ë‘ëŠ” íŒ¨í„´
  - (ë‹¨ê³„ë§ˆë‹¤) ë§Œë“œëŠ” ì¦‰ì‹œ ì œí’ˆì„ ë¦¬í„´í•œë‹¤.
    - *í…Œë€, í”„ë¡œí† ìŠ¤ ê³µì¥ì„ ë§Œë“¤ì–´ë‘” í›„ ë§Œë“œëŠ” ì¦‰ì‹œ ë¦¬í„´*

<br>

## ğŸ”” ì˜ˆì œ 1

- íƒˆ ê²ƒ `Vehicle` 
  - ë°”í€´ê°€ 2 ê°œì¸ ê²ƒ ğŸ‘‰ Motocycle
  - ë°”í€´ê°€ 4 ê°œì¸ ê²ƒ ğŸ‘‰ Car
- ì¸í„°í˜ì´ìŠ¤ `IVehicleBuilder`
  - ìƒì† `CarBuilder`
  - ìƒì† `MotorCycleBuilder`

<br>

### ğŸ“œVehicle.cs

- *AddPart* í•¨ìˆ˜
  - ë¶€í’ˆì„ ëª¨ì•„ì„œ ë¶™ì„
- *GetPartsList* í•¨ìˆ˜
  - ë¶€í’ˆ ë¦¬ìŠ¤íŠ¸ë¥¼ ë¦¬í„´

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

// Our final product
class Vehicle
{
    public VehicleType vehicleType;
    private List<string> _parts = new List<string>();

    // Constructor method
    public Vehicle(VehicleType vehicleType)
    {
        this.vehicleType = vehicleType;
    }

    public void AddPart(string desc)
    {
        _parts.Add(desc);
    }

    public string GetPartsList()
    {
        string partsList = vehicleType.ToString() + " parts:\n\t";
        foreach (string part in _parts)
        {
            partsList += part + " ";
        }

        return partsList;
    }
}
```

<br>

### ğŸ“œInterfaceBuilder.cs

> ì¸í„°í˜ì´ìŠ¤

- <u>íƒˆ ê²ƒì˜ ì¸í„°í˜ì´ìŠ¤</u>
  1. í”„ë ˆì„ ë§Œë“¤ê¸°
  2. ì—”ì§„ ë§Œë“¤ê¸°
  3. ë°”í€´ ë§Œë“¤ê¸°

```c#
using UnityEngine;
using System.Collections.Generic;

// 'abstract Builder' class
interface IVehicleBuilder
{
    Vehicle getVehicle();

    void BuildFrame(); // í”„ë ˆì„ ë§Œë“¤ê¸°
    void BuildEngine(); // ì—”ì§„ ë§Œë“¤ê¸°
    void BuildWheels(); // ë°”í€´ ë§Œë“¤ê¸°
}

public enum VehicleType
{
    Car,
    MotorCycle
}
```

<br>

### ğŸ“œCarBuilder.cs

```c#
using UnityEngine;

class CarBuilder : IVehicleBuilder
{
    private Vehicle _vehicle;

    public Vehicle getVehicle()
    {
        return _vehicle;
    }

    public CarBuilder()
    {
        // ë¹Œë”ê°€ ë§Œë“¤ì–´ì§ˆ ë•Œ ì•„ë¬´ê²ƒë„ ì—†ëŠ” ì°¨ë„ í•˜ë‚˜ ë§Œë“ ë‹¤. (ë¶€í’ˆì´ ë¶™ê¸° ì „)
        _vehicle = new Vehicle(VehicleType.Car);
    }

    public void BuildFrame() // Carì˜ í”„ë ˆì„ ë§Œë“¤ê¸°
    {
        _vehicle.AddPart("ê°•ì² ");
    }

    public void BuildEngine() // Carì˜ ì—”ì§„ ë§Œë“¤ê¸°
    {
        _vehicle.AddPart("100ë§ˆë ¥");
    }

    public void BuildWheels()  // Carì˜ ë°”í€´ ë§Œë“¤ê¸°
    {
        _vehicle.AddPart("ì•.ì™¼ìª½ ë°”í€´");
        _vehicle.AddPart("ì•.ì˜¤ë¥¸ìª½ ë°”í€´");
        _vehicle.AddPart("ë’¤.ì™¼ìª½ ë°”í€´");
        _vehicle.AddPart("ë’¤.ì˜¤ë¥¸ìª½ ë°”í€´");
    }
}

```

<br>

### ğŸ“œMotorCycleBuilder.cs

```c#
using UnityEngine;

class MotorCycleBuilder : IVehicleBuilder
{
    private Vehicle _vehicle;

    public Vehicle getVehicle()
    {
        return _vehicle;
    }

    public MotorCycleBuilder()
    {
        // ë¹Œë”ê°€ ë§Œë“¤ì–´ì§ˆ ë•Œ ì•„ë¬´ê²ƒë„ ì—†ëŠ” ëª¨í„°ì‹¸ì´í´ë„ í•˜ë‚˜ ë§Œë“ ë‹¤.(ë¶€í’ˆì´ ë¶™ê¸° ì „)
        _vehicle = new Vehicle(VehicleType.MotorCycle);
    }

    public void BuildFrame()  // MotorCycleì˜ í”„ë ˆì„ ë§Œë“¤ê¸° 
    {
        _vehicle.AddPart("ì•Œë£¨ë¯¸ëŠ„");
    }

    public void BuildEngine() // MotorCycleì˜ ì—”ì§„ ë§Œë“¤ê¸° 
    {
        _vehicle.AddPart("50ë§ˆë ¥");
    }

    public void BuildWheels() // MotorCycleì˜ ë°”í€´ ë§Œë“¤ê¸° 
    {
        _vehicle.AddPart("ì• ë°”í€´");
        _vehicle.AddPart("ë’¤ ë°”í€´");
    }
}

```

<br>

### ğŸ“œEngineer.cs

> ë¶€í’ˆë“¤(í”„ë ˆì„, ì—”ì§„, ë°”í€´)ë¥¼ ë§Œë“¤ì–´ì£¼ëŠ” ì—­í• 

- `ë‹¤í˜•ì„±`
  - IVehicleBuilder vehicleBuilder
    - ì–´ë–¤ ì¢…ë¥˜ì˜ íƒˆ ê²ƒì´ ë“¤ì–´ì˜¤ëŠëƒì— ë”°ë¼ì„œ ë¶€í’ˆë“¤ì´ ë‹¤ë¥´ê²Œ ìƒì„±ë˜ê² ì§€

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

class Engineer
{
    public void Construct(IVehicleBuilder vehicleBuilder)
    {
        vehicleBuilder.BuildFrame();
        vehicleBuilder.BuildEngine();
        vehicleBuilder.BuildWheels();
    }
}

```

<br>

### ğŸ“œBuilderUse.cs

```c#
using UnityEngine;

public class BuilderUse : MonoBehaviour
{
    void Start()
    {
        // Instantiate the director and builders
        Engineer engineer = new Engineer();  // â­ ì—”ì§€ë‹ˆì–´ ë§Œë“¤ê¸°
        CarBuilder carBuilder = new CarBuilder(); // ë¹ˆ Car ë§Œë“¤ê¸°
        MotorCycleBuilder motorCycleBuilder = new MotorCycleBuilder();  // ë¹ˆ MotorCycle ë§Œë“¤ê¸°

        // ë¹Œë”ë¥¼ í†µí•´ êµ¬ì„±í•´ì•¼ í•  ì œí’ˆì„ ì…ë ¥ë°›ì•„ ì œí’ˆì„ êµ¬ì„±í•œë‹¤.
        // ë¶€í’ˆë“¤ì„ ë¶™ì¸ë‹¤.
        engineer.Construct(carBuilder);  
        engineer.Construct(motorCycleBuilder);

        // ìµœì¢… ìƒì‚°ëœ ì™„ì„±ëœ ì œí’ˆì„ ë°˜í™˜ë°›ëŠ”ë‹¤.
        Vehicle car = carBuilder.getVehicle();
        Debug.Log(car.GetPartsList());
        Vehicle motorCycle = motorCycleBuilder.getVehicle();
        Debug.Log(motorCycle.GetPartsList());
    }

}

```

![image](https://user-images.githubusercontent.com/42318591/88627043-a820d180-d0e6-11ea-8f55-a7daed434431.png){: width="70%" height="70%"}{: .align-center}


## ğŸ”” ì˜ˆì œ 2

- íƒˆ ê²ƒ `Vehicle` 
  - ë°”í€´ê°€ 2 ê°œì¸ ê²ƒ ğŸ‘‰ Motocycle
  - ë°”í€´ê°€ 4 ê°œì¸ ê²ƒ ğŸ‘‰ Car
- ì¸í„°í˜ì´ìŠ¤ `IVehicleBuilder`
  - ìƒì† `CarBuilder`
  - ìƒì† `MotorCycleBuilder`
- í”„ë¦¬íŒ¹
  - ğŸŸ¦Engine
    - ë…¸ë€ êµ¬
  - ğŸŸ¦FrameCar
    - íŒŒë€ íë¸Œ
  - ğŸŸ¦FrameCycle
    - ì´ˆë¡ íë¸Œ
  - ğŸŸ¦ParentOfVehicle
    - ë¹ˆ ì˜¤ë¸Œì íŠ¸ë¡œ ë¶€í’ˆë“¤ì„ ëª¨ìœ¼ê¸° ìœ„í•œ ìš©ë„
    - ê²Œì„ì´ ì‹¤í–‰ë˜ë©´ ë¶€í’ˆë“¤ì´ ì–˜ì˜ ìì‹ì´ë˜ì–´ ìë™ì°¨, ì˜¤í† ë°”ì´ë¥¼ ë§Œë“ ë‹¤.
  - ğŸŸ¦Wheel
    - ë¹¨ê°„ êµ¬

### ğŸ“œVehicle.cs

> ğŸŸ¦ParentOfVehicle í”„ë¦¬íŒ¹ì— ë¶™ì¸ë‹¤.

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

// Our final product
public class Vehicle : MonoBehaviour
{
    private VehicleType vehicleType;

    public void setVehicleType(VehicleType vehicleType)
    {
        this.vehicleType = vehicleType;
    }

    public void AddPart(GameObject part, Vector3 localPosition)
    {
        GameObject obj = Instantiate(part) as GameObject;  
        obj.transform.localPosition = localPosition;
        obj.transform.SetParent(this.transform);
    }

    public string GetPartsList()
    {
        string partsList = vehicleType.ToString() + " parts:\n\t";

        Transform[] trs = GetComponentsInChildren<Transform>();
        for (int i = 1; i < trs.Length; i++)
        {
            partsList += trs[i].gameObject.name + " ";
        }

        return partsList;
    }
}

```

- ìœ ë‹ˆí‹°ì—ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ë‹ˆ MonoBehaviourë¥¼ ìƒì† ë°›ê³  `new`ê°€ ì•„ë‹Œ `Instantiate`ë¡œ ìƒì„±

<br>

### ğŸ“œInterfaceBuilder.cs

```c#
using UnityEngine;
using System.Collections.Generic;

// 'abstract Builder' class
interface IVehicleBuilder
{
    Vehicle getVehicle();

    void BuildFrame();
    void BuildEngine();
    void BuildWheels();
}

public enum VehicleType
{
    Car,
    MotorCycle
}
```

- ì˜ˆì œ 1ê³¼ ë˜‘ê°™

<br>

### ğŸ“œCarBuilder.cs

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

class CarBuilder : MonoBehaviour, IVehicleBuilder
{
    public GameObject ParentOfVehicle;
    public GameObject frame;
    public GameObject engine;
    public GameObject wheel1;
    public GameObject wheel2;
    public GameObject wheel3;
    public GameObject wheel4;

    private Vehicle _vehicle;

    public Vehicle getVehicle()
    {
        return _vehicle;
    }

    public void makeVehicle()
    {
        //_vehicle = new Vehicle(VehicleType.Car);
        GameObject obj = Instantiate(ParentOfVehicle) as GameObject;
        _vehicle = obj.GetComponent<Vehicle>();
        _vehicle.setVehicleType(VehicleType.Car);
    }

    public void BuildFrame()
    {
        _vehicle.AddPart(frame, Vector3.zero);
    }

    public void BuildEngine()
    {
        _vehicle.AddPart(engine, new Vector3(0, 0.5f, 0));
    }

    public void BuildWheels()
    {
        _vehicle.AddPart(wheel1, new Vector3(0.75f, -0.5f, 0.5f));
        _vehicle.AddPart(wheel2, new Vector3(-0.75f, -0.5f, 0.5f));
        _vehicle.AddPart(wheel3, new Vector3(-0.75f, -0.5f, -0.5f));
        _vehicle.AddPart(wheel4, new Vector3(0.75f, -0.5f, -0.5f));
    }
}

```

<br>

### ğŸ“œMotorCycleBuilder.cs

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

class MotorCycleBuilder : MonoBehaviour, IVehicleBuilder
{
    public GameObject ParentOfVehicle;
    public GameObject frame;
    public GameObject engine;
    public GameObject wheel1;
    public GameObject wheel2;

    private Vehicle _vehicle;

    public Vehicle getVehicle()
    {
        return _vehicle;
    }

    public void makeVehicle()
    {
        //_vehicle = new Vehicle(VehicleType.MotorCycle);
        GameObject obj = Instantiate(ParentOfVehicle) as GameObject;
        _vehicle = obj.GetComponent<Vehicle>();
        _vehicle.setVehicleType(VehicleType.MotorCycle);
    }

    public void BuildFrame()
    {
        _vehicle.AddPart(frame, Vector3.zero);
    }

    public void BuildEngine()
    {
        _vehicle.AddPart(engine, new Vector3(0, 0.5f, 0));
    }

    public void BuildWheels()
    {
        _vehicle.AddPart(wheel1, new Vector3(1.5f, 0, 0));
        _vehicle.AddPart(wheel2, new Vector3(-1.5f, 0, 0));
    }
}

```

<br>

### ğŸ“œEngineer.cs

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

// Our 'Director' class.
class Engineer
{
    public void Construct(IVehicleBuilder vehicleBuilder)
    {
        vehicleBuilder.BuildFrame();
        vehicleBuilder.BuildEngine();
        vehicleBuilder.BuildWheels();
    }
}

```


<br>

### ğŸ“œBuilderUse.cs

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class BuilderUse : MonoBehaviour
{
    void Start()
    {
        // Instantiate the director and builders
        Engineer engineer = new Engineer();
        //CarBuilder carBuilder = new CarBuilder();
        CarBuilder carBuilder = GetComponent<CarBuilder>();
        carBuilder.makeVehicle();
        //MotorCycleBuilder motorCycleBuilder = new MotorCycleBuilder();
        MotorCycleBuilder motorCycleBuilder = GetComponent<MotorCycleBuilder>();
        motorCycleBuilder.makeVehicle();

        // ë¹Œë”ë¥¼ í†µí•´ êµ¬ì„±í•´ì•¼ í•  ì œí’ˆì„ ì…ë ¥ë°›ì•„ ì œí’ˆì„ êµ¬ì„±í•œë‹¤.
        engineer.Construct(carBuilder);
        engineer.Construct(motorCycleBuilder);

        // ìµœì¢… ìƒì‚°ëœ ì œí’ˆì„ ë°˜í™˜ë°›ëŠ”ë‹¤.
        Vehicle car = carBuilder.getVehicle();
        Debug.Log(car.GetPartsList());
        
        Vehicle motorCycle = motorCycleBuilder.getVehicle();
        Debug.Log(motorCycle.GetPartsList());

        // ìµœì¢… ìƒì‚°ëœ ì œí’ˆì˜ ìœ„ì¹˜ë¥¼ ì§€ì •í•œë‹¤.
        car.transform.position = new Vector3(-3f, 0, 0);
        motorCycle.transform.position = new Vector3(3f, 0, 0);
    }

}

```

### ìœ ë‹ˆí‹° ì ìš©

- `Game Manager`ë¼ëŠ” ë¹ˆ ì˜¤ë¸Œì íŠ¸ë¥¼ ë§Œë“  í›„
  - ğŸ“œCarBuilder.cs ì™€ ğŸ“œMotorCycleBuilder.cs ì™€ ğŸ“œBuilderUse.cs ë¥¼ ë¶™ì—¬ì¤€ë‹¤. 
- í”„ë¦¬íŒ¹ ì—°ê²°
  - ![image](https://user-images.githubusercontent.com/42318591/91811471-84fbbb80-ec6a-11ea-87e2-895981fd1c53.png){: width="70%" height="70%"}{: .align-center}
- ì•„ë˜ì™€ ê°™ì´ ë§Œë“¤ì–´ì§„ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.
  - ![image](https://user-images.githubusercontent.com/42318591/91811517-98a72200-ec6a-11ea-9d04-55345ee5f3d8.png){: width="70%" height="70%"}{: .align-center}


***
<br>

    ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš° 
    ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}