---
title:  "Chapter 7. ì›í˜• íŒ¨í„´(Prototype Pattern)" 

categories:
  -  Design Pattern
tags:
  - [Game Engine, Unity, Design Pattern, C Sharp]

toc: true
toc_sticky: true

date: 2020-07-16
last_modified_at: 2020-07-16
---

ì¸í”„ëŸ°ì— ìˆëŠ” ì´ì¬í™˜ë‹˜ì˜ ê°•ì˜ **ê²Œì„ ë””ìì¸ íŒ¨í„´ with Unity** ë¥¼ ë“£ê³  ì •ë¦¬í•œ í•„ê¸°ì…ë‹ˆë‹¤. ğŸ˜€  
{: .notice--warning}

# Chapter 7. Prototype Pattern

## ğŸ”” Prototype Pattern

![image](https://user-images.githubusercontent.com/42318591/87653137-12a14b80-c790-11ea-8697-06937a82b160.png){: width="70%" height="70%"}{: .align-center}

> ì˜¤ë¸Œì íŠ¸ë¥¼ ìƒˆë¡œ ìƒì„±í• ì‹œ ê¸°ì¡´ ì˜¤ë¸Œì íŠ¸ì˜ ë³µì‚¬ë³¸ìœ¼ë¡œ ìƒì„±í•˜ì—¬ ë‚´ìš©ë§Œ ì¡°ê¸ˆ ìˆ˜ì •í•´ì¤€ë‹¤.

- `Prototype`ì„ ìƒì† ë°›ì•„ clone() ë©”ì†Œë“œë¥¼ êµ¬í˜„í•˜ëŠ” `ConcretePrototype`ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤. 
- ì›í˜•ì„ í•˜ë‚˜ ê°€ì§€ê³  ìˆê³ , ì›í˜•ì˜ `Prototype`ì„ ìƒì† ë°›ì•„  clone() ë©”ì†Œë“œë¥¼ êµ¬í˜„í•œ ìƒíƒœë¼ë©´ `Client` ì—ì„œ ì›í•  ë•Œ ì›í˜•ìœ¼ë¡œ í´ë¡ ì„ ë§Œë“¤ì–´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

### ì‚¬ìš©í•˜ëŠ” ì´ìœ 

- ì¸ìŠ¤í„´ìŠ¤ ë§Œë“¤ ë•Œ `new`ë‚˜ `Instantiate`ì„ ì‚¬ìš©í•˜ë©´ ê·¸ë§Œì¸ë° <u>ì™œ í”„ë¡œí† íƒ€ì… íŒ¨í„´ì„ ì‚¬ìš©í• ê¹Œ?</u>
  - > í”„ë¡œí† íƒ€ì… íŒ¨í„´ì€ ë¹„ìŠ·í•œ ì˜¤ë¸Œì íŠ¸ë¥¼ ì§€ì†ì ìœ¼ë¡œ ìƒì„±í•´ì•¼ í•  ë•Œ ìœ ìš©í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
    - <u>ì•„ì˜ˆ ìƒˆë¡œìš´ ì˜¤ë¸Œì íŠ¸ë¥¼ ì§€ì†ì ìœ¼ë¡œ ìƒì„± new í•˜ëŠ”ê±´ ë¶€ë‹´ìŠ¤ëŸ¬ìš´ ì¼ì´ê¸° ë•Œë¬¸.</u>
    - ê·¸ë³´ë‹¤ ì‹¼ ë¹„ìš©ì¸ <u>ë³¸ë˜ì˜ ì˜¤ë¸Œì íŠ¸ì˜ ë³µì‚¬ë³¸ì„ ë§Œë“¤ì–´ ë‚´ì–´ (ì„œë¡œ ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤), ê° ê°ì²´ì— ë”°ë¼ ë°ì´í„° ìˆ˜ì •</u>ì„ í•´ì£¼ëŠ” ë°©ì‹ìœ¼ë¡œ ì˜¤ë¸Œì íŠ¸ë¥¼ ìƒì„±í•œë‹¤.
- `ë™ì  í´ë˜ìŠ¤ í™•ì¥`
  - ì•½ê°„ì˜ ì„¤ì • ë³€ê²½ìœ¼ë¡œ ë¹„ìŠ·í•˜ì§€ë§Œ ë‹¤ë¥¸ í´ë˜ìŠ¤ë¡œì˜ í™•ì¥ì´ ê°€ëŠ¥í•œ ê²½ìš°, ì„¸ë¶€ í´ë˜ìŠ¤ë¥¼ ë¯¸ë¦¬ ëª…ì„¸í•˜ì§€ ì•Šê³ 
  - ëŸ°íƒ€ì„ ë•Œ ì›í˜•ì„ ë³µì œí•´ì„œ ê·¸ ë³µì‚¬ë³¸ì„ ìˆ˜ì •í•¨ìœ¼ë¡œì¨ ë™ì ìœ¼ë¡œ ì˜¤ë¸Œì íŠ¸ë¥¼ ìƒì„±í•¨.

<br>

## ğŸ”” ì˜ˆì œ 1

### êµ¬ì¡°

- ğŸ“œIUnit.cs
  - ğŸ§¾Iunit ì¸í„°í˜ì´ìŠ¤
    - **Clone() í•¨ìˆ˜**
      - <u>ëª¨ë“  ìœ ë‹›ë“¤ì€ Clone()í•¨ìˆ˜ë¥¼ ê°€ì§„ë‹¤.</u>
  - ğŸ§¾Marine 
    - ğŸ‘‰ğŸ» ğŸ§¾Iunit ì¸í„°í˜ì´ìŠ¤ ìƒì†
      - **Clone() í•¨ìˆ˜** ì˜¤ë²„ë¼ì´ë”©
  - ğŸ§¾Firebat 
    - ğŸ‘‰ğŸ» ğŸ§¾Iunit ì¸í„°í˜ì´ìŠ¤ ìƒì†
      - **Clone() í•¨ìˆ˜** ì˜¤ë²„ë¼ì´ë”©
- ğŸ“œUnitManager.cs
  - `ì›í˜• íŒ¨í„´` ì‚¬ìš©! 
    - ì„¤ëª…ì€ ë°‘ì—ì„œ í™•ì¸

### ğŸ“œUnit.cs

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

// 'IPrototype' interface
public interface IUnit
{
    // Method for cloning
    IUnit Clone();
}

// 'ConcretePrototype1' class implements IPrototype interface
public class Marine : IUnit
{
    public int Hp { get; set; }
    public int AttackPower { get; set; }

    // Implement shallow cloning method
    public IUnit Clone()
    {
        // Shallow Copy
        return this.MemberwiseClone() as IUnit;

        // Deep Copy
        // Implement Memberwise clone method for every reference type object 
        // return ..
    }
}

public class Firebat : IUnit
{
    public int Age { get; set; }
    public int AttackPower { get; set; }

    // Implement shallow cloning method
    public IUnit Clone()
    {
        // Shallow Copy 
        return this.MemberwiseClone() as IUnit;
    }
}
```

#### MemberwiseClone() í•¨ìˆ˜ in C#

> í•´ë‹¹ ê°ì²´ë¥¼ <u>ì–•ì€ ë³µì‚¬</u>ë¡œ <u>ë‹¨ìˆœ ë³µì‚¬ë³¸ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ë¦¬í„´</u>í•œë‹¤. 

- <u>ê°ì²´ ë³µì‚¬</u>ë¥¼ ìœ„í•´ C# Object í´ë˜ìŠ¤ì—ì„œ ì§€ì›í•˜ëŠ” í•¨ìˆ˜
  ```c#
  this.MemberwiseClone() as IUnit;
  ```
  - `IUnit` íƒ€ì…ìœ¼ë¡œ `this`(Firebat, Marine ê°ì²´)ì˜ ì‚¬ë³¸ì„ ìƒì„±í•œë‹¤.
- ê¹Šì€ ë³µì‚¬ë¥¼ í•˜ë ¤ë©´ ì´ í•¨ìˆ˜ ë§ê³  ë”°ë¡œ ê°œë°œìê°€ ì§ì ‘ ê¹Šì€ ë³µì‚¬ ë‚´ìš©ì„ êµ¬í˜„í•´ì•¼ í•œë‹¤.

<br>

### ğŸ“œUnitManager.cs

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class UnitManager : MonoBehaviour {

	void Start () {
        Marine marine = new Marine();
        marine.Hp = 25;
        marine.AttackPower = 5;

        // clone Marine object with Clone method
        // If you will not set the new value for any field the it will take the default value
        // from original object
        Marine marineClone = (Marine)marine.Clone();
        marineClone.Hp = 30;  // ê°’ë§Œ ìˆ˜ì •í•´ì¤€ë‹¤.
        marineClone.AttackPower = 6;  // ê°’ë§Œ ìˆ˜ì •í•´ì¤€ë‹¤.

        Debug.Log("Marine Details");
        Debug.LogFormat("Age: {0} / AttackPower: {1}",marine.Hp, marine.AttackPower);

        Debug.Log("Cloned Marine Details");
        Debug.LogFormat("Age: {0} / AttackPower: {1}", marineClone.Hp, marineClone.AttackPower);

        // you can perform the same operation for Firebat
    }
}
```

- ë§ˆë¦° ìµœì´ˆì˜ ìƒì„±ì€ `new`ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒì„±í•œë‹¤.
- <u>ë‘ë²ˆì§¸ ë§ˆë¦°ë¶€í„°ëŠ” ìƒˆë¡œ ìƒì„±í•˜ì§€ ì•Šê³  ê¸°ì¡´ ë§ˆë¦°ìœ¼ë¡œë¶€í„° ë³µì‚¬ë³¸ì„ ë§Œë“  í›„ ë‚´ìš©ë§Œ ìˆ˜ì •í•´ì¤€ë‹¤.</u>
- ì›ë³¸ì¸ `marine`ê³¼ ë³µì‚¬ë³¸ì¸ `marineClone`ì€ ë³„ê°œì˜ ê°ì²´ì´ë‹¤.

<br>

## ğŸ”” ì˜ˆì œ 2

- ìœ ë‹ˆí‹°ì—ì„œ ğŸŸ¦í”„ë¦¬íŒ¹ì€ ì´ë¯¸ <u>í”„ë¡œí†  íƒ€ì…</u>ì„ ë”°ë¥´ê³  ìˆì—ˆë‹¤.
  - ì›í˜•ì¸ ğŸŸ¦í”„ë¦¬íŒ¹ì„ <u>ë³µì‚¬í•´ì„œ</u> â¬œì˜¤ë¸Œì íŠ¸ë¡œ ì°ì–´ë‚´ëŠ” ê²ƒì´ê¸° ë•Œë¬¸.
  - í”„ë¦¬íŒ¹ì´ `Instantiate`ë˜ì–´ ìƒì„±ëœ ì˜¤ë¸Œì íŠ¸ë“¤ì€ ëª¨ë‘ í”„ë¦¬íŒ¹ì˜ ë³µì‚¬ë³¸ì´ë‹¤.
  - ì—¬ê¸°ì„œ ë‚´ìš©ë§Œ ì¡°ê¸ˆ ìˆ˜ì •ë  ë¿.

### ğŸ“œMarine.cs

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class Marine : MonoBehaviour
{
    void Start()
    {
        float r = Random.Range(0.0f, 1.0f);
        float g = Random.Range(0.0f, 1.0f);
        float b = Random.Range(0.0f, 1.0f);

        Renderer rend = GetComponent<Renderer>();
        rend.material.color = new Color(r, g, b, 0f);   
    }

    void OnCollisionEnter(Collision collision)
    {
        Debug.Log("OnCollisionEnter");
        Destroy(this.gameObject);
    }
}
```

- ê²Œì„ì´ ì‹œì‘ë˜ë©´ ìœ„ ğŸ“œMarine.cs ìŠ¤í¬ë¦½íŠ¸ê°€ ë¶™ëŠ” ì˜¤ë¸Œì íŠ¸ì˜ ìƒ‰ìƒì´ ëœë¤í•˜ê²Œ ì„¤ì •ëœë‹¤.
- ğŸ“œMarine.cs ìŠ¤í¬ë¦½íŠ¸ê°€ ë¶™ëŠ” ì˜¤ë¸Œì íŠ¸ê°€ ì–´ë–¤ ë¬¼ì²´ì™€ ì¶©ëŒí•˜ë©´ ì˜¤ë¸Œì íŠ¸ë¥¼ íŒŒê´´í•œë‹¤.

<br>

### ğŸ“œUnitManager.cs

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class UnitManager : MonoBehaviour {

    public GameObject unit;
    public Transform tr;

	void Start () {
    }

    public void CreateUnit()
    {
        GameObject obj = Instantiate(unit);
        obj.transform.position = tr.position;
    }
}
```

- `unit`ì— í”„ë¦¬íŒ¹ì„ ë“œë˜ê·¸ ì•¤ ë“œë¡­í•˜ì—¬ ì—°ê²°í•œë‹¤.
- `unit` í”„ë¦¬íŒ¹ì„ ë³µì‚¬í•˜ì—¬ `obj` ì˜¤ë¸Œì íŠ¸ë¥¼ ë§Œë“¤ì–´ë‚¸ë‹¤.
-  CreateUnit() ì´ í•¨ìˆ˜ëŠ” ë²„íŠ¼ ì´ë²¤íŠ¸ë¡œ ì—°ê²°í•  ê²ƒ.

***
<br>

    ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš° 
    ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}