---
title:  "Chapter 12. ì˜µì €ë²„ íŒ¨í„´(Observer Pattern)" 

categories:
  -  Design Pattern
tags:
  - [Game Engine, Unity, Design Pattern]

toc: true
toc_sticky: true

date: 2020-12-08
last_modified_at: 2020-12-08
---

ì¸í”„ëŸ°ì— ìˆëŠ” ì´ì¬í™˜ë‹˜ì˜ ê°•ì˜ **ê²Œì„ ë””ìì¸ íŒ¨í„´ with Unity** ë¥¼ ë“£ê³  ì •ë¦¬í•œ í•„ê¸°ì…ë‹ˆë‹¤. ğŸ˜€  
{: .notice--warning}

# Chapter 12. Observer Pattern

## ğŸ”” ê°œë…

> í•œ ê°ì²´ì˜ ìƒíƒœê°€ ë°”ë€Œë©´ ê·¸ ê°ì²´ì— ì˜ì¡´í•˜ëŠ” <u>ë‹¤ë¥¸ ê°ì²´ë“¤í•œí…Œ ì—°ë½ì´ ê°€ì„œ ìë™ìœ¼ë¡œ ë‚´ìš©ì´ ê°±ì‹ ë˜ëŠ” ë°©ì‹</u>. 1:N ì˜ì¡´ì„±ì„ ì •ì˜í•œë‹¤.

![image](https://user-images.githubusercontent.com/42318591/101434223-ee682600-394d-11eb-8563-70cd533cea90.png)

![image](https://user-images.githubusercontent.com/42318591/101441855-68ec7200-395d-11eb-9d0c-0ddf9a519dc4.png)

Subject ê°ì²´ê°€ `bCheck` ê°’ ë³€ê²½ì´ ì¼ì–´ë‚˜ë©´ Observer ê°ì²´ë“¤ì—ê²Œ ì´ë¥¼ ì•Œë¦°ë‹¤. ê°ê°ì˜ Observer ê°ì²´ë“¤ì˜ update() í•¨ìˆ˜ì—ì„œ ì´ë¥¼ ê°ì§€í•˜ê³  ì´ì— ë”°ë¥¸ ë™ì‘ë“¤ì„ ìˆ˜í–‰í•œë‹¤. 

- Subject ê°€ Observer ì— ëŒ€í•´ì„œ ì•„ëŠ” ê²ƒì€ Observer ê°€ íŠ¹ì • ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œë‹¤ëŠ” ê²ƒ ë¿
  - ì˜ˆë¥¼ ë“¤ì–´ Observer ê°ì²´ë“¤ì€ ëª¨ë‘ update() í•¨ìˆ˜ë¥¼ ê°€ì§€ë©° ì´ì—ì„œ ë³€í™”ë¥¼ ê°ì§€í•œë‹¤.
- Observer ëŠ” ì–¸ì œë“ ì§€ ìƒˆë¡œ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤.
  - Subject ëŠ” Observer ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ” ê°ì²´ ëª©ë¡ì—ë§Œ ì˜ì¡´í•˜ê¸° ë•Œë¬¸.
- ìƒˆë¡œìš´ í˜•ì‹ì˜ Observerë¥¼ ì¶”ê°€í•˜ë ¤ í•´ë„ Subject ë¥¼ ì „í˜€ ë³€ê²½í•  í•„ìš”ê°€ ì—†ë‹¤.
  - ìƒˆë¡œìš´ í´ë˜ìŠ¤ì—ì„œ Observer ì¸í„°í˜ì´ìŠ¤ë§Œ êµ¬í˜„í•´ì£¼ë©´ ëœë‹¤.
- Subject ë‚˜ Observer ê°€ ë°”ë€Œë”ë¼ë„ ì„œë¡œì—ê²Œ ì „í˜€ ì˜í–¥ì„ ì£¼ì§€ ì•ŠëŠ”ë‹¤. ê·¸ë˜ì„œ Subject ì™€ Observer ëŠ” ì„œë¡œ ë…ë¦½ì ìœ¼ë¡œ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

**ì„œë¸Œì íŠ¸ì—ì„œ ì˜µì €ë²„ë“¤ì„ ë¦¬ìŠ¤íŠ¸ë¡œ ê´€ë¦¬ë¥¼ í•˜ê³ , ì´ ë¦¬ìŠ¤íŠ¸ë¥¼ ìˆœíšŒí•˜ë©° ì˜µì €ë²„ë“¤ì˜ í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œí‚¤ëŠ” ì‹ìœ¼ë¡œ ì‘ë™í•œë‹¤.** ì˜ˆë¥¼ ë“¤ì–´ ë²„íŠ¼ ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ë©´ ì„œë¸Œì íŠ¸ì˜ A í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ê³  ì´ A í•¨ìˆ˜ëŠ” ì˜µì €ë²„ ì˜¤ë¸Œì íŠ¸ë“¤ì˜ B í•¨ìˆ˜ë¥¼ ì¼ê´„ì ìœ¼ë¡œ ì‹¤í–‰ì‹œí‚¤ëŠ” ì‹ìœ¼ë¡œ.

<br>

ìœ ë‹ˆí‹°, C# ì—ì„œì˜ <u>ë¸ë¦¬ê²Œì´íŠ¸ì™€ ê°™ë‹¤. ë¸ë¦¬ê²Œì´íŠ¸ê°€ ê³§ ì´ ì˜µì €ë²„ íŒ¨í„´ì¸ ê²ƒì´ë‹¤.</u> ë¸ë¦¬ê²Œì´íŠ¸ ì‚¬ìš©í•˜ë©´ ì˜µì €ë²„ ê°ì²´ë“¤ì„ ë¦¬ìŠ¤íŠ¸ë¡œ ê´€ë¦¬í•  í•„ìš”ê°€ ì—†ë‹¤.

<br>

## ğŸ”” ì˜ˆì œ 1

### ğŸ“œObserver

```c#
// ì˜µì €ë²„ ì¶”ìƒí´ë˜ìŠ¤
// : ì˜µì €ë²„ë“¤ì´ êµ¬í˜„í•´ì•¼ í•  ì¸í„°í˜ì´ìŠ¤ ë©”ì„œë“œ
public abstract class Observer
{
    // ìƒíƒœ update ë©”ì„œë“œ
    public abstract void OnNotify();
}

```

<br>

### ğŸ“œConcreteObserver1

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

// ì˜µì €ë²„ êµ¬í˜„í´ë˜ìŠ¤
public class ConcreteObserver1 : Observer
{
    // ëŒ€ìƒíƒ€ì…ì˜ í´ë˜ìŠ¤ì—ì„œ ì´ ë©”ì†Œë“œë¥¼ ì‹¤í–‰ì‹œí‚´
    public override void OnNotify()
    {
        Debug.Log("ì˜µì €ë²„ í´ë˜ìŠ¤ì˜ ë©”ì„œë“œ ì‹¤í–‰ #1");
    }
}

```

<br>

### ğŸ“œConcreteObserver2

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

// ì˜µì €ë²„ êµ¬í˜„í´ë˜ìŠ¤
public class ConcreteObserver2 : Observer
{
    // ëŒ€ìƒíƒ€ì…ì˜ í´ë˜ìŠ¤ì—ì„œ ì´ ë©”ì†Œë“œë¥¼ ì‹¤í–‰ì‹œí‚´
    public override void OnNotify()
    {
        Debug.Log("ì˜µì €ë²„ í´ë˜ìŠ¤ì˜ ë©”ì„œë“œ ì‹¤í–‰ #2");
    }
}
```

<br>

### ğŸ“œSubject

```c#
// ëŒ€ìƒ ì¸í„°í˜ì´ìŠ¤
// : ì˜µì €ë²„ ê´€ë¦¬, í™œìš©ì— ê´€í•œ íƒ€ì… ì •ì˜
public interface ISubject
{
    void AddObserver(Observer o);
    void RemoveObserver(Observer o);
    void Notify();
}
```

> ëª¨ë“  Subject ì¸í„°í˜ì´ìŠ¤ ìì‹ í´ë˜ìŠ¤ë“¤ì€ ìœ„ í•¨ìˆ˜ë“¤ìœ¼ ã„¹ì˜¤ë²„ë¼ì´ë”© í•´ì•¼ í•œë‹¤.

- AddObserver
  - ë©”ì„¸ì§€ ë¿Œë¦´ ì˜µì €ë²„ ì¶”ê°€
- RemoveObserver
  - ë©”ì„¸ì§€ ë¿Œë¦´ ì˜µì €ë²„ ì‚­ì œ
- Notify
  - ì˜µì €ë²„ë“¤ì—ê²Œ ì—°ë½í•˜ëŠ” í•¨ìˆ˜ 

<br>

### ğŸ“œConcreteSubject

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

// ëŒ€ìƒ í´ë˜ìŠ¤
// : ëŒ€ìƒ ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ í´ë˜ìŠ¤
public class ConcreteSubject : MonoBehaviour, ISubject
{
    List<Observer> observers = new List<Observer>();  // ì˜µì €ë²„ë¥¼ ê´€ë¦¬í•˜ëŠ” List

    // ê´€ë¦¬í•  ì˜µì €ë²„ë¥¼ ë“±ë¡
    public void AddObserver(Observer observer)
    {
        observers.Add(observer);
    }

    // ê´€ë¦¬ì¤‘ì¸ ì˜µì €ë²„ë¥¼ ì‚­ì œ
    public void RemoveObserver(Observer observer)
    {
        if (observers.IndexOf(observer) > 0) observers.Remove(observer);
    }

    // ê´€ë¦¬ì¤‘ì¸ ì˜µì €ë²„ì—ê²Œ ì—°ë½
    public void Notify()
    {
//        for (int i = 0; i < observers.Count; i++)
//        {
//            observers[i].OnNotify();
//        }
		foreach (Observer o in observers)
		{
			o.OnNotify();
		}
    }

    void Start()
    {
        Observer obj1 = new ConcreteObserver1();
        Observer obj2 = new ConcreteObserver2();

        AddObserver(obj1);
        AddObserver(obj2);
    }
}

```

- ì˜µì €ë²„ë“¤ì„ ë¦¬ìŠ¤íŠ¸ë¡œ ê´€ë¦¬
- Notify() í•¨ìˆ˜ë¥¼ í†µí•´ ì˜µì €ë²„ë“¤ì˜ OnNotify() í•¨ìˆ˜ë¥¼ ë‹¤ ì‹¤í–‰ì‹œí‚´
  - ìœ ë‹ˆí‹° ë²„íŠ¼ ì´ë²¤íŠ¸ì— ì´ Notify() í•¨ìˆ˜ë¥¼ ì¶”ê°€í•˜ì—¬, ë²„íŠ¼ì´ ëˆŒë¦¬ë©´ ì˜µì €ë²„ë“¤ì˜ OnNotify() í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ë„ë¡ í•œë‹¤. 


<br>

## ğŸ”” ì˜ˆì œ 2

### ğŸ“œObserver

```c#
// ì˜µì €ë²„ ì¶”ìƒí´ë˜ìŠ¤
// : ì˜µì €ë²„ë“¤ì´ êµ¬í˜„í•´ì•¼ í•  ì¸í„°í˜ì´ìŠ¤ ë©”ì„œë“œ
public abstract class Observer
{
    // ìƒíƒœ update ë©”ì„œë“œ
    public abstract void OnNotify(int num);
}
```

- ì´ë²ˆì—” Subject ë¡œ ë¶€í„° íŒŒë¼ë¯¸í„° ë°ì´í„°ë¥¼ ë°›ëŠ”ë‹¤.

<br>

### ğŸ“œConcreteObserver1

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

// ì˜µì €ë²„ êµ¬í˜„í´ë˜ìŠ¤
public class ConcreteObserver1 : Observer
{
    GameObject obj;

    // ìƒì„±ìë¥¼ í†µí•´ ê°ì²´ ì „ë‹¬
    public ConcreteObserver1(GameObject obj)
    {
        this.obj = obj;
    }

    // ëŒ€ìƒíƒ€ì…ì˜ í´ë˜ìŠ¤ì—ì„œ ì´ ë©”ì†Œë“œë¥¼ ì‹¤í–‰ì‹œí‚´
    public override void OnNotify(int num)
    {
        int num2 = obj.gameObject.GetComponent<ConcreteSubject>().getNum();

        Debug.Log("ì˜µì €ë²„ í´ë˜ìŠ¤ì˜ ë©”ì„œë“œ ì‹¤í–‰ #1");
        Debug.Log("ë©”ì„œë“œì˜ íŒŒë¼ë¯¸í„° : " + num);
        Debug.Log("ê°ì²´ ë³€ìˆ˜ë¥¼ í†µí•œ ì ‘ê·¼ : " + num2);
    }
}


```

- `obj`ë¡œ ë¶€í„° ì„œë¸Œì íŠ¸ ğŸ“œConcreteSubject ê°€ ë¶™ì–´ìˆëŠ” ì˜¤ë¸Œì íŠ¸ë¥¼ ë°›ëŠ”ë‹¤.
  - ğŸ“œConcreteSubjectì˜ í•¨ìˆ˜ì™€ ë°ì´í„°ë¥¼ ì˜µì €ë²„ê°€ ë°›ê¸° ìœ„í•˜ì—¬

<br>

### ğŸ“œConcreteObserver2

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

// ì˜µì €ë²„ êµ¬í˜„í´ë˜ìŠ¤
public class ConcreteObserver2 : Observer
{
    GameObject obj;

    // ìƒì„±ìë¥¼ í†µí•´ ê°ì²´ ì „ë‹¬
    public ConcreteObserver2(GameObject obj)
    {
        this.obj = obj;
    }

    // ëŒ€ìƒíƒ€ì…ì˜ í´ë˜ìŠ¤ì—ì„œ ì´ ë©”ì†Œë“œë¥¼ ì‹¤í–‰ì‹œí‚´
    public override void OnNotify(int num)
    {
        int num2 = obj.gameObject.GetComponent<ConcreteSubject>().getNum();

        Debug.Log("ì˜µì €ë²„ í´ë˜ìŠ¤ì˜ ë©”ì„œë“œ ì‹¤í–‰ #2");
        Debug.Log("ë©”ì„œë“œì˜ íŒŒë¼ë¯¸í„° : " + num);
        Debug.Log("ê°ì²´ ë³€ìˆ˜ë¥¼ í†µí•œ ì ‘ê·¼ : " + num2);
    }
}

```


- `obj`ë¡œ ë¶€í„° ì„œë¸Œì íŠ¸ ğŸ“œConcreteSubject ê°€ ë¶™ì–´ìˆëŠ” ì˜¤ë¸Œì íŠ¸ë¥¼ ë°›ëŠ”ë‹¤.
  - ğŸ“œConcreteSubjectì˜ í•¨ìˆ˜ì™€ ë°ì´í„°ë¥¼ ì˜µì €ë²„ê°€ ë°›ê¸° ìœ„í•˜ì—¬

<br>

### ğŸ“œSubject

```c#
// ëŒ€ìƒ ì¸í„°í˜ì´ìŠ¤
// : ì˜µì €ë²„ ê´€ë¦¬, í™œìš©ì— ê´€í•œ íƒ€ì… ì •ì˜
public interface ISubject
{
    void AddObserver(Observer o);
    void RemoveObserver(Observer o);
    void Notify();
}
```

> ëª¨ë“  Subject ì¸í„°í˜ì´ìŠ¤ ìì‹ í´ë˜ìŠ¤ë“¤ì€ ìœ„ í•¨ìˆ˜ë“¤ìœ¼ ã„¹ì˜¤ë²„ë¼ì´ë”© í•´ì•¼ í•œë‹¤.

- AddObserver
  - ë©”ì„¸ì§€ ë¿Œë¦´ ì˜µì €ë²„ ì¶”ê°€
- RemoveObserver
  - ë©”ì„¸ì§€ ë¿Œë¦´ ì˜µì €ë²„ ì‚­ì œ
- Notify
  - ì˜µì €ë²„ë“¤ì—ê²Œ ì—°ë½í•˜ëŠ” í•¨ìˆ˜ 

<br>

### ğŸ“œConcreteSubject

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

// ëŒ€ìƒ í´ë˜ìŠ¤
// : ëŒ€ìƒ ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ í´ë˜ìŠ¤
public class ConcreteSubject : MonoBehaviour, ISubject
{
    List<Observer> observers = new List<Observer>();  // ì˜µì €ë²„ë¥¼ ê´€ë¦¬í•˜ëŠ” List
    private int myNum;

    // ê´€ë¦¬í•  ì˜µì €ë²„ë¥¼ ë“±ë¡
    public void AddObserver(Observer observer)
    {
        observers.Add(observer);
    }

    // ê´€ë¦¬ì¤‘ì¸ ì˜µì €ë²„ë¥¼ ì‚­ì œ
    public void RemoveObserver(Observer observer)
    {
        if (observers.IndexOf(observer) > 0) observers.Remove(observer);
    }

    // ê´€ë¦¬ì¤‘ì¸ ì˜µì €ë²„ì—ê²Œ ì—°ë½
    public void Notify()
    {
		  foreach (Observer o in observers)
		  {
			  o.OnNotify(myNum); 
		  } 
    }

    void Start()
    {
        myNum = 10;

        Observer obj1 = new ConcreteObserver1(this.gameObject);
        Observer obj2 = new ConcreteObserver2(this.gameObject);

        AddObserver(obj1);
        AddObserver(obj2);
    }

    public int getNum()
    {
        return myNum;
    }
}


```

- ì˜µì €ë²„ë“¤ì—ê²Œ `myNum` ë°ì´í„°ë¥¼ ì•Œë ¤ì¤€ë‹¤.  `o.OnNotify(myNum);`
- ì˜µì €ë²„ë“¤ì—ê²Œ ìì‹ ì˜ ì˜¤ë¸Œì íŠ¸ë¥¼ ë„˜ê²¨ `this.gameObject`, ì´ë¥¼ í†µí•´ ğŸ“œConcreteSubject ì˜ `getNum()` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤. 

<br>

## ğŸ”” ì˜ˆì œ 3 (delegate ì‚¬ìš©)

ë‚˜ë¨¸ì§€ ì½”ë“œë“¤ì€ ì˜ˆì œ 2 ì™€ ì¼ì¹˜í•˜ë‹¤.

### ğŸ“œConcreteSubject

```c#
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class ConcreteSubject : MonoBehaviour
{
  //  List<Observer> observers = new List<Observer>();  // ì˜µì €ë²„ë¥¼ ê´€ë¦¬í•˜ëŠ” List
  
    private int myNum;

	  delegate void NotiHandler(int num);
	  NotiHandler _notiHandler;

    public void Notify()
    {
		    _notiHandler(myNum);
    }

    void Start()
    {
        myNum = 10;

        Observer obj1 = new ConcreteObserver1(this.gameObject);
        Observer obj2 = new ConcreteObserver2(this.gameObject);

		    _notiHandler += new NotiHandler(obj1.OnNotify);
		    _notiHandler += new NotiHandler(obj2.OnNotify);
    }

    public int getNum()
    {
        return myNum;
    }
}

```

- int íŒŒë¼ë¯¸í„° í•˜ë‚˜ë¥¼ ë°›ëŠ” void í˜• í•¨ìˆ˜ë“¤ë§Œ ë“±ë¡í•  ìˆ˜ ìˆëŠ” `_notiHandler` ë¸ë¦¬ê²Œì´íŠ¸ ê°ì²´ë¥¼ ìƒì„±í•œë‹¤.
  - ğŸ“œConcreteSubjectì˜ Notify()ëŠ” ì´ ë¸ë¦¬ê²Œì´íŠ¸ë¥¼ íŒŒë¼ë¯¸í„°ë§Œ ë„˜ê²¨ ì‹¤í–‰ì‹œí‚¬ ë¿ì´ë‹¤. ì–´ë–¤ í•¨ìˆ˜ë“¤ì´ ë“±ë¡ë˜ìˆëŠ”ì§€ ì•Œ í•„ìš” ì—†ëŠ” ì²´ë¡œ.
    - ì´ì „ì— ê°œë³„ì ìœ¼ë¡œ ë¦¬ìŠ¤íŠ¸ì— ì˜µì €ë²„ ê°ì²´ë“¤ì„ ì €ì¥í•´ë‘ê³  forë¬¸ ëŒë ¤ ì¼ì¼ì´ ì˜µì €ë²„ë“¤ì˜ OnNotifyë¥¼ ì‹¤í–‰ì‹œì¼°ë˜ ê²ƒê³¼ ë‹¬ë¦¬ ê°„ë‹¨.
- ë¸ë¦¬ê²Œì´íŠ¸ì— ê·¸ì € ì˜µì €ë²„ì˜ OnNotify í•¨ìˆ˜ë¥¼ ë“±ë¡ì‹œí‚¬ ë¿ì´ë‹¤.
  ```c#
  		  _notiHandler += new NotiHandler(obj1.OnNotify);
		    _notiHandler += new NotiHandler(obj2.OnNotify);
  ```



***
<br>

    ğŸŒœ ê°œì¸ ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ì´ ìˆì„ ê²½ìš° 
    ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}