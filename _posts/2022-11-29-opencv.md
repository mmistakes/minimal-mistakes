---
layout: single
title:  "[DL/CV] ì´ë¯¸ì§€ ì²˜ë¦¬í•˜ê¸° - openCV ğŸ–¼ï¸"
toc: true
toc_sticky: true
categories:
  - visions
---

## 8. ì˜ìƒ(ì´ë¯¸ì§€) ë‹¤ë£¨ê¸° (OpenCV, Matplotlib)

### 8.1 ì´ë¯¸ì§€ ë¶ˆëŸ¬ì˜¤ê¸°, ì¶œë ¥í•˜ê¸°, ì €ì¥í•˜ê¸°
#### 8.1.1 openCV ì‚¬ìš©í•´ì„œ
ë¨¼ì € ê¸°ë³¸ì ìœ¼ë¡œ opencvë¥¼ ì´ìš©í•´ì„œ ì´ë¯¸ì§€ë¥¼ ì¶œë ¥í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ì.


```python
import os
import glob
import cv2
from google.colab.patches import cv_imshow # colabì—ì„œëŠ” imshow ì‚¬ìš© ë¶ˆê°€
```


```python
image_path = '/content/Lenna.png' # ì´ë¯¸ì§€ ê²½ë¡œ ì§€ì •
image = cv2.imread(image_path) # ì´ë¯¸ì§€ ë¶ˆëŸ¬ì˜¤ê¸°
```


```python
cv_imshow(image) # cv_imshowë¥¼ ì‚¬ìš©í•´ì„œ ì´ë¯¸ì§€ ì¶œë ¥í•˜ê¸°
```




    
![opencv1](https://user-images.githubusercontent.com/77332628/204678180-290321f9-e5cb-4ff8-9ef0-093165549ba6.png)



ì´ë¯¸ì§€ë¥¼ ì½ì–´ì˜¤ëŠ” imread í•¨ìˆ˜ëŠ” **flags**ë¥¼ í†µí•´ì„œ ì´ë¯¸ì§€ íƒ€ì…ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤. ê°€ì¥ ë§ì´ ì‚¬ìš©í•˜ëŠ” 3ê°€ì§€ flagsì— ëŒ€í•´ì„œ ì•Œì•„ë³´ì.

* IMREAD_COLOR
ë”°ë¡œ flags ê°’ì„ ì§€ì •í•´ì£¼ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •ë˜ëŠ” ê°’ì´ë©° BGR ì±„ë„ê°’ìœ¼ë¡œ í‘œí˜„ë˜ëŠ” ì˜µì…˜ì´ë‹¤.




```python
img_color = cv2.imread(image_path, cv2.IMREAD_COLOR)
cv_imshow(img_color)
```




    
![opencv2](https://user-images.githubusercontent.com/77332628/204678190-8f8e8ae9-4a65-49df-a6a8-75782af46c10.png)
    



* IMREAD_GRAYSCALE
í‘ë°±ì‚¬ì§„ ê°™ì´ ìƒ‰ìƒ ì •ë³´ ì—†ì´ ì˜¤ì§ ë°ê¸° ì •ë³´ë§Œìœ¼ë¡œ êµ¬ì„±ëœ ì´ë¯¸ì§€ íŒŒì¼ì´ê³  ë°ê¸°ëŠ” 256ë‹¨ê³„ë¡œ ë³€í™˜í•´ì„œ ë³´ì—¬ì¤€ë‹¤.


```python
img_gray = cv2.imread(image_path, cv2.IMREAD_GRAYSCALE)
cv_imshow(img_gray)
```




    
![opencv3](https://user-images.githubusercontent.com/77332628/204678192-08ac2a65-ed00-47fa-8eee-39df126c2172.png)
    



* IMREAD_UNCHANGED
ì›ë³¸ì˜ ìƒ‰ ê·¸ëŒ€ë¡œ ì¶œë ¥í•˜ëŠ” ê°’ì´ë‹¤. ë¨¼ì € ì½”ë“œë¡œ ì¶œë ¥í•´ë³´ì.


```python
img_unchanged = cv2.imread(image_path, cv2.IMREAD_UNCHANGED)
cv_imshow(img_unchanged)
```




    
![opencv4](https://user-images.githubusercontent.com/77332628/204678195-5fe8b7fb-8740-429b-aa6e-5d49305165c5.png)
    



IMREAD_COLORê³¼ ê°™ì€ ê²°ê³¼ë¥¼ ì¶œë ¥í•œ ê²ƒì²˜ëŸ¼ ë³´ì´ì§€ë§Œ IMREAD_COLORëŠ” 3ì±„ë„ê°’ì¸ BGRë¡œ ë³€í™˜ë˜ì–´ ì¶œë ¥í•˜ì§€ë§Œ IMREAD_UNCHANGEDëŠ” ìƒ‰ìƒê°’ ë³€ê²½ ì—†ì´ ì›ë³¸ì‚¬ì§„ ê·¸ëŒ€ë¡œë¥¼ ì¶œë ¥í•˜ê¸° ë•Œë¬¸ì— ë°°ê²½ì´ íˆ¬ëª…í•œ png íŒŒì¼ ë“±ì—ì„œ, alpha channelê¹Œì§€ í¬í•¨í•´ì„œ ì½ì„ ìˆ˜ ìˆë‹¤. ê·¸ë¦¬ê³  IMREAD_COLOR, IMREAD_GRAYSCALE, IMREAD_UNCHANGED ëŒ€ì‹ ì— ìˆœì„œëŒ€ë¡œ 1,0,-1 ê°’ì„ ì‚¬ìš©í•´ë„ ëœë‹¤.

ì´ë¯¸ì§€ ì €ì¥ì€ cv2.imwrtie() í•¨ìˆ˜ë¥¼ ì´ìš©í•´ì„œ ê°€ëŠ¥í•˜ë‹¤. cv2.imwrite('ì €ì¥í•  íŒŒì¼ëª…', ì €ì¥í•  ì‚¬ì§„)ì„ ì§€ì •í•´ì£¼ë©´ ëœë‹¤.



```python
cv2.imwrite('new_lenna.jpg',img_gray) 
```




    True




```python
saved_image_path = '/content/new_lenna.jpg'
saved_image = cv2.imread(saved_image_path)
cv_imshow(saved_image)
```




    
![opencv5](https://user-images.githubusercontent.com/77332628/204678199-353441da-b1b0-414b-b6ff-81dcba41d5f2.png)
    



*ì €ì¥ëœ* ì´ë¯¸ì§€ë¥¼ ì˜ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆëŠ” ê±¸ë¡œ ë³´ì•„ ì´ë¯¸ì§€ ì €ì¥ì´ ì„±ê³µì ìœ¼ë¡œ ì´ë¤„ì§„ ê²ƒ ê°™ë‹¤.

#### 8.1.2 Matplotlib ì‚¬ìš©í•˜ê¸°
Matplotlibì€ ì´ë¯¸ì§€ë¥¼ í™•ëŒ€í•˜ê±°ë‚˜ í•˜ë‚˜ì˜ í™”ë©´ì— ì—¬ëŸ¬ê°œì˜ ì´ë¯¸ì§€ë¥¼ ì¶œë ¥í•˜ê³ ì í•  ë•Œ ìœ ìš©í•˜ê²Œ ì“°ì´ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë‹¤.


```python
import cv2
from matplotlib import pyplot as plt

img = cv2.imread(image_path,1)
plt.imshow(img)
plt.xticks([]) # xì¶• ëˆˆê¸ˆ ì„¤ì •
plt.yticks([]) # yì¶• ëˆˆê¸ˆ ì„¤ì •
plt.show()
```




    
![opencv6](https://user-images.githubusercontent.com/77332628/204678201-e0b77108-9725-4401-b699-81fd80291b08.png)
    



ê·¼ë° ì¶œë ¥í•œ ì´ë¯¸ì§€ì˜ ìƒ‰ì´ ì›ë³¸ê³¼ ë‹¤ë¥´ë‹¤. ì›ë³¸ ì´ë¯¸ì§€ëŠ” ë¶‰ì€ìƒ‰ ê³„ì—´ì˜ ìƒ‰ì´ ëŒ€ë¶€ë¶„ì¸ë°, ì¶œë ¥ëœ ì´ë¯¸ì§€ëŠ” íŒŒë€ìƒ‰ ê³„ì—´ì˜ ì´ë¯¸ì§€ì´ë‹¤. ì´ëŸ¬ëŠ” ì´ìœ ëŠ” openCVëŠ” BGRì´ì§€ë§Œ Matplotlibì€ RGBë¡œ ì´ë¯¸ì§€ë¥¼ ì¶œë ¥í•˜ê¸° ë•Œë¬¸ì´ë‹¤. ì¦‰, ê²°ê³¼ ê°’ì€ 3ì°¨ì› ë°°ì—´ì˜ ì²«ë²ˆì§¸ì™€ ë§ˆì§€ë§‰ ê°’ì„ ì„œë¡œ ë°”ê¿”ì¤˜ì•¼ í•œë‹¤.


```python
b, g, r = cv2.split(img) # img íŒŒì¼ì„ b,g,rë¡œ ë¶„ë¦¬
img2 = cv2.merge([r,g,b]) # r,g,b ìˆœì„œë¡œ ë°”ê¿”ì„œ merge
# img2 = cv2.cvtColor(img, cv2.COLOR_BGR2RGB) ë„ ì‚¬ìš©ê°€ëŠ¥
plt.imshow(img2)
plt.xticks([]) # xì¶• ëˆˆê¸ˆ ì„¤ì •
plt.yticks([]) # yì¶• ëˆˆê¸ˆ ì„¤ì •
plt.show()
```




    
![opencv7](https://user-images.githubusercontent.com/77332628/204678203-d4de4ee6-8f48-45c6-844d-f28f1fa4a43e.png)
    



### 8.2 ë„í˜• ê·¸ë¦¬ê¸°
openCVë¥¼ ì‚¬ìš©í•´ì„œ ë‹¤ì–‘í•œ ë„í˜•ì„ ê·¸ë¦´ ìˆ˜ ìˆë‹¤. ë„í˜• ê·¸ë¦¬ê¸°ëŠ” ì´ë¯¸ì§€ ë¶„í•  ê°™ì€ ë¶„ì•¼ì—ì„œ ë™ì˜ìƒì´ë‚˜ ì´ë¯¸ì§€ì—ì„œ ì›í•˜ëŠ” ì˜ì—­ì„ ì°¾ì€ í›„ì— ì‚¬ìš©ìê°€ ì¸ì‹í•˜ê¸° ì‰½ê²Œ í‘œì‹œí•˜ëŠ” ëª©ì ìœ¼ë¡œ ì‚¬ìš©ëœë‹¤.

#### 8.2.1 ì§ì„  ê·¸ë¦¬ê¸°
cv2.line(ê·¸ë¦¼ ê·¸ë¦´ ì´ë¯¸ì§€ íŒŒì¼, ì‹œì‘ ì¢Œí‘œ, ì¢…ë£Œ ì¢Œí‘œ, BGR í˜•íƒœì˜ ìƒ‰, ì„ ì˜ ë‘ê»˜)ì˜ parameterë¥¼ ì„¤ì •í•´ì„œ ì‚¬ìš©í•˜ë©´ ëœë‹¤.


```python
img = cv2.imread(image_path) # ì›ë³¸ ì´ë¯¸ì§€
copy_img = img.copy() # ì´ë¯¸ì§€ë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì›ë³¸ì´ë¯¸ì§€ë‘ ë¶„ë¦¬ ì‹œí‚¤ê¸° ìœ„í•´ copy

img_line = cv2.line(copy_img,(256,256),(300,300),(0,255,0),2)
cv_imshow(img_line)
```




    
![opencv8](https://user-images.githubusercontent.com/77332628/204678205-16e63c3d-43a3-4bbb-bbaf-25d440758f52.png)
    



#### 8.2.2 ì‚¬ê°í˜• ê·¸ë¦¬ê¸° 
cv2.line() í•¨ìˆ˜ì˜ parameterë“¤ê³¼ ê°™ì€ parameterë¥¼ ë„£ìœ¼ë©´ ë˜ì§€ë§Œ cv2.rectangleì˜ ì‹œì‘ì ê³¼ ì¢…ë£Œì ì€ ì™¼ìª½ ìœ„ ê¼­ì§“ì ê³¼ ì˜¤ë¥¸ìª½ ì•„ë˜ ê¼­ì§“ì ì„ ì„¤ì •í•˜ë©´ ëœë‹¤.


```python
copy_img = img.copy() # ì´ë¯¸ì§€ë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì›ë³¸ì´ë¯¸ì§€ë‘ ë¶„ë¦¬ ì‹œí‚¤ê¸° ìœ„í•´ copy
img_rect = cv2.rectangle(copy_img,(200,200),(300,300),(0,255,0),2)
cv_imshow(img_rect)
```




    
![opencv9](https://user-images.githubusercontent.com/77332628/204678210-52f9c561-32f2-4696-b230-351f747653ed.png)
    



#### 8.2.3 ì› ê·¸ë¦¬ê¸°
cv2.circle(ì›ë³¸ ì´ë¯¸ì§€, ì¤‘ì‹¬ ì¢Œí‘œ, ë°˜ì§€ë¦„, (B,G,R),ë‘ê»˜)ì˜ parameterë¥¼ ë„£ì–´ì£¼ë©´ ëœë‹¤. 


```python
copy_img = img.copy()
img_circle = cv2.circle(copy_img, (266,266),30,(255,0,0),2)
cv_imshow(img_circle)
```




    
![opencv10](https://user-images.githubusercontent.com/77332628/204678212-5a3ba176-ada9-41c2-8ed7-45dc34cd28a4.png)
    



ì´ì™¸ì—ë„ íƒ€ì›ê·¸ë¦¬ê¸°, ë‹¤ê°í˜• ê·¸ë¦¬ê¸°, ì´ë¯¸ì§€ì— í…ìŠ¤íŠ¸ ì¶”ê°€í•˜ê¸° í•¨ìˆ˜ë“¤ì´ ì¡´ì¬í•˜ì§€ë§Œ ë§ì´ ì‚¬ìš©í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ë‹¤ë£¨ì§€ ì•Šê³  ë„˜ì–´ê°€ê² ë‹¤.

### 8.3 ì´ë¯¸ì§€ ë³€í™˜

#### 8.3.1 Flip í•¨ìˆ˜
cv2.img(img,flipCode=?)ì—ì„œ flipCodeì— 0ì„ ë„£ìœ¼ë©´ ìƒí•˜ëŒ€ì¹­, 1ì„ ë„£ìœ¼ë©´ ì¢Œìš°ëŒ€ì¹­ì´ ëœë‹¤.


```python
copy_img = img.copy()
flip0_img = cv2.flip(copy_img,flipCode=0)
cv_imshow(flip0_img)
```




    
![opencv11](https://user-images.githubusercontent.com/77332628/204678213-b73f6ea6-160b-4792-ae02-e25614ab755e.png)
    




```python
copy_img = img.copy()
flip1_img = cv2.flip(copy_img,flipCode=1)
cv_imshow(flip1_img)
```




    
![opencv12](https://user-images.githubusercontent.com/77332628/204678214-64dcfed2-63ac-4b74-84d1-cb7c27c7c0c1.png)
    



#### 8.3.2 íšŒì „í•˜ê¸°
getRotationMatrix2D(ì¤‘ì‹¬ ì¢Œí‘œ, ê°ë„, ìŠ¤ì¼€ì¼) parameterë“¤ì„ ì„¤ì •í•˜ë©´ ë˜ëŠ”ë° ì—¬ê¸°ì„œ ê°ë„ëŠ” ì´ë¯¸ì§€ë¥¼ ì–¼ë§ˆë‚˜ íšŒì „í• ì§€, ìŠ¤ì¼€ì¼ì€ ì´ë¯¸ì§€ í™•ëŒ€ ë¹„ìœ¨ì´ë‹¤. 

í•˜ì§€ë§Œ getRotationMatrix2Dí•¨ìˆ˜ëŠ” ê·¸ì € ë³€í™˜ëœ í–‰ë ¬ê°’ë§Œ ë°˜í™˜í•˜ê¸° ë•Œë¬¸ì—, warpAffineí•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ ì¶œë ¥í•´ì•¼í•œë‹¤. wrapAffine(ì›ë³¸ ì´ë¯¸ì§€, ë³€í™˜ í–‰ë ¬, (ë„ˆë¹„,ë†’ì´)) parameterë¥¼ ì„¤ì •í•´ì£¼ë©´ ëœë‹¤.



```python
copy_img = img.copy()
width, height = copy_img.shape[:2]

rotate = cv2.getRotationMatrix2D((width/2, height/2),45,1)
img_rotate = cv2.warpAffine(copy_img,rotate,(width,height))
cv_imshow(img_rotate)
```




    
![opencv13](https://user-images.githubusercontent.com/77332628/204678216-04619af2-dcc0-4b65-b653-c173eab48322.png)
    



#### 8.3.3 ì´ë¯¸ì§€ í¬ê¸° ì¡°ì ˆ
ì´ë¯¸ì§€ì˜ í¬ê¸°ë¥¼ ì¡°ì ˆí•  ë•Œ ë‘ê°€ì§€ ë°©ë²•ì´ ìˆë‹¤.

* cv2.resize(ì›ë³¸ ì´ë¯¸ì§€, dsize=(ë³€í™˜í•  ë„ˆë¹„, ë³€í™˜í•  ë†’ì´))ë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜


```python
copy_img = img.copy()
img_resize1 = cv2.resize(copy_img,dsize=(256,256))
cv_imshow(img_resize1)
```




    
![opencv14](https://user-images.githubusercontent.com/77332628/204678218-7b645a4d-544c-433e-8e4f-240f1c2e8258.png)
    



* cv2.resize(ì›ë³¸ ì´ë¯¸ì§€, dsize=(0,0), fx=ê°€ë¡œì¶• ë¹„ìœ¨, fy= ì„¸ë¡œì¶• ë¹„ìœ¨)ë¡œ ë¹„ìœ¨ì„ ì„¤ì •í•´ì£¼ë©´ ëœë‹¤.


```python
copy_img = img.copy()
img_resize2 = cv2.resize(copy_img, dsize=(0,0),fx=0.5, fy=0.25)
cv_imshow(img_resize2)
```




    
![opencv15](https://user-images.githubusercontent.com/77332628/204678219-5c0abc9d-5b2a-44a2-a726-1ee207778727.png)

    


