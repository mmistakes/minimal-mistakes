---
title:  "[Python Pandas] ì—¬ëŸ¬ê°œì˜ í•¨ìˆ˜ë¥¼ ì ìš©í•˜ì—¬ GroupBy ì§‘ê³„í•˜ê¸° - agg()"
layout: single

categories: "Pandas"
tags: 
    - Python
    - Pandas

toc: true
toc_sticky: true
toc_label : "ëª©ì°¨"
author_profile: false
sidebar:
    nav: "study"
published: false
---

***

# GroupBy ì— agg() ë¥¼ ì‚¬ìš©í•˜ì—¬ ì§‘ê³„í•˜ê¸°
- List(ë¦¬ìŠ¤íŠ¸ ìë£Œí˜•) ì„ ì´ìš©í•˜ì—¬ <u>ì§‘ê³„ í•¨ìˆ˜ë¥¼ ì„ íƒí•˜ì—¬ ì‚¬ìš©</u>
- Dictionary (ë”•ì…”ë„ˆë¦¬ ìë£Œí˜•) ì„ ì´ìš©í•˜ì—¬ <u>ì»¬ëŸ¼ë³„ë¡œ ì§‘ê³„ í•¨ìˆ˜ë¥¼ ì§€ì •í•˜ì—¬ ì‚¬ìš©</u>
- Tuple (íŠœí”Œ) ì„ ì‚¬ìš©í•˜ì—¬ <u>ì§‘ê³„ í•¨ìˆ˜ì— ì´ë¦„ ë¶€ì—¬</u>

## ë°ì´í„° ì •ë³´
- Dataset : Kaggle íƒ€ì´íƒ€ë‹‰ (df.head() ì˜ ê²°ê³¼ë¬¼)
- [ğŸ‘‰ ë°ì´í„° ë³´ëŸ¬ê°€ê¸°](https://www.kaggle.com/competitions/titanic/data)

||	PassengerId|	Survived|	Pclass	|Name|	Sex|	Age	|SibSp|	Parch|	Ticket	|Fare	|Cabin|	Embarked|
|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|
|0	|1	|0	|3|	Braund, Mr. Owen Harris|	male|	22.0|	1|	0	|A/5 21171|	7.2500|	NaN|	S|
|1	|2|	1|	1|	Cumings, Mrs. John Bradley (Florence Briggs Th...	|female|	38.0|	1	|0	|PC 17599|	71.2833|	C85	|C|
|2|	3|	1|	3|	Heikkinen, Miss. Laina	|female|	26.0|	0	|0|	STON/O2. 3101282|	7.9250|	NaN	|S|
|3|	4|	1|	1|	Futrelle, Mrs. Jacques Heath (Lily May Peel)|	female|	35.0	|1|	0|	113803|	53.1000|	C123|	S|
|4|	5|	0	|3|	Allen, Mr. William Henry|	male	|35.0|	0|	0|	373450|	8.0500|	NaN|	S|

## (1) List ë¡œ ê·¸ë£¹ë³„ ì§‘ê³„
- List(ë¦¬ìŠ¤íŠ¸ ìë£Œí˜•) ì„ ì´ìš©í•˜ì—¬ <u>ì§‘ê³„ í•¨ìˆ˜ë¥¼ ì„ íƒí•˜ì—¬ ì‚¬ìš©</u>
- agg() ì•ˆì— ë¦¬ìŠ¤íŠ¸ë¥¼ ë„£ìœ¼ë©´, ë¦¬ìŠ¤íŠ¸ ì•ˆì— ìˆëŠ” ì§‘ê³„í•¨ìˆ˜ë¥¼ ì ìš©í•  ìˆ˜ ìˆë‹¤.

```python
# ì„±ë³„ë¡œ ê·¸ë£¹í™” í•˜ì—¬ ë‚˜ì´, ìš”ê¸ˆì„ í‰ê· , ìµœëŒ“ê°’, ìµœì†Ÿê°’, ì¤‘ì•™ê°’ ìœ¼ë¡œ ì¶œë ¥í•˜ê¸°
agg_list = ["mean", "max", "min", "median"]
df.groupby(by="Sex")[["Age", "Fare"]].agg(agg_list)
```

||Age|	|||Fare||||
|:---|:---|:---|:---|:--|:---|:---|:---|:---|
||mean|	max|	min|	median|	mean|	max	|min|	median|
|Sex|||||||||								
|female|	27.915709	|63.0|	0.75|	27.0	|44.479818	|512.3292|	6.75|	23.0|
|male|	30.726645|	80.0|	0.42|	29.0|	25.523893|	512.3292|	0.00|	10.5|


## (2) Dictionary ë¡œ ê·¸ë£¹ë³„ ì§‘ê³„
- Dictionary (ë”•ì…”ë„ˆë¦¬ ìë£Œí˜•) ì„ ì´ìš©í•˜ì—¬ <u>ì»¬ëŸ¼ë³„ë¡œ ì§‘ê³„ í•¨ìˆ˜ë¥¼ ì§€ì •í•˜ì—¬ ì‚¬ìš©</u>
- agg() ì•ˆì— ë”•ì…”ë„ˆë¦¬ë¥¼ ë„£ìœ¼ë©´, ë”•ì…”ë„ˆë¦¬ì˜ (keyê°’ == ì»¬ëŸ¼ëª…) ì— ëŒ€í•œ ì§‘ê³„ í•¨ìˆ˜ë¥¼ ì§€ì •í•  ìˆ˜ ìˆë‹¤.
- ì»¬ëŸ¼ë³„ë¡œ ë‹¤ë¥¸ ì§‘ê³„ í•¨ìˆ˜ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.

```python
# ì„±ë³„ë¡œ ê·¸ë£¹í™”í•˜ì—¬ ë‚˜ì´ëŠ” í‰ê· , ìš”ê¸ˆì€ í‰ê· , ìµœëŒ“ê°’, ìµœì†Ÿê°’ ìœ¼ë¡œ ì¶œë ¥í•˜ê¸°
agg_dict = {"Age": ["mean"], "Fare": ["mean", "max", "min"]}
df.groupby(by="Sex")[["Age", "Fare"]].agg(["mean", "max", "min", "median"])
```

|	|Age|	Fare|||
|:---|:---|:---|:---|:---|
||mean	|mean|	max	|min|
|Sex|||||				
|female|	27.915709|	44.479818|	512.3292|	6.75|
|male	|30.726645	|25.523893	|512.3292	|0.00|

## (3) Tuple ë¡œ ë£¹ë³„ ì§‘ê³„
- Tuple (íŠœí”Œ) ì„ ì‚¬ìš©í•˜ì—¬ <u>ì§‘ê³„ í•¨ìˆ˜ì— ì´ë¦„ ë¶€ì—¬</u>
- íŠœí”Œì€ (ì´ë¦„, í•¨ìˆ˜) ë¡œ í•¨ìˆ˜ì— íŠ¹ì • ì´ë¦„ì„ ë¶€ì—¬í•  ìˆ˜ ìˆë‹¤.

```python
# ê°’ì˜ ë²”ìœ„ í•¨ìˆ˜
def max_min_range(x):
    
    max_val = np.max(x)
    min_val = np.min(x)
    
    return max_val-min_val

# ì„±ë³„ë¡œ ê·¸ë£¹í™”í•˜ì—¬ ë‚˜ì´, ìš”ê¸ˆì— ëŒ€í•´ ìµœëŒ“ê°’, ìµœì†Ÿê°’, ê°’ì˜ ë²”ìœ„ ê°€ì ¸ì˜¤ê¸° 
df.groupby(by="Sex")[["Age", "Fare"]].agg([("ìµœëŒ“ê°’", max), ("ìµœì†Ÿê°’", min), ("ë²”ìœ„", max_min_range)])
```

||	Age|||	Fare|||
|:---|:---|:---|:---|:---|:---|:---|
||ìµœëŒ“ê°’|	ìµœì†Ÿê°’|	ë²”ìœ„	|ìµœëŒ“ê°’|	ìµœì†Ÿê°’|	ë²”ìœ„|
|Sex||||||
|female|	63.0|	0.75	|62.25	|512.3292	|6.75	|505.5792|
|male	|80.0	|0.42	79.58	||512.3292	|0.00	|512.3292|

<br>

# Reference
- [[Pandas ê³µì‹ë¬¸ì„œ] - pandas.DataFrame.groupby](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.groupby.html)
- [[Pandas 0.23.1 ë¬¸ì„œ] - pandas.core.groupby.DataFrameGroupBy.agg](https://pandas.pydata.org/pandas-docs/version/0.23/generated/pandas.core.groupby.DataFrameGroupBy.agg.html)
- [[ë°ì‡ê±¸ì¦ˆ2] Pandas 10ë¶„ ì™„ì„± - 7. Grouping(ê·¸ë£¹í™”)](https://dataitgirls2.github.io/10minutes2pandas/)
- [[Python pandas] ì—¬ëŸ¬ê°œì˜ í•¨ìˆ˜ë¥¼ ì ìš©í•˜ì—¬ GroupBy ì§‘ê³„í•˜ê¸° : grouped.agg()](https://rfriend.tistory.com/392)

<br>

***