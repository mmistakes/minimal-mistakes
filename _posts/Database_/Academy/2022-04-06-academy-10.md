---
layout: single
title:  " DAY-26. DataBase DDL"
categories: Database-academy
tag: [Database, DDL]
toc: true
toc_sticky: true
author_profile: false
sidebar:
  nav: "docs"
---


# ğŸ” 2022-04-06 -2 

## ë°ì´í„°ë² ì´ìŠ¤ 

<!--Quote-->

> â— ìˆ˜ì—…ì„ ë“£ê³ , ê°œì¸ì´ ê³µë¶€í•œ ë‚´ìš©ì„ ì ì€ ê²ƒ ì´ê¸°ì— ì˜¤ë¥˜ê°€ ë§ì„ ìˆ˜ë„ ìˆìŒ  


# 2022-04-06-2

## ğŸ”” DDL (Data Definition Language)

ë°ì´í„° ì •ì˜ì–´ 

ë°ì´í„°ë² ì´ìŠ¤ ê°ì²´ ìƒì„±(create), ìˆ˜ì •(alter), ì‚­ì œ(drop) í•˜ëŠ” êµ¬ë¬¸

### *ì œì•½ì¡°ê±´ (constraints)*

í…Œì´ë¸”ì„ ìƒì„±í•  ë•Œ êµ¬ì„±í•˜ëŠ” ì»¬ëŸ¼ì— ë“¤ì–´ê°ˆ ë°ì´í„°ì— ëŒ€í•´ ì œì•½ì¡°ê±´ì„ ì„¤ì •í•˜ëŠ” ê²ƒ 

â†’ ë°ì´í„°ì˜ ì¼ê´€ì„±ê³¼ ì •í™•ì„±ì„ ìœ ì§€í•˜ê¸° ìœ„í•´ì„œ(ë°ì´í„° ë¬´ê²°ì„±)



1. not null : í•´ë‹¹ ì»¬ëŸ¼ì— null ê°’ì´ ë“¤ì–´ê°ˆ ìˆ˜ ì—†ìŒ â†’ null ê°’ í—ˆìš© x
2. unique : ì¤‘ë³µëœ ê°’ì„ í—ˆìš© x â†’ nullê°’ë„ ë“¤ì–´ê°„ë‹¤ 
3. primary key(ê¸°ë³¸í‚¤) : not null + nuique â†’ nullê°’ í—ˆìš© x ì¤‘ë³µ ê°’ í—ˆìš© x â†’ ì»¬ëŸ¼ì˜ ê³ ìœ  ì‹ë³„ìë¡œ ì‚¬ìš© â†’ í•˜ë‚˜ì˜ í…Œì´ë¸”ì—ì„œ í•œë²ˆ ì‚¬ìš© ê°€ëŠ¥
4. foreign key(ì™¸ë˜í‚¤) : ë‘ í…Œì´ë¸” ê°„ì˜ ê´€ê³„ë¥¼ ì„¤ì • â†’ Aí…Œì´ë¸”(id,pw...) Bí…Œì´ë¸”(member_id, count...)ê°€ ì¡´ì¬í•œë‹¤ê³  ê°€ì • â†’ Bí…Œì´ë¸”ì˜ member_id ì»¬ëŸ¼ì— ë“¤ì–´ê°ˆ ìˆ˜ ìˆëŠ” ê°’ì´ Aí…Œì´ë¸”ì˜ idì— ìˆëŠ” ë°ì´í„°ì—¬ì•¼í•˜ëŠ” ê²½ìš°
5. check : í•´ë‹¹ ì»¬ëŸ¼ì— ì €ì¥ ê°€ëŠ¥í•œ ê°’ì˜ ë²”ìœ„ ì¡°ê±´ì„ ì§€ì •í•´ì„œ ì„¤ì •í•œ ê°’ë§Œ í—ˆìš©


---
**ğŸš€ ì œì•½ì¡°ê±´ì„ ê±°ëŠ” ë°©ì‹**



- ì»¬ëŸ¼ ë ˆë²¨  : ì»¬ëŸ¼ëª… ìë£Œí˜• ì˜†ì— ì œì•½ì¡°ê±´ëª…ì„ ëª…ì‹œ
- í…Œì´ë¸” ë ˆë²¨ :  ì»¬ëŸ¼ì„ ëª¨ë‘ ì •ì˜í•œ í›„ ë§ˆì§€ë§‰ì— ì œì•½ì¡°ê±´ëª…(ì»¬ëŸ¼ëª…) í˜•ì‹ìœ¼ë¡œ ì œì•½ì¡°ê±´ì„ ê±¸ì–´ì£¼ëŠ” ë°©ì‹




```java
ğŸ”
create table user_cons (
    no number not null unique,   // not null ê³¼ uniqueë¥¼ ê°™ì´ ì‚¬ìš©
    ,pw varchar2(100) not null
    ,name varchar2(100) not null
    ,gender varchar2(10)
);
```




<span style="color: #2D3748; background-color:#fff5b1;">ğŸš€ primary key</span>

```java
ğŸ”
// ë‘ ê°œì˜ ì»¬ëŸ¼ì„ primary keyë¡œ ë¬¶ì„ ë•Œ
create table user_cons (  
    no number 
    ,id varchar(100) 
    ,pw varchar2(100) not null
    ,gender varchar2(10)
    ,primary key (no,id)  
);

insert into user_cons values(1,'11234','tom','ë‚¨');
insert into user_cons values(1,'555aa','kacey','ì—¬');  // ê°€ëŠ¥
insert into user_cons values(1,'555aa','kacey','ì—¬'); // unique constraint ë°œìƒ
```

- primary keyë¥¼ í•˜ë‚˜ì˜ ì»¬ëŸ¼ì´ ì•„ë‹ˆë¼ ì—¬ëŸ¬ê°œì˜ ì»¬ëŸ¼ì— ëŒ€í•œ ë³µí•©í‚¤ í˜•íƒœë¡œ ì ìš©ì„ í•˜ê³  ì‹¶ë‹¤ë©´ â†’ ì»¬ëŸ¼ë ˆë²¨ì—ì„œëŠ” ë¶ˆê°€ â†’  í…Œì´ë¸” ë ˆë²¨ ì‚¬ìš©
- primary keyê°€ no, id ì´ë‹¤ â†’ no,idë¥¼ í•˜ë‚˜ì˜ ì…‹íŠ¸ë¡œ ë³´ê³  â†’ ë‘˜ë‹¤ ê°™ì€ ë°ì´í„°ë¥¼ insertë¥¼ í•˜ë©´ ì—ëŸ¬ ë°œìƒ







<span style="color: #2D3748; background-color:#fff5b1;">ğŸš€ foreign key</span>

ì°¸ì¡°ëœ ë‹¤ë¥¸ í…Œì´ë¸”ì´ ì œê³µí•˜ëŠ” ê°’ë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì œì•½í•˜ê³  ì‹¶ì„ ë•Œ

â†’ ì°¸ì¡°í•˜ëŠ” ì»¬ëŸ¼, ì°¸ì¡°ë˜ëŠ” ì»¬ëŸ¼ì„ í†µí•´ ë‘ í…Œì´ë¸”ê°„ì— ê´€ê³„ê°€ ìƒì„±

â†’ ì°¸ì¡°í•˜ëŠ” ì»¬ëŸ¼ì´ ì°¸ì¡°ë˜ëŠ” ì»¬ëŸ¼ì— ìˆëŠ” ê°’ê³¼ ì¼ì¹˜í•˜ê±°ë‚˜, NULL ê°’ë§Œ ê°€ì§ˆ ìˆ˜ ì—†ìŒ

```java

// student í…Œì´ë¸” 
create table student (
    id varchar2(100) primary key
    ,name varchar2(100) not null
    ,age number not null
);

insert into student values('001','tom',20);
insert into student values('002','salley',30);
insert into student values('003','chole',25);

// borrow í…Œì´ë¸” 1
create table borrow (
    book_id varchar2(100) primary key
    ,std_id varchar2(100)
    ,rent_date date
    ,foreign key (std_id) references student (id)  // foreign key (ì°¸ì¡°í•˜ëŠ” ì»¬ëŸ¼) references ì°¸ì¡°ëŒ€ìƒí…Œì´ë¸” (ì°¸ì¡°ëŒ€ìƒ ì»¬ëŸ¼ëª…)
);

insert into borrow values('500','005',sysdate);  // ì—ëŸ¬ ë°œìƒ -> 005ê°€ ë¬¸ì œ
insert into borrow values('500','002',sysdate);  // ì—ëŸ¬ ë°œìƒ x ë¶€ëª¨í‚¤ì— ìˆëŠ” idë§Œ ì…ë ¥ê°€ëŠ¥ 

// borrow í…Œì´ë¸” 2 
create table borrow(
    book_id varchar2(100) primary key
    , std_id varchar2(100) references student(id) // ì»¬ëŸ¼ëª… ìë£Œí˜• reference ì°¸ì¡°ëŒ€ìƒ (ì°¸ì¡°ëŒ€ìƒ ì»¬ëŸ¼ëª…)
    , rend_date date
)

insert into borrow values('500','002',sysdate); // ì—ëŸ¬ ë°œìƒ x 
```

- ì°¸ì¡°í•˜ëŠ” ì»¬ëŸ¼ : ì°¸ì¡° ëŒ€ìƒì„ ì°¸ì¡°í•˜ëŠ” í…Œì´ë¸”ì˜ ì»¬ëŸ¼ (borrow í…Œì´ë¸”)
- ì°¸ì¡°ë˜ëŠ” ì»¬ëŸ¼ : ì°¸ì¡° ëŒ€ìƒì´ ë˜ëŠ” í…Œì´ë¸” ì»¬ëŸ¼(student í…Œì´ë¸”)


---
### **ì‚­ì œ**

- ë¶€ëª¨ í…Œì´ë¸”ì—ì„œ ë°ì´í„°ë¥¼ ì‚­ì œ í•  ë•Œ ìì‹ í…Œì´ë¸”ì— ìˆëŠ” ë°ì´í„°ë¥¼ ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬í• ì§€ â†’ ì œì•½ì¡°ê±´ì„ ê±¸ ë•Œ ì‚­ì œì˜µì…˜ë„ í•¨ê»˜ ê±¸ì–´ì¤Œ
- ê¸°ë³¸ ì‚­ì œ ì˜µì…˜ì€ on delete no action â†’ ìì‹ ì„ ì°¸ì¡°í•˜ëŠ” ë°ì´í„°ê°€ ìˆë‹¤ë©´ ì‚­ì œ í•  ìˆ˜ ì—†ë‹¤.(default)

```java
ğŸ”
// ì°¸ì¡°ë˜ê³  ìˆëŠ” id -> 002 -> ì‚­ì œ
// ì°¸ì¡°ë˜ê³  ìˆëŠ” ì»¬ëŸ¼ì˜ ë°ì´í„°ë¥¼ ê°€ì§€ê³  ìˆëŠ” ìì‹ ì»¬ëŸ¼ì´ ìˆë‹¤ë©´ ì›ë³¸ í…Œì´ë¸”ì˜ ë°ì´í„° ì‚­ì œ
// borrowì—ë„ idê°€ 002ê°€ ì¡´ì¬ 

delete from student where id = '002';  // integrity constraint violated - child record found
```

<span style="color: #ffd33d">1) on delete set null</span>


```java
ğŸ”
create table student (
    id varchar2(100) primary key
    ,name varchar2(100) not null
    ,age number not null
);

insert into student values('001','tom',20);
insert into student values('002','salley',30);
insert into student values('003','chole',25);

create table borrow(
    book_id varchar2(100) primary key
    , std_id varchar2(100) references student(id) on delete set null // ì»¬ëŸ¼ëª… ìë£Œí˜• reference ì°¸ì¡°ëŒ€ìƒ (ì°¸ì¡°ëŒ€ìƒ ì»¬ëŸ¼ëª…)
    , rend_date date
);
insert into borrow values('500','002',sysdate);

delete from student where id = '002';  // studentì—ì„œ 002í–‰ ì‚¬ë¼ì§„ë‹¤
select * from borrow; // ê¸°ì¡´ì— ê°€ì§€ê³  ìˆë˜ 002 ê°’ì´ ì‚¬ë¼ì§„ë‹¤ 
```

![5.png](/assets/images/posts/2022-04-06/5.png)

![4.png](/assets/images/posts/2022-04-06/4.png)

- ë¶€ëª¨ì˜ ë°ì´í„°ê°€ ì‚­ì œë˜ë©´ ìì‹ì˜ ë°ì´í„°ê°€ nullë¡œ ë°”ë€œ â†’ ê¸°ì¡´ì˜ borrow í…Œì´ë¸”ì˜ std_id ê°€ **null**ë¡œ ë°”ë€œ

<span style="color: #ffd33d">2) on delete cascade</span>



- ë¶€ëª¨ ë°ì´í„°ê°€ ì‚­ì œë˜ë©´ í•´ë‹¹ ë°ì´í„°ë¥¼ ì°¸ì¡°í•˜ê³  ìˆëŠ” ìì‹ ë°ì´í„° ì—­ì‹œë„ í•¨ê»˜ ì‚­ì œ â†’ on delete set nullê³¼ ë‹¤ë¥´ê²Œ ì•„ì˜ˆ í–‰ ìì²´ê°€ ë‹¤ ì‚­ì œ ë˜ë²„ë¦¼
- ì˜ˆì‹œ) ê²Œì‹œê¸€ í•˜ë‚˜ì— 3ê°œì˜ ëŒ“ê¸€ì´ ë‹¬ë ¸ë‹¤ â†’ 1ë²ˆ ê²Œì‹œê¸€ ì‚­ì œ â†’ 3ê°œì˜ ëŒ“ê¸€ë„ ëª¨ë‘ ì‚­ì œ



```java
drop table borrow;
create table borrow(
    book_id varchar2(100) primary key
    , std_id varchar2(100) references student(id) on delete cascade
    , rend_date date
);
```



<span style="color: #ffd33d">3) check</span>

- ê°’ ì…ë ¥ì‹œ ì¡°ê±´ì„ ì¤€ë‹¤

```java
drop table user_cons;
create table user_cons(
    no number
    ,id varchar2(100)
    ,pw varchar2(100)
    ,gender varchar2(100) check(gender in ('ë‚¨','ì—¬'))  -- ë‚¨ ì•„ë‹ˆë©´ ì—¬ë§Œ ì…ë ¥ ê°€ëŠ¥í•˜ê²Œ ì¡°ê±´ 
    ,primary key (no,id)
);
insert into user_cons values(1,'ab123','sdasd','ë§ê³ '); // check constraint ì—ëŸ¬ 
insert into user_cons values(1,'ab123','sdasd','ë‚¨');
select * from user_cons;
```

<span style="color: #ffd33d">4) default</span>




- í…Œì´ë¸” ìƒì„±ì‹œ ê°’ì„ ì…ë ¥í•˜ì§€ ì•Šì•˜ì„ ë•Œ ìë™ìœ¼ë¡œ ë“¤ì–´ê°ˆ ê°’ ì„¤ì •

```java
create table temp(
    date_one date
    ,date_two date default sysdate // ê°’ì„ ì„¤ì • í•´ì£¼ì§€ ì•Šìœ¼ë©´ defaultë¡œ sysdateë¡œ ì¤€ë‹¤ 
);

insert into temp values(sysdate); // ì»¬ëŸ¼ì˜ ì´ ê°œìˆ˜ì™€ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ë°ì´í„°ë¥¼ ë„£ê³  ìˆì–´ ì—ëŸ¬ ë°œìƒ
insert into temp values(sysdate, default);
select * from temp;
```
---
### alter

- í…Œì´ë¸”ì— ì •ì˜ëœ ë‚´ìš©ì„ ìˆ˜ì •í•˜ê³ ì í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ë°ì´í„° ì •ì˜ì–´
- ì»¬ëŸ¼ ì¶”ê°€/ì‚­ì œ,  ì œì•½ì¡°ê±´ ì¶”ê°€/ì‚­ì œ,  ì»¬ëŸ¼ì˜ ìë£Œí˜• ë³€ê²½, defualtê°’ ë³€ê²½
- í…Œì´ë¸”ëª…/ì»¬ëŸ¼ëª…/ì œì•½ì¡°ê±´ì˜ ì´ë¦„ ë³€ê²½

```java
// í…Œì´ë¸” ìƒì„±
create table member(
    no number primary key
    ,id varchar2(100)
    ,pw varchar2(100)
);

// desc member; -- í…Œì´ë¸”ì˜ ëª¨ë“  ì •ë³´ë¥¼ ë³´ì—¬ì¤Œ

// í…Œì´ë¸” ìˆ˜ì •
 
// ì´ë¯¸ ì¡´ì¬í•˜ëŠ” member í…Œì´ë¸”ì— ìƒˆë¡œìš´ ì»¬ëŸ¼ ì¶”ê°€(name)
alter table member add (name varchar2(100));

// ìƒˆë¡œìš´ ì»¬ëŸ¼ ì¶”ê°€(age) + default 
alter table member add (age number default 0 );

// ì œì•½ ì¡°ê±´ ì¶”ê°€ -> id ì»¬ëŸ¼ì— unique ì œì•½ì¡°ê±´ ì¶”ê°€ 
alter table member add constraint id_unq unique(id);

// ì œì•½ ì¡°ê±´ ì¶”ê°€ -> pwì»¬ëŸ¼ì— not null ì œì•½ì¡°ê±´ ì¶”ê°€ -> addê°€ ì•„ë‹Œ modify 
// alter table member add constraint pw_nn not null(pw); ì—ëŸ¬
alter table member modify pw constraint pw_nn not null;

// ì»¬ëŸ¼ëª… ìˆ˜ì • -> pw ì»¬ëŸ¼ì„ password ë¼ê³  ë³€ê²½
alter table member rename column pw to password;

// ì»¬ëŸ¼ì˜ ë°ì´í„° íƒ€ì… ìˆ˜ì • - name varchar2(100) -> char(100)
alter table member modify name char(100);

// ì»¬ëŸ¼ ì‚­ì œ -age ì»¬ëŸ¼ ì‚­ì œ
alter table member drop column age; 

// ì œì•½ì¡°ê±´ ì‚­ì œ -- passwrod ì»¬ëŸ¼ì˜ ì œì•½ì¡°ê±´ ì‚­ì œ
// ì œì•½ì¡°ê±´ì˜ ì´ë¦„ì„ ë¨¼ì € ì•Œì•„ì•¼ í•¨
select constraint_name from user_constraints where table_name = 'MEMBER';
alter table member drop constraint pw_nn;

// ì œì•½ì¡°ê±´ëª… ìˆ˜ì •
alter table member rename constraint SYS_C007105 to no_pk;
select constraint_name from user_constraints where table_name = 'MEMBER';

// í…Œì´ë¸”ëª… ë³€ê²½
alter table member rename to tbl_member;
select * from member; -- ì—ëŸ¬ memberì—ì„œ tbl_memberë¡œ ë³€ê²½
select * from tbl_member;
```