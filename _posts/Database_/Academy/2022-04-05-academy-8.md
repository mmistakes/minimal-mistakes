---
layout: single
title:  " DAY-25. DataBase set Operator, ì„œë¸Œì¿¼ë¦¬"
categories: Database-academy
tag: [Database, set Operator, ì„œë¸Œì¿¼ë¦¬]
toc: true
toc_sticky: true
author_profile: false
sidebar:
  nav: "docs"
---


# ğŸ” 2022-04-05 

## ë°ì´í„°ë² ì´ìŠ¤ 

<!--Quote-->

> â— ê°œì¸ì´ ê³µë¶€í•œ ë‚´ìš©ì„ ì ì€ ê²ƒ ì´ê¸°ì— ì˜¤ë¥˜ê°€ ë§ì„ ìˆ˜ë„ ìˆìŒ 



# 2022-04-05

## ğŸ”” set Operator (ì§‘í•© ì—°ì‚°ì)

- ë‘ ê°œ ì´ìƒì˜ í…Œì´ë¸”ì„ ì¡°ì¸ ì—†ì´ ì—°ê´€ëœ ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ëŠ” ë°©ì‹
- ê° í…Œì´ë¸”ì—ì„œ ë°˜í™˜ëœ ê²°ê³¼ê°’ì„ í•˜ë‚˜ì˜ í…Œì´ë¸”ë¡œ ê²°í•©í•˜ëŠ” ë°©ì‹
- ì—¬ê±° ê°œì˜ sqlë¬¸ì„ ì‚¬ìš©í•´ì„œ í•˜ë‚˜ì˜ í…Œì´ë¸”ë¡œ ê²°ê³¼ë¥¼ ë°˜í™˜í•´ì•¼ í•˜ëŠ” ê²½ìš°

### ì¡°ê±´

1. select ì ˆì—ì„œ ì¡°íšŒí•˜ë ¤ëŠ” â€˜ì»¬ëŸ¼ì˜ ìˆ˜ê°€ ë™ì¼â€™ 
2. select ì ˆì˜ ì¢…ì¼ ìœ„ì¹˜ì— ì¡´ì¬í•˜ëŠ” ì»¬ëŸ¼ì˜ â€˜ë°ì´í„° íƒ€ì…ì´ ìƒí˜¸ í˜¸í™˜ ê°€ëŠ¥â€™

### UNION(í•©ì§‘í•©)

ì¤‘ë³µëœ ë°ì´í„°ë¥¼ ì œê±°í•˜ê³  ì²«ë²ˆì§¸ ì»¬ëŸ¼ì„ ê¸°ì¤€ìœ¼ë¡œ ì˜¤ë¦„ì°¨ìˆœí•˜ì—¬ ë°ì´í„°ë¥¼ ë³´ì—¬ ì¤Œ 

- [ ]  ê° í…Œì´ë¸”ì—ì„œ ì¡°íšŒí•˜ëŠ” ì»¬ëŸ¼ìˆ˜ê°€ ë‹¤ë¥´ë©´ ì—ëŸ¬ ë°œìƒ
- [ ]  ì¡°íšŒí•˜ë ¤ëŠ” ì»¬ëŸ¼ì´ ì„œë¡œ ìƒí˜¸í˜¸í™˜ ë¶ˆê°€í•œ(ê°™ì€ íƒ€ì…ì´ ì•„ë‹ˆë©´) ë°ì´í„°ì´ë©´ union ì‚¬ìš© x

> ğŸ’¡  UNIONì€ ì»¬ëŸ¼ì˜ ìˆ˜ì™€ ë°ì´í„°ê°€ ê°™ì•„ì•¼ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤
> 

```java
SELECT no_a from A // 1,5,3,4,2
SELECT no_b from B; // 7,6,3,8,5,9

SELECT no_a from A
UNION
SELECT no_b from B;

// 1,2,3,4,5,6,7,8,9 (ì¤‘ë³µëœ ë°ì´í„°ëŠ” ì œê±° ë˜ê³  ì¶œë ¥)
```

### UNION ALL (í•©ì§‘í•©)

ì¢…ë³µëœ ë°ì´í„°ì œê±°ë¥¼ ì•ˆí•˜ê³  , ì •ë ¬ ì—†ì´ ë°ì´í„°ë¥¼ ê·¸ëŒ€ë¡œ ë³´ì—¬ì¤€ë‹¤ 

â†’ ì¡°íšŒëœ ê²°ê³¼ê°’ì˜ ì²«ë²ˆì§¸ í…Œì´ë¸” ì•„ë˜ë¡œ ë‘ë²ˆì§¸ í…Œì´ë¸” ê²°ê³¼ê°’ì„ ê·¸ëŒ€ë¡œ ì´ì–´ë¶™ì´ëŠ” ì‹.

```java
SELECT no_a from A // 1,5,3,4,2
SELECT no_b from B; // 7,6,3,8,5,9

SELECT no_a from A
UNION ALL 
SELECT no_b from B;  // 5 3 4 2 7 6 3 8 5 9 
```

### INTERSECT (êµì§‘í•©)

ë‘ í…Œì´ë¸”ì˜ ì¿¼ë¦¬ ê²°ê³¼ ì¤‘ ê³µí†µëœ ê²°ê³¼ ê°’ë§Œ ë³´ì—¬ ì¤Œ.

```java
SELECT no_a from A // 1,5,3,4,2
SELECT no_b from B; // 7,6,3,8,5,9

SELECT no_a from A 
INTERSECT
SELECT no_b from B;     // 3 5 
```

### MINUS (ì°¨ì§‘í•©)

ë‘ í…Œì´ë¸”ì˜ ì¿¼ë¦¬ ê²°ê³¼ ì¤‘ ê³µí†µëœ ìš”ì†Œë¥¼ ëº€ í•œ í…Œì´ë¸”ì˜ ê²°ê³¼ê°’ë§Œ ë³´ì—¬ì¤Œ 

```java
SELECT no_a from A // 1,5,3,4,2
SELECT no_b from B; // 7,6,3,8,5,9

SELECT no_a from A
MINUS
SELECT no_b from B;  // 1,2,4 (ì¤‘ë³µ ì œê±° í›„ Aë¶€ë¶„ì„ ë³´ì—¬ì¤Œ)

SELECT no_b from B
MINUS
SELECT no_a from A;  // 6,7,8,9(ì¤‘ë³µ ì œê±° í›„ Bë¶€ë¶„ì„ ë³´ì—¬ì¤Œ)
```

![1.png](/assets/images/posts/2022-04-05/1.png)

## ğŸ”” ì„œë¸Œì¿¼ë¦¬ (SubQuery)

í•˜ë‚˜ì˜ sql ë¬¸ì•ˆì— í¬í•¨ëœ ë‹¤ë¥¸ sqlë¬¸ ()ì•ˆì— sql ë¬¸ ì‚½ì…

â†’ ë©”ì¸ ì¿¼ë¦¬ê°€ ì„œë¸Œ ì¿¼ë¦¬ë¥¼ í¬í•¨í•˜ëŠ” ì¢…ì†ì ì¸ ê´€ê³„ 

â†’ ì†Œê´„í˜¸ë¡œ ë¬¶ì–´ì¤Œ / ì—°ì‚°ìì˜ ì˜¤ë¥¸ìª½ì— ìœ„ì¹˜ / order by ì ˆì€ subqueryë‚´ì—ì„œ ì‚¬ìš© ë¶ˆê°€

```java
select 
    emp_id, emp_name 
from employee 
    where emp_id = select manager_id from employee where emp_name ='ì „ì§€ì—°';

// select manager_id from employee where emp_name ='ì „ì§€ì—°'ì˜ ê°’ì´ 214ê°€ ë„ì¶œë˜ì–´
// where emp_id = 214ê°€ ëœë‹¤.
```

### ë‹¨ì¼í–‰ ì„œë¸Œì¿¼ë¦¬

ì„œë¸Œì¿¼ë¦¬ ì¡°íšŒ ê²°ê³¼ ê°’ì´ 1ê°œ(í–‰)ì¼ ê²½ìš° 

```java
ğŸ”
// ì „ ì§ì›ì˜ ê¸‰ì—¬ í‰ê· ë³´ë‹¤ ê¸‰ì—¬ë¥¼ ë§ì´ ë°›ëŠ” ì‚¬ì›ì˜ ì‚¬ë²ˆ, ì‚¬ì›ëª…, ì§ê¸‰ì½”ë“œ, ì›”ê¸‰ ì¡°íšŒ


select 
    emp_id , emp_name , job_code , salary
from employee
    where salary > 3047662;

// ìœ„ ë‘ê°œì˜ ì¿¼ë¦¬ë¬¸ì„ í•˜ë‚˜ë¡œ 

select 
    emp_id , emp_name , job_code , salary
from employee 
    where salary > (select  floor(avg(salary)) from employee);
```

```java
ğŸ”
// ìœ¤ì€í•´ ì§ì›ê³¼ ê¸‰ì—¬ê°€ ê°™ì€ ì‚¬ì›ë“¤ì„ ê²€ìƒ‰ -> ì‚¬ë²ˆ, ì‚¬ì›ëª…, ê¸‰ì—¬ ì¶œë ¥ 

select 
    emp_id, emp_name, salary 
from employee   
    where salary = (select salary from employee where emp_name = 'ìœ¤ì€í•´') 
            and emp_name != 'ìœ¤ì€í•´';
```

### ë‹¤ì£¼í–‰ ì„œë¸Œì¿¼ë¦¬

ì„œë¸Œì¿¼ë¦¬ ì¡°íšŒ ê²°ê³¼ê°€ ì—¬ëŸ¬ê°œ(ì—¬ëŸ¬ í–‰) ì¼ ë•Œ

â†’ ë‹¤ì¤‘í–‰ ì„œë¸Œì¿¼ë¦¬ ì•ì—ëŠ” = , ! = ì—°ì‚°ì ì‚¬ìš© ë¶ˆê°€ 

â†’ in, not in, any, all, exists ë“±ì„ ì´ìš©

```java
ğŸ” 
//ì°¨íƒœì—°, ì „ì§€ì—° ì‚¬ì›ì˜ ê¸‰ì—¬ë“±ê¸‰(sal_level)ê³¼ ê°™ì€ ë“±ê¸‰ì„ ê°€ì§„ ì‚¬ì›ì˜ ì§ê¸‰ëª…, ì‚¬ì›ëª…, ê¸‰ì—¬ë“±ê¸‰ ì¶œë ¥

select * from job;
select emp_name , sal_level from employee where emp_name in('ì°¨íƒœì—°','ì „ì§€ì—°');
select emp_name, sal_level from employee where sal_level in ('S5','S4');

select 
    job_name "ì§ê¸‰ëª…",
    emp_name "ì‚¬ì›ëª…",
    sal_level "ê¸‰ì—¬ë“±ê¸‰"
from employee join job 
     using(job_code)
where sal_level in (select sal_level from employee where emp_name in('ì°¨íƒœì—°','ì „ì§€ì—°'));
```

**any**

ì„œë¸Œ ì¿¼ë¦¬ ê²°ê³¼ ì¤‘ì— í•˜ë‚˜ë¼ë„ ì°¸ì´ë¼ê³  í•œë‹¤ë©´ ì°¸ (or)

```java
ê°’ > any(1,2,3) : ì™¼ìª½ì— ìˆëŠ” ê°’ì´ ì˜¤ë¥¸ìª½ì˜ ìµœì†Œê°’ë³´ë‹¤ í¬ë©´ ëœë‹¤.-> ê°’ì´ 1 ë³´ë‹¤ í¬ë©´ ì°¸
ê°’ < any(1,2,3) : ì™¼ìª½ì— ìˆëŠ” ê°’ì´ ì˜¤ë¥¸ìª½ì˜ ìµœëŒ€ê°’ë³´ë‹¤ ì‘ìœ¼ë©´ ëœë‹¤ -> ê°’ì´ 3ë³´ë‹¤ ì‘ìœ¼ë©´ ì°¸
ê°’ = any(1,2,3) : inê³¼ ê°™ì€ ì˜ë¯¸
ê°’ != any(1,2,3) : not in ê³¼ ê°™ì€ ì˜ë¯¸
```

```java
ğŸ”
// ê¸‰ì—¬ê°€ 200ë§Œì› í˜¹ì€ 300ë§Œì›ë³´ë‹¤ í° ì‚¬ëŒì˜ ì‚¬ì›ëª…, ê¸‰ì—¬ ì¶œë ¥

select 
    emp_name,salary 
from employee
    where salary > any(2000000,3000000); // salaryê°€ 2000000ë³´ë‹¤ í¬ë©´ ì¶œë ¥
```

```java
ğŸ” 
// D1, D5ì˜ ë¶€ì„œì½”ë“œë¥¼ ê°€ì§„ ì‚¬ì›ë“¤ì˜ ê¸‰ì—¬ë³´ë‹¤ ì ê²Œ ë°›ëŠ” ì‚¬ì›ë“¤ì˜ ì‚¬ì›ëª…, ê¸‰ì—¬, ë¶€ì„œì½”ë“œ ì¶œë ¥
// D1, D5 ë¶€ì„œ ì§ì›ì€  ì¶œë ¥ X 
// ì •ë ¬ì€ ë¶€ì„œì½”ë“œ ê¸°ì¤€ ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬

// 1 ë²ˆì§¸ ë°©ë²•
select 
    emp_name, salary, nvl(dept_code,'ì¸í„´') "ë¶€ì„œì½”ë“œ"
from employee 
where salary < any(select salary from employee where dept_code in('D1','D5'))
        and dept_code not in ('D1','D5') or dept_code is null 
															// null ê°’ë„ ì¶œë ¥í•´ì£¼ëŠ” ì½”ë“œ dept_code is null
order by 3;

// 2 ë²ˆì§¸ ë°©ë²•
select 
    emp_name, salary, dept_code "ë¶€ì„œì½”ë“œ"
from employee 
where salary < any(select salary from employee where dept_code in('D1','D5'))
        and nvl(dept_code,'ì—†ìŒ') not in ('D1','D5')
order by 3;
```

> ğŸ’¡ null ê°’ ë¹„êµëŠ” is null í˜¹ì€ is not nullë¡œë§Œ ë¹„êµ ê°€ëŠ¥



**all**

ì„œë¸Œ ì¿¼ë¦¬ ê²°ê³¼ ì¤‘ì— ëª¨ë“  ê²ƒì´ ì°¸ì´ì—¬ì•¼ë§Œ í•¨ 

```java
ê°’ > all(1,2,3) : ì™¼ìª½ì— ìˆëŠ” ê°’ì´ ì˜¤ë¥¸ìª½ì— ìˆëŠ” ìµœëŒ€ê°’ ë³´ë‹¤ ì»¤ì•¼í•œë‹¤ 
ê°’ < all(1,2,3) : ì™¼ìª½ì— ìˆëŠ” ê°’ì´ ì˜¤ë¥¸ìª½ì— ìˆëŠ” ìµœì†Œê°’ ë³´ë‹¤ ì‘ì•„ì•¼í•œë‹¤
ê°’ = all(1,2,3) : ì™¼ìª½ì— ìˆëŠ” ê°’ì´ ì˜¤ë¥¸ìª½ì— ìˆëŠ” ê°’ì˜ ëª¨ë‘ì™€ ë˜‘ê°™ì•„ì•¼í•œë‹¤ -> and ì—°ì‚°ì 
```

### ë‹¤ì¤‘ì—´ ì„œë¸Œì¿¼ë¦¬

ì„œë¸Œì¿¼ë¦¬ ì¡°íšŒ ê²°ê³¼ ì—†ì´ ì—¬ëŸ¬ê°œ(ì—´) ì¼ ë•Œ 

```java

ğŸ”
// í‡´ì‚¬í•œ ì—¬ì§ì› -> ê°™ì€ ë¶€ì„œ, ê°™ì€ ì§ê¸‰ì— í•´ë‹¹í•˜ëŠ” ì‚¬ì›ì˜ ì‚¬ì›ëª…, ì§ê¸‰ì½”ë“œ, ë¶€ì„œì½”ë“œ, ì…ì‚¬ì¼ ì¡°íšŒ

select dept_code, job_code 
from employee 
    where ent_yn ='Y'
    and substr(emp_no,8,1) = 2;

select 
    emp_name, job_code, dept_code, hire_date
from employee 
    where dept_code ='D8' and job_code = 'J6';

select 
    emp_name, job_code, dept_code, hire_date
from employee 
    where (dept_code ,job_code) in (select dept_code, job_code from employee where ent_yn ='Y' and substr(emp_no,8,1) = 2);
```

- dept_codeì™€ job_code â†’ ì—´ì´ ë‘ê°œë‹¤ â†’ ë‹¤ì¤‘ì—´ ì„œë¸Œì¿¼ë¦¬ ì´ìš© â†’ where ì ˆ ì•ˆì— () in ()ìœ¼ë¡œ í™œìš©

```java
ğŸ”
ê¸°ìˆ ì§€ì›ë¶€ì´ë©´ì„œ ê¸‰ì—¬ê°€ 200ë§Œì›ì¸ ì§€ì›ì˜ ì‚¬ì›ëª…, ë¶€ì„œì½”ë“œ, ê¸‰ì—¬, ë¶€ì„œì˜ ì§€ì—­ëª… ì¶œë ¥ 

select * from employee join department on(dept_code = dept_id) where dept_title ='ê¸°ìˆ ì§€ì›ë¶€' and salary = 2000000;  

// ë°©ë²• 1    
select 
    emp_name,dept_code,salary,local_name
from employee join department 
        on(dept_code = dept_id) join location 
        on(location_id = local_code)
where dept_title ='ê¸°ìˆ ì§€ì›ë¶€' and salary = 2000000;

// ë°©ë²• 2 -> departmentë¥¼ ì—°ê²° í‚¤ë¡œ í•´ì„œ ì‚¬ìš© 
select 
    emp_name,dept_code,salary,local_name,local_code
from employee, location
    where (dept_code, local_code) in (select dept_id, location_id from department where dept_title = 'ê¸°ìˆ ì§€ì›ë¶€')
    and salary = 2000000;

// employeeì™€ locationì€ ì§ì ‘ ì—°ê²°í•œ í‚¤ê°€ ì—†ê¸°ì— departmentì‚¬ìš© 
```

 

### joinì—ì„œë„ group by ê°€ëŠ¥

```java
//ë¶€ì„œì½”ë“œ, ë¶€ì„œëª…, ë¶€ì„œë³„ í‰ê· ê¸‰ì—¬, ë¶€ì„œë³„ ì¸ì›ìˆ˜

select
	nvl(dept_code,'ì—†ìŒ') "ë¶€ì„œì½”ë“œ",
	nvl(dept_title,'ì—†ìŒ') "ë¶€ì„œëª…",
	floor(avg(salary)) "ë¶€ì„œë³„ í‰ê· ê¸‰ì—¬",
	count(*) "ë¶€ì„œë³„ ì¸ì›ìˆ˜"
from employee left outer join department
		on(dept_code = dept_id)
group by dept_code, dept_title  // dept_codeë¡œë§Œ í•˜ë©´ ì˜¤ë¥˜ ë°œìƒ dept_title(departmentì— ìˆìŒ)ë„ í•„ìš”
order by 1;
```