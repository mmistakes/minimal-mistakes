---
layout: single
title:  " DAY-24. DataBase Join"
categories: Database-academy
tag: [Database, Join]
toc: true
toc_sticky: true
author_profile: false
sidebar:
  nav: "docs"
---


# ğŸ” 2022-04-04 - 2

## ë°ì´í„°ë² ì´ìŠ¤ 

<!--Quote-->

> â— ê°œì¸ì´ ê³µë¶€í•œ ë‚´ìš©ì„ ì ì€ ê²ƒ ì´ê¸°ì— ì˜¤ë¥˜ê°€ ë§ì„ ìˆ˜ë„ ìˆìŒ 


# 2022-04-04 -2

# 1ï¸âƒ£ Join

- ë‘ ê°œ ì´ìƒì˜ í…Œì´ë¸”ì„ ê²°í•© í•˜ëŠ” ê²ƒ -> ì¡°í•©í•˜ë ¤ê³  í•˜ëŠ” í…Œì´ë¸”ì—ì„œ ê° í…Œì´ë¸”ì˜ ê³µí†µëœ ì»¬ëŸ¼ì„ ë°ì´í„°ë¡œ í•©ì³ì„œ í‘œí˜„í•˜ëŠ” ê²ƒ
- 2ì¤‘ forë¬¸ì´ë¼ê³  ìƒê°

## ğŸš€ì¡°ì¸ë¬¸ì„ ì‚¬ìš©í• ë•Œ ê° í…Œì´ë¸”ì´ ê°€ì§€ê³  ìˆëŠ” ì»¬ëŸ¼ëª… ê°™ì„ ë•Œ/ ì»¬ëŸ¼ëª…ì¼ ë‹¤ë¥¼ ë•Œ

### 1) ì»¬ëŸ¼ëª…ì´ ë‹¤ë¥¼ ë•Œ

```java
ğŸ”
//ë¶€ì„œì½”ë“œê°€ ê°™ì€ employee, department í…Œì´ë¸”ì˜ ì‚¬ë²ˆ, ì‚¬ì›ëª…, ë¶€ì„œì½”ë“œ, ë¶€ì„œëª… ì¡°íšŒ

// oracle ë¬¸ë²•
// emp_id, emp_name, dept_codeëŠ” employeeë§Œ ê°€ì§€ê³  ìˆê³ , dept_titleì€ departmentë§Œ ê°€ì§€ê³  ìˆë‹¤
select emp_id, emp_name, dept_code, dept_title 
    from employee, department 
        where dept_code = dept_id;

// ANSI ë¬¸ë²•
select emp_id, emp_name, dept_code, dept_title 
    from employee join department
        on(dept_code = dept_id);
```

![1.png](/assets/images/posts/2022-04-04/1.png)

### 2) ì»¬ëŸ¼ëª…ì´ ê°™ì„ ë•Œ

- ê° í…Œì´ë¸”ì˜ ë³„ì¹­ì„ ì •í•´ì¤˜ì•¼í•œë‹¤

```java
ğŸ”
// ì‚¬ë²ˆ, ì‚¬ì›ëª…, ì§ê¸‰ì½”ë“œ, ì§ê¸‰ëª…
// ê° í…Œì´ë¸”ì˜ ë³„ì¹­ì„ ì •í•´ì¤˜ì•¼í•œë‹¤

// oracle
select 
    emp_id, emp_name, e.job_code, job_name // e.job_codeì´ë“  j.job_code ì´ë“  ìƒê´€ x -> ì–´ì°¨í”¼ ê°™ì•„ì„œ
from employee e, job j       // ë³„ì¹­ ì •í•´ì£¼ê¸° 
    where e.job_code = j.job_code;    // ë³„ì¹­.ì»¬ëŸ¼ëª… = ë³„ì¹­.ì»¬ëŸ¼ëª…

// ANSI : ë‘ í…Œì´ë¸”ì˜ ê°™ì€ ì»¬ëŸ¼ëª… -> using(ì»¬ëŸ¼ëª…)
select 
    emp_id, emp_name, job_code,job_name
from employee join job
    using(job_code);

```

<aside>
ğŸ’¡ ì»¬ëŸ¼ëª…ì´ ë‹¤ë¥¼ ë•Œ â†’ on ì‚¬ìš© , ì»¬ëŸ¼ëª…ì´ ê°™ì„ ë•Œ â†’ using ì‚¬ìš©

</aside>

## ğŸš€ Joinì˜ ì¢…ë¥˜

### Cross Join (ìƒí˜¸ ì¡°ì¸)

- ì¡°ì¸ë˜ëŠ” í…Œì´ë¸”ì— ì¡°ê±´ì„ ê±¸ì–´ì£¼ì§€ ì•Šì•„ì„œ ëª¨ë“  ë°ì´í„°(ëª¨ë“  ê²½ìš°ì˜ ìˆ˜ê°€) ì¡°í•©ë˜ì–´ ë‚˜ì˜¤ëŠ” ê²½ìš°
- í•œ í…Œì´ë¸”ì˜ ì´ í–‰ìˆ˜ * ë‹¤ë¥¸ í…Œì´ë¸”ì˜ ì´ í–‰ìˆ˜

```java
ğŸ”
select * from employee, department; // oracle
select * from employee cross join department; // ANSI
```

### (Inner) Join (ë‚´ë¶€ ì¡°ì¸/ êµì§‘í•©)

ê°€ì¥ ë§ì´ ìš©í•˜ëŠ” Join í˜•íƒœ : í…Œì´ë¸” Aì™€ í…Œì´ë¸” Bì—ì„œ ì¡°ê±´ì´ ë§ëŠ” ë°ì´í„°ë§Œ ë³€í™˜

- select ì»¬ëŸ¼.. from í…Œì´ë¸” A, í…Œì´ë¸” B where ì¡°ê±´;
- select ì»¬ëŸ¼.. from í…Œì´ë¸” A inner join í…Œì´ë¸” B on ì¡°ê±´;
- select ì»¬ëŸ¼.. from í…Œì´ë¸” A join í…Œì´ë¸” B on ì¡°ê±´;

```java
ğŸ”
select * from employee, department where dept_code = dept_id; // oracle
select * from employee join department on (dept_code = dept_id); // ANSI
```

```java
ğŸ”
// ì´ë¬´ë¶€, íšŒê³„ê´€ë¦¬ë¶€ì¸ ì‚¬ì›ë“¤ì˜ ì‚¬ì›ëª…, ì´ë©”ì¼, ë¶€ì„œëª…, ë¶€ì„œì½”ë“œë§Œ ì¡°íšŒ

// oracle
select 
    emp_name "ì‚¬ì›ëª…",
    email "ì´ë©”ì¼",
    dept_title "ë¶€ì„œëª…",
    dept_id "ë¶€ì„œì½”ë“œ"
from employee, department
    where dept_code = dept_id and dept_title in ('ì´ë¬´ë¶€','íšŒê³„ê´€ë¦¬ë¶€');

// ANSI
select 
    emp_name "ì‚¬ì›ëª…",
    email "ì´ë©”ì¼",
    dept_title "ë¶€ì„œëª…",
    dept_code "ë¶€ì„œì½”ë“œ"
from employee inner join department 
    on(dept_code = dept_id)
    where dept_title in ('ì´ë¬´ë¶€','íšŒê³„ê´€ë¦¬ë¶€');
```

```java
ğŸ”
// ì§ì±…ì´ ëŒ€ë¦¬ì¸ ì‚¬ëŒë“¤ì˜ ê¸‰ì—¬ ëª©ë¡ í™•ì¸ 
// ëŒ€ë¦¬ê¸‰ ì‚¬ì›ë“¤ì˜ ì‚¬ì›ëª…, ì§ê¸‰ì½”ë“œ, ì§ê¸‰ëª…, ë¶€ì„œì½”ë“œ (null - ì¸í„´), ì›”ê¸‰ ì¡°íšŒ
// ì›”ê¸‰ -> ì›í™” ê¸°í˜¸ë¡œ 
// ì´ë¦„ ì˜¤ë¦„ì°¨ìˆœ, ì›”ê¸‰ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬

// oracle
select * from employee;
select * from job;
select 
    emp_name "ì‚¬ì›ëª…",
    j.job_code "ì§ê¸‰ì½”ë“œ",
    job_name "ì§ê¸‰ëª…",
    nvl(dept_code,'ì¸í„´') "ë¶€ì„œì½”ë“œ",
    to_char(salary,'L999,999,999') "ì—°ë´‰"
from employee e, job j
    where e.job_code = j.job_code and job_name = 'ëŒ€ë¦¬'
    order by 1 asc, 4 desc;

// ANSI
select 
    emp_name "ì‚¬ì›ëª…",
    job_code "ì§ê¸‰ì½”ë“œ",
    job_name "ì§ê¸‰ëª…",
    nvl(dept_code,'ì¸í„´') "ë¶€ì„œì½”ë“œ",
    to_char(salary,'L999,999,999') "ì›”ê¸‰"
from employee inner join job 
    using(job_code)
    where job_name = 'ëŒ€ë¦¬'
    order by 1,5 desc;
```

### Left Outer Join (ì™¸ë¶€ ì¡°ì¸/ í•©ì§‘í•© â†’ ì™¼ìª½ ì™¸ë¶€ ì¡°ì¸)

ì¡°ì¸í•˜ëŠ” í…Œì´ë¸” Aì˜ í…Œì´í„°ë¥¼ ëª¨ë‘ ë°˜í™˜, í…Œì´ë¸” BëŠ” ì¡°ê±´ êµ¬ë¬¸ì— ì¼ì¹˜í•˜ëŠ” ë°ì´í„°ë§Œ ë°˜í™˜

â†’ inner join ì¡°ê±´ì„ ê±¸ê²Œ ë˜ë©´ ì¡°ê±´ì— ë§ëŠ” ë°ì´í„°ë§Œ ë°˜í™˜ 

â†’ left outer join ì¡°ê±´ì´ ì¼ì¹˜í•˜ì§€ ì•Šì•„ë„ ì™¼ìª½ í…Œì´ë¸”ì˜ ë°ì´í„°ëŠ” ëª¨ë‘ ë°˜í™˜


â— inner joinì„ ì‚¬ìš©í•  ê²½ìš° ì¡°ê±´ì„ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ë°ì´í„°ê°€ fullë¡œ ì¡°íšŒë˜ì§€ ì•Šì€ ê²½ìš° ë°œìƒ 
â†’ left outer join ì‚¬ìš©í•˜ë©´ ì™¼ìª½ìœ¼ë¡œ ë‘” í…Œì´ë¸”ì€ ì „ì²´ê°€ ë‚˜ì˜¤ê³  ì˜¤ë¥¸ìª½ìœ¼ë¡œ ë‘” í…Œì´ë¸”ì€ ì¡°ê±´ì— ë§ëŠ” ë°ì´í„°ë§Œ ì¶œë ¥

ë°©ë²•)

```java
oracle : select ì»¬ëŸ¼ .. from í…Œì´ë¸” A, í…Œì´ë¸” B where ì»¬ëŸ¼ = ì»¬ëŸ¼(+);
ANSI : select ì»¬ëŸ¼..  from í…Œì´ë¸” A left outer join í…Œì´ë¸” B on() / using()
```

```java
ğŸ”
// oracle 
select emp_name,dept_title
from employee, department
    where dept_code = dept_id(+);

// ANSI
select emp_name, dept_title
from employee left outer join department
    on(dept_code = dept_id);
```

```java
ğŸ”
// ê¸°ìˆ ì§€ì›ë¶€ë¥¼ ì œì™¸í•˜ê³  ëª¨ë“  ë¶€ì„œ ì§ì›ì˜ ì‚¬ë²ˆ, ì‚¬ì›ëª…, ë¶€ì„œëª…, ì—°ë´‰ ì¡°íšŒ
select emp_id "ì‚¬ë²ˆ",
       emp_name "ì‚¬ì›ëª…", 
       nvl(dept_title,'ë¯¸ì •')"ë¶€ì„œëª…", 
       to_char(salary * 12,'L999,999,999') "ì—°ë´‰"
from employee left outer join department on (dept_code = dept_id)
    where dept_title != 'ê¸°ìˆ ì§€ì›ë¶€' or dept_code is null 
    order by ë¶€ì„œëª…,ì‚¬ë²ˆ,ì—°ë´‰;

```

- != / = / like / not like ê°™ì€ equal ì—°ì‚°ìë¥¼ ì´ìš©í•˜ê²Œ ë˜ë©´ null ê°’ì— ëŒ€í•œ ì œëŒ€ë¡œ ëœ ë¹„êµê°€ ë˜ì§€ ì•Šê³  ëª¨ë‘ ì œì™¸
- null ê°’ë„ í¬í•¨ì‹œí‚¤ê³  ì‹¶ë‹¤ë©´ ìš°íšŒì ìœ¼ë¡œ ì¶”ê°€ ì¡°ê±´ì„ ë¶™ì—¬ì¤Œ -> dept_code is null

### Right Outer Join (í•©ì§‘í•© / ì˜¤ë¥¸ìª½ ì™¸ë¶€ ì¡°ì¸)

ì¡°ì¸í•˜ê³ ì í•˜ëŠ” í…Œì´ë¸” Aì™€ í…Œì´ë¸” Bê°€ ìˆì„ ë•Œ, í…Œì´ë¸” AëŠ” ì¡°ê±´ êµ¬ë¬¸ì— ì¼ì¹˜í•˜ëŠ” ë°ì´í…€ë‚˜ ë°˜í™˜, í…Œì´ë¸” BëŠ” ì¡°ê±´ì— ìƒê´€ì—†ì´ ëª¨ë“  ë°ì´í„° ë³€í™˜ 

ë°©ë²•)

```java
oracle : select ì»¬ëŸ¼ .. from í…Œì´ë¸” A, í…Œì´ë¸” B where ì»¬ëŸ¼(+) = ì»¬ëŸ¼;
ANSI : select ì»¬ëŸ¼..  from í…Œì´ë¸” A right outer join í…Œì´ë¸” B on() / using()
```

- Left outer Join ê³¼ ë‹¤ë¥¼ê²Œ ì—†ë‹¤

### Full Outer Join(í•©ì§‘í•©)

í…Œì´ë¸” Aì™€ í…Œì´ë¸” Bë¥¼ ì¡°ì¸í•  ë•Œ ì¡°ê±´ì— ë§ì§€ ì•Šë”ë¼ë„ ëª¨ë“  ë°ì´í„° ì¶œë ¥



<aside>
ğŸ’¡ ANSI : select ì»¬ëŸ¼ëª…... from í…Œì´ë¸” A full outer join í…Œì´ë¸” B on() / using()

</aside>

```java
ğŸ”
select emp_name, dept_title
from employee full outer join department
    on(dept_code = dept_id);
```

- null ê°’ë“¤ë„ ë‹¤ ì¶œë ¥

### Non-Equi Join(ë¹„ë“±ê°€ ì¡°ì¸)

ì§€ì •í•œ ì»¬ëŸ¼ì˜ ê°’ì´ ì¼ì¹˜í•˜ëŠ” ê²½ìš°ê°€ ì•„ë‹ˆë¼, ê°’ì˜ ë²”ìœ„ì— í¬í•¨ë˜ëŠ” í–‰ì„ ì—°ê²°(between, <, >, â‰¤ ë“±)

### Self Join

ë‹¤ë¥¸ í…Œì´ë¸”ì´ ì•„ë‹Œ ê°™ì€ í…Œì´ë¸”ì„ ì¡°ì¸í•˜ëŠ” ê²ƒ 

- ë˜‘ê°™ì€ í…Œì´ë¸”ì„ join í•˜ê¸° ë•Œë¬¸ì— ê° í…Œì´ë¸”ì— ë³„ì¹­ì„ ë°˜ë“œì‹œ ì§€ì •
- ì‚¬ìš©í•˜ë ¤ëŠ” ì»¬ëŸ¼ëª…ì´ ì–´ë–¤ ë³„ì¹­ì— í•´ë‹¹í•˜ëŠ” ì»¬ëŸ¼ëª…ì„ ì‚¬ìš©í•˜ë ¤ëŠ”ê±´ì§€ ëª…í™•íˆ í•´ì¤˜ì•¼í•œë‹¤

```java
ğŸ”
//manager_idì— í•´ë‹¹í•˜ëŠ” ì‚¬ì›ëª…(ë§¤ë‹ˆì €ëª…)ë„ ì¶”ê°€í•˜ê³  ì‹¶ë‹¤ë©´? 
// ë‹´ë‹¹ ë§¤ë‹ˆì €ì˜ ì‚¬ë²ˆì— í•´ë‹¹í•˜ëŠ” ì´ë¦„ì„ ì¶œë ¥ í•˜ëŠ” ë¬¸ì œ
// ìœ¤ì€í•´ ë§¤ë‹ˆì € ì‚¬ë²ˆì€ 207 -> ì§ì› ì‚¬ë²ˆ -> 207ì€ í•˜ì´ìœ (ë§¤ë‹ˆì €)

select 
    e1.emp_id "ì§ì›ì‚¬ë²ˆ",
    e1.emp_name "ì§ì›ëª…",
    e1.manager_id "ë§¤ë‹ˆì € ì‚¬ë²ˆ",
    e2.emp_name "ë§¤ë‹ˆì €ëª…"
from employee e1 join employee e2
    on(e1.manager_id = e2.emp_id);
```

![2.png](/assets/images/posts/2022-04-04/2.png)

### ë‹¤ì¤‘ Join

ì—¬ëŸ¬ ê°œì˜ ì¡°ì¸ë¬¸ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°

- ìˆœì„œì— ìœ ì˜

```java
ğŸ”
// employee departement ì¡°ì¸ -> ì‚¬ë²ˆ, ì‚¬ì›ëª…, ë¶€ì„œì½”ë“œ, ë¶€ì„œëª…

select emp_id "ì‚¬ë²ˆ",
       emp_name "ì‚¬ì›ëª…",
       dept_code "ë¶€ì„œì½”ë“œ",
       dept_title "ë¶€ì„œëª…"
from employee join department
    on(dept_code = dept_id);

-- ì‚¬ë²ˆ, ì‚¬ì›ëª…, ë¶€ì„œì½”ë“œ, ë¶€ì„œëª… + ë¶€ì„œì§€ì—­ëª… 
select * from location;
select * from department;

select 
    dept_id,
    dept_title,
    local_name
from department join location 
    on(location_id = local_code);

// ANSI
select 
    emp_id "ì‚¬ë²ˆ",
    emp_name "ì‚¬ì›ëª…",
    dept_code "ë¶€ì„œì½”ë“œ",
    dept_title "ë¶€ì„œëª…",
    local_name "ë¶€ì„œì§€ì—­ëª…"
from employee join department on(dept_code = dept_id)
    join location on(location_id = local_code);

// oracle 
select 
    emp_id "ì‚¬ë²ˆ",
    emp_name "ì‚¬ì›ëª…",
    dept_code "ë¶€ì„œì½”ë“œ",
    dept_title "ë¶€ì„œëª…",
    local_name "ë¶€ì„œì§€ì—­ëª…"
from employee, department, location
    where dept_code = dept_id
    and location_id = local_code;
```

![3.png](/assets/images/posts/2022-04-04/3.png)