---
title: '[DL/BASIC] λ”¥λ¬λ‹ μµμ ν™” : μ›λ¦¬ νν•΄μΉκΈ° π“‰'
layout : single
---

# 2. κ·Έλ λ””μ–ΈνΈ κΈ°λ° μµμ ν™” 

## 2.1 ν™•λ¥ μ  κ²½μ‚¬ ν•κ°•λ²•

λ‹¤μμ μμ„λ΅ μµμ ν™”λ¥Ό μ§„ν–‰ν•  μ μλ‹¤.


1.   ν›λ ¨ μƒν” λ°°μΉ xμ™€ μ΄μ— μƒμ‘ν•λ” νƒ€κΉƒ y_trueλ¥Ό μ¶”μ¶ν•λ‹¤.
2.   xλ΅ λ¨λΈμ„ ν›λ ¨ν•κ³  μμΈ΅ y_predλ¥Ό κµ¬ν•λ‹¤(μ •λ°©ν–¥ ν¨μ¤).
3.   μ΄ λ°°μΉμ—μ„ y_predμ™€ y_true μ‚¬μ΄μ μ¤μ°¨(λ¨λΈμ μ†μ‹¤)μ„ κ³„μ‚°ν•λ‹¤.
4.   λ¨λΈμ νλΌλ―Έν„°μ— λ€ν• μ†μ‹¤ ν•¨μμ κ·Έλ λ””μ–ΈνΈλ¥Ό κ³„μ‚°ν•λ‹¤(μ—­λ°©ν–¥ ν¨μ¤).
5.   κ·Έλ λ””μ–ΈνΈμ λ°λ€ λ°©ν–¥μΌλ΅ νλΌλ―Έν„°λ¥Ό μ΅°κΈμ”© μ΄λ™μ‹ν‚¨λ‹¤. μλ¥Ό λ“¤μ–΄ W -= learning_rate * gradientμ²λΌ μ†μ‹¤μ„ μ΅°κΈ κ°μ†μ‹ν‚¨λ‹¤.

μ„μ λ°©λ²•μ΄ **λ―Έλ‹ λ°°μΉ SGD**μ΄λ‹¤.

λ§μ•½ λ€μƒ νλΌλ―Έν„°κ°€ μ‘μ€ ν•™μµλ¥ μ„ κ°€μ§„ SGDλ΅ μµμ ν™”λμ—λ‹¤λ©΄ μ „μ—­ μµμ†κ°’μ΄ μ•„λ‹ μ§€μ—­ μµμ†κ°’μ— κ°‡νκ² λ  κ²ƒμ΄λ‹¤.

μ΄λ¬ν• λ¬Έμ λ¥Ό **λ¨λ©ν…€**μ΄λΌλ” κ°λ…μΌλ΅ ν•΄κ²°ν•  μ μλ‹¤. λ¨λ©ν…€μ€ ν„μ¬ κ·Έλ λ””μ–ΈνΈ κ°’ λΏλ§ μ•„λ‹λΌ μ΄μ „μ— μ—…λ°μ΄νΈν• νλΌλ―Έν„°μ— κΈ°μ΄ν•μ—¬ νλΌλ―Έν„° **W**λ¥Ό μ—…λ°μ΄νΈ ν•λ‹¤.

λ‹¤μμ€ λ¨λ©ν…€μ λ‹¨μ κµ¬ν„ μλ‹¤.


```python
past_velocity = 0
momentum = 0.1
while loss > 0.01:
  w, loss , gradient = get_current_parameters()
  velocity = momentum * velocity - learning_rate * gradient
  w = w + momentum * velocity - learning_rate * gradient
  past_velocity = velocity
  update_parameter(w)
```

## 2.2 μ—­μ „ν μ•κ³ λ¦¬μ¦

λ³µμ΅ν• μ‹μ κ·Έλ λ””μ–ΈνΈλ¥Ό κ³„μ‚°ν•λ” λ°©λ²•μ΄ **μ—­μ „ν μ•κ³ λ¦¬μ¦**μ΄λ‹¤.

μ—°μ‡„ λ²•μΉ™μ„ μ—­λ°©ν–¥ κ·Έλν”„μ— μ μ©ν•λ©΄ , λ…Έλ“κ°€ μ—°κ²°λ κ²½λ΅λ¥Ό λ”°λΌμ„ μ°λ¦¬κ°€ μ›ν•λ” κ·Έλ λ””μ–ΈνΈμ κ³„μ‚°μ΄ κ°€λ¥ν•΄μ§„λ‹¤. 

μ—­μ „νλ” μµμΆ… μ†μ‹¤κ°’μ—μ„ μ‹μ‘ν•΄μ„ λ§¨ μ„μΈµκΉμ§€ κ±°κΎΈλ΅ μ¬λΌκ°€μ„ κ° νλΌλ―Έν„°κ°€ μ†μ‹¤κ°’μ— κΈ°μ—¬ν• μ •λ„λ” κ³„μ‚°ν•λ‹¤. μ”μ¦μ—λ” ν…μ„ν”λ΅μ™€ κ°™μ΄ **μλ™ λ―Έλ¶„**μ΄ κ°€λ¥ν• ν”„λ μ„ μ›ν¬ λ•λ¶„μ— μ—­μ „νλ¥Ό μ‰½κ² κµ¬ν„ν•  μ μλ‹¤.

### κ·Έλ λ””μ–ΈνΈ ν…μ΄ν”„ (GradientTape)
κ·Έλ λ””μ–ΈνΈ ν…μ΄ν”„λ” ν•΄λ‹Ή μ½”λ“ λΈ”λ΅ μ•μ λ¨λ“  ν…μ„ μ—°μ‚°μ„ κ³„μ‚° κ·Έλν”„ ν•νƒ(**Tape**)λ΅ κΈ°λ΅ν•λ‹¤. κ·Έ λ‹¤μ κ³„μ‚° κ·Έλν”„λ¥Ό μ‚¬μ©ν•΄μ„ tf.Variable ν΄λμ¤ λ³€μ λλ” λ³€μ μ§‘ν•©μ— λ€ν• μ–΄λ–¤ μ¶λ ¥μ κ·Έλ λ””μ–ΈνΈλ„ κ³„μ‚°ν•  μ μλ‹¤.
(tf.Variableμ€ λ³€κ²½ κ°€λ¥ν• μƒνƒλ¥Ό λ‹΄κΈ° μ„ν• νΉλ³„ν• ν…μ„μ΄λ‹¤.)


```python
import tensorflow as tf

x = tf.Variable(0.) # μ΄κΈ°κ°’ 0μΌλ΅ μ¤μΉΌλΌ λ³€μλ¥Ό μƒμ„±
with tf.GradientTape() as tape: 
  y = 2 * x + 3     # λ³€μμ— ν…μ„ μ—°μ‚°μ„ μ μ©
grad_of_y_wrt_x = tape_gradient(y,x) # tapeλ¥Ό μ‚¬μ©ν•΄μ„ xμ— λ€ν• yμ κ·Έλ λ””μ–ΈνΈ κ³„μ‚°

```
μ¶μ²:

ν”„λ‘μ†μ™€ μ„λ  μ§€μ, βμΌ€λΌμ¤ μ°½μ‹μμ—κ² λ°°μ°λ” λ”¥λ¬λ‹ κ°μ •2νβ, λ°•ν•΄μ„  μ®κΉ€, κΈΈλ²—, 2022 , 83-100μ½
