---
layout: single
title:  "í•¸ì¦ˆì˜¨ ë¨¸ì‹ ëŸ¬ë‹ - 4"
categories : hands-on
tag : [hands-on, study, machine-learning, python]
toc: true
toc_sticky: true
---

![header](https://capsule-render.vercel.app/api?type=waving&color=a2dcec&height=300&section=header&text=í•¸ì¦ˆì˜¨ ë¨¸ì‹ ëŸ¬ë‹ - 4&fontSize=40&animation=fadeIn&fontAlignY=38&fontColor=FFFFFF)

- ì°¸ê³  : [í•¸ì¦ˆì˜¨ ë¨¸ì‹ ëŸ¬ë‹ 2íŒ](http://www.kyobobook.co.kr/product/detailViewKor.laf?mallGb=KOR&ejkGb=KOR&barcode=9791162242964)

------------------------------------------------------

&nbsp;



## ëª¨ë¸ í›ˆë ¨

- ì§ì ‘ ê³„ì‚°í•  ìˆ˜ ìˆëŠ” ê³µì‹ì„ ì‚¬ìš©í•˜ì—¬ í›ˆë ¨ ì„¸íŠ¸ì— ê°€ì¥ ì˜ ë§ëŠ” ëª¨ë¸ íŒŒë¼ë¯¸í„°ë¥¼ í•´ì„ì ìœ¼ë¡œ êµ¬í•¨
- ê²½ì‚¬ í•˜ê°•ë²•(GD)ë¼ê³  ë¶ˆë¦¬ëŠ” ë°˜ë³µì ì¸ ìµœì í™” ë°©ì‹ì„ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ íŒŒë¼ë¯¸í„°ë¥¼ ì¡°ê¸ˆì”© ë°”ê¾¸ë©´ì„œ ë¹„ìš© í•¨ìˆ˜ë¥¼ í›ˆë ¨ ì„¸íŠ¸ì— ëŒ€í•´ ìµœì†Œí™” ì‹œí‚´

&nbsp;

## ì„ í˜• íšŒê·€

- ![image-20220927163018049](/images/2022-09-27-hands_on_4/image-20220927163018049.png)

- ì„ í˜•ì´ì§€ë§Œ íŠ¹ì„±ì´ ë§ì•„ì§€ë©´ ê³ ì°¨ì›ì´ ë¨

- íŒŒë¼ë¯¸í„° ê¸°ì¤€ì€ MSE ìµœì†Œ í•˜ëŠ” íŒŒë¼ë¯¸í„° ì„ ì •

  ![image-20220927163142878](/images/2022-09-27-hands_on_4/image-20220927163142878.png)

> ì…ë ¥ íŠ¹ì„±ì˜ ê°€ì¤‘ì¹˜ í•© + í¸í–¥(ì ˆí¸, x0) ì´ë¼ëŠ” ìƒìˆ˜ë¥¼ ë”í•´ ì˜ˆì¸¡ì„ ìƒì„±

&nbsp;

### ì •ê·œ ë°©ì •ì‹

- ê³µì‹

â€‹	![image-20220927163532147](/images/2022-09-27-hands_on_4/image-20220927163532147.png)

- ë¹„ìš©í•¨ìˆ˜ë¥¼ ìµœì†Œí•˜ í•˜ëŠ” ğœ½ ê°’ì„ ì°¾ê¸°ìœ„í•œ í•´ì„ì  ë°©ë²•

**ì •ê·œ ë°©ì •ì‹ ì˜ˆì‹œ**

```python
import numpy as np

X = 2 * np.random.rand(100, 1)
y = 4 + 3 * X + np.random.randn(100, 1)

plt.plot(X, y, "b.")
plt.xlabel("$x_1$", fontsize=18)
plt.ylabel("$y$", rotation=0, fontsize=18)
plt.axis([0, 2, 0, 15])
plt.show()


X_b = np.c_[np.ones((100, 1)), X]  # ëª¨ë“  ìƒ˜í”Œì— x0 = 1ì„ ì¶”ê°€í•©ë‹ˆë‹¤. (X0 = 1)
theta_best = np.linalg.inv(X_b.T.dot(X_b)).dot(X_b.T).dot(y) # np.linalg.invë¡œ ì—­í–‰ë ¬ ê³„ì‚°
>> array([[4.21509616],
          [2.77011339]])

# êµ¬í•œ theta_bestë¥¼ í†µí•´ì„œ ì˜ˆì¸¡ ìˆ˜í–‰

X_new = np.array([[0], [2]])
X_new_b = np.c_[np.ones((2, 1)), X_new]  # ëª¨ë“  ìƒ˜í”Œì— x0 = 1ì„ ì¶”ê°€í•©ë‹ˆë‹¤.
y_predict = X_new_b.dot(theta_best)
y_predict
>> array([[4.21509616],
          [9.75532293]])
```

- ê²°ê³¼ ì‹œê°í™”

```python
plt.plot(X_new, y_predict, "r-")
plt.plot(X, y, "b.")
plt.axis([0, 2, 0, 15])
plt.show()
```

![image-20220927164423415](/images/2022-09-27-hands_on_4/image-20220927164423415.png)

&nbsp;



## sklearn ì„ í˜• íšŒê·€

- `ê°€ì¤‘ì¹˜(coef)` , `í¸í–¥(intercept)` í˜¸ì¶œ ê°€ëŠ¥
- `LinearRegression` í´ë˜ìŠ¤ëŠ” `scipy.linalg.lstsq()` í•¨ìˆ˜(ìµœì†Œ ì œê³±)ì„ ì‚¬ìš©

```python
from sklearn.linear_model import LinearRegression

lin_reg = LinearRegression()
lin_reg.fit(X, y)
lin_reg.intercept_, lin_reg.coef_
>> (array([4.21509616]), array([[2.77011339]]))

lin_reg.predict(X_new)
>> array([[4.21509616],
       	  [9.75532293]])


# scipy.linalg.lstsq() or np.linalg.lstsq() ë¡œ í‘œí˜„í•˜ë©´
theta_best_svd, residuals, rank, s = np.linalg.lstsq(X_b, y, rcond=1e-6)
theta_best_svd
>> array([[4.21509616],
       	  [2.77011339]])


```

- ì´ë•Œ `np.linalg.lstsq()` í•¨ìˆ˜ëŠ”  ìœ ì‚¬ ì—­í–‰ë ¬ì„ ê³„ì‚°í•¨

  - `np.linalg.pinv()`ì„ ì‚¬ìš©í•´ì„œ ìœ ì‚¬ ì—­í–‰ë ¬ì„ ì§ì ‘ ê³„ì‚° ê°€ëŠ¥
  - `ìœ ì‚¬ ì—­í–‰ë ¬`ì€ ì—­í–‰ë ¬ì„ ê³„ì‚°í• ìˆ˜ ì—†ì„ë•Œ ì—­í–‰ë ¬ê³¼ ìœ ì‚¬í•œ í–‰ë ¬ì„ ê³„ì‚°
  - ![image-20220927191720050](/images/2022-09-27-hands_on_4/image-20220927191720050.png)

```python
# ìœ ì‚¬ ì—­í–‰ë ¬ êµ¬í•˜ëŠ” ë°©ë²•
np.linalg.pinv(X_b).dot(y)
>> array([[4.21509616],
          [2.77011339]])
```

- ìœ ì‚¬ì—­í–‰ë ¬ ìì²´ëŠ” `íŠ¹ì´ê°’ ë¶„í•´(SVD)`ë¼ ë¶€ë¥´ëŠ” í‘œì¤€ í–‰ë ¬ ë¶„í•´ ê¸°ë²•ì„ ì‚¬ìš©í•´ ê³„ì‚°
- ![image-20220927191654670](/images/2022-09-27-hands_on_4/image-20220927191654670.png)
- ![image-20220927191707760](/images/2022-09-27-hands_on_4/image-20220927191707760.png)
- íŠ¹ì„±ì´ ì¤‘ë³µë˜ì–´ ì—­í–‰ë ¬ì´ ì—†ì„ë•Œ ì •ê·œë°©ì •ì‹ì´ ì‘ë™í•˜ì§€ ì•Šì§€ë§Œ `ìœ ì‚¬ì—­í–‰ë ¬` ì€ í•­ìƒ ì¡´ì¬

&nbsp;



## ê²½ì‚¬ í•˜ê°•ë²•(GD)

- ì—¬ëŸ¬ ì¢…ë¥˜ì˜ ë¬¸ì œì—ì„œ ìµœì ì˜ í•´ë²•ì„ ì°¾ì„ ìˆ˜ ìˆëŠ” ì¼ë°˜ì ì¸ ìµœì í™” ì•Œê³ ë¦¬ì¦˜
- ë¹„ìš©í•¨ìˆ˜ ìµœì í™”ë¥¼ ìœ„í•´ ë°˜ë³µìˆ˜í–‰ì„ í†µí•´ íŒŒë¼ë¯¸í„° ì¡°ì •
- í˜„ ìƒíƒœì˜ ê¸°ìš¸ê¸°ê°€ ê°ì†Œí•˜ëŠ” ë°©í–¥ìœ¼ë¡œ ì§„í–‰í•˜ë‹¤ê°€ 0ì¸ ì§€ì ì´ ìµœì†Ÿê°’
- ìŠ¤í…ì˜ í¬ê¸°ëŠ” í•™ìŠµë¥  íŒŒë¼ë¯¸í„°ë¡œ ê²°ì •ë¨
  - í•™ìŠµë¥ ì´ ë„ˆë¬´ ì‘ìœ¼ë©´ ìˆ˜ë ´ì„ ìœ„í•œ ë°˜ë³µì´ ë§ì•„ì§€ê³  ì‹œê°„ì†Œìš”ê°€ ì»¤ì§
  - í•™ìŠµë¥ ì´ ë„ˆë¬´ í¬ë©´ í° ê°’ìœ¼ë¡œ ë°œì‚°í•  ìœ„í—˜ì´ ì¡´ì¬

![image-20220928110628368](/images/2022-09-27-hands_on_4/image-20220928110628368.png)

> í•™ìŠµ ìŠ¤í…ì€ ìµœì†Ÿê°’ì— ê°€ê¹Œì›Œ ì§ˆìˆ˜ë¡ ì¤„ì–´ë“¦



![image-20220928110918423](/images/2022-09-27-hands_on_4/image-20220928110918423.png)

> ìœ„ ê·¸ë¦¼ê³¼ ê°™ì´ ì™¼ìª½ì—ì„œ ì‹œì‘í•˜ë©´ ì§€ì—­ ìµœì†Ÿê°’ì— ë¹ ì§ˆ ìœ„í—˜ì´ í¬ê³ , ì˜¤ë¥¸ìª½ì—ì„œ ì‹œì‘í•˜ë©´ í‰íƒ„í•œ ë¶€ë¶„ì„ ì§€ë‚˜ëŠ” ë™ì•ˆ í•™ìŠµì´ ì˜¤ë˜ ê±¸ë¦¬ë©° ì¡°ê¸° ì¢…ë£Œë˜ì–´ ì „ì—­ ìµœì†Ÿê°’ì— ì´ë¥´ì§€ ëª»í• ìˆ˜ ìˆìŒ



**`MSE ë¹„ìš©í•¨ìˆ˜`**

- ì„ í˜• íšŒê·€ë¥¼ ìœ„í•œ MSE ë¹„ìš© í•¨ìˆ˜ëŠ” ê³¡ì„ ì—ì„œ ì–´ë–¤ ë‘ ì ì„ ì„ íƒí•´ ì„ ì„ ê·¸ì–´ë„ ê³¡ì„ ì„ ê°€ë¡œì§€ë¥´ì§€ ì•ŠëŠ” `ë³¼ë¡í•¨ìˆ˜`

  - ì§€ì—­ ìµœì†Ÿê°’ X , ì „ì—­ ìµœì†Ÿê°’ 0

  - ì—°ì†ëœ í•¨ìˆ˜ì´ê³  ê¸°ìš¸ê¸°ê°€ ë³€í•˜ì§€ ì•ŠìŒ

    > ê²½ì‚¬ í•˜ê°•ë²•ì´ ì „ì—­ ìµœì†Ÿê°’ì— ê°€ê¹ê²Œ ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ë³´ì¥



**`íŠ¹ì„± ìŠ¤ì¼€ì¼`**

![image-20220928112312958](/images/2022-09-27-hands_on_4/image-20220928112312958.png)

- ì™¼ìª½ì´ íŠ¹ì„± ìŠ¤ì¼€ì¼ ì ìš©, ì˜¤ë¥¸ìª½ì€ ë¯¸ì ìš©
- ê²½ì‚¬ í•˜ê°•ë²•ì„ ì‚¬ìš©í•  ë•ŒëŠ” ë°˜ë“œì‹œ ëª¨ë“  íŠ¹ì„±ì´ ê°™ì€ ìŠ¤ì¼€ì¼ì„ ê°–ë„ë¡ ë§Œë“¤ì–´ì•¼í•¨, ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ê°™ì€ ê²°ê³¼ ë„ë‹¬ê¹Œì§€ ì˜¤ëœ ì‹œê°„ ì†Œìš”

&nbsp;

### ë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²•

- ê²½ì‚¬ í•˜ê°•ë²• êµ¬í˜„ì‹œ ê° ëª¨ë¸ íŒŒë¼ë¯¸í„°ì— ëŒ€í•´ ë¹„ìš© í•¨ìˆ˜ì˜ ê¸°ìš¸ê¸°ë¥¼ ê³„ì‚°

- ëª¨ë¸ íŒŒë¼ë¯¸í„°ê°€ ì¡°ê¸ˆ ë³€ê²½ë  ë•Œ ë¹„ìš© í•¨ìˆ˜ê°€ ì–¼ë§ˆë‚˜ ë³€ê²½ë˜ëŠ”ì§€ ê³„ì‚° <- `í¸ë„í•¨ìˆ˜`

- ![image-20220928113007641](/images/2022-09-27-hands_on_4/image-20220928113007641.png)

  - ë¹„ìš©í•¨ìˆ˜ì˜ MSE ê·¸ë ˆì´ë””ì–¸íŠ¸ ë²¡í„°ëŠ” ë¹„ìš©í•¨ìˆ˜ì˜ í¸ë„í•¨ìˆ˜ë¥¼ ëª¨ë‘ ê°€ì§€ê³ ìˆìŒ

    > ë§¤ ê²½ì‚¬ í•˜ê°•ë²• ìŠ¤í…ì—ì„œ ì „ì²´ í›ˆë ¨ ì„¸íŠ¸ Xì— ëŒ€í•´ ê³„ì‚° ê·¸ë˜ì„œ **ë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²•**
    >
    > ë§¤ìš° í° í›ˆë ¨ ì„¸íŠ¸ì—ì„œëŠ” ì•„ì£¼ ëŠë¦¼, íŠ¹ì„±ìˆ˜ì— ë¯¼ê°í•˜ì§€ ì•Šì•„ì„œ ìˆ˜ë°±ë§Œ íŠ¹ì„±ì—ì„œëŠ” ì •ê·œë°©ì ì‹, SVD ë³´ë‹¤ ê²½ì‚¬ í•˜ê°•ë²•ì´ ë¹ ë¦„

- ìœ„ë¡œ í–¥í•˜ëŠ” ê·¸ë ˆì´ë””ì–¸íŠ¸ ë²¡í„°ê°€ êµ¬í•´ì§€ë©´ ë°˜ëŒ€ ë°©í–¥ì¸ ì•„ë˜ë¡œ ì´ë™ **theta - MSE(theta)** ë¥¼ ì˜ë¯¸, ë‚´ë ¤ê°€ëŠ” ìŠ¤í…ì˜ í¬ê¸°ë¥¼ ê²°ì •í•˜ê¸° ìœ„í•´  n : í•™ìŠµë¥  ì‚¬ìš©

  - ê³µì‹

    ![image-20220928113641528](/images/2022-09-27-hands_on_4/image-20220928113641528.png)

    ```python
    eta = 0.1  # í•™ìŠµë¥ 
    n_iterations = 1000
    m = 100
    
    theta = np.random.randn(2,1)  # ëœë¤ ì´ˆê¸°í™”
    
    for iteration in range(n_iterations):
        gradients = 2/m * X_b.T.dot(X_b.dot(theta) - y)
        theta = theta - eta * gradients
    
    theta
    >> array([[4.21509616],
              [2.77011339]])
    ```

  - í•™ìŠµë¥ ì— ë”°ë¥¸ ê²½ì‚¬ í•˜ê°•ë²• ì‹œê°í™”

    ![image-20220928114155599](/images/2022-09-27-hands_on_4/image-20220928114155599.png)

    - ì™¼ìª½ì˜ ê²½ìš° í•™ìŠµë¥ ì´ ë„ˆë¬´ ë‚®ê³  ìµœì ì  ë„ë‹¬ê¹Œì§€ ì‹œê°„ì†Œìš” í¼

    - ê°€ìš´ë°ëŠ” ì ì ˆí•œ í•™ìŠµë¥  ë¹ ë¥´ê²Œ ìµœì ì  ë„ë‹¬

    - ì˜¤ë¥¸ìª½ì€ ë„ˆë¬´ í° í•™ìŠµë¥ ë¡œ ìµœì ì ì— ë©€ì–´ì ¸ ë°œì‚°

> ì ì ˆí•œ í•™ìŠµë¥ ì„ ì°¾ê¸° ìœ„í•´ì„œëŠ” ê·¸ë¦¬ë“œ íƒìƒ‰ì„ ì‚¬ìš©, ê·¸ë¦¬ë“œ íƒìƒ‰ì€ ìˆ˜ë ´í•˜ëŠ”ë° ë„ˆë¬´ ì˜¤ë˜ ê±¸ë¦¬ëŠ” ëª¨ë¸ì„ ë§‰ê¸°ìœ„í•´ ë°˜ë³µ íšŸìˆ˜ë¥¼ ì œí•œí•´ì•¼ í•¨
>
> `ê°„ë‹¨í•œ ë°©ë²•ì€ ë°˜ë³µíšŸìˆ˜ í¬ê²Œ ì§€ì •í•˜ê³  ê·¸ë ˆë””ì–¸íŠ¸ ë²¡í„°ê°€ ì•„ì£¼ ì ì–´ì§€ë©´ ì¤‘ì§€`

&nbsp;

### í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•

![image-20220928125131057](/images/2022-09-27-hands_on_4/image-20220928125131057.png)

- ë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²•ì€ ë§¤ ìŠ¤í…ë§ˆë‹¤ ì „ì²´ í›ˆë ¨ ì„¸íŠ¸ë¥¼ ì‚¬ìš©í•´ ê·¸ë ˆë””ì–¸íŠ¸ë¥¼ ê³„ì‚°í•¨, í›ˆë ¨ ì„¸íŠ¸ í¬ë©´ ëŠë¦¼
- í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•ì€ ë§¤ ìŠ¤í…ì—ì„œ í•œ ê°œì˜ ìƒ˜í”Œì„ ë¬´ì‘ìœ„ë¡œ ì„ íƒí•˜ê³  ê·¸ ì…ˆí”Œì— ëŒ€í•œ ê·¸ë ˆì´ë””ì–¸íŠ¸ë¥¼ ê³„ì‚°
  - ë§¤ ë°˜ë³µë§ˆë‹¤ ê³„ì‚°í•˜ëŠ” ë°ì´í„°ê°€ ë§¤ìš° ì ê¸° ë•Œë¬¸ì— í•œ ë²ˆì— í•˜ë‚˜ì˜ ìƒ˜í”Œ ì²˜ë¦¬
- ë¬´ì‘ìœ„ ì ì¸ íŠ¹ì„± ë•Œë¬¸ì— ë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²•ë³´ë‹¤ í›¨ì”¬ ë¶ˆì•ˆì •
  - ë¹„ìš©í•¨ìˆ˜ê°€ ìµœì†Ÿê°’ì— ë‹¤ë‹¤ë¥¼ ë•Œê¹Œì§€ ìš”ë™ì¹˜ë©´ì„œ ê°ì†Œ
  - ìš”ë™ì„ ì¹˜ê¸°ë•Œë¬¸ì— ì „ì—­ì„ ì§€ë‚˜ì¹ ìˆ˜ ìˆìŒ

> ì ì§„ì ìœ¼ë¡œ í•™ìŠµë¥ ì„ ê°ì†Œì‹œì¼œì„œ ìš”ë™ì¹˜ëŠ” ë¬¸ì œë¥¼ í•´ê²°
>
> ì‹œì‘í• ë•ŒëŠ” í•™ìŠµë¥ ì„ í¬ê²Œí•˜ê³  ì ì°¨ ì‘ê²Œ ì¤„ì—¬ì„œ ì•Œê³ ë¦¬ì¦˜ì´ ì „ì—­ìœ¼ë¡œ ìˆ˜ë ´í•˜ë„ë¡ í•¨



**í•™ìŠµ ìŠ¤ì¼€ì¤„ì„ ì‚¬ìš©í•œ í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•**

```python
n_epochs = 50
t0, t1 = 5, 50  # í•™ìŠµ ìŠ¤ì¼€ì¤„ í•˜ì´í¼íŒŒë¼ë¯¸í„°

def learning_schedule(t):
    return t0 / (t + t1)

theta = np.random.randn(2,1)  # ëœë¤ ì´ˆê¸°í™”

for epoch in range(n_epochs):
    for i in range(m):
        if epoch == 0 and i < 20:                    
            y_predict = X_new_b.dot(theta)           
            style = "b-" if i > 0 else "r--"         
            plt.plot(X_new, y_predict, style)        
        random_index = np.random.randint(m)
        xi = X_b[random_index:random_index+1]
        yi = y[random_index:random_index+1]
        gradients = 2 * xi.T.dot(xi.dot(theta) - yi)
        eta = learning_schedule(epoch * m + i)
        theta = theta - eta * gradients
        theta_path_sgd.append(theta)                 

plt.plot(X, y, "b.")                                
plt.xlabel("$x_1$", fontsize=18)                    
plt.ylabel("$y$", rotation=0, fontsize=18)           
plt.axis([0, 2, 0, 15])                              
save_fig("sgd_plot")                                 
plt.show()                                          

theta
>> array([[4.21076011],
          [2.74856079]])
```

![image-20220928125618690](/images/2022-09-27-hands_on_4/image-20220928125618690.png)

- ìœ„ì—ì„œëŠ” ì…ˆí”Œì„ ë¬´ì‘ìœ„ë¡œ ì„ íƒ, ì…ˆí”Œë§ˆë‹¤ ë½‘íìˆ˜ë„ ìˆê³  ì•ˆë½‘íìˆ˜ë„ ìˆìŒ

&nbsp;

**sklearn SGDRegressor**

- ê¸°ë³¸ê°’ìœ¼ë¡œ ì œê³± ì˜¤ì°¨ ë¹„ìš© í•¨ìˆ˜ë¥¼ ìµœì í™” í•¨

```python
from sklearn.linear_model import SGDRegressor

sgd_reg = SGDRegressor(max_iter=1000, tol=1e-3, penalty=None, eta0=0.1, random_state=42)
sgd_reg.fit(X, y.ravel())

sgd_reg.intercept_, sgd_reg.coef_
>> array([4.24365286]), array([2.8250878])
```

&nbsp;



### ë¯¸ë‹ˆë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²•

- ê° ìŠ¤í…ì—ì„œ ì „ì²´ í›ˆë ¨ ì„¸íŠ¸(ë°°ì¹˜ ê²½ì‚¬í•˜ê°•ë²•)ì´ë‚˜ í•˜ë‚˜ì˜ ìƒ˜í”Œ(í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•)ì„ ê¸°ë°˜ìœ¼ë¡œ ê·¸ë ˆë””ì–¸íŠ¸ë¥¼ ê³„ì‚°í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ **ë¯¸ë‹ˆë°°ì¹˜**ë¼ ë¶€ë¥´ëŠ” ì„ì˜ì˜ ì‘ì€ ìƒ˜í”Œ ì„¸íŠ¸ì— ëŒ€í•´ ê·¸ë ˆë””ì–¸íŠ¸ë¥¼ ê³„ì‚°.
- gpu ì‚¬ìš©ê°€ëŠ¥
- SGD ë³´ë‹¤ ëœ ë¶ˆê·œì¹™í•˜ê²Œ ì›€ì§ì„, SGDë³´ë‹¤ ìµœì†Ÿê°’ì— ê°€ê¹Œìš¸ìˆ˜ ìˆê³  ë°˜ëŒ€ë¡œ ì§€ì—­ ìµœì†Ÿê°’ì´ ë ìˆ˜ ìˆìŒ

![image-20220928155319137](/images/2022-09-27-hands_on_4/image-20220928155319137.png)

> ë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²•ì´ ì‹¤ì œë¡œ ìµœì†Ÿì ì— ë„ë‹¬, í™•ë¥ ì ê³¼ ë¯¸ë‹ˆë°°ì¹˜ëŠ” ì£¼ë³€ì— ìˆ˜ë ´
>
> í™•ë¥ ì  ê²½ì‚¬í•˜ê°•ë²•ê³¼ ë¯¸ë‹ˆë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²• ë‘˜ë‹¤ ì ì ˆí•œ í•™ìŠµ ìŠ¤ì¼€ì¤„ì„ ì‚¬ìš©í•˜ë©´ ìµœì†Ÿê°’ì— ë„ë‹¬

&nbsp;

**ì„ í˜•íšŒê·€ë¥¼ ì‚¬ìš©í•œ ì•Œê³ ë¦¬ì¦˜ ì •ë¦¬**

![image-20220928155542543](/images/2022-09-27-hands_on_4/image-20220928155542543.png)



&nbsp;

## ë‹¤í•­ íšŒê·€

-  ë‹¤í•­íšŒê·€ë€ ë°ì´í„°ë“¤ê°„ì˜ í˜•íƒœê°€ ë¹„ì„ í˜• ì¼ë•Œ ë°ì´í„°ì— ê° íŠ¹ì„±ì˜ ì œê³±ì„ ì¶”ê°€í•´ì£¼ì–´ì„œ íŠ¹ì„±ì´ ì¶”ê°€ëœ ë¹„ì„ í˜• ë°ì´í„°ë¥¼ ì„ í˜• íšŒê·€ ëª¨ë¸ë¡œ í›ˆë ¨ì‹œí‚¤ëŠ” ë°©ë²•

 &nbsp;

**ë‹¤í•­íšŒê·€ ì˜ˆì‹œ**

```python
import numpy as np
import numpy.random as rnd
np.random.seed(42)

m = 100
X = 6 * np.random.rand(m, 1) - 3
y = 0.5 * X**2 + X + 2 + np.random.randn(m, 1)


plt.plot(X, y, "b.")
plt.xlabel("$x_1$", fontsize=18)
plt.ylabel("$y$", rotation=0, fontsize=18)
plt.axis([-3, 3, 0, 10])
save_fig("quadratic_data_plot")
plt.show()
```

![image-20220928160731677](/images/2022-09-27-hands_on_4/image-20220928160731677.png)

- ë°ì´í„°ì— ì¼ë¶€ ì¡ìŒì´ í¬í•¨ë˜ì–´ìˆì–´ì„œ sklearnì˜ **PolynomialFeatures**ë¥¼ ì‚¬ìš©í•´ í›ˆë ¨ë°ì´í„°ë¡œ ë³€í™˜
  - í›ˆë ¨ ì„¸íŠ¸ì— ê° íŠ¹ì„±ì„ ì œê³±í•˜ì—¬ ìƒˆë¡œìš´ íŠ¹ì„±ì„ ë§Œë“¬

```python
from sklearn.preprocessing import PolynomialFeatures
poly_features = PolynomialFeatures(degree=2, include_bias=False)
X_poly = poly_features.fit_transform(X)

X[0]
>> array([-0.75275929])
X_poly[0]
>> array([-0.75275929,  0.56664654])
```

> x_polyëŠ” ì›ë˜ì˜ íŠ¹ì„± Xì™€ íŠ¹ì„±ì˜ ì œê³±ì„ í¬í•¨

```python
lin_reg = LinearRegression()
lin_reg.fit(X_poly, y)
lin_reg.intercept_, lin_reg.coef_
>> array([1.78134581]), array([[0.93366893, 0.56456263]])


X_new=np.linspace(-3, 3, 100).reshape(100, 1)
X_new_poly = poly_features.transform(X_new)
y_new = lin_reg.predict(X_new_poly)
plt.plot(X, y, "b.")
plt.plot(X_new, y_new, "r-", linewidth=2, label="Predictions")
plt.xlabel("$x_1$", fontsize=18)
plt.ylabel("$y$", rotation=0, fontsize=18)
plt.legend(loc="upper left", fontsize=14)
plt.axis([-3, 3, 0, 10])
plt.show()
```

![image-20220928165417406](/images/2022-09-27-hands_on_4/image-20220928165417406.png)

> íŠ¹ì„±ì´ ì—¬ëŸ¬ ê°œì¼ ë•Œ ë‹¤í•­ íšŒê·€ëŠ” ì´ íŠ¹ì„± ì‚¬ì´ì˜ ê´€ê³„ë¥¼ ì°¾ìŒ
>
> PolynomialFeaturesê°€ ì£¼ì–´ì§„ ì°¨ìˆ˜ê¹Œì§€ íŠ¹ì„± ê°„ì˜ ëª¨ë“  êµì°¨í•­ì„ ì¶”ê°€í•¨

 &nbsp;

## í•™ìŠµ ê³¡ì„ 

- ê³ ì°¨ ë‹¤í•­ íšŒê·€ë¥¼ ì ìš©í•˜ë©´ ë³´í†µì˜ ì„ í˜• íšŒê·€ì—ì„œë³´ë‹¤ ë” í›ˆë ¨ ë°ì´í„°ì— ì˜ ë§ì¶œë ¤ê³  í•¨

**ì„ í˜•ëª¨ë¸, 2ì°¨ íšŒê·€ ëª¨ë¸, 300ì°¨ ë‹¤í•­íšŒê·€ ëª¨ë¸ ë¹„êµ**

```python
from sklearn.preprocessing import StandardScaler
from sklearn.pipeline import Pipeline

for style, width, degree in (("g-", 1, 300), ("b--", 2, 2), ("r-+", 2, 1)):
    polybig_features = PolynomialFeatures(degree=degree, include_bias=False)
    std_scaler = StandardScaler()
    lin_reg = LinearRegression()
    polynomial_regression = Pipeline([
            ("poly_features", polybig_features),
            ("std_scaler", std_scaler),
            ("lin_reg", lin_reg),
        ])
    polynomial_regression.fit(X, y)
    y_newbig = polynomial_regression.predict(X_new)
    plt.plot(X_new, y_newbig, style, label=str(degree), linewidth=width)

plt.plot(X, y, "b.", linewidth=3)
plt.legend(loc="upper left")
plt.xlabel("$x_1$", fontsize=18)
plt.ylabel("$y$", rotation=0, fontsize=18)
plt.axis([-3, 3, 0, 10])
plt.show()
```

- ê³ ì°¨ ë‹¤í•­ íšŒê·€ ëª¨ë¸ì€ ì‹¬ê°í•œ ê³¼ëŒ€ì í•©ì„ ë³´ì—¬ì¤Œ, ì„ í˜• ëª¨ë¸ì€ ê³¼ì†Œì í•©
- ìœ„ ê²½ìš°ì—ì„œ ê°€ì¥ ì¼ë°˜í™”ê°€ ì˜ëœ ëª¨ë¸ì€ 2ì°¨ ë‹¤í•­ íšŒê·€ëª¨ë¸ì„

> ëª¨ë¸ì˜ ê³¼ëŒ€ì í•©, ê³¼ì†Œì í•©ì„ í™•ì¸í•˜ëŠ” ë°©ë²•ì€ í›ˆë ¨ë°ì´í„°ì—ì„œì˜ ì„±ëŠ¥ê³¼ êµì°¨ ê²€ì¦ ì„±ëŠ¥ì´ ë‚˜ìœì§€ í™•ì¸í•˜ëŠ” **êµì°¨ ê²€ì¦ , í•™ìŠµ ê³¡ì„ ** ë“±ì˜ ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤.

  &nbsp;

**í•™ìŠµ ê³¡ì„ **

- í›ˆë ¨ ì„¸íŠ¸ì™€ ê²€ì¦ ì„¸íŠ¸ì˜ ëª¨ë¸ ì„±ëŠ¥ì„ í›ˆë ¨ ì„¸íŠ¸ í¬ê¸°ì˜ í•¨ìˆ˜ë¡œ í‘œí˜„
- í›ˆë ¨ì„¸íŠ¸ì—ì„œ í¬ê¸°ê°€ ë‹¤ë¥¸ ì„œë¸Œ ì„¸íŠ¸ë¥¼ ë§Œë“¤ì–´ ëª¨ë¸ì„ ì—¬ëŸ¬ ë²ˆ í›ˆë ¨ ì‹œí‚¤ë©´ì„œ ê·¸ë¦¼

```python
from sklearn.metrics import mean_squared_error
from sklearn.model_selection import train_test_split

def plot_learning_curves(model, X, y):
    X_train, X_val, y_train, y_val = train_test_split(X, y, test_size=0.2, random_state=10)
    train_errors, val_errors = [], []
    for m in range(1, len(X_train) + 1):
        model.fit(X_train[:m], y_train[:m])
        y_train_predict = model.predict(X_train[:m])
        y_val_predict = model.predict(X_val)
        train_errors.append(mean_squared_error(y_train[:m], y_train_predict))
        val_errors.append(mean_squared_error(y_val, y_val_predict))

    plt.plot(np.sqrt(train_errors), "r-+", linewidth=2, label="train")
    plt.plot(np.sqrt(val_errors), "b-", linewidth=3, label="val")
    plt.legend(loc="upper right", fontsize=14)   # ì±…ì—ëŠ” ì—†ìŒ
    plt.xlabel("Training set size", fontsize=14) # ì±…ì—ëŠ” ì—†ìŒ
    plt.ylabel("RMSE", fontsize=14)              # ì±…ì—ëŠ” ì—†ìŒ

lin_reg = LinearRegression()
plot_learning_curves(lin_reg, X, y)
plt.axis([0, 80, 0, 3])                         # ì±…ì—ëŠ” ì—†ìŒ
plt.show()                                      # ì±…ì—ëŠ” ì—†ìŒ
```

![image-20220929174909417](/images/2022-09-27-hands_on_4/image-20220929174909417.png)

- ìœ„ ëª¨ë¸ì€ ê³¼ì†Œ ì í•©ì„ ë³´ì—¬ì£¼ëŠ” ëª¨ë¸
  - ì²˜ìŒì—ëŠ” ì™„ë²½í•œ ì í•©ì„ ë³´ì—¬ì£¼ì§€ë§Œ ì ì  ëŠ˜ì–´ë‚ ìˆ˜ë¡ ê³¡ì„ ì´ í‰íƒ„í•´ì§ˆë•Œ ê¹Œì§€ ì˜¤ì°¨ê°€ ê²Œì† ìƒìŠ¹í•¨
  - ì´ëŸ° ê²½ìš°ì—ì„œëŠ” **ë°ì´í„°ë¥¼ ë” ë„£ì–´ì£¼ëŠ”ê²ƒ ë³´ë‹¤ëŠ” ë” ë³µì¡í•œ ëª¨ë¸ì„ ì‚¬ìš©í•´ì•¼í•¨**

&nbsp;

**ê°™ì€ ë°ì´í„°ì—ì„œ ë‹¤í•­ íšŒê·€ ëª¨ë¸ ì‚¬ìš©ì‹œ**

```python
from sklearn.pipeline import Pipeline

polynomial_regression = Pipeline([
        ("poly_features", PolynomialFeatures(degree=10, include_bias=False)),
        ("lin_reg", LinearRegression()),
    ])

plot_learning_curves(polynomial_regression, X, y)
plt.axis([0, 80, 0, 3])           # ì±…ì—ëŠ” ì—†ìŒ
plt.show()                        # ì±…ì—ëŠ” ì—†ìŒ
```

![image-20220929174944690](/images/2022-09-27-hands_on_4/image-20220929174944690.png)

- ì´ì „ì˜ í•™ìŠµ ê³¡ì„ ê³¼ì˜ í° ì°¨ì´ë¥¼ ë³¼ìˆ˜ ìˆìŒ
  - í›ˆë ¨ ë°ì´í„°ì˜ ì˜¤ì°¨ê°€ ì„ í˜• íšŒê·€ ëª¨ë¸ë³´ë‹¤ ë‚®ìŒ
  - ë‘ ê³¡ì„  ì‚¬ì´ì˜ ê³µê°„ì´ ì¡´ì¬, í›ˆë ¨ ë°ì´í„°ì—ì„œì˜ ëª¨ë¸ ì„±ëŠ¥ì´ ê²€ì¦ ë°ì´í„°ì—ì„œë³´ë‹¤ í›¨ì”¬ ë‚«ë‹¤ëŠ” ëœ» â† ì´ëŸ° íŠ¹ì„±ì€ ê³¼ëŒ€ì í•© ëª¨ë¸ì˜ íŠ¹ì§•
    - í•´ê²°ë°©ì•ˆì€ ë” ë§ì€ í›ˆë ¨ ì„¸íŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²• (ë°ì´í„° ì¶”ê°€)

&nbsp;

**í¸í–¥/ë¶„ì‚° íŠ¸ë ˆì´ë“œì˜¤í”„**

- ëª¨ë¸ì˜ ì¼ë°˜í™” ì˜¤ì°¨ëŠ” ì„¸ ê°€ì§€ ë‹¤ë¥¸ ì¢…ë¥˜ì˜ ì˜¤ì°¨ì˜ í•©ìœ¼ë¡œ í‘œí˜„í•  ìˆ˜ ìˆë‹¤ëŠ” ì‚¬ì‹¤
  - í¸í–¥
    - ì¼ë°˜í™” ì˜¤ì°¨ì¤‘ í¸í–¥ì€ ì˜ëª»ëœ ê°€ì •ìœ¼ë¡œ ì¸í•´ ë°œìƒ
    - ì‹¤ì œëŠ” 2ì°¨ì¸ë° ì„ í˜•ìœ¼ë¡œ ê°€ì •í•˜ëŠ” ê²½ìš°
    - **í¸í–¥ì´ í° ëª¨ë¸ì€ í›ˆë ¨ ë°ì´í„°ì— ê³¼ì†Œì í•©ë˜ê¸° ì‰¬ì›€**
  - ë¶„ì‚°
    - í›ˆë ¨ ë°ì´í„°ì— ìˆëŠ” ì‘ì€ ë³€ë™ì— ëª¨ë¸ì´ ê³¼ë„í•˜ê²Œ ë¯¼ê°í•˜ê¸° ë•Œë¬¸ì— ë°œìƒ
    - ììœ ë„ê°€ ë†’ì€ ëª¨ë¸(ê³ ì°¨ì› ë‹¤í•­ íšŒê·€ ëª¨ë¸)ì´ ë†’ì€ ë¶„ì‚°ì„ ê°€ì§€ê¸° ì‰¬ì›Œ í›ˆë ¨ë°ì´í„°ì— ê³¼ëŒ€ì í•©í•˜ëŠ” ê²½í–¥ ë°œìƒ
  - ì¤„ì¼ ìˆ˜ ì—†ëŠ” ì˜¤ì°¨
    - ë°ì´í„° ìì²´ì— ìˆëŠ” ì¡ìŒ ë•Œë¬¸ì— ë°œìƒ
    - ì˜¤ì°¨ë¥¼ ì¤„ì¼ìˆ˜ ìˆëŠ” ìœ ì¼í•œ ë°©ë²•ì€ ë°ì´í„°ì—ì„œ ì¡ìŒì„ ì œê±°í•˜ëŠ” ê²ƒ

> ëª¨ë¸ì˜ ë³µì¡ë„ê°€ ì»¤ì§€ë©´ í†µìƒì ìœ¼ë¡œ ë¶„ì‚°ì´ ëŠ˜ì–´ë‚˜ê³  í¸í–¥ì€ ì¤„ì–´ë“¦, ë°˜ëŒ€ë¡œ ëª¨ë¸ì˜ ë³µì¡ë„ê°€ ì¤„ì–´ë“¤ë©´ í¸í–¥ì´ ì»¤ì§€ê³  ë¶„ì‚°ì´ ì‘ì•„ì§ **(ê·¸ë˜ì„œ í¸í–¥ ë¶„ì‚° íŠ¸ë ˆì´ë“œ ì˜¤í”„)**

 &nbsp;

## ê·œì œê°€ ìˆëŠ” ì„ í˜• ëª¨ë¸

- ê³¼ëŒ€ì í•©ì„ ê°ì†Œì‹œí‚¤ëŠ” ì¢‹ì€ ë°©ë²•ì€ ëª¨ë¸ì„ ê·œì œí•˜ëŠ” ê²ƒ
- ììœ ë„ë¥¼ ì¤„ì´ë©´ ë°ì´í„°ì— ê³¼ëŒ€ì í•©ë˜ê¸°ê°€ ë” ì–´ë ¤ì›Œì§
- ë‹¤í•­ íšŒê·€ëª¨ë¸ì„ ê·œì œí•˜ëŠ” ê°„ë‹¨í•œ ë°©ë²•ì€ ë‹¤í•­ì‹ì˜ ì°¨ìˆ˜ë¥¼ ê°ì†Œì‹œí‚¤ëŠ” ê²ƒ
- ì„ í˜• í™”ê·€ ëª¨ë¸ì—ì„œëŠ” ë³´í†µ ëª¨ë¸ì˜ ê°€ì¤‘ì¹˜ë¥¼ ì œí•œ, ê°ê¸° ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ ê°€ì¤‘ì¹˜ë¥¼ ì œí•œí•˜ëŠ” â€˜ë¦¿ì§€â€™, â€˜ë¼ì˜â€™, â€˜ì—˜ë¼ìŠ¤í‹±ë„·â€™ ì´ ì¡´ì¬

&nbsp;

### ë¦¿ì§€ íšŒê·€

- ê·œì œê°€ ì¶”ê°€ëœ ì„ í˜• íšŒê·€
- í•™ìŠµ ì•Œê³ ë¦¬ì¦˜ì„ ë°ì´í„°ì— ë§ì¶”ëŠ” ê²ƒë¿ë§Œ ì•„ë‹ˆë¼ ëª¨ë¸ì˜ ê°€ì¤‘ì¹˜ê°€ ê°€ëŠ¥í•œ ì‘ê²Œ ìœ ì§€ë˜ë„ë¡ ë…¸ë ¥
- ê·œì œí•­ì€ í›ˆë ¨í•˜ëŠ” ë™ì•ˆì—ë§Œ ë¹„ìš© í•¨ìˆ˜ì— ì¶”ê°€, ëª¨ë¸ì˜ í›ˆë ¨ì´ ëë‚˜ë©´ ëª¨ë¸ì˜ ì„±ëŠ¥ì„ ê·œì œê°€ ì—†ëŠ” ì„±ëŠ¥ì§€í‘œë¡œ í‰ê°€

```python
- alpha : ê°’ì´ í´ìˆ˜ë¡ ê°•ë ¥í•œ ì •ê·œí™”(ê·œì œ) ì„¤ì •í•˜ì—¬ ë¶„ì‚°ì„ ì¤„ì„, ì–‘ìˆ˜ë¡œ ì„¤ì •
- fit_intercept : ëª¨í˜•ì— ìƒìˆ˜í•­ (ì ˆí¸)ì´ ìˆëŠ”ê°€ ì—†ëŠ”ê°€ë¥¼ ê²°ì •í•˜ëŠ” ì¸ìˆ˜ (default : True)
- normalize : ë§¤ê°œë³€ìˆ˜ ë¬´ì‹œ ì—¬ë¶€
- copy_X : Xì˜ ë³µì‚¬ ì—¬ë¶€
- max_iter : ê³„ì‚°ì— ì‚¬ìš©í•  ì‘ì—… ìˆ˜
- tol : ì •ë°€ë„
- solver : ê³„ì‚°ì— ì‚¬ìš©í•  ì•Œê³ ë¦¬ì¦˜ (auto, svd, cholesky, lsqr, sparse_cg, sag, saga)
	- auto : ë°ì´í„° ìœ í˜•ì— ë”°ë¥¸ ìë™ì„ íƒ
	- svd : xì˜ íŠ¹ì´ê°’ ë¶„í•´ë¥¼ ì‚¬ìš©í•´ ë¦¿ì§€ ê³„ìˆ˜ ê³„ì‚°, ê°€ì¥ ì•ˆì •ì  , cholesky ë°©ì‹ë³´ë‹¤ ëŠë¦¬ì§€ë§Œ ì•ˆì •ì 
	- cholesky : í‘œì¤€ scipy.linalg.solve ì‚¬ìš©í•œ í–‰ë ¬ ë¶„í•´
	- lsqr : scipy.sparse.linalg.lsqr ì‚¬ìš©, ê°€ì¥ ë¹ ë¦„, ìµœì†Œì œê³±ë²• ë°©ì‹ ì‚¬ìš©í•´ ì„ í˜• ì—°ë¦½ë°©ì •ì‹ í’€ì–´ëƒ„
	- sag : SGD ì‚¬ìš©
	- parse_cg : scipy.sparse.linalg.cg ì‚¬ìš©, ëŒ€ê·œëª¨ ë°ì´í„°ì—ì„œ cholesky ë³´ë‹¤ ì í•©
	- lbfgs : scipy.optimize.minimize.positive ê°€ True ì¼ë•Œ ì‚¬ìš©ê°€ëŠ¥

	>> svdë¥¼ ì œì™¸í•œ ëª¨ë“  ë‹¤ë¥¸ íŒŒë¼ë¯¸í„°ëŠ” ë°€ì§‘ë°ì´í„°, í¬ì†Œë°ì´í„° ì§€ì›, 
			lsqr, sag, sparse_cg, lbfgëŠ” fit_interceotê°€ True ì¸ ê²½ìš°ë§Œ í¬ì†Œ ì…ë ¥ ì§€ì›
- random_state : ë‚œìˆ˜ seed ì„¤ì •
```

> ì¼ë°˜ì ìœ¼ë¡œ í›ˆë ¨í•˜ëŠ” ë™ì•ˆ ì‚¬ìš©ë˜ëŠ” ë¹„ìš© í•¨ìˆ˜ì™€ í…ŒìŠ¤íŠ¸ì—ì„œ ì‚¬ìš©ë˜ëŠ” ì„±ëŠ¥ ì§€í‘œëŠ” ë‹¤ë¦„, ê·œì œë¥¼ ë– ë‚˜ì„œ ì´ë“¤ì´ ë‹¤ë¥¸ ì´ìœ ëŠ” í›ˆë ¨ì— ì‚¬ìš©ë˜ëŠ” ë¹„ìš© í•¨ìˆ˜ëŠ” ìµœì í™”ë¥¼ ìœ„í•´ ë¯¸ë¶„ ê°€ëŠ¥í•´ì•¼ í•˜ê¸° ë•Œë¬¸

> ë°˜ë©´ í…ŒìŠ¤íŠ¸ì— ì‚¬ìš©ë˜ëŠ” ì„±ëŠ¥ì§€í‘œëŠ” ìµœì¢… ëª©í‘œì— ê°€ëŠ¥í•œ ê°€ê¹Œì›Œì•¼ í•´ì„œ ë¡œê·¸ ì†ì‹¤ê°™ì€ ë¹„ìš©í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ í›ˆë ¨ì‹œí‚¨ ë¶„ë¥˜ê¸°ë¥¼ ì •ë°€ë„/ì¬í˜„ìœ¨ì„ ì‚¬ìš©í•´ í‰ê°€í•˜ëŠ” ê²ƒì´ ì¢‹ì€ ì˜ˆ

- ë¦¿ì§€ ë¹„ìš©í•¨ìˆ˜

  ![image-20220929175022948](/images/2022-09-27-hands_on_4/image-20220929175022948.png)

  - Î±ëŠ” ëª¨ë¸ì„ ì–¼ë§ˆë‚˜ ë§ì´ ê·œì œí• ì§€ ì¡°ì ˆ, Î± = 0 ì´ë©´ ì„ í˜•íšŒê·€ì™€ ë™ì¼

  - Î±ê°€ ë„ˆë¬´ ì»¤ì§€ë©´ ëª¨ë“  ê°€ì¤‘ì¹˜ê°€ ê±°ì˜ 0ì— ê°€ê¹Œì›Œì§€ë©° ê²°êµ­ **ë°ì´í„°ì˜ í‰ê· ì„ ì§€ë‚˜ëŠ” ìˆ˜í‰ì„ **ì´ ë¨

  - í¸í–¥(Î¸) ëŠ” ê·œì œë˜ì§€ ì•ŠìŒ, wë¥¼ íŠ¹ì„±ì˜ ê°€ì¤‘ì¹˜ ë²¡í„°(Î¸_1 --> Î¸_n)ì´ë¼ê³  ì •ì˜ í•œë‹¤ë©´ ê·œì œí•­ì€ ì•„ë˜ì™€ ê°™ìŒ

    ![image-20220929175036927](/images/2022-09-27-hands_on_4/image-20220929175036927.png)

    - ì—¬ê¸°ì„œ ![image-20220929175103569](/images/2022-09-27-hands_on_4/image-20220929175103569.png) ê°€ ê°€ì¤‘ì¹˜ ë²¡í„°ì˜ ![image-20220929175116594](/images/2022-09-27-hands_on_4/image-20220929175116594.png) ë…¸ë¦„
    - ê²½ì‚¬í•˜ê°•ë²•ì— ì ìš©í•˜ë ¤ë©´ MSE ê·¸ë ˆì´ë””ì–¸íŠ¸ ë²¡í„°ì— Î±wë¥¼ ë”í•˜ë©´ ë¨

> ë¦¿ì§€ íšŒê·€ëŠ” ì…ë ¥ íŠ¹ì„±ì˜ ìŠ¤ì¼€ì¼ì— ë¯¼ê°í•˜ê¸° ë•Œë¬¸ì— ìˆ˜í–‰í•˜ê¸° ì „ì— ë°ì´í„° ìŠ¤ì¼€ì¼ ë§ì¶”ëŠ” ê²ƒì´ ì¤‘ìš”, ê·œì œê°€ ìˆëŠ” ëª¨ë“  ëª¨ë¸ì€ ëŒ€ë¶€ë¶„ ë§ˆì°¬ê°€ì§€

&nbsp;

**ì„ í˜• ë°ì´í„°ì— ë‹¤ë¥¸ Î±ë¥¼ ì‚¬ìš©í•´ ë¦¿ì§€ ëª¨ë¸ í›ˆë ¨ ì‹œê°í™”**

- ì™¼ìª½ì€ í‰ë²”í•œ ë¦¿ì§€ ëª¨ë¸ ì‚¬ìš©, ì˜¤ë¥¸ìª½ì€ PolynomialFeatures(degree=10) ì‚¬ìš©í•´ ë¨¼ì € ë°ì´í„°ë¥¼ í™•ì¥í›„ StandardScaler ì‚¬ìš©í•´ ìŠ¤ì¼€ì¼ì„ ì¡°ì •í•œ ë’¤ ë¦¿ì§€ ëª¨ë¸ ì ìš© (ë¦¿ì§€ ê·œì œë¥¼ ì‚¬ìš©í•œ ë‹¤í•­íšŒê·€)

```python
from sklearn.linear_model import Ridge

def plot_model(model_class, polynomial, alphas, **model_kargs):
    for alpha, style in zip(alphas, ("b-", "g--", "r:")):
        model = model_class(alpha, **model_kargs) if alpha > 0 else LinearRegression()
        if polynomial:
            model = Pipeline([
                    ("poly_features", PolynomialFeatures(degree=10, include_bias=False)),
                    ("std_scaler", StandardScaler()),
                    ("regul_reg", model),
                ])
        model.fit(X, y)
        y_new_regul = model.predict(X_new)
        lw = 2 if alpha > 0 else 1
        plt.plot(X_new, y_new_regul, style, linewidth=lw, label=r"$\\alpha = {}$".format(alpha))
    plt.plot(X, y, "b.", linewidth=3)
    plt.legend(loc="upper left", fontsize=15)
    plt.xlabel("$x_1$", fontsize=18)
    plt.axis([0, 3, 0, 4])

plt.figure(figsize=(8,4))
plt.subplot(121)
plot_model(Ridge, polynomial=False, alphas=(0, 10, 100), random_state=42)
plt.ylabel("$y$", rotation=0, fontsize=18)
plt.subplot(122)
plot_model(Ridge, polynomial=True, alphas=(0, 10**-5, 1), random_state=42)
plt.show()
```

![image-20220929175202704](/images/2022-09-27-hands_on_4/image-20220929175202704.png)

- **Î±**ë¥¼ ì¦ê°€ì‹œí‚¬ìˆ˜ë¡ ì§ì„ ì— ê°€ê¹Œì›Œì§€ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŒ
- ì¦‰, ëª¨ë¸ì˜ ë¶„ì‚°ì€ ì¤„ì§€ë§Œ í¸í–¥ì€ ì»¤ì§
- ì„ í˜• íšŒê·€ì™€ ë§ˆì°¬ê°€ì§€ë¡œ ë¦¿ì§€ íšŒê·€ë¥¼ ê³„ì‚°í•˜ê¸° ìœ„í•´ ì •ê·œë°©ì •ì‹ì„ ì‚¬ìš©í•  ìˆ˜ë„ ìˆê³  ê²½ì‚¬ í•˜ê°•ë²•ì„ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìŒ

&nbsp;

**ì •ê·œë°©ì •ì‹ì„ ì‚¬ìš©í•œ ridge íšŒê·€ ì™€ í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²• ë¹„êµ**

- í–‰ë ¬ ë¶„í•´ ê³µì‹ì„ ì‚¬ìš©í•´ ë³€í˜•í•œ ë°©ì •ì‹ í™œìš©

```python
from sklearn.linear_model import Ridge
ridge_reg = Ridge(alpha=1, solver="cholesky", random_state=42)
ridge_reg.fit(X, y)
ridge_reg.predict([[1.5]])
>> array([[1.55071465]])
```

- SGD ì‚¬ìš©
  - penalty ë§¤ê°œë³€ìˆ˜ëŠ” ì‚¬ìš©í•  ê·œì œë¥¼ ì„¤ì •
  - L2ëŠ” SGDê°€ ë¹„ìš© í•¨ìˆ˜ì— ê°€ì¤‘ì¹˜ ë²¡í„°ì˜ L2 ë…¸ë¦„ì˜ ì œê³±ì„ 2ë¡œ ë‚˜ëˆˆ ê·œì œí•­ ì¶”ê°€í•˜ê²Œ ë§Œë“¬ â†’ ë¦¿ì§€íšŒê·€ì™€ ë™ì¼

```python
sgd_reg = SGDRegressor(penalty="l2", max_iter=1000, tol=1e-3, random_state=42)
sgd_reg.fit(X, y.ravel())
sgd_reg.predict([[1.5]])
```

> L2 ê·œì œ : ê°€ì¤‘ì¹˜ì˜ ì œê³±ì— ë¹„ë¡€í•˜ëŠ” ë¹„ìš©ì´ ì¶”ê°€ë©ë‹ˆë‹¤. L2ê·œì œëŠ” ì‹ ê²½ë§ì—ì„œ ê°€ì¤‘ì¹˜ ê°ì‡ 

 &nbsp;

## ë¼ì˜ íšŒê·€

- ì„ í˜• íšŒê·€ì˜ ë˜ ë‹¤ë¥¸ ê·œì œëœ ë²„ì „

- ë¦¿ì§€ íšŒê·€ì²˜ëŸ¼ ë¹„ìš© í•¨ìˆ˜ì— ê·œì œí•­ì„ ë”í•˜ì§€ë§Œ L2 ë…¸ë¦„ / 2 ë¡œ ë‚˜ëŠ” ê²ƒ ëŒ€ì‹  ê°€ì¤‘ì¹˜ ë²¡í„°ì˜ L1 ë…¸ë¦„ì„ ì‚¬ìš©

- ë¼ì˜ ë¹„ìš©í•¨ìˆ˜

  ![image-20220929175225884](/images/2022-09-27-hands_on_4/image-20220929175225884.png)

  ```python
  from sklearn.linear_model import Lasso
  
  plt.figure(figsize=(8,4))
  plt.subplot(121)
  plot_model(Lasso, polynomial=False, alphas=(0, 0.1, 1), random_state=42)
  plt.ylabel("$y$", rotation=0, fontsize=18)
  plt.subplot(122)
  plot_model(Lasso, polynomial=True, alphas=(0, 10**-7, 1), random_state=42)
  plt.show()
  ```

  ![image-20220929175243799](/images/2022-09-27-hands_on_4/image-20220929175243799.png)

  - ì´ì „ì˜ Ridge ëª¨ë¸ê³¼ ê°™ì€ ì–‘ìƒì´ì§€ë§Œ ì¡°ê¸ˆ ë” ì‘ì€ **Î±**ê°’ì„ ì‚¬ìš©
  - ë¼ì˜ì˜ ì¤‘ìš”í•œ ì ì€ ëœ ì¤‘ìš”í•œ íŠ¹ì„±ì˜ ê°€ì¤‘ì¹˜ë¥¼ ì œê±°í•˜ë ¤ê³  í•œë‹¤ëŠ” ì 
    - ì˜¤ë¥¸ìª½ ê·¸ë˜í”„ì˜ ì ì„ ì€ 2ì°¨ë°©ì ì‹ ì²˜ëŸ¼ ë³´ì´ëŠ” ì„ í˜•
    - ì°¨ìˆ˜ê°€ ë†’ì€ ë‹¤í•­ íŠ¹ì„±ì˜ ê°€ì¤‘ì¹˜ê°€ ëª¨ë‘ 0ìœ¼ë¡œ ë³€ê²½, ë¼ì˜ íšŒê·€ëŠ” ìë™ìœ¼ë¡œ íŠ¹ì„± ì„ íƒì„ í•˜ê³  **í¬ì†Œ ëª¨ë¸ ìƒì„±**

> ë¼ì˜ ì‚¬ìš©ì‹œ ê²½ì‚¬ í•˜ê°•ë²•ì´ ìµœì ì  ê·¼ì²˜ì—ì„œ ì§„ë™í•˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ê¸° ìœ„í•´ì„œëŠ” í›ˆë ¨í•˜ëŠ” ë™ì•ˆ ì ì§„ì ìœ¼ë¡œ í•™ìŠµë¥  ê°ì†Œì‹œì¼œì•¼ í•¨

- ë¼ì˜ì˜ ë¹„ìš©í•¨ìˆ˜ëŠ” Î¸0ì—ì„œ ë¯¸ë¶„ ê°€ëŠ¥í•˜ì§€ ì•ŠìŒ, í•˜ì§€ë§Œ Î¸i = 0ì¼ë•Œ g(**ì„œë¸Œê·¸ë ˆì´ë””ì–¸íŠ¸ ë²¡í„°)**ë¥¼ ì‚¬ìš©í•˜ë©´ ê²½ì‚¬ í•˜ê°•ë²•ì„ ì ìš©í•˜ëŠ” ë° ë¬¸ì œê°€ ì—†ìŒ

- ê²½ì‚¬ í•˜ê°•ë²•ì„ ìœ„í•´ ë¼ì˜ ë¹„ìš© í•¨ìˆ˜ì— ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì„œë¸Œê·¸ë ˆì´ë””ì–¸íŠ¸ ë²¡í„° ê³µì‹

  ![image-20220929175309914](/images/2022-09-27-hands_on_4/image-20220929175309914.png)

&nbsp;

**sklearn Lasso ì˜ˆì‹œ**

```python
from sklearn.linear_model import Lasso
lasso_reg = Lasso(alpha=0.1)
lasso_reg.fit(X, y)
lasso_reg.predict([[1.5]])
>> array([1.53788174])
```

- Lasso ëŒ€ì‹  SGDRegressor(penalty=â€™l1â€™)ë„ ê°€ëŠ¥

 &nbsp;

### ì—˜ë¼ìŠ¤í‹±ë„·

- ë¦¿ì§€, ë¼ì˜ ë‘ ëª¨ë¸ì„ ì ˆì¶©í•œ ëª¨ë¸

- ê·œì œëŠ” ë¦¿ì§€ ê·œì œ + ë¼ì˜ ê·œì œ, í˜¼í•© ë¹„ìœ¨ì„ rì„ ì´ìš©í•´ ì¡°ì ˆ

- r=0 ì´ë©´ ë¦¿ì§€, r=1 ì´ë©´ ë¼ì˜ì™€ ê°™ìŒ

- ë¹„ìš©í•¨ìˆ˜

  ![image-20220929175334122](/images/2022-09-27-hands_on_4/image-20220929175334122.png)

**ì„ í˜•íšŒê·€, ë¦¿ì§€, ë¼ì˜, ì—˜ë¼ìŠ¤í‹±ë„· ?**

- ì¼ë°˜ì ìœ¼ë¡œ í‰ë²”í•œ ì„ í˜• íšŒê·€ëŠ” í”¼í•´ì•¼í•¨, ëŒ€ë¶€ë¶„ ê·œì œê°€ ìˆëŠ” ê²ƒì´ ì¢‹ìŒ
- ë¦¿ì§€ê°€ ê¸°ë³¸ì´ ë˜ì§€ë§Œ ëª‡ëª‡ ì‚¬ìš©ë˜ëŠ” í•µì‹¬ íŠ¹ì„±ì´ ì ë‹¤ê³  íŒë‹¨ë˜ë©´ ë¼ì˜ë‚˜ ì—˜ë¼ìŠ¤í‹±ë„·ì´ ì¢‹ìŒ
  - ë¼ì˜, ì—˜ë¼ìŠ¤í‹±ë„·ì€ ë¶ˆí•„ìš”í•œ íŠ¹ì„±ì˜ ê°€ì¤‘ì¹˜ë¥¼ 0ìœ¼ë¡œ ë§Œë“¬
  - íŠ¹ì„± ìˆ˜ê°€ í›ˆë ¨ ìƒ˜í”Œë³´ë‹¤ ë§ê±°ë‚˜ íŠ¹ì„± ëª‡ ê°œê°€ ê°•í•˜ê²Œ ì—°ê´€ë˜ì–´ ìˆë‹¤ë©´ ë¼ì˜ë³´ë‹¤ â†’ ì—˜ë¼ìŠ¤í‹±ë„·

&nbsp;

**ElasticNet ì˜ˆì œ**

```python
from sklearn.linear_model import ElasticNet
elastic_net = ElasticNet(alpha=0.1, l1_ratio=0.5, random_state=42)
elastic_net.fit(X, y)
elastic_net.predict([[1.5]])
>> array([1.54333232])
```

 &nbsp;

### ì¡°ê¸° ì¢…ë£Œ

- ê²½ì‚¬ í•˜ê°•ë²•ê³¼ ê°™ì€ ë°˜ë³µì ì¸ í•™ìŠµ ì•Œê³ ë¦¬ì¦˜ì„ ê·œì œí•˜ëŠ” ë°©ë²•ì€ ê²€ì¦ ì—ëŸ¬ê°€ ìµœì†Ÿê°’ì— ë„ë‹¬í•˜ë©´ ë°”ë¡œ í›ˆë ¨ì„ ì¤‘ì§€í•˜ëŠ” ê²ƒ â†’ **ì¡°ê¸°ì¢…ë£Œ**

![image-20220929175401118](/images/2022-09-27-hands_on_4/image-20220929175401118.png)

- ìœ„ì˜ ê·¸ë¦¼ì„ í†µí•´ í•™ìŠµì„ ì§„í–‰í•˜ë©´ì„œ RMSEë¥¼ ê¸°ë¡
- ê¸°ë¡ëœ RMSEê°€ ìµœì†Œì¼ë•Œë¥¼ ì„ íƒ â† ë‹¤ì‹œ errorê°€ ëŠ˜ì–´ë‚˜ëŠ”ê²ƒì´ ì ì°¨ ê³¼ëŒ€ì í•©ì´ ë˜ê³  ìˆëŠ”ê²ƒì„ ì˜ë¯¸

> SGD ë‚˜ ë¯¸ë‹ˆë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²•ì—ì„œëŠ” ê³¡ì„ ì´ ë§¤ë„ëŸ½ì§€ ì•Šì•„ ìµœì†Ÿê°’ ë„ë‹¬ì´ ì–´ë ¤ì›€, ì´ë•ŒëŠ” ê²€ì¦ ì—ëŸ¬ê°€ ì¼ì • ì‹œê°„ ë™ì•ˆ ìµœì†Ÿê°’ë³´ë‹¤ í´ ë•Œ í•™ìŠµì„ ë©ˆì¶”ê³  ê²€ì¦ ì—ëŸ¬ê°€ ìµœì†Œì˜€ì„ ë•Œì˜ ëª¨ë¸ íŒŒë¼ë¯¸í„°ë¡œ ì„¤ì •

```python
from copy import deepcopy

poly_scaler = Pipeline([
        ("poly_features", PolynomialFeatures(degree=90, include_bias=False)),
        ("std_scaler", StandardScaler())
    ])

X_train_poly_scaled = poly_scaler.fit_transform(X_train)
X_val_poly_scaled = poly_scaler.transform(X_val)

sgd_reg = SGDRegressor(max_iter=1, tol=-np.infty, warm_start=True,
                       penalty=None, learning_rate="constant", eta0=0.0005, random_state=42)

minimum_val_error = float("inf")
best_epoch = None
best_model = None
for epoch in range(1000):
    sgd_reg.fit(X_train_poly_scaled, y_train)  # ì¤‘ì§€ëœ ê³³ì—ì„œ ë‹¤ì‹œ ì‹œì‘í•©ë‹ˆë‹¤
    y_val_predict = sgd_reg.predict(X_val_poly_scaled)
    val_error = mean_squared_error(y_val, y_val_predict)
    if val_error < minimum_val_error:
        minimum_val_error = val_error
        best_epoch = epoch
        best_model = deepcopy(sgd_reg)
```

- ìµœì†Œì¼ë•Œ epoch, model ê¸°ë¡
- warm_start=True ë¥¼ í†µí•´ì„œ fit() ë©”ì„œë“œ ì¬ í˜¸ì¶œì‹œ ì´ì „ ëª¨ë¸ íŒŒë¼ë¯¸í„°ì—ì„œ í›ˆë ¨ ì´ì–´ê°

 &nbsp;

## ë¡œì§€ìŠ¤í‹± íšŒê·€

- íšŒê·€ ì•Œê³ ë¦¬ì¦˜ì¤‘ ì¼ë¶€ëŠ” ë¶„ë¥˜ì—ì„œë„ ì‚¬ìš©ì´ ê°€ëŠ¥í•¨
- ìƒ˜í”Œì´ íŠ¹ì • í´ë˜ìŠ¤ì— ì†í•  í™•ë¥ ì„ ì¶”ì •í•˜ëŠ”ë° ì‚¬ìš©
- ì¶”ì • í™•ë¥ ì´ 50% ì´ìƒì´ë©´ ëª¨ë¸ì€ ê·¸ ìƒ˜í”Œì´ í•´ë‹¹ í´ë˜ìŠ¤ì— ì†í•œë‹¤ê³  íŒë‹¨, ë°˜ëŒ€ë©´ ì†í•˜ì§€ ì•ŠëŠ”ë‹¤ê³  ì˜ˆì¸¡ -> **ì´ì§„ë¶„ë¥˜**(ì‹œê·¸ëª¨ì´ë“œ)

&nbsp;

### í™•ë¥  ì¶”ì •

- ì…ë ¥ íŠ¹ì„±ì˜ ê°€ì¤‘ì¹˜ í•©ì„ ê³„ì‚°, ê·¸ë¦¬ê³  í¸í–¥ì„ ë”í•¨

- ë°”ë¡œ ê²°ê³¼ë¥¼ ì¶œë ¥í•˜ì§€ ì•Šê³  ê²°ê³¼ê°’ì˜ ë¡œì§€ìŠ¤í‹±ì„ ì¶œë ¥

- ê³µì‹ (**ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜**)

  ![image-20220930112847132](/images/2022-09-27-hands_on_4/image-20220930112847132.png)

> tê°€ 0 ì´ìƒì´ë©´ ![image-20220930113337199](/images/2022-09-27-hands_on_4/image-20220930113337199.png) ëŠ” 0.5 ì´ìƒ 1ë¡œ ì˜ˆì¸¡  ë°˜ëŒ€ëŠ” 0  

&nbsp;

### í›ˆë ¨ê³¼ ë¹„ìš© í•¨ìˆ˜

- í›ˆë ¨ì˜ ëª©ì ì€ ì–‘ìƒ ìƒ˜í”Œ(y=1)ì— ëŒ€í•´ ë†’ì€ í™•ë¥ ì„ ì¶”ì •, ìŒì„± ìƒ˜í”Œ(y=0)ì— ëŒ€í•´ì„œëŠ” ë‚®ì€ í™•ë¥ ì„ ì¶”ì •í•˜ëŠ” ëª¨ë¸ì˜ íŒŒë¼ë¯¸í„° ë²¡í„° Î¸ ë¥¼ ì°¾ëŠ” ê²ƒ

- í•˜ë‚˜ì˜ í›ˆë ¨ ìƒ˜í”Œì— ëŒ€í•œ ë¹„ìš©í•¨ìˆ˜

  ![image-20220930114156228](/images/2022-09-27-hands_on_4/image-20220930114156228.png)

  - ë¹„ìš©í•¨ìˆ˜ê°€ tê°€ 0ì— ê°€ê¹Œì›Œ ì§€ë©´ -log(t)ê°€ ë§¤ìš° ì»¤ì§€ë¯€ë¡œ íƒ€ë‹¹, ëª¨ë¸ì´ ì–‘ì„± ìƒ˜í”Œì„ 0ì— ê°€ê°€ìš´ í™•ë¥ ë¡œ ì¶”ì •í•˜ë©´ ë¹„ìš©ì´ í¬ê²Œ ì¦ê°€
  - ë°˜ëŒ€ë¡œ tê°€ 1ì— ê°€ê¹Œìš°ë©´ -log(t)ëŠ” 0ì— ê°€ê¹Œì›Œì§

  > ìŒì„±í™•ë¥ ì€ 0ì— ê°€ê¹ê²Œ ì¶”ì •, ì–‘ì„± ìƒ˜í”Œì˜ í™•ë¥ ì„ 1ì— ê°€ê¹ì²´ ì¶”ì • í•˜ë©´ ë¹„ìš©ì€ 0ì— ê°€ê¹Œì›Œì§

- ì „ì²´ í›ˆë ¨ ì„¸íŠ¸ì— ëŒ€í•œ ë¹„ìš© í•¨ìˆ˜ëŠ” ëª¨ë“  í›ˆë ¨ ìƒ˜í”Œì˜ ë¹„ìš©ì„ í‰ê· í•œ ê²ƒ (ë¡œì§€ìŠ¤í‹± íšŒê·€ ë¹„ìš© í•¨ìˆ˜)

  ![image-20220930120731894](/images/2022-09-27-hands_on_4/image-20220930120731894.png)

  - í•´ë‹¹ ë¹„ìš© í•¨ìˆ˜ì˜ ìµœì†Ÿê°’ì„ ê³„ì‚°í•˜ëŠ” ì•Œë ¤ì§„ í•´ëŠ” ì¡´ì¬í•˜ì§€ ì•ŠìŒ

  - í•´ë‹¹ ë¹„ìš© í•¨ìˆ˜ëŠ” ë³¼ë¡ í•¨ìˆ˜ì´ë¯€ë¡œ ê²½ì‚¬í•˜ê°•ë²•ì´ ì „ì—­ ìµœì†Ÿê°’ì„ ë³´ì¥

  - ìœ„ì˜ ë¹„ìš© í•¨ìˆ˜ì˜ jë²ˆì§¸ ëª¨ë¸ íŒŒë¼ë¯¸í„° ![image-20220930120937228](/images/2022-09-27-hands_on_4/image-20220930120937228.png)ì— ëŒ€í•´ í¸ë¯¸ë¶„ì„ í•œ ë¡œì§€ìŠ¤í‹± ë¹„ìš© í•¨ìˆ˜ì˜ í¸ë„í•¨ìˆ˜

    ![image-20220930121023527](/images/2022-09-27-hands_on_4/image-20220930121023527.png)

    - ê° ìƒ˜í”Œì— ëŒ€í•´ ì˜ˆì¸¡ ì˜¤ì°¨ë¥¼ ê³„ì‚°í•˜ê³  jë²ˆì§¸ íŠ¹ì„±ê°’ì„ ê³±í•´ì„œ ëª¨ë“  í›ˆë ¨ ìƒ˜í”Œì— ëŒ€í•´ í‰ê· ì„ ê³„ì‚°



&nbsp;

### ê²°ì • ê²½ê³„

- ë¡œì§€ìŠ¤í‹± íšŒê·€ë¥¼ í†µí•œ ê½ƒìì˜ ë„ˆë¹„ ê¸°ë°˜ Iris-Versicolor ì¢…ì„ ê°ì§€í•˜ëŠ” ë¶„ë¥˜ê¸° ì˜ˆì‹œ

```python
from sklearn import datasets
iris = datasets.load_iris()
list(iris.keys())
>> ['data', 'target', 'frame', 'target_names', 'DESCR', 'feature_names', 'filename', 'data_module']

X = iris["data"][:, 3:]  # ê½ƒì ë„ˆë¹„
y = (iris["target"] == 2).astype(int)  # Iris virginicaì´ë©´ 1 ì•„ë‹ˆë©´ 0

from sklearn.linear_model import LogisticRegression
log_reg = LogisticRegression(random_state=42)
log_reg.fit(X, y)

decision_boundary # ê²°ì •ê²½ê³„
>> array([1.66066066])
log_reg.predict([[1.7], [1.5]])
>> array([1, 0])
```

![image-20220930124958565](/images/2022-09-27-hands_on_4/image-20220930124958565.png)

- Iris-Verginicaì˜ ê½ƒì ë„ˆë¹„ëŠ” 1.4~2.5cmì— ë¶„í¬, ë‹¤ë¥¸ ê½ƒì€ 0.1~1.8cmì— ë¶„í¬
- ì•½ê°„ ê²¹ì¹˜ëŠ” ë¶€ë¶„ì¸ 1.4~1.8 ë¶€ë¶„ ì¤‘ì—ì„œ ê·¸ë˜í”„ì˜ 1.6ì´ **ê²°ì •ê²½ê³„**
- ê²°ì •ê²½ê³„ë¥¼ ê¸°ì¤€ìœ¼ë¡œ 1.6 ë³´ë‹¤ í¬ë©´ 1, ì•„ë‹ˆë©´ 0ìœ¼ë¡œ ì˜ˆì¸¡

```python
from sklearn.linear_model import LogisticRegression

X = iris["data"][:, (2, 3)]  # petal length, petal width
y = (iris["target"] == 2).astype(int)

log_reg = LogisticRegression(solver="lbfgs", C=10**10, random_state=42)
log_reg.fit(X, y)

x0, x1 = np.meshgrid(
        np.linspace(2.9, 7, 500).reshape(-1, 1),
        np.linspace(0.8, 2.7, 200).reshape(-1, 1),
    )
X_new = np.c_[x0.ravel(), x1.ravel()]

y_proba = log_reg.predict_proba(X_new)

plt.figure(figsize=(10, 4))
plt.plot(X[y==0, 0], X[y==0, 1], "bs")
plt.plot(X[y==1, 0], X[y==1, 1], "g^")

zz = y_proba[:, 1].reshape(x0.shape)
contour = plt.contour(x0, x1, zz, cmap=plt.cm.brg)


left_right = np.array([2.9, 7])
boundary = -(log_reg.coef_[0][0] * left_right + log_reg.intercept_[0]) / log_reg.coef_[0][1]

plt.clabel(contour, inline=1, fontsize=12)
plt.plot(left_right, boundary, "k--", linewidth=3)
plt.text(3.5, 1.5, "Not Iris virginica", fontsize=14, color="b", ha="center")
plt.text(6.5, 2.3, "Iris virginica", fontsize=14, color="g", ha="center")
plt.xlabel("ê½ƒì ê¸¸ì´", fontsize=14)
plt.ylabel("ê½ƒì ë„ˆë¹„", fontsize=14)
plt.axis([2.9, 7, 0.8, 2.7])
plt.show()
```

![image-20220930130450747](/images/2022-09-27-hands_on_4/image-20220930130450747.png)

- ë‹¤ë¥¸ ì„ í˜• ëª¨ë¸ì²˜ëŸ¼ ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ë„ l1, l2 í˜ë„í‹°ë¥¼ ì‚¬ìš©í•´ ê·œì œì„¤ì • ê°€ëŠ¥
- parameterì˜ cë¥¼ í†µí•´ cê°€ ë†’ì„ìˆ˜ë¡ ëª¨ë¸ì˜ ê·œì œê°€ ì¤„ì–´ë“¦

&nbsp;



### ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€

- ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ì€ ì—¬ëŸ¬ ê°œì˜ ì´ì§„ ë¶„ë¥˜ê¸°ë¥¼ í›ˆë ¨ ì‹œì¼œ ì—°ê²°í•˜ì§€ ì•Šê³  ì§ì ‘ ë‹¤ì¤‘ í´ë˜ìŠ¤ ì§€ì›í•˜ë„ë¡ ì¼ë°˜í™” ì‹œí‚¨ê²ƒì´ **ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€**

- ìƒ˜í”Œ xê°€ ì£¼ì–´ì§€ë©´ ë¨¼ì € ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ ëª¨ë¸ì´ ê° í´ë˜ìŠ¤ kì— ëŒ€í•œ ì ìˆ˜ ![image-20220930131832470](/images/2022-09-27-hands_on_4/image-20220930131832470.png)ë¥¼ ê³„ì‚°í•˜ëŠ” ì‹ì€ ì„ í˜• íšŒê·€ ì˜ˆì¸¡ì„ ìœ„í•œ ì‹ê³¼ ë§¤ìš° ë¹„ìŠ·

  ![image-20220930131951995](/images/2022-09-27-hands_on_4/image-20220930131951995.png)

  - ê° í´ë˜ìŠ¤ëŠ” ìì‹ ë§Œì˜ íŒŒë¼ë¯¸í„° ë²¡í„°ì¸ ![image-20220930132118650](/images/2022-09-27-hands_on_4/image-20220930132118650.png)ê°€ ìˆìŒ, ì´ ë²¡í„°ë“¤ì€ íŒŒë¼ë¯¸í„° í–‰ë ¬ ![image-20220930132154126](/images/2022-09-27-hands_on_4/image-20220930132154126.png)ì— í–‰ìœ¼ë¡œ ì €ì¥

- ìƒ˜í”Œ xì— ëŒ€í•´ ê° í´ë˜ìŠ¤ì˜ ì ìˆ˜ê°€ ê³„ì‚°ë˜ë©´ ì†Œí”„íŠ¸ë§¥ìŠ¤ í•¨ìˆ˜ë¥¼ í†µê³¼ì‹œì¼œ í´ë˜ìŠ¤kì— ì†í•  í™•ë¥  ![image-20220930132310061](/images/2022-09-27-hands_on_4/image-20220930132310061.png)ì„ ì¶”ì •í•  ìˆ˜ ìˆìŒ

  - **ì†Œí”„íŠ¸ë§¥ìŠ¤ í•¨ìˆ˜**

    ![image-20220930132625362](/images/2022-09-27-hands_on_4/image-20220930132625362.png)

    - KëŠ” í´ë˜ìŠ¤ ìˆ˜
    - s(x)ëŠ” ìƒ˜í”Œ xì— ëŒ€í•œ ê° í´ë˜ìŠ¤ì˜ ì ìˆ˜ë¥¼ ë‹´ì€ ë²¡í„°
    - ![image-20220930132722296](/images/2022-09-27-hands_on_4/image-20220930132722296.png)ëŠ” ìƒ˜í”Œ xì— ëŒ€í•œ ê° í´ë˜ìŠ¤ì˜ ì ìˆ˜ê°€ ì£¼ì–´ì¡Œì„ ë•Œ ì´ ìƒ˜í”Œì´ í´ë˜ìŠ¤ kì— ì†í•  ì¶”ì • í™•ë¥ 

    > ì¶”ì • í™•ë¥ ì´ ê°€ì¥ ë†’ì€ í´ë˜ìŠ¤ë¥¼ ì„ íƒ
    >
    > ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ ë¶„ë¥˜ê¸°ëŠ” í•œ ë²ˆì— í•˜ë‚˜ì˜ í´ë˜ìŠ¤ë§Œ ì˜ˆì¸¡, ì¢…ë¥˜ê°€ ë‹¤ë¥¸ ë¶“ê½ƒê°™ì´ ìƒí˜¸ ë°°íƒ€ì ì¸ í´ë˜ìŠ¤ì—ì„œë§Œ ì‚¬ìš© ê°€ëŠ¥

  - ê° ì ìˆ˜ì— ì§€ìˆ˜ í•¨ìˆ˜ë¥¼ ì ìš©í•œ í›„ ì •ê·œí™”, ì¼ë°˜ì ìœ¼ë¡œ ì´ ì ìˆ˜ë¥¼ **ë¡œì§“** ë˜ëŠ” **ë¡œê·¸-ì˜¤ì¦ˆ**ë¼ê³  í•¨

&nbsp;

### í›ˆë ¨ ë°©ë²•

- ëª¨ë¸ì´ íƒ€ê¹ƒ í´ë˜ìŠ¤ì— ëŒ€í•´ì„œ ë†’ì€ í™•ë¥ ì„ ì¶”ì •í•˜ë„ë¡ ë§Œë“œëŠ” ê²ƒì´ ëª©ì 

- ì•„ë˜ ê³µì‹ì˜ í¬ë¡œìŠ¤ ì—”íŠ¸ë¡œí”¼ ë¹„ìš© í•¨ìˆ˜ë¥¼ ìµœì†Œí™”í•˜ëŠ” ê²ƒì€ íƒ€ê¹ƒ í´ë˜ìŠ¤ì— ëŒ€í•´ ë‚®ì€ í™•ë¥ ì„ ì˜ˆì¸¡í•˜ëŠ” ëª¨ë¸ì„ ì–µì œí•˜ë¯€ë¡œ ì´ ëª©ì ì— ë¶€í•©í•¨

  - **í¬ë¡œìŠ¤ ì—”íŠ¸ë¡œí”¼** : ì¶”ì •ëœ í´ë˜ìŠ¤ì˜ í™•ë¥ ì´ íƒ€ê¹ƒ í´ë˜ìŠ¤ì— ì–¼ë§ˆë‚˜ ì˜ ë§ëŠ”ì§€ ì¸¡ì •í•˜ëŠ” ìš©ë„ë¡œ ì‚¬ìš©

  - í¬ë¡œìŠ¤ ì—”íŠ¸ë¡œí”¼ ë¹„ìš© í•¨ìˆ˜

    ![image-20220930134338732](/images/2022-09-27-hands_on_4/image-20220930134338732.png)

    - ì´ ì‹ì—ì„œëŠ” ![image-20220930134606131](/images/2022-09-27-hands_on_4/image-20220930134606131.png)ëŠ” ië²ˆì§¸ ìƒ˜í”Œì´ í´ë˜ìŠ¤ kì— ì†í•  íƒ€ê¹ƒ í™•ë¥ ì„ ì˜ë¯¸, ì¼ë°˜ì ìœ¼ë¡œ ìƒ˜í”Œì´ í´ë˜ìŠ¤ì— ì†í•˜ëŠ”ì§€ ì•„ë‹Œì§€ì— ë”°ë¼ 1, 0 ìœ¼ë¡œ íŒë‹¨
    - ë‘ ê°œì˜ í´ë˜ìŠ¤ë§Œì´ ì¡´ì¬í• ë•ŒëŠ” ë¹„ìš©í•¨ìˆ˜ëŠ” ë¡œì§€ìŠ¤í‹± íšŒê·€ì˜ ë¹„ìš© í•¨ìˆ˜ì™€ ê°™ìŒ

  - í´ë˜ìŠ¤ kì— ëŒ€í•œ í¬ë¡œìŠ¤ ì—”íŠ¸ë¡œí”¼ì˜ ê·¸ë ˆì´ë””ì–¸íŠ¸ ë²¡í„°

    ![image-20220930134851240](/images/2022-09-27-hands_on_4/image-20220930134851240.png)

    - ë¹„ìš©í•¨ìˆ˜ ![image-20220930134907416](/images/2022-09-27-hands_on_4/image-20220930134907416.png)ì— ëŒ€í•œ ê·¸ë ˆì´ë””ì–¸íŠ¸ ë²¡í„°ì˜ ê³µì‹ì„



> ê° í´ë˜ìŠ¤ì— ëŒ€í•œ ê·¸ë ˆì´ë””ì–¸íŠ¸ ë²¡í„°ë¥¼ ê³„ì‚°í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë¹„ìš© í•¨ìˆ˜ë¥¼ ìµœì†Œí™”í•˜ê¸° ìœ„í•œ íŒŒë¼ë¯¸í„° í–‰ë ¬ ![image-20220930132154126](/images/2022-09-27-hands_on_4/image-20220930132154126.png)ë¥¼ ì°¾ê¸° ìœ„í•´ ê²½ì‚¬í•˜ê°•ë²•ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ



&nbsp;

**ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ë¥¼ í†µí•œ 3 class ë¶„ë¥˜**

- sklearn Logistic Regressionì€ í´ë˜ìŠ¤ ë‘˜ ì´ìƒì¼ë•Œ ê¸°ë³¸ì ìœ¼ë¡œ OvA ì „ëŸ‰ì„ ì‚¬ìš©
- multi_class ë§¤ê°œë³€ìˆ˜ë¥¼ "multinomial"ë¡œ ë°”ê¾¸ë©´ ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ë¥¼ ì‚¬ìš© ê°€ëŠ¥, ì†Œí”„íŠ¸ ë§¥ìŠ¤ íšŒê·€ ì‚¬ìš©ì‹œ solver ë§¤ê°œë³€ìˆ˜ì— "lbfgs"ì™€ ê°™ì€ ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ë¥¼ ì§€ì›í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ì„ ì§€ì •
- Cë¥¼ í†µí•´ l2 ê·œì œ ì¡°ì ˆ

```python
X = iris["data"][:, (2, 3)]  # ê½ƒì ê¸¸ì´, ê½ƒì ë„ˆë¹„
y = iris["target"]

softmax_reg = LogisticRegression(multi_class="multinomial",solver="lbfgs", C=10, random_state=42)
softmax_reg.fit(X, y)
```

![image-20220930142225118](/images/2022-09-27-hands_on_4/image-20220930142225118.png)

- ê²°ì •ê²½ê³„ê°€ ë§ë‚˜ëŠ” ì§€ì ì€ ëª¨ë‘ 33% ì¶”ì •í™•ë¥ ì„ ê°€ì§



&nbsp;

## ì—°ìŠµë¬¸ì œ

###  1. ìˆ˜ë°±ë§Œ ê°œì˜ íŠ¹ì„±ì„ ê°€ì§„ í›ˆë ¨ ì„¸íŠ¸ì—ì„œëŠ” ì–´ë–¤ ì„ í˜• íšŒê·€ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•  ìˆ˜ ìˆì„ê¹Œìš”?

> ë³´í†µì€ í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•(SGD), ë¯¸ë‹ˆë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²•ì„ ì‚¬ìš©í•œë‹¤. í›ˆë ¨ ì„¸íŠ¸ì˜ í¬ê¸°ê°€ ë©”ëª¨ë¦¬ì— ë§ë‹¤ë©´ ë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²•ë„ ê°€ëŠ¥í•˜ë‹¤. í•˜ì§€ë§Œ ì •ê·œë°©ì •ì‹ì€ ê³„ì‚° ë³µì¡ë„ê°€ "íŠ¹ì„±ì˜ ê°¯ìˆ˜"ì— ë”°ë¼ ë§¤ìš° ë¹ ë¥´ê²Œ ì¦ê°€í•˜ê¸°ì— ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.
>
> ```
> í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•(SGD) O, ë¯¸ë‹ˆë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²• O, ë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²• O ,ì •ê·œë°©ì •ì‹ X
> ```

&nbsp;

### 2. í›ˆë ¨ ì„¸íŠ¸ì— ìˆëŠ” íŠ¹ì„±ë“¤ì´ ê°ê¸° ë‹¤ë¥¸ ìŠ¤ì¼€ì¼ì„ ê°–ê³  ìˆë‹¤. ì´ëŸ° ë°ì´í„°ì— ì˜ ì‘ë™í•˜ì§€ ì•ŠëŠ” ì•Œê³ ë¦¬ì¦˜ì€ ë¬´ì—‡ì¼ê¹Œìš”? ê·¸ ì´ìœ ëŠ” ë¬´ì—‡ì¼ê¹Œìš”? ì´ ë¬¸ì œë¥¼ ì–´ë–»ê²Œ í•´ê²°í•  ìˆ˜ ìˆì„ê¹Œìš”?

> ê²½ì‚¬í•˜ê°•ë²•(GD) ëŠ” íŠ¹ì„±ì˜ ìŠ¤ì¼€ì¼ì´ ë§¤ìš° ë‹¤ë¥´ë©´ ìˆ˜ë ´í•˜ëŠ”ë° ì˜¤ëœ ì‹œê°„ì´ ì†Œìš” <- scale ì ìš©í•´ì„œ í•´ê²°
>
> ì •ê·œë°©ì •ì‹, SVDëŠ” ìŠ¤ì¼€ì¼ ì¡°ì • ì—†ì´ë„ ì˜ ì‘ë™
>
> ê·œì œê°€ ìˆëŠ” ëª¨ë¸ì€ íŠ¹ì„±ì˜ ìŠ¤ì¼€ì¼ì´ ë‹¤ë¥´ë©´ ì§€ì—­ ìµœì ì  ìˆ˜ë ´, ê·œì œëŠ” ê°€ì¤‘ì¹˜ê°€ ì»¤ì§€ì§€ ëª»í•˜ê²Œ ì œì•½ì„ ê°€í•˜ë¯€ë¡œ íŠ¹ì„±ê°’ì´ ì‘ìœ¼ë©´ í° ê°’ì˜ íŠ¹ì„±ì— ì˜í•´ ë¬´ì‹œë¨

&nbsp;

### 3. ê²½ì‚¬ í•˜ê°•ë²•ìœ¼ë¡œ ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ì„ í›ˆë ¨ì‹œí‚¬ ë•Œ ì§€ì—­ ìµœì†Ÿê°’ì— ê°‡í ê°€ëŠ¥ì„±ì´ ìˆì„ê¹Œìš”?

> ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ì˜ ë¹„ìš©í•¨ìˆ˜ëŠ” ë³¼ë¡í•¨ìˆ˜, ê²½ì‚¬ í•˜ê°•ë²•ì´ í›ˆë ¨ë  ë•Œ ì§€ì—­ ìµœì†Ÿê°’ì— ê°‡í ê°€ëŠ¥ì„± ì—†ìŒ



&nbsp;

### 4. ì¶©ë¶„íˆ ì˜¤ë«ë™ì•ˆ ì‹¤í–‰í•˜ë©´ ëª¨ë“  ê²½ì‚¬ í•˜ê°•ë²• ì•Œê³ ë¦¬ì¦˜ì´ ê°™ì€ ëª¨ë¸ì„ ë§Œë“¤ì–´ë‚¼ê¹Œìš”?

> ìµœì í™”í•  í•¨ìˆ˜ê°€ ë³¼ë¡ í•¨ìˆ˜ì´ê³  í•™ìŠµë¥ ì´ ë„ˆë¬´ í¬ì§€ ì•Šìœ¼ë©´ ëª¨ë“  ê²½ì‚¬í•˜ê°•ë²•ì´ ìµœì ì ì— ë„ë‹¬
>
> í•˜ì§€ë§Œ í•™ìŠµë¥ ì„ ê°ì†Œì‹œí‚¤ì§€ ì•Šìœ¼ë©´ SGD, ë¯¸ë‹ˆë°°ì¹˜ GDëŠ” ìµœì ì ì— ë„ë‹¬í•˜ì§€ ëª»í•¨

&nbsp;

### 5. ë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²•ì„ ì‚¬ìš©í•˜ê³  ì—í”„í¬ë§ˆë‹¤ ê²€ì¦ ì˜¤ì°¨ë¥¼ ê·¸ë˜í”„ë¡œ ë‚˜íƒ€ë‚´ë´¤ìŠµë‹ˆë‹¤. ê²€ì¦ ì˜¤ì°¨ê°€ ì¼ì •í•˜ê²Œ ìƒìŠ¹ë˜ê³  ìˆë‹¤ë©´ ì–´ë–¤ ì¼ì´ ì¼ì–´ë‚˜ê³  ìˆëŠ” ê±¸ê¹Œìš”? ì´ ë¬¸ì œë¥¼ ì–´ë–»ê²Œ í•´ê²°í•  ìˆ˜ ìˆë‚˜ìš”?

> epoch ë§ˆë‹¤ ê²€ì¦ ì—ëŸ¬ê°€ ì§€ì†ì ìœ¼ë¡œ ìƒìŠ¹í•œë‹¤ë©´ í•™ìŠµë¥ ì´ ë„ˆë¬´ ë†’ê³  ì•Œê³ ë¦¬ì¦˜ ë°œì‚°í•˜ëŠ” ê²ƒ
>
> í›ˆë ¨ ì—ëŸ¬ë„ ì˜¬ë¼ê°„ë‹¤ë©´ í•™ìŠµë¥ ì„ ë‚´ë ¤ì•¼í•¨
>
> ë§Œì•½ í›ˆë ¨ ì—ëŸ¬ê°€ ì˜¬ë¼ê°€ì§€ ì•ŠëŠ”ë‹¤ë©´ ëª¨ë¸ì´ í›ˆë ¨ ì„¸íŠ¸ì— ê³¼ëŒ€ì í•© ë˜ì–´ ìˆëŠ” ê²ƒìœ¼ë¡œ í›ˆë ¨ ì •ì§€

&nbsp;



### 6. ê²€ì¦ ì˜¤ì°¨ê°€ ìƒìŠ¹í•˜ë©´ ë¯¸ë‹ˆë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²•ì„ ì¦‰ì‹œ ì¤‘ë‹¨í•˜ëŠ” ê²ƒì´ ì¢‹ì€ ë°©ë²•ì¸ê°€ìš”?

> SGD ë‚˜ ë¯¸ë‹ˆë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²•ì€ ë§¤ í›ˆë ¨ ë°˜ë³µë§ˆë‹¤ í•™ìŠµì˜ ì§„ì •ì„ ë³´ì¥í•˜ê¸° ì–´ë ¤ì›€ 
>
> ê²€ì¦ì—ëŸ¬ ì˜¬ë¼ê°ˆë•Œ ë°”ë¡œ ì •ì§€í•œë‹¤ë©´ ìµœì ì  ê·¼ì²˜ì— ê°€ì§€ ëª»í• ìˆ˜ë„ ìˆìŒ
>
> ì¡°ê¸°ì¢…ë£Œì— ëª¨ë¸ì˜ ê²°ê³¼ë¥¼ ê³„ì†ì €ì¥í•˜ê³  ì¼ì •ì‹œê°„ì„ ë„˜ì„ë•Œ ì €ì¥ëœ ëª¨ë¸ì¤‘ ìµœê³ ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë°©ë²•ì´ ê°€ì¥ ì¢‹ìŒ

&nbsp;

###  7. ì–´ë–¤ ê²½ì‚¬ í•˜ê°•ë²• ì•Œê³ ë¦¬ì¦˜ì´ ê°€ì¥ ë¹ ë¥´ê²Œ ìµœì  ì†”ë£¨ì…˜ì˜ ì£¼ë³€ì— ë„ë‹¬í• ê¹Œìš”? ì‹¤ì œë¡œ ìˆ˜ë ´í•˜ëŠ” ê²ƒì€ ì–´ë–¤ ê²ƒ ì¸ê°€ìš”? ë‹¤ë¥¸ ë°©ë²•ë“¤ë„ ìˆ˜ë ´í•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆë‚˜ìš”?

> SGD > ë¯¸ë‹ˆë°°ì¹˜ GD
>
> SGDëŠ” í•œ ë²ˆì— í•˜ë‚˜ì˜ í›ˆë ¨ ìƒ˜í”Œë§Œ ì‚¬ìš©í•´ í›ˆë ¨ ë°˜ë³µì´ ê°€ì¥ ë¹ ë¦„ ê·¸ë˜ì„œ ê°€ì¥ ë¨¼ì € ì „ì—­ ìµœì ì  ê·¼ì²˜ì— ë„ë‹¬ (ê·¸ë‹¤ìŒì€ ë¯¸ë‹ˆë°°ì¹˜ GD)
>
> í›ˆë ¨ì‹œê°„ì´ ì¶©ë¶„í•˜ë©´ ë°°ì¹˜ ê²½ì‚¬ í•˜ê°•ë²•ìœ¼ë¡œ ì‹¤ì œ ìˆ˜ë ´ê°€ëŠ¥
>
> í•˜ì§€ë§Œ SGD, ë¯¸ë‹ˆë°°ì¹˜ GDëŠ” ì ì§„ì ìœ¼ë¡œ ê°ì†Œ ì‹œí‚¤ì§€ ì•Šìœ¼ë©´ ìµœì ì  ì£¼ë³€ì—ë§Œ ìˆ˜ë ´

&nbsp;

### 8. ë‹¤í•­ íšŒê·€ë¥¼ ì‚¬ìš©í–ˆì„ ë•Œ í•™ìŠµ ê³¡ì„ ì„ ë³´ë‹ˆ í›ˆë ¨ ì˜¤ì°¨ì™€ ê²€ì¦ ì˜¤ì°¨ ì‚¬ì´ì— ê°„ê²©ì´ í½ë‹ˆë‹¤. ë¬´ìŠ¨ ì¼ì´ ìƒê¸´ ê±¸ê¹Œìš”? ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ì„¸ ê°€ì§€ ë°©ë²•ì€ ë¬´ì—‡ì¸ê°€ìš”?

> ê²€ì¦ì˜¤ì°¨ê°€ í›ˆë ¨ ì˜¤ì°¨ë³´ë‹¤ í›¨ì”¬ ë” ë†’ìœ¼ë©´ í›ˆë ¨ ì„¸íŠ¸ì— ê³¼ëŒ€ì í•© ê°€ëŠ¥ì„± ë†’ìŒ
>
> - ë‹¤í•­ ì°¨ìˆ˜ë¥¼ ë‚®ì¶”ëŠ” ë°©ë²• (ììœ ë„ ì¤„ì–´ë“¦)
> - ëª¨ë¸ ê·œì œí•˜ëŠ” ë°©ë²• (ììœ ë„ ì¤„ì–´ë“¦)
> - í›ˆë ¨ ì„¸íŠ¸ì˜ í¬ê¸°ë¥¼ ì¦ê°€

&nbsp;

###  9. ë¦¿ì§€ íšŒê·€ë¥¼ ì‚¬ìš©í–ˆì„ ë•Œ í›ˆë ¨ ì˜¤ì°¨ì™€ ê²€ì¦ ì˜¤ì°¨ê°€ ê±°ì˜ ë¹„ìŠ·í•˜ê³  ë‘˜ ë‹¤ ë†’ì•˜ìŠµë‹ˆë‹¤. ì´ ëª¨ë¸ì—ëŠ” ë†’ì€ í¸í–¥ì´ ë¬¸ì œì¸ê°€ìš”, ì•„ë‹ˆë©´ ë†’ì€ ë¶„ì‚°ì´ ë¬¸ì œì¸ê°€ìš”? ê·œì œ í•˜ì´í¼íŒŒë¼ë¯¸í„° Î±ë¥¼ ì¦ê°€ì‹œì¼œì•¼ í• ê¹Œìš”, ì•„ë‹ˆë©´ ì¤„ì—¬ì•¼ í• ê¹Œìš”?

> í›ˆë ¨ ì—ëŸ¬ì™€ ê²€ì¦ ì—ëŸ¬ê°€ ê±°ì˜ ë¹„ìŠ·í•˜ê³  ë§¤ìš° ë†’ë‹¤ë©´ í›ˆë ¨ ì„¸íŠ¸ì— ê³¼ì†Œì í•© ê°€ëŠ¥ì„±ì´ í¼
>
> ë†’ì€ í¸í–¥ì„ ê°€ì§„ ëª¨ë¸ë¡œ íŒë‹¨ë¨, Î±ë¥¼ ì¤„ì—¬ì•¼ í•¨

&nbsp;

### 10. ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ì´ìœ ëŠ”?

- **í‰ë²”í•œ ì„ í˜• íšŒê·€ (ì•„ë¬´ëŸ° ê·œì œê°€ ì—†ìŒ) ëŒ€ì‹  ë¦¿ì§€ íšŒê·€**

  > ê·œì œê°€ ìˆëŠ” ëª¨ë¸ì´ ì—†ëŠ” ëª¨ë¸ë³´ë‹¤ ì¼ë°˜ì ìœ¼ë¡œ ì„±ëŠ¥ì´ ì¢‹ìŒ ê·¸ë˜ì„œ ì„ í˜•ëª¨ë¸ë³´ë‹¤ ë¦¿ì§€ë¥¼ ì‚¬ìš©

- **ë¦¿ì§€ íšŒê·€ ëŒ€ì‹  ë¼ì˜ íšŒê·€**

  > ë¼ì˜ëŠ” l1 ê·œì œë¥¼ ì‚¬ìš©í•´ ê°€ì¤‘ì¹˜ë¥¼ ì™„ì „íˆ 0ìœ¼ë¡œ ë§Œë“œëŠ” ê²½í–¥ì´ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” í¬ì†Œí•œ ëª¨ë¸ì„ ë§Œë“œëŠ” ìœ„í—˜ì´ ìˆìŒ ë˜í•œ ìë™ìœ¼ë¡œ íŠ¹ì„± ì„ íƒì˜ íš¨ê³¼ë¥¼ ê°€ì§€ë¯€ë¡œ ë‹¨ì§€ ëª‡ ê°œì˜ íŠ¹ì„±ë§Œ ì‹¤ì œ ìœ ìš©í•˜ë‹¤ê³  íŒë‹¨ë ë•Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ìŒ ì•„ë‹ˆë¼ë©´ ë¦¿ì§€

- **ë¼ì˜ íšŒê·€ ëŒ€ì‹  ì—˜ë¼ìŠ¤í‹±ë„·**

  > ë¼ì˜ê°€ ëª‡ ê°œì˜ íŠ¹ì„±ì´ ê°•í•˜ê²Œ ì—°ê´€ë˜ì–´ ìˆê±°ë‚˜ í›ˆë ¨ ìƒ˜í”Œë³´ë‹¤ íŠ¹ì„±ì´ ë” ë§ì„ ë•Œì—ëŠ” ë¶ˆê·œì¹™ì ì¸ í–‰ë™ì„ í•¨ìœ¼ë¡œ ì—˜ë¼ìŠ¤í‹±ë„·ì´ ë¼ì˜ë³´ë‹¤ ì¼ë°˜ì ìœ¼ë¡œ ì„ í˜¸, ê·¸ëŸ¬ë‚˜ ì¶”ê°€ì ì¸ í•˜ì´í¼íŒŒë¼ë¯¸í„°ê°€ ìƒê¹€, ë¶ˆê·œì¹™ì ì¸ í–‰ë™ì´ ì—†ëŠ” ë¼ì˜ë¥¼ ì›í•˜ë©´ ì—˜ë¼ìŠ¤í‹± ë„·ì— l1_ratioë¥¼ 1ì— ê°€ê¹ê²Œ ì„¤ì •

&nbsp;

### 11. ì‚¬ì§„ì„ ë‚®ê³¼ ë°¤, ì‹¤ë‚´ì™€ ì‹¤ì™¸ë¡œ ë¶„ë¥˜í•˜ë ¤ í•œë‹¤. ë‘ ê°œì˜ ë¡œì§€ìŠ¤í‹± íšŒê·€ ë¶„ë¥˜ê¸°ë¥¼ ë§Œë“¤ì–´ì•¼ í• ê¹Œ, ì•„ë‹ˆë©´ í•˜ë‚˜ì˜ ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ ë¶„ë¥˜ê¸°ë¥¼ ë§Œë“¤ì–´ì•¼ í• ê¹Œ?

> ì‹¤ì™¸ì™€ ì‹¤ë‚´, ë‚®ê³¼ ë°¤ì€ ë°°íƒ€ì ì¸ í´ë˜ìŠ¤ê°€ ì•„ë‹ˆë¯€ë¡œ (4ê°œ class ì¡°í•©ì´ ê°€ëŠ¥) 
>
> ë‘ ê°œì˜ ë¡œì§€ìŠ¤í‹± íšŒê·€ ë¶„ë¥˜ê¸°ê°€ ì ì ˆí•¨

&nbsp;

