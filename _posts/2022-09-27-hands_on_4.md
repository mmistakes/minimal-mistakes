---
layout: single
title:  "ν•Έμ¦μ¨ λ¨Έμ‹ λ¬λ‹ - 4(μ§„ν–‰μ¤‘)"
categories : scikit-learn
tag : [scikit-learn, machine-learning, python]
toc: true
toc_sticky: true
---

![header](https://capsule-render.vercel.app/api?type=waving&color=a2dcec&height=300&section=header&text=ν•Έμ¦μ¨ λ¨Έμ‹ λ¬λ‹ - 4&fontSize=40&animation=fadeIn&fontAlignY=38&fontColor=FFFFFF)

- μ°Έκ³  : [ν•Έμ¦μ¨ λ¨Έμ‹ λ¬λ‹ 2ν](http://www.kyobobook.co.kr/product/detailViewKor.laf?mallGb=KOR&ejkGb=KOR&barcode=9791162242964)

------------------------------------------------------

&nbsp;



## λ¨λΈ ν›λ ¨

- μ§μ ‘ κ³„μ‚°ν•  μ μλ” κ³µμ‹μ„ μ‚¬μ©ν•μ—¬ ν›λ ¨ μ„ΈνΈμ— κ°€μ¥ μ λ§λ” λ¨λΈ νλΌλ―Έν„°λ¥Ό ν•΄μ„μ μΌλ΅ κµ¬ν•¨
- κ²½μ‚¬ ν•κ°•λ²•(GD)λΌκ³  λ¶λ¦¬λ” λ°λ³µμ μΈ μµμ ν™” λ°©μ‹μ„ μ‚¬μ©ν•μ—¬ λ¨λΈ νλΌλ―Έν„°λ¥Ό μ΅°κΈμ”© λ°”κΎΈλ©΄μ„ λΉ„μ© ν•¨μλ¥Ό ν›λ ¨ μ„ΈνΈμ— λ€ν•΄ μµμ†ν™” μ‹ν‚΄

&nbsp;

## μ„ ν• νκ·€

- ![image-20220927163018049](/images/2022-09-27-hands_on_4/image-20220927163018049.png)

- μ„ ν•μ΄μ§€λ§ νΉμ„±μ΄ λ§μ•„μ§€λ©΄ κ³ μ°¨μ›μ΄ λ¨

- νλΌλ―Έν„° κΈ°μ¤€μ€ MSE μµμ† ν•λ” νλΌλ―Έν„° μ„ μ •

  ![image-20220927163142878](/images/2022-09-27-hands_on_4/image-20220927163142878.png)

> μ…λ ¥ νΉμ„±μ κ°€μ¤‘μΉ ν•© + νΈν–¥(μ νΈ, x0) μ΄λΌλ” μƒμλ¥Ό λ”ν•΄ μμΈ΅μ„ μƒμ„±

&nbsp;

## μ •κ·λ°©μ •μ‹

- κ³µμ‹

β€‹	![image-20220927163532147](/images/2022-09-27-hands_on_4/image-20220927163532147.png)

- λΉ„μ©ν•¨μλ¥Ό μµμ†ν• ν•λ” π½ κ°’μ„ μ°ΎκΈ°μ„ν• ν•΄μ„μ  λ°©λ²•

**μ •κ· λ°©μ •μ‹ μμ‹**

```python
import numpy as np

X = 2 * np.random.rand(100, 1)
y = 4 + 3 * X + np.random.randn(100, 1)

plt.plot(X, y, "b.")
plt.xlabel("$x_1$", fontsize=18)
plt.ylabel("$y$", rotation=0, fontsize=18)
plt.axis([0, 2, 0, 15])
plt.show()


X_b = np.c_[np.ones((100, 1)), X]  # λ¨λ“  μƒν”μ— x0 = 1μ„ μ¶”κ°€ν•©λ‹λ‹¤. (X0 = 1)
theta_best = np.linalg.inv(X_b.T.dot(X_b)).dot(X_b.T).dot(y) # np.linalg.invλ΅ μ—­ν–‰λ ¬ κ³„μ‚°
>> array([[4.21509616],
          [2.77011339]])

# κµ¬ν• theta_bestλ¥Ό ν†µν•΄μ„ μμΈ΅ μν–‰

X_new = np.array([[0], [2]])
X_new_b = np.c_[np.ones((2, 1)), X_new]  # λ¨λ“  μƒν”μ— x0 = 1μ„ μ¶”κ°€ν•©λ‹λ‹¤.
y_predict = X_new_b.dot(theta_best)
y_predict
>> array([[4.21509616],
          [9.75532293]])
```

- κ²°κ³Ό μ‹κ°ν™”

```python
plt.plot(X_new, y_predict, "r-")
plt.plot(X, y, "b.")
plt.axis([0, 2, 0, 15])
plt.show()
```

![image-20220927164423415](/images/2022-09-27-hands_on_4/image-20220927164423415.png)

&nbsp;



## sklearn μ„ ν• νκ·€

- `κ°€μ¤‘μΉ(coef)` , `νΈν–¥(intercept)` νΈμ¶ κ°€λ¥
- `LinearRegression` ν΄λμ¤λ” `scipy.linalg.lstsq()` ν•¨μ(μµμ† μ κ³±)μ„ μ‚¬μ©

```python
from sklearn.linear_model import LinearRegression

lin_reg = LinearRegression()
lin_reg.fit(X, y)
lin_reg.intercept_, lin_reg.coef_
>> (array([4.21509616]), array([[2.77011339]]))

lin_reg.predict(X_new)
>> array([[4.21509616],
       	  [9.75532293]])


# scipy.linalg.lstsq() or np.linalg.lstsq() λ΅ ν‘ν„ν•λ©΄
theta_best_svd, residuals, rank, s = np.linalg.lstsq(X_b, y, rcond=1e-6)
theta_best_svd
>> array([[4.21509616],
       	  [2.77011339]])


```

- μ΄λ• `np.linalg.lstsq()` ν•¨μλ”  μ μ‚¬ μ—­ν–‰λ ¬μ„ κ³„μ‚°ν•¨

  - `np.linalg.pinv()`μ„ μ‚¬μ©ν•΄μ„ μ μ‚¬ μ—­ν–‰λ ¬μ„ μ§μ ‘ κ³„μ‚° κ°€λ¥
  - `μ μ‚¬ μ—­ν–‰λ ¬`μ€ μ—­ν–‰λ ¬μ„ κ³„μ‚°ν• μ μ—†μ„λ• μ—­ν–‰λ ¬κ³Ό μ μ‚¬ν• ν–‰λ ¬μ„ κ³„μ‚°
  - ![image-20220927191720050](/images/2022-09-27-hands_on_4/image-20220927191720050.png)

```python
# μ μ‚¬ μ—­ν–‰λ ¬ κµ¬ν•λ” λ°©λ²•
np.linalg.pinv(X_b).dot(y)
>> array([[4.21509616],
          [2.77011339]])
```

- μ μ‚¬μ—­ν–‰λ ¬ μμ²΄λ” `νΉμ΄κ°’ λ¶„ν•΄(SVD)`λΌ λ¶€λ¥΄λ” ν‘μ¤€ ν–‰λ ¬ λ¶„ν•΄ κΈ°λ²•μ„ μ‚¬μ©ν•΄ κ³„μ‚°
- ![image-20220927191654670](/images/2022-09-27-hands_on_4/image-20220927191654670.png)
- ![image-20220927191707760](/images/2022-09-27-hands_on_4/image-20220927191707760.png)
- νΉμ„±μ΄ μ¤‘λ³µλμ–΄ μ—­ν–‰λ ¬μ΄ μ—†μ„λ• μ •κ·λ°©μ •μ‹μ΄ μ‘λ™ν•μ§€ μ•μ§€λ§ `μ μ‚¬μ—­ν–‰λ ¬` μ€ ν•­μƒ μ΅΄μ¬

&nbsp;

