---
layout: single
title: "[TDD] TDD κ°λ… μ •λ¦¬"
date: "2022-01-01 16:00:05"
categories: TDD
tag: [TDD, Junit, Test]
toc: true
author_profile: true
sidebar:
  nav: "docs"
---

## β” μ„λ΅ 

> `TDD`λ” λ°©λ€ν• μ–‘μ„ κ°€μ§€κ³  μκΈ° λ•λ¬Έμ— μ•„λ μ„¤λ…λ§μΌλ΅λ” λ¶€μ΅±ν• κ°μ΄ μλ‹¤  
> μ΄λ² μ¥μ—μ„λ” μ „μ²΄μ μΈ TDDμ νλ¦„κ³Ό JUnit 5 μ‚¬μ© λ°©λ²•μ— λ€ν• λ¶€λ¶„μ„ κ°„λµν μ •λ¦¬ν•λ‹¤

## [TDDκ°€ μ™ ν•„μ”ν•κ°€?](https://brunch.co.kr/@freeism/19)

**TDDμ ν•„μ”μ„±μ€ λ‹¤λ¥Έ λ¶„κ»μ„ μ •λ¦¬λ¥Ό ν•΄λ‘μ‹  λ‚΄μ©μ„ λ°μ· ν•μ—¬ μ‘μ„±ν–μµλ‹λ‹¤**

- π’£ **μ‹¤ν¨ν•λ” ν…μ¤νΈ**λ¥Ό λ§λ“¤κ³ , κ·Έ **ν…μ¤νΈκ°€ ν†µκ³Ό**ν•λ” μ ν’μ„ λ§λ“¤λ©΄ κ²°κµ­μ€ μ›ν•λ” κΈ°λ¥μ΄ λ™μ‘ν•κ² λλ” κ°λ° λ°©λ²•λ΅ 
- π‘ κ°λ°μκ°€ μλ„ν•λ€λ΅ λ΅μ§μ΄ λ™μ‘ν•λ”μ§€ λ…ν™•ν•κ² μ• μ μκ³ , **λ΅μ§μ— λ€ν•΄ λ³΄μ¦**ν•  μ μλ‹¤
- π›΅ μ‚¬μ „μ— λ‹¤μ–‘ν• μΌ€μ΄μ¤λ¥Ό κ³ λ ¤ν•΄λ΄„μΌλ΅μ¨ λ¬Έμ κ°€ λ  μ μλ” μ μ¬μ  μ¤λ¥λ“¤μ„ λ°©μ–΄ν•  μ μλ‹¤
- π¤­ μ•„ν‚¤ν…μ² λ° λ΅μ§μ΄ κΉ”λ”ν•΄μ§„λ‹¤, **ν…μ¤νΈκ°€ μ–΄λ ¤μ΄ μ½”λ“λ” μΆ‹μ€ μ½”λ“κ°€ μ•„λ‹λ‹¤**
- π‘€ λ‹¤λ¥Έ μ‚¬λμ΄ λ΅μ§μ„ μμ •ν• κ²½μ° λ΅μ§μ λ³€κ²½μ— λ€ν• μν–¥λ„(Side-Effect)κ°€ λ…ν™•ν•κ² λ³΄μΈλ‹¤

## TDD (Test-Driven-Development)

> μ”κµ¬μ‚¬ν•­ μ •μ > λ„λ©”μΈ νμ•… λ° κµ¬μ΅° μ„¤κ³„ > .. μμΌλ΅ κ°€λ” κ²ƒ κ°™λ‹¤

- `ν…μ¤νΈ μ£Όλ„ κ°λ°`μ΄λΌλ” μλ―Έ
- λ‹¨μν•κ² ν‘ν„ν•μλ©΄ `ν…μ¤νΈ μ½”λ“λ¥Ό λ¨Όμ € μ„¤κ³„ λ° κµ¬μ¶• ν›„` ν…μ¤νΈλ¥Ό ν†µκ³Όν•  μ μ‡λ” μ½”λ“λ¥Ό μ§λ” κ²ƒ
- μ½”λ“ μ‘μ„± ν›„ ν…μ¤νΈλ¥Ό μ§„ν–‰ν•λ” μ§€κΈκΉμ§€ μ‚¬μ© λ μΌλ°μ μΈ λ°©μ‹κ³Ό λ‹¤μ† μ°¨μ΄κ°€ μλ‹¤

### μ• μμΌ κ°λ° λ°©μ‹ μ¤‘ ν•λ‚

> μ• μμΌ λ°©λ²•λ΅ μ€ μ¶”ν›„ λ”°λ΅ ν¬μ¤ν…μ„ ν•  μμ •μ΄λ‹¤

- μ½”λ“ μ„¤κ³„μ‹ μ›ν•λ” `λ‹¨κ³„μ  λ©ν‘`λ¥Ό μ„¤μ •ν•μ—¬ μ§„ν–‰ν•κ³ μ ν•λ” κ²ƒμ— λ€ν• `κ²°μ • λ°©ν–¥μ κ°­`μ„ μ¤„μ΄κ³ μ ν•¨
- μµμ΄ λ©ν‘μ— λ§μ¶ ν…μ¤νΈλ¥Ό κµ¬μ¶•ν•μ—¬ κ·Έμ— λ§κ² μ½”λ“λ¥Ό μ„¤κ³„ν•κΈ° λ•λ¬Έμ— λ³΄λ‹¤ μ μ€ μκ²¬ μ¶©λμ„ κΈ°λ€ν•  μ μμ

## ν…μ¤νΈ μ½”λ“μ μ‘μ„± λ©μ 

- `μ½”λ“μ μ•μ •μ„±`μ„ λ†’μΌ μ μλ‹¤
- κΈ°λ¥ `μ¶”κ°€` λ° `λ³€κ²½` μ¤‘ μΌμ–΄λ‚λ” `Side-Effect` λ―Έμ—°μ— λ°©μ§€
- ν•΄λ‹Ή μ½”λ“κ°€ μ‘μ„±λ λ©μ μ„ λ…ν™•ν•κ² ν‘ν„ν•  μ μλ‹¤
  - μ½”λ“μ— λ¶ν•„μ”ν• λ‚΄μ©μ΄ λ“¤μ–΄κ°€λ” κ²ƒμ„ λΉ„κµμ  μ¤„μΌ μ μλ‹¤

## JUnit?

### Java μ§„μμ λ€ν‘μ μΈ Test Framework

- λ‹¨μ„ ν…μ¤νΈ(JUnit Test)λ¥Ό μ„ν• λ„κµ¬λ¥Ό μ κ³µ
  - λ‹¨μ„ ν…μ¤νΈλ€?
    - μ½”λ“μ νΉμ • λ¨λ“μ΄ μλ„λ λ€λ΅ λ™μ‘ν•λ”μ§€ ν…μ¤νΈ ν•λ” μ μ°¨
    - λ¨λ“  ν•¨μμ™€ λ©”μ„λ“μ— λ€ν• κ°κ°μ `ν…μ¤νΈ μΌ€μ΄μ¤`(Test Case)λ¥Ό μ‘μ„±ν•λ” κ²ƒ
  - μ–΄λ…Έν…μ΄μ…(Annotation)μ„ κΈ°λ°μΌλ΅ ν…μ¤νΈλ¥Ό μ§€μ›
  - λ‹¨μ •λ¬Έ(Assert)μΌλ΅ ν…μ¤νΈ μΌ€μ΄μ¤μ κΈ°λ€κ°’μ— λ€ν•΄ μν–‰ κ²°κ³Όλ¥Ό ν™•μΈν•  μ μμ
  - Spring Boot 2.2λ²„μ „λ¶€ν„° JUnit 5 λ²„μ „ μ‚¬μ©
  - `JUnit 5`λ” ν¬κ² `Platform`, `Jupiter`, `Vintage`(JUnit 4 νΈν™) λ¨λ“λ΅ κµ¬μ„±

## JUnit Module?

<img width="620" alt="junit5" src="https://user-images.githubusercontent.com/53969142/145025982-33005e67-1652-4f18-80f9-deb7483dc6cc.png">

> μ¶μ²: https://medium.com/techwasti/junit5-tutorial-part-1-24471afdd68f

### JUnit5

> JUnit5 μ—μ„λ” μλ°” λ©”μΈ λ©”μ„λ“ μ—†μ΄λ„ JUnit Platform μ—μ„ ν…μ¤νΈ μ½”λ“λ¥Ό μ‹¤ν–‰ν•μ—¬  
> @Test μ–΄λ…Έν…μ΄μ…μ΄ μ„ μ–Έλ ν…μ¤νΈ μ½”λ“λ¥Ό μ‹¤ν–‰μ‹ν‚¬ μ μλ‹¤

- JUnit5 : `λ¨λ“ν™”` λμ–΄ μλ” κµ¬μ΅°.
- λ¨λ“ν™” κµ¬μ΅° : `JUnit Platform`μ„ κΈ°λ°μΌλ΅ μ„μ— κµ¬ν„μ²΄μΈ `Jupiter`μ™€ `Vintage` λ¨λ“μ„ μ¬λ ¤λ†“μ€ κµ¬μ΅°
  - μƒμ„ λ¨λ“ : JUnit Platform, ν•μ„ λ¨λ“ : Jupiter, Vintage
- Javaλ΅ ν…μ¤νΈ ν•  μ μλ” λ‹¨μ„ ν…μ¤νΈ F/W

### JUnit Platform

- `JUnit ν…μ¤νΈ μ½”λ“λ¥Ό μ‹¤ν–‰ μ‹μΌμ£Όλ” λ°μ² μ—­ν• μ„ μ κ³µν•λ” λ¨λ“`
- ν…μ¤νΈλ¥Ό `λ°κ²¬`ν•κ³  ν…μ¤νΈ `κ³„ν`μ„ μƒμ„±ν•λ” `TestEngine Interface`λ¥Ό κ°€μ§€κ³  μμ
- λ°μ²
  - κ°λ° ν΄
  - μλ°” λ©”μ„λ“μ—μ„ JUnit5 μ‹¤ν–‰ν•λ” κ²ƒμ΄ κ°€λ¥

### JUnit Jupiter

- `JUnit 5 TestEngine κµ¬ν„μ²΄`
- JUnit 5κΈ°λ° ν…μ¤νΈ μΌ€μ΄μ¤ μ‘μ„±μ„ μ„ν• `ν”„λ΅κ·Έλλ° λ¨λΈ, ν™•μ¥ λ¨λΈμ„ μ§€μ›ν•λ” λ¨λ“`
- Jupier κΈ°λ°μΌλ΅ μ‘μ„±λ ν…μ¤νΈ μ½”λ“λ¥Ό Junit Platformμ—μ„ μ‹¤ν–‰μ‹ν‚¤κΈ° μ„ν• `ν…μ¤νΈ μ—”μ§„`μ„ μ κ³µν•λ” λ¨λ“
- Spring Boot μμ΅΄μ„± μ—†μ΄ JUnit μμ΅΄μ„±λ§μΌλ΅ μλ°”μ—μ„ JUnit5 μ‚¬μ© κ°€λ¥

### JUnit Vintage

- `JUnit 3.4 TestEngine κµ¬ν„μ²΄`
- κΈ°μ΅΄ JUnit 3.4 λ²„μ „ κΈ°λ°μΌλ΅ μ‘μ„±λ ν…μ¤νΈ μ½”λ“λ¥Ό Platform μ—μ„ μ‹¤ν–‰ν•κΈ° μ„ν•΄ μ‚¬μ©

## JUnit LifeCycle Annotaion

JUnit 5λ” μ•„λμ™€ κ°™μ€ ν…μ¤νΈ λΌμ΄ν”„ μ‚¬μ΄ν΄μ΄ μ΅΄μ¬ν•λ‹¤

| Annotation      | Desc                                                              |
| --------------- | ----------------------------------------------------------------- |
| **@Test**       | ν…μ¤νΈμ© λ©”μ„λ“λ¥Ό ν‘ν„ν•λ” μ–΄λ…Έν…μ΄μ…                             |
| **@BeforeEach** | κ° ν…μ¤νΈ λ©”μ„λ“κ°€ μ‹μ‘λκΈ° μ „μ— μ‹¤ν–‰λμ–΄μ•Ό ν•λ” λ©”μ„λ“λ¥Ό ν‘ν„    |
| **@AfterEach**  | κ° ν…μ¤νΈ λ©”μ„λ“κ°€ μ‹μ‘λ ν›„ μ‹¤ν–‰λμ–΄μ•Ό ν•λ” λ©”μ„λ“λ¥Ό ν‘ν„        |
| **@BeforeAll**  | ν…μ¤νΈ μ‹μ‘ μ „μ— μ‹¤ν–‰λμ–΄μ•Ό ν•λ” λ©”μ„λ“λ¥Ό ν‘ν„ (static μ²λ¦¬ ν•„μ”) |
| **@AfterAll**   | ν…μ¤νΈ μΆ…λ£ ν›„μ— μ‹¤ν–‰λμ–΄μ•Ό ν•λ” λ©”μ„λ“λ¥Ό ν‘ν„ (static μ²λ¦¬ ν•„μ”) |

## JUnit Main Annotaion

### @SpringBootTest

- **ν†µν•© ν…μ¤νΈ μ©λ„**
  - μ—¬λ¬ κΈ°λ¥μ„ μ΅°ν•©ν•μ—¬ μ „μ²΄ λΉ„μ¦λ‹μ¤ λ΅μ§μ΄ μ λ€λ΅ λ™μ‘ν•λ”μ§€ ν™•μΈν•λ” κ²ƒμ„ μλ―Έ
  - `λ§¤λ² λ¬΄κ±°μ΄ μ‘μ—…μ΄ μν–‰μ΄ λλ‹¤`
- @SpringBootApplicationμ„ μ°Ύμ•„κ°€ ν•μ„μ λ¨λ“  Beanμ„ μ¤μΊ”ν•μ—¬ λ΅λ“ν•¨
- κ·Έ ν›„ Testμ© Application Contextλ¥Ό λ§λ“¤μ–΄ Beanμ„ μ¶”κ°€ν•κ³ , MockBeanμ„ μ°Ύμ•„ κµμ²΄

### @ExtendWith

```java
@ExtendWith(SpringExtension.class)
```

- JUnit 4μ—μ„ **@RunWith**λ΅ μ‚¬μ©λλ μ–΄λ…Έν…μ΄μ…μ΄ **@ExtendWith**λ΅ λ³€κ²½λ¨
- **@ExtendWith**λ” λ©”μΈμΌλ΅ μ‹¤ν–‰λ  Classλ¥Ό μ§€μ •ν•  μ μμ
- **@SpringBootTest**λ” κΈ°λ³Έμ μΌλ΅ **@ExtendWith**κ°€ μ¶”κ°€λμ–΄ μμ

### @WebMvcTest(ν΄λμ¤λ….class)

```java
@WebMvcTest(controllers = UserAPI.class)
```

- (ν΄λμ¤λ….class)μ— μ‘μ„±λ ν΄λμ¤λ§ μ‹¤μ λ΅ λ΅λ“ν•μ—¬ ν…μ¤νΈλ¥Ό μ§„ν–‰ν•  κ²½μ° μ‚¬μ©
- `λ§¤κ° λ³€μλ¥Ό μ§€μ •ν•μ§€ μ•μΌλ©΄ @Controller, @RestController, @RestControllerAdvice λ“± μ»¨νΈλ΅¤λ¬μ™€ μ—°κ΄€λ λ¨λ“  Beanμ΄ λ΅λ“λλ‹¤`
- μ¤ν”„λ§μ λ¨λ“  Beanμ„ λ΅λ“ν•λ” @SpringBootTest λ€μ‹  μ»¨νΈλ΅¤λ¬ κ΄€λ ¨ μ½”λ“λ§ ν…μ¤νΈν•  κ²½μ° μ‚¬μ©

### @Autowired about @Mockbean

```java
@AutoWired
private MockMvc mvc; //MockMvcλ” μ‹¤μ  κ°μ²΄κ°€ μ•„λ‹ κ°€μƒ κ°μ²΄
```

```java
String bNo = "1";
        mockMvc.perform(
            get("/api/board/{bNo}", bNo))
            .andDo(print())
            .andExpect(status().isOk());
```

- `Controllerμ APIλ¥Ό ν…μ¤νΈ`ν•λ” μ©λ„μΈ `MockMvc κ°μ²΄`λ¥Ό μ£Όμ… λ°›μ
- perform() λ©”μ„λ“λ¥Ό ν™μ©ν•μ—¬ μ»¨νΈλ΅¤λ¬μ λ™μ‘μ„ ν™•μΈν•  μ μμ
- .andExpect(), andDo(), andReturn() λ“±μ λ©”μ„λ“λ¥Ό κ°™μ΄ ν™μ©ν•¨

### @MockBean

```java
@MockBean
private BoardService boardService;
```

- ν…μ¤νΈν•  ν΄λμ¤μ—μ„ μ£Όμ… λ°›κ³  μλ” `κ°€μ§ κ°μ²΄`λ¥Ό μƒμ„±ν•λ” μ–΄λ…Έν…μ΄μ…
- π€ `ν•΄λ‹Ή κ°μ²΄λ” μ‹¤μ  ν–‰μ„λ¥Ό ν•μ§€ μ•μ`
  - μ„ κ°™μ€ μ΄μ λ΅ μΈν•΄ λΉ„μ¦λ‹μ¤ λ΅μ§μ΄ μ΄μ–΄μ§€μ§€ μ•λ” κ²½μ°κ°€ μ΅΄μ¬
- `given()`μ„ ν™μ©ν•μ—¬ κ°€μ§ κ°μ²΄μ λ™μ‘μ— λ€ν•΄ μ •μν•μ—¬ μ‚¬μ©ν•  μ μμ

### @AutoConfigureMockMvc

- spring.test.mockmvcμ μ„¤μ •μ„ λ΅λ“ν•λ©΄μ„ MockMvcμ μμ΅΄μ„±μ„ μλ™μΌλ΅ μ£Όμ….
- MockMvc ν΄λμ¤λ” REST API ν…μ¤νΈλ¥Ό ν•  μ μλ” ν΄λμ¤.

## π λ‹¨μ„ ν…μ¤νΈ

```gradle
testImplementation 'org.springframework.boot:spring-boot-starter-test'
```

> λ‹¨μ„ ν…μ¤νΈλ” ν”„λ΅μ νΈμ— ν•„μ”ν• λ¨λ“  κΈ°λ¥μ— λ€ν• ν…μ¤νΈλ¥Ό κ°κ° μ§„ν–‰ν•λ” κ²ƒμ„ μλ―Έ.  
> μΌλ°μ μΌλ΅ μ¤ν”„λ§ λ¶€νΈ -> spring-starter-test λ””νλμ‹λ§μΌλ΅ μμ΅΄μ„±μ„ λ¨λ‘ κ°€μ§ μ μμ.

### F.I.R.S.T μ›μΉ™

- **Fast**: ν…μ¤νΈ μ½”λ“μ μ‹¤ν–‰μ€ λΉ λ¥΄κ² μ§„ν–‰ λμ–΄μ•Όν•¨
- **Independent**: λ…λ¦½μ μΈ ν…μ¤νΈκ°€ κ°€λ¥ν•΄μ•Όν•¨ (κ°κ°μ λ©”μ„λ“λ” κ°κ° ν…μ¤νΈκ°€ κ°€λ¥)
- **Repeatable**: ν…μ¤νΈλ” λ§¤λ² κ°™μ€ κ²°κ³Όλ¥Ό λ§λ“¤μ–΄μ•Ό ν•¨ (λ‘κ°™μ€ Input & Output)
- **Self-Validating**: ν…μ¤νΈλ” κ·Έ μμ²΄λ΅ μ‹¤ν–‰ν•μ—¬ κ²°κ³Όλ¥Ό ν™•μΈν•  μ μμ–΄μ•Όν•¨
- **Timely**: λ‹¨μ„ ν…μ¤νΈλ” λΉ„μ¦λ‹μ¤ μ½”λ“κ°€ μ™„μ„±λκΈ° μ „μ— κµ¬μ„±ν•κ³  ν…μ¤νΈκ°€ κ°€λ¥ν•΄μ•Όν•¨

## μ°Έκ³  μλ£

- [TDD JUnit 5](https://www.youtube.com/watch?v=SFVWo0Z5Ppo)
- [JUnit 5 κ³µμ‹ μ‚¬μ΄νΈ](https://junit.org/junit5/docs/current/user-guide/)
- [JUnit 5 λ¨λ“ κµ¬μ΅°](https://wjjeong.tistory.com/53)
