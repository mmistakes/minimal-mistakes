---
title:  "[Python] Pandasë¥¼ í™œìš©í•´ ì›-í•« ì¸ì½”ë”©(One-Hot Encoding) í•˜ê¸°"
layout: single

categories: "Python"
tags: 
    - Python
    - Pandas

toc: true
toc_sticky: true
toc_label : "ëª©ì°¨"
---

***

# ë”ë¯¸ë¡œ ì¸ì½”ë”© í•˜ê¸°
ğŸ‘‰ ê¸°ë³¸ êµ¬ì¡° : ```pd.get_dummies()```

## ì£¼ìš” íŒŒë¼ë¯¸í„°
- ```data``` : array-like, Series, DataFrame
  - ì¸ì½”ë”© í•  ë°ì´í„°
- ```prefix``` : str, (ê¸°ë³¸ê°’ : '_')
  - DataFrame ì»¬ëŸ¼ ì´ë¦„ì„ ì¶”ê°€í•  ë¬¸ìì—´
  - DataFrameì—ì„œ ```get_dummies``` í˜¸ì¶œí•  ë•Œ, ì»¬ëŸ¼ ìˆ˜ì™€ ë™ì¼í•œ ê¸¸ì´ì˜ list ì „ë‹¬
  - ë˜ëŠ” ```prefix``` ëŠ” ì»¬ëŸ¼ëª…ì„ ë¥ë‘ì‚¬ì— ë§¤í•‘í•˜ëŠ” dictionary
- ```prefix_sep``` : str, (ê¸°ë³¸ê°’ : '_')
  - ì ‘ë‘ì‚¬ë¥¼ ì¶”ê°€í•˜ëŠ” ê²½ìš°, ì‚¬ìš©í•  êµ¬ë¶„ ê¸°í˜¸/êµ¬ë¶„ì
  - ë˜ëŠ” ```prefix``` ì™€ ê°™ì´ ëª©ë¡ì´ë‚˜ ì‚¬ì „ì„ ì „ë‹¬
- ```dummy_na``` : bool, (ê¸°ë³¸ê°’ : False)
  - False NaNì´ ë¬´ì‹œë˜ëŠ” ê²½ìš° NaNì„ ë‚˜íƒ€ë‚´ëŠ” ì—´ ì¶”ê°€
  - NaNì— ëŒ€í•œ ì¸ì½”ë”© ê°’ì„ ì¶”ê°€í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©
- ```columns``` : list-like, (ê¸°ë³¸ê°’ None)
  - ì¸ì½”ë”©í•  DataFrameì˜ ì»¬ëŸ¼ëª…
  - ì»¬ëŸ¼ì´ None ì´ë©´ object, string ë˜ëŠ” category dtype ì´ ìˆëŠ” ëª¨ë“  ì»¬ëŸ¼ì´ ë³€í™˜ë¨
- ```sparse``` : bool, (ê¸°ë³¸ê°’ : False)
  - ë”ë¯¸ ì¸ì½”ë”©ëœ ì»¬ëŸ¼ì´ ì§€ì›ë˜ì–´ì•¼ í•˜ëŠ”ì§€ ```SparseArray```(True) ë˜ëŠ” ì¼ë°˜ Numpy ë°°ì—´(False) ì— ì˜í•´ ì§€ì›ë˜ì–´ì•¼ í•˜ëŠ”ì§€ ì—¬ë¶€
- ```drop_first``` : bool, (ê¸°ë³¸ê°’ : False)
  - ì²« ë²ˆì§¸ ìˆ˜ì¤€ì„ ì œê±°í•˜ì—¬ k ë²”ì£¼ ìˆ˜ì¤€ì—ì„œ k-1 ë”ë¯¸ë¥¼ ê°€ì ¸ì˜¬ì§€ ì—¬ë¶€
- ```dtype``` : dtype, (ê¸°ë³¸ : np.unit8)
  - ìƒˆ ì—´ì˜ ë°ì´í„° ìœ í˜•
  - ë‹¨ì¼ dtypeë§Œ í—ˆìš©

ğŸ‘‰ Return : ë°ì´í„° í”„ë ˆì„ í˜•íƒœë¡œ dummy-coded data ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤. <br>
ğŸ‘‰ ```Series.str.get_dummies```: seriesë¥¼ ë”ë¯¸ ì½”ë“œë¡œ ë³€í™˜ <br>
ğŸ‘‰ ```from_dummies()``` : ë”ë¯¸ ì½”ë“œë¥¼ categorical ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë³€í™˜ 

<br>

# ì‹¤ìŠµìœ¼ë¡œ ë°°ìš°ê¸°
## ë°ì´í„° ì •ë³´
- Dataset : Kaggle íƒ€ì´íƒ€ë‹‰ - train.csv
- [ğŸ‘‰ ë°ì´í„° ë³´ëŸ¬ê°€ê¸°](https://www.kaggle.com/competitions/titanic/data)

|	|Survived|	Pclass|	Name|	Sex|	Age	|SibSp|	Parch|	Ticket|	Fare|	Cabin|	Embarked|
|:--|:--|:--|:--|:--|:--|:--|:--|:--|:--|:--|:--|
|PassengerId	||||||||||||										
|1|	0|	3	|Braund, Mr. Owen Harris|	male|	22.0|	1|	0|	A/5 21171|	7.2500	|NaN|	S|
|2	|1|	1	|Cumings, Mrs. John Bradley (Florence Briggs Th...	|female	|38.0|	1	|0|	PC 17599	|71.2833|	C85|	C|
|3|	1|	3|	Heikkinen, Miss. Laina	|female|	26.0|	0	|0	|STON/O2.| 3101282	|7.9250	|NaN|	S|
|4|	1|	1|	Futrelle, Mrs. Jacques Heath (Lily May Peel)	|female|	35.0|	1	|0	|113803	|53.1000|	C123	|S|
|5	|0|	3	|Allen, Mr. William Henry|	male|	35.0|	0|	0|	373450	|8.0500	|NaN|	S|

## ë²”ì£¼í˜•ì„ ìˆ˜ì¹˜í˜•ìœ¼ë¡œ ë°”ê¾¸ê¸°

```python
# ì—¬ëŸ¬ ë²”ì£¼í˜• ë³€ìˆ˜ ì¤‘, ìœ ì¼ê°’(unique)ì´ ì ì€ ì„±ë³„ê³¼ Embarked ì»¬ëŸ¼ë§Œ ì›-í•« ì¸ì½”ë”©
pd.get_dummies(data=train[["Sex", "Embarked"]]
               , columns=["Sex", "Embarked"]).head()
```

|	|Sex_female|	Sex_male|	Embarked_C|	Embarked_Q|	Embarked_S|
|:--|:---|:---|:---|:---|:---|
|0|	0|	1|	0|	0|	1|
|1|	1|	0|	1|	0|	0|
|2|	1|	0|	0|	0|	1|
|3|	1|	0|	0|	0|	1|
|4|	0|	1|	0|	0|	1|

## ê²°ì¸¡ì¹˜ ê²½ìš° í¬í•¨í•˜ê¸°

```python
# ê° ì»¬ëŸ¼ì— ëŒ€í•´ ê²°ì¸¡ì¹˜ ê°’ë„ ì¸ì½”ë”© ì˜ì—­ì— í¬í•¨ì‹œì¼œì¤Œ
pd.get_dummies(data=train[["Sex", "Embarked"]]
               , columns=["Sex", "Embarked"], dummy_na=True).head()
```

|	|Sex_female	|Sex_male|Sex_nan|Embarked_C|Embarked_Q|Embarked_S|	Embarked_nan|
|:---|:---|:--|:---|:---|:---|:---|:---|
|0|	0|	1|	0|	0|	0|	1|	0|
|1|	1|	0|	0|	1|	0|	0|	0|
|2|	1|	0|	0|	0|	0|	1|	0|
|3|	1|	0|	0|	0|	0|	1|	0|
|4|	0|	1|	0|	0|	0|	1|	0|

## ìƒì„±ë˜ëŠ” ì»¬ëŸ¼ ìˆ˜ ì¤„ì´ê¸°
- ```get_dummies```ë¡œ ì›-í•« ì¸ì½”ë”©ì„ í•˜ë©´ unique(ìœ ì¼ê°’) í¬ê¸°ë§Œí¼ ì»¬ëŸ¼ì´ ìƒê¹ë‹ˆë‹¤.
- ë§Œì•½, ê³¼ì¼ì´ë¼ëŠ” ì»¬ëŸ¼ì— ì‚¬ê³¼, ë°”ë‚˜ë‚˜, ë”¸ê¸° ê°€ ìˆë‹¤ë©´ [1, 0, 0], [0, 1, 0], [0, 1, 1] ë¡œ ì¸ì½”ë”©ë©ë‹ˆë‹¤.
- ê³¼ì¼ ì»¬ëŸ¼ì— ëŒ€í•´ [1, 0], [0, 1], [0, 0] ìœ¼ë¡œ í‘œí˜„í•œë‹¤ë©´ ë²¡í„°ì˜ í¬ê¸°ë¥¼ ì¡°ê¸ˆì´ì§€ë§Œ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br>

<div style="text-align : center;">
<img src="https://ifh.cc/g/yYTOo1.png" width="65%">
</div>
<center><small>ë‹¤ì¤‘ ê³µì„ ì„±(Multicollinearity) í•´ê²°</small></center>

<br>

```python
# ë‹¤ì¤‘ ê³µì„ ì„± ë¬¸ì œ í•´ê²°í•˜ê¸°
pd.get_dummies(data=train[["Sex", "Embarked"]]
               , columns=["Embarked"], drop_first=True).head()
```

||Sex_male|Embarked_Q|Embarked_S|
|:--|:--|:--|:--|
|0	|1	|0	|1|
|1	|0	|0	|0|
|2	|0	|0	|1|
|3	|0	|0	|1|
|4	|1	|0	|1|

## ì •ë¦¬
> pandas ì˜ ```get_dummies``` ë©”ì„œë“œë¡œ ë²”ì£¼í˜• ë³€ìˆ˜ë¥¼ ìˆ˜ì¹˜í˜• ë³€ìˆ˜ë¡œ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
<br>ë‹¤ì¤‘ ê³µì„ ì„±ì„ í•´ê²°í•˜ê¸° ìœ„í•´ ```drop_first=True``` ë¥¼ ì‚¬ìš©í•´ ë³´ì•˜ìŠµë‹ˆë‹¤.
<br>ë²”ì£¼í˜• ë³€ìˆ˜ë¥¼ ìˆ˜ì¹˜í˜• ë³€ìˆ˜ë¡œ ë³€ê²½í•  ë•Œ, ìˆœì„œê°€ ë¬´ì˜ë¯¸í•œ ë°ì´í„°ë¼ë©´ ì›-í•« ì¸ì½”ë”©ì„ ì‚¬ìš©í•˜ëŠ”ê²Œ ì¢‹ìŠµë‹ˆë‹¤.
<br>ì›-í•« ì¸ì½”ë”© ë°©ë²•ìœ¼ë¡  pandasì˜ ```get_dummies``` í•¨ìˆ˜ê°€ ê°€ì¥ ì¢‹ì€ ë°©ë²•ì´ë¼ê³  ìƒê°í•©ë‹ˆë‹¤.

<br>

# Reference 
- [[Pandas ê³µì‹ë¬¸ì„œ] pandas.get_dummies](https://pandas.pydata.org/docs/reference/api/pandas.get_dummies.html)
- [[Wikidocs - ë”¥ ëŸ¬ë‹ì„ ì´ìš©í•œ ìì—°ì–´ ì²˜ë¦¬ ì…ë¬¸] 08) ì›-í•« ì¸ì½”ë”©(One-Hot Encoding)](https://wikidocs.net/22647)
- [[Jone] ë°ì´í„° ì „ì²˜ë¦¬ : ë ˆì´ë¸” ì¸ì½”ë”©ê³¼ ì›í•« ì¸ì½”ë”©](https://john-analyst.medium.com/%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%84%EC%B2%98%EB%A6%AC-%EB%A0%88%EC%9D%B4%EB%B8%94-%EC%9D%B8%EC%BD%94%EB%94%A9%EA%B3%BC-%EC%9B%90%ED%95%AB-%EC%9D%B8%EC%BD%94%EB%94%A9-f0220df21df1)
-[[í‹°ìŠ¤í† ë¦¬ - Hongfluenza] ì¸ì½”ë”©(Encoding)ì´ë€? : ASCII, URL, HTML, Base64, MS Script ì¸ì½”ë”©](https://ghdwn0217.tistory.com/76)
- [[í‹°ìŠ¤í† ë¦¬ by Data_Pistachio] Machine Learning - Label Encoding (ë¼ë²¨ ì¸ì½”ë”©)](https://steadiness-193.tistory.com/243)