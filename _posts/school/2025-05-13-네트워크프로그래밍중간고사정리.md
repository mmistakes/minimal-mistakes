---
layout: single
title: "ğŸ“˜ ë„¤íŠ¸ì›Œí¬í”„ë¡œê·¸ë˜ë° ì¤‘ê°„ê³ ì‚¬ ì •ë¦¬"
toc: true
toc_sticky: true
toc_label: "ëª©ì°¨"
categories: school
excerpt: "ë„¤íŠ¸ì›Œí¬í”„ë¡œê·¸ë˜ë° ì¤‘ê°„ê³ ì‚¬ ì •ë¦¬"
tag: [school]
---

# ë„¤íŠ¸ì›Œí¬ í”„ë¡œê·¸ë˜ë°

: ë„¤íŠ¸ì›Œí¬ë¡œ ì—°ê²°ëœ ë‘˜ ì´ìƒì˜ ì»´í“¨í„° ì‚¬ì´ì—ì„œ ë°ì´í„° ì†¡ìˆ˜ì‹  í”„ë¡œê·¸ë¨ ì‘ì„± ì˜ë¯¸. ì†Œì¼“ ê¸°ë°˜ìœ¼ë¡œ í”„ë¡œê·¸ë˜ë°

 ì†Œì¼“ : ë„¤íŠ¸ì›Œí¬ ì—°ê²° ë„êµ¬

### **TCPë€?**

**TCP (Transmission Control Protocol)**

â†’ ë°ì´í„°ë¥¼ **ì•ˆì „í•˜ê³  ì •í™•í•˜ê²Œ** ì£¼ê³ ë°›ê¸° ìœ„í•œ **â€œì—°ê²°ì§€í–¥í˜•â€** í”„ë¡œí† ì½œì´ì•¼.

SOCKET_STREAM

> â€œë‚´ê°€ ë³´ë‚¸ ë©”ì‹œì§€ê°€ ì˜ ë„ì°©í–ˆëŠ”ì§€ í™•ì¸í•˜ê³  ì‹¶ì–´!â€ â†’ ê·¸ëŸ´ ë•ŒëŠ” ë¬´ì¡°ê±´ TCP

![image](/assets/images/network/image.png)

### **TCP í†µì‹ ì˜ íë¦„ êµ¬ì¡°**

**ğŸ“ TCP í†µì‹ ì€ ì „í™” ê±°ëŠ” ê³¼ì •ì´ë‘ ë¹„ìŠ·í•¨.áŸ**

1. **ì„œë²„ëŠ” ëŒ€ê¸° ì¤‘** (ì „í™” ë°›ì„ ì¤€ë¹„)
2. **í´ë¼ì´ì–¸íŠ¸ê°€ ì „í™”í•¨** (ì—°ê²° ìš”ì²­)
3. **ì„œë²„ê°€ ë°›ìŒ** (ì—°ê²° ìˆ˜ë½)
4. **ë‘˜ì´ í†µí™”í•¨** (ë°ì´í„° ì†¡ìˆ˜ì‹ )
5. **í•œìª½ì´ ëŠìŒ** (ì¢…ë£Œ)

** ì„œë²„ ì…ì¥**

```c
socket()      // ì „í™”ê¸° ì¥ë§Œ
bind()        // ì „í™”ë²ˆí˜¸ ë“±ë¡ (IP + PORT)
listen()      // ì „í™” ë°›ì„ ì¤€ë¹„ ì™„ë£Œ
accept()      // ì „í™” ë°›ê¸°
read()/write() // í†µí™” (ë°ì´í„° ì£¼ê³ ë°›ê¸°)
```

** í´ë¼ì´ì–¸íŠ¸ ì…ì¥**

```c
socket()      // ì „í™”ê¸° ì¥ë§Œ
connect()     // ì „í™” ê±¸ê¸°
read()/write() // í†µí™” (ë°ì´í„° ì£¼ê³ ë°›ê¸°)
```

![image](/assets/images/network/image2.png)

### **ì¸í„°ë„· ì£¼ì†Œ & í¬íŠ¸**

** IP ì£¼ì†Œ?**

- ì¸í„°ë„·ìƒì—ì„œ ì»´í“¨í„°ë¥¼ ì‹ë³„í•˜ê¸° ìœ„í•œ ì£¼ì†Œ
- IPv4 (4ë°”ì´íŠ¸), IPv6 (16ë°”ì´íŠ¸)

** PORT ë²ˆí˜¸?**

- í•œ ì»´í“¨í„° ë‚´ì—ì„œ ì†Œì¼“ì„ êµ¬ë¶„í•˜ê¸° ìœ„í•œ ë²ˆí˜¸
- 065535 (01023ì€ well-known í¬íŠ¸)

**êµ¬ì¡°ì²´ sockaddr_in ì„¤ëª…**

- sin_family: ì£¼ì†Œ ì²´ê³„ (AF_INET ë“±)
- sin_port: í¬íŠ¸ ë²ˆí˜¸ (ë„¤íŠ¸ì›Œí¬ ë°”ì´íŠ¸ ìˆœì„œ)
- sin_addr: IP ì£¼ì†Œ
- sin_zero: ì˜ë¯¸ ì—†ìŒ, 0ìœ¼ë¡œ ì±„ì›€

### **ë°”ì´íŠ¸ ìˆœì„œ & ë„¤íŠ¸ì›Œí¬ ë°”ì´íŠ¸ ìˆœì„œ**

** ë¹… ì—”ë””ì•ˆ (Big Endian)**

- ìƒìœ„ ë°”ì´íŠ¸ë¥¼ **ì‘ì€ ë²ˆì§€ìˆ˜**ì— ì €ì¥ (ë„¤íŠ¸ì›Œí¬ ê¸°ì¤€)
- ì˜ˆ: 0x12345678 â†’ 12ê°€ ê°€ì¥ ì•ì—

** ë¦¬í‹€ ì—”ë””ì•ˆ (Little Endian)**

- ìƒìœ„ ë°”ì´íŠ¸ë¥¼ **í° ë²ˆì§€ìˆ˜**ì— ì €ì¥
- ì˜ˆ: 0x12345678 â†’ 78ì´ ê°€ì¥ ì•ì—

** í˜¸ìŠ¤íŠ¸ ë°”ì´íŠ¸ ìˆœì„œ**

- CPUë³„ ë°ì´í„° ì €ì¥ ë°©ì‹ (OSë‚˜ ì»´í“¨í„° êµ¬ì¡°ì— ë”°ë¼ ë‹¤ë¦„)

** ë„¤íŠ¸ì›Œí¬ ë°”ì´íŠ¸ ìˆœì„œ**

- **í†µì‹  í‘œì¤€**
- í•­ìƒ **ë¹… ì—”ë””ì•ˆ**ì„ ê¸°ì¤€
    
    â†’ ë°ì´í„° ì „ì†¡ ì „ì— ë°˜ë“œì‹œ í˜¸ìŠ¤íŠ¸ ë°”ì´íŠ¸ ìˆœì„œë¥¼ ë„¤íŠ¸ì›Œí¬ ë°”ì´íŠ¸ ìˆœì„œë¡œ ë³€í™˜í•´ì•¼ í•¨!
    

----

### ** ë°”ì´íŠ¸ ìˆœì„œ ë³€í™˜ í•¨ìˆ˜**

| **í•¨ìˆ˜** | **ì—­í• ** |
| --- | --- |
| htons() | host(ë¦¬í‹€ ì—”ë””ì•ˆ)â†’ network(ë¹… ì—”ë””ì•ˆ) (shortí˜• == 16ë¹„íŠ¸) / ì²˜ìŒë¶€í„° ë¹… ì—”ë””ì•ˆ ì¼ì‹œ ê·¸ëƒ¥ ë¹… ì—”ë””ì•ˆ ìœ ì§€ |
| htonl() | host â†’ network (longí˜• == 32ë¹„íŠ¸) |
| ntohs() | network â†’ host (shortí˜•) |
| ntohl() | network â†’ host (longí˜•) |

---

### ** ì£¼ì†Œ ë³€í™˜ ê´€ë ¨ í•¨ìˆ˜**

** inet_addr()**

- "127.0.0.1" ê°™ì€ ë¬¸ìì—´ IP â†’ 4ë°”ì´íŠ¸ ìˆ«ìë¡œ ë³€í™˜
- ê²°ê³¼: ì •ìˆ˜í˜• IP ì£¼ì†Œ ë°˜í™˜
- ë‹¨, **byte ìˆœì„œë¥¼ ë°”ê¿”ì„œ ì €ì¥í•¨ (ì£¼ì˜!)**

** inet_aton()**

- ìœ„ í•¨ìˆ˜ì™€ ë™ì¼í•œ ì—­í•  (ë” ì•ˆì „í•˜ê³  ì—„ê²©í•œ ë²„ì „)
- **ê°’ì„ ì €ì¥**í•œë‹¤ëŠ” ì ì—ì„œ ì°¨ì´
- ë¦¬í„´ê°’: ì„±ê³µ ì—¬ë¶€ (ì •ìˆ˜)

** inet_ntoa()**

- ìˆ«ì í˜•íƒœì˜ IP ì£¼ì†Œ â†’ ë¬¸ìì—´ë¡œ ë‹¤ì‹œ ë°”ê¿”ì¤Œ
- IPë¥¼ ì‚¬ëŒì´ ì½ì„ ìˆ˜ ìˆë„ë¡ í‘œì‹œ

- **WSAStringToAddress**
    - inet_addrê³¼ ë¹„ìŠ·í•˜ì§€ë§Œ, ì£¼ì†Œì™€ í¬íŠ¸ë²ˆí˜¸ê°€ ê°™ì´ ìˆëŠ”ê±° í—ˆìš© (**1.2.3.4:9000**)
- **WSAAddressToString**
    - inet_ntoaì™€ ë¹„ìŠ·í•˜ì§€ë§Œ, ì£¼ì†Œì™€ í¬íŠ¸ë²ˆí˜¸ê°€ ê°™ì´ ìˆëŠ”ê±° í—ˆìš© (**1.2.3.4:9000**)

---

### ** sockaddr êµ¬ì¡°ì²´ì™€ ì£¼ì†Œ ì„¤ì •**

**struct sockaddr_inì„ ì‚¬ìš©í•  ë•Œ ì£¼ì˜ì‚¬í•­**

- IPv4ìš© ì†Œì¼“ ì£¼ì†ŒëŠ” SOCKADDR_INìœ¼ë¡œ ì •ì˜
- bind ì‹œì—ëŠ” sockaddr*ë¡œ ìºìŠ¤íŒ…í•´ì„œ ì‚¬ìš©í•´ì•¼ í•¨

```
struct sockaddr_in serv_addr;
serv_addr.sin_family = AF_INET;
serv_addr.sin_addr.s_addr = htonl(INADDR_ANY); // ëª¨ë“  IP í—ˆìš©
serv_addr.sin_port = htons(atoi(serv_port));
```

---

### ** INADDR_ANY?**

- í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ ì»´í“¨í„°ì˜ **ëª¨ë“  IP ì£¼ì†Œì—ì„œ ì ‘ê·¼ ê°€ëŠ¥**
- ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ì„ ë‹¤ ìˆ˜ë½í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •í•˜ëŠ” ìƒìˆ˜

---

### ** ì„œë²„ ì£¼ì†Œ ë°”ì¸ë”© ì˜ˆì‹œ**

```
int serv_sock;
struct sockaddr_in serv_addr;
char* serv_port = "9190";

// ì†Œì¼“ ìƒì„±
serv_sock = socket(PF_INET, SOCK_STREAM, 0);

// ì£¼ì†Œ ì„¤ì •
memset(&serv_addr, 0, sizeof(serv_addr));
serv_addr.sin_family = AF_INET;
serv_addr.sin_addr.s_addr = htonl(INADDR_ANY);
serv_addr.sin_port = htons(atoi(serv_port));

// ë°”ì¸ë”©
bind(serv_sock, (struct sockaddr*)&serv_addr, sizeof(serv_addr));
```

** ì´ê±´ TCP ì„œë²„ì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” í¬ë§·!**

---

### **UDP (User Datagram Protocol)**

**TCPì™€ UDP ë¹„êµ**

- UDPëŠ” **ë¹„ì—°ê²°í˜• í”„ë¡œí† ì½œ**ë¡œ TCPì™€ ë‹¤ë¥´ê²Œ ì—°ê²° ê°œë… ì—†ìŒ
- í™•ì¸ ë©”ì‹œì§€(SEQ, ACK) ì—†ìŒ â†’ **Flow Control ì—†ìŒ**
- ë°ì´í„° ì „ì†¡ ìˆœì„œ ë° ì†ì‹¤ì— ëŒ€í•œ ë³´ì¥ X
- ì‹¤ì‹œê°„ì„±ì´ ì¤‘ìš”í•œ ì„œë¹„ìŠ¤ì— ì í•© (ìŒì„±, ì˜ìƒ ë“±)
- SOCKET_DGRAM

### **âš™ï¸ UDP ì£¼ìš” í•¨ìˆ˜ ì„¤ëª…**

** recvfrom() í•¨ìˆ˜**

- ë°ì´í„°ë¥¼ ìˆ˜ì‹ í•˜ê³  **ì†¡ì‹ ì ì •ë³´ë„ í•¨ê»˜ ì „ë‹¬ë°›ìŒ**
- ì£¼ìš” íŒŒë¼ë¯¸í„°:
    - from: ë³´ë‚¸ ì¸¡ ì£¼ì†Œ ì •ë³´ ì €ì¥í•  êµ¬ì¡°ì²´
    - addrlen: ì£¼ì†Œ ê¸¸ì´
- ì—°ê²° ê°œë… ì—†ìŒ â†’ ë§¤ë²ˆ ìˆ˜ì‹ í•  ë•Œ ì†¡ì‹ ì ì •ë³´ í¬í•¨ í•„ìš”

** sendto() í•¨ìˆ˜**

- ë°ì´í„°ë¥¼ ì†¡ì‹ í•˜ë©° **ìˆ˜ì‹ ì ì£¼ì†Œë¥¼ ëª…ì‹œ**
- ì£¼ìš” íŒŒë¼ë¯¸í„°:
    - to: ë°›ì„ ì¸¡ ì£¼ì†Œ ì •ë³´
    - addrlen: ì£¼ì†Œ êµ¬ì¡°ì²´ì˜ í¬ê¸°

 ìš”ì•½: **recvfromì€ ëˆ„ê°€ ë³´ëƒˆëŠ”ì§€ ì•Œë ¤ì£¼ê³ **, sendtoëŠ” **ì–´ë””ë¡œ ë³´ë‚¼ì§€ ì§ì ‘ ì§€ì •**

---

### ** UDPì˜ ë°ì´í„° ê²½ê³„ ì²˜ë¦¬**

- UDPëŠ” **ë°ì´í„° ë‹¨ìœ„(íŒ¨í‚·) ê²½ê³„ê°€ ì¡´ì¬**
- recvfrom()ì„ í˜¸ì¶œí•  ë•Œë§ˆë‹¤ **í•œ ê°œì˜ íŒ¨í‚·ë§Œ ìˆ˜ì‹ ë¨**
- ì˜ˆ: sleep() ì¤‘ì—ë„ ë©”ì‹œì§€ê°€ ì˜¤ë©´ 3ê°œ ì¤‘ 3ê°œ ëª¨ë‘ ê°œë³„ë¡œ ë„ì°©í•¨
    
    â†’ **TCPì™€ ë‹¬ë¦¬ ë­‰ì³ì„œ ì˜¤ëŠ” ê²Œ ì•„ë‹˜**
    

---

### ** UDP vs TCP í•¨ìˆ˜ ì°¨ì´**

- TCPëŠ” ì—°ê²° ê¸°ë°˜ì´ë¼ send, recvë§Œ ì“°ê³  ëŒ€ìƒ ì§€ì • X
- UDPëŠ” ë¹„ì—°ê²°ì´ë¯€ë¡œ sendto, recvfromìœ¼ë¡œ **ë§¤ë²ˆ ì£¼ì†Œ ì§€ì • í•„ìš”**

---

### ** Connected UDP ì†Œì¼“?**

- connected UDP ì†Œì¼“ì€ **TCPì²˜ëŸ¼ ì—°ê²°ëœ ê±´ ì•„ë‹ˆì§€ë§Œ**
- ì†Œì¼“ì˜ **ëª©ì ì§€ë¥¼ ë¯¸ë¦¬ ì„¤ì •**í•œ ìƒíƒœ
- ì´í›„ì—” send, recvë¡œë§Œ ì‚¬ìš© ê°€ëŠ¥ (ì£¼ì†Œ ë§¤ë²ˆ ì§€ì • ì•ˆ í•´ë„ ë¨)

### ** ì–‘ë°©í–¥ í†µì‹ : ì—ì½” ì„œë²„ & í´ë¼ì´ì–¸íŠ¸**

**ì—ì½” í†µì‹ ì´ë€?**

> í´ë¼ì´ì–¸íŠ¸ê°€ ì…ë ¥í•œ ë¬¸ìì—´ì„ ì„œë²„ê°€ ê·¸ëŒ€ë¡œ ë°›ì•„ì„œ ëŒë ¤ë³´ë‚´ëŠ” êµ¬ì¡°

![image](/assets/images/network/image3.png)

### **ğŸ”šÂ ì†Œì¼“ì˜ ìš°ì•„í•œ ì¢…ë£Œ (Half-Close & shutdown())**

** ì¼ë°˜ì ì¸ close()ì˜ í•œê³„**

- ìš°ë¦¬ê°€ í‰ì†Œì— ì“°ë˜ close()ëŠ” **ì–‘ìª½ ìŠ¤íŠ¸ë¦¼ ëª¨ë‘ ì¢…ë£Œ**í•¨
- ë¬¸ì œëŠ”?
    
    â†’ ìƒëŒ€ë°©ì´ ì•„ì§ ë°ì´í„°ë¥¼ ë³´ë‚´ê³  ìˆì„ ìˆ˜ë„ ìˆìŒ
    
    â†’ ì¼ë°©ì ì¸ ì¢…ë£Œë¡œ **ë°ì´í„° ìœ ì‹¤** ê°€ëŠ¥ì„± ìˆìŒ 
    

** Half-Close**

- TCPëŠ” ë°ì´í„°ë¥¼ **ì£¼ê³ ë°›ëŠ” ë°©í–¥**ì´ ë”°ë¡œ ìˆìŒ
- â†’ ê·¸ëŸ¼ **ì½ê¸°ë§Œ ëŠê±°ë‚˜**, **ì“°ê¸°ë§Œ ëŠëŠ” ê²Œ ê°€ëŠ¥í•˜ì§€ ì•Šì„ê¹Œ?**

ì´ê±¸ ê°€ëŠ¥í•˜ê²Œ í•´ì£¼ëŠ” í•¨ìˆ˜ê°€ ë°”ë¡œ **shutdown()**

ì…ë ¥ ìŠ¤íŠ¸ë¦¼ ë§Œ ì¢…ë£Œ / ì¶œë ¥ ìŠ¤íŠ¸ë¦¼ ë§Œ ì¢…ë£Œ ê°€ëŠ¥

![image](/assets/images/network/image4.png)

### **ë„ë©”ì¸**

ìš°ë¦¬ê°€ í”íˆ ì ‘í•˜ëŠ” ì›¹ ì£¼ì†Œ: www.google.com, www.naver.com ê°™ì€ ê²ƒë“¤

ì´ê±´ **ì‚¬ëŒì´ ë³´ê¸° ì‰½ê²Œ ë§Œë“  ì£¼ì†Œì„**

ì‹¤ì œ í†µì‹ ì€ **IP ì£¼ì†Œ(ìˆ«ì)** ê¸°ë°˜ìœ¼ë¡œ ì´ë£¨ì–´ì§

ê·¸ë˜ì„œ ë„ë©”ì¸ â†’ IP ì£¼ì†Œ ì´ê±¸ ì²˜ë¦¬í•˜ëŠ” ê²Œ **DNS (Domain Name System)**

** DNSì˜ ì—­í• **

> ë„ë©”ì¸ ì´ë¦„ì„ IP ì£¼ì†Œë¡œ ë°”ê¿”ì£¼ëŠ” ì‹œìŠ¤í…œ

** ë„ë©”ì¸ â†’ IPë¡œ ë°”ê¾¸ê¸°:Â gethostbyname()**

```c

struct hostent* gethostbyname(const char* name);
```

**IP â†’ ë„ë©”ì¸ìœ¼ë¡œ ë°”ê¾¸ê¸°:Â gethostbyaddr()**

```c
struct hostent* gethostbyaddr(const void* addr, socklen_t len, int type);

```

**gethostbyname()ì€ DNSì˜ ì¢…ë¥˜ì¸ê°€?**

â†’ **ì•„ë‹˜!** 

gethostbynameì€ **DNSì˜ ì¢…ë¥˜ê°€ ì•„ë‹ˆë¼**, **DNSë¥¼ ì‚¬ìš©í•˜ëŠ” Cí•¨ìˆ˜ ì¤‘ í•˜ë‚˜**

gethostbyaddr()ì€ ë°©í–¥ì´ ë°˜ëŒ€ 

IP ì£¼ì†Œì˜ **ì—­ë°©í–¥ ì¡°íšŒ(Reverse DNS Lookup)** ì—­í• 

</aside>