---
title:  "[ê²½ê³  ë©”ì‹œì§€] RuntimeWarning: invalid value encountered in log1p"
layout: single

categories: "Error-Warning"
tags: 
    - "Warning"
    - "Numpy"
    
# toc: true
# toc_sticky: true
# toc_label : "ëª©ì°¨"
---

***

Numpy ì—ì„œ ì œê³µí•˜ëŠ” log í•¨ìˆ˜ì— ê´€í•œ ê²½ê³  ë©”ì‹œì§€ë¥¼ ë¶„ì„í•´ ë³¸ë‹¤.

## Case 1. 0ì´ ì…ë ¥ëœ ê²½ìš°

<div style="text-align : center;">
<img src="https://ifh.cc/g/NBw5r6.png", width=600>
</div>

<br>

```log()``` ì— 0 ê°’ì´ ë“¤ì–´ê°”ë‹¤ê³  ì•Œë ¤ì£¼ëŠ” ê²½ê³  ë©”ì‹œì§€ì´ë‹¤. ```log(0)```ì€ ìŒì˜ ë¬´í•œëŒ€ ê°’ì„ ê°€ì§€ê¸° ë•Œë¬¸ì— ```-inf```(ìŒì˜ ë¬´í•œëŒ€, negative infinity) ê°’ì´ ë°˜í™˜ëœë‹¤.
<br>
<br>```-inf``` ê°’ì´ ì˜ ë°˜í™˜ë˜ëŠ”ë° ê²½ê³  ë©”ì‹œì§€ë¥¼ ë°˜í™˜í•˜ëŠ” ì´ìœ ê°€ ë¬´ì—‡ì¼ê¹Œ? ğŸ¤”
<br>ì‚¬ì‹¤ xëŠ” 0 ê°’ì„ ê°€ì§ˆ ë•Œ, ì •í™•í•œ y ê°’ì´ ì—†ë‹¤. ë¡œê·¸ í•¨ìˆ˜ ê·¸ë˜í”„ë¥¼ ë³´ë©´ xê°€ 1ì—ì„œ 0ìœ¼ë¡œ ê°ˆìˆ˜ë¡ ìŒì˜ ë¬´í•œëŒ€ë¡œ ë°œì‚°í•œë‹¤ê³  í‘œí˜„í•©ë‹ˆë‹¤.

<br>

<div style="text-align : center;">
<img src="https://ifh.cc/g/mtypa4.png", width=180>
</div>

<br>ğŸ” Case 1. log() ì— 0ì´ ë“¤ì–´ê°€ì„œ ë°œìƒí•˜ëŠ” ê²½ê³  ë©”ì‹œì§€ì´ë‹¤. 

## Case 2. ì˜³ì§€ì•Šì€ ê°’ì´ ì…ë ¥ëœ ê²½ìš°

<div style="text-align : center;">
<img src="https://ifh.cc/g/ST0P36.png", width=600>
</div>

<br>

```log1p()```ì— ì í•©í•˜ì§€ ì•Šì€ ê°’ì´ ë“¤ì–´ê°”ë‹¤ê³  ì•Œë ¤ì£¼ëŠ” ê²½ê³  ë©”ì‹œì§€ì´ë‹¤.
<br>ğŸ” Case 2 ê²½ê³  ë©”ì‹œì§€ëŠ” ë¡œê·¸í•¨ìˆ˜ì— ìŒìˆ˜ê°€ ë“¤ì–´ê°€ 'ì˜³ì§€ ì•Šì€ ê°’'ì´ ë“¤ì–´ê°”ë‹¤ê³  ì¹œì ˆí•˜ê²Œ ì•Œë ¤ì£¼ëŠ” ê²½ê³  ë©”ì‹œì§€ì´ë‹¤.
<br>
<br>logì— ìŒìˆ˜ë¥¼ ë„£ìœ¼ë©´, nan ìœ¼ë¡œ ë°˜í™˜í•œë‹¤. (ìë™ ê²°ì¸¡ì¹˜ ì²˜ë¦¬) 
<br><br>

### ì˜ˆì‹œë¡œ ì´í•´í•˜ê¸°
- ë°ì´í„° : Kaggle ì£¼íƒ ê°€ê²© ì˜ˆì¸¡í•˜ê¸° ë°ì´í„°ì…‹ì˜ ```train.csv``` ì‚¬ìš©
- [ğŸ‘‰ Kaggle -  House Prices ë°ì´í„° ë³´ëŸ¬ê°€ê¸°](https://www.kaggle.com/c/house-prices-advanced-regression-techniques)

```python
# SalePrice ë°ì´í„°ë¥¼ standardscalerë¡œ ìŠ¤ì¼€ì¼ë§ 
from sklearn.preprocessing import StandardScaler

ss = StandardScaler()
train[["SalePrice_ss"]] = ss.fit_transform(train[["SalePrice"]])
# ìŠ¤ì¼€ì¼ë§ í›„ Log Transformation 
train[["SalePrice_ss_log1p"]] = np.log1p(train["SalePrice_ss"])

# ë³€ìˆ˜ ìŠ¤ì¼€ì´ë§ í›„, Log Transformation ì „, í›„ ê¸°ìˆ í†µê³„ê°’ ë¹„êµ
train[["SalePrice_ss", "SalePrice_ss_log1p"]].describe()
```

<br>

<div style="text-align : center;">
<img src="https://ifh.cc/g/lwXFds.png", width=350>
</div>

<center><small>Log Transformation ì „(ì™¼ìª½), í›„(ì˜¤ë¥¸ìª½) ê¸°ìˆ í†µê³„</small></center>

<br>

```python
count_bef = train["SalePrice_ss"].count()
count_aft = train["SalePrice_ss_log1p"].count()
count_neg = train.loc[(train["SalePrice_ss"]+1)< 0, "SalePrice_ss"].count()

count_bef - count_neg == count_aft # True ë°˜í™˜
```

ë¡œê·¸ì— ìŒìˆ˜ë¥¼ ì…ë ¥í•˜ë©´ ```nan``` ê°’ìœ¼ë¡œ ë°˜í™˜í•˜ì—¬ count ê°’ì— í¬í•¨ë˜ì§€ ì•ŠëŠ”ë‹¤.
<br>ìœ„ ì½”ë“œëŠ” ```nan``` ê°’ì„ ë°˜í™˜í•˜ëŠ”ì§€ í™•ì¸í•´ ë³¸ ê²°ê³¼ì´ë‹¤.