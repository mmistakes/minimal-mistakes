---
toc : true
title : '[DL/CV] ì‚¬ì „ í›ˆë ¨ëœ ëª¨ë¸ ì•Œì•„ë³´ê¸° - MobileNetV1,V2 ğŸ“š'
layout : single
toc: true
toc_sticky: true
categories:
  - visions
---

## 9. MobilenNet ,MobileNetV2 ëª¨ë¸ ì•Œì•„ë³´ê¸°

### 9.0 ë“¤ì–´ê°€ë©°
ì´ë²ˆ ê¸€ì€ MobileNetì— ê´€ë ¨ëœ ë…¼ë¬¸ì— ì„¤ëª…ëœ ëª¨ë¸ì— ëŒ€í•´ì„œ ì•Œì•„ë³¼ ê²ƒì´ë‹¤. ì°¸ê³ í•œ ë…¼ë¬¸ì€ MobileNets: Efficient Convolutional Neural Networks for Mobile Vision Applicationì´ê³ , [**ì´ ë¸”ë¡œê·¸**](https://deep-learning-study.tistory.com/532)ì˜ ë‚´ìš©ì„ ì°¸ê³ í–ˆë‹¤.

### 9.1 MobileNet(V1)
MobileNetì€ Depthwise seperable convolutionì„ í™œìš©í•´ì„œ ëª¨ë¸ì„ ê²½ëŸ‰í™”í•˜ëŠ”ë° ì§‘ì¤‘í–ˆë‹¤. MobileNetì´ ê²½ëŸ‰í™”ì— ì§‘ì¤‘í•œ ì´ìœ ëŠ” ë©”ëª¨ë¦¬ê°€ ì œí•œëœ í™˜ê²½ì—ì„œ ë”¥ëŸ¬ë‹ì„ ì ìš©í•˜ê¸° ìš©ì´í•œ ëª¨ë¸ì„ ë§Œë“¤ê¸° ìœ„í•´ì„œì´ë‹¤. ë¨¼ì € Depthwise Seperable Convolutionì— ëŒ€í•´ ì•Œì•„ë³´ì.

#### 9.1.1 Depthwise Seperable Convolution
**Depthwise Seperable Convolution**ì€ Depthwise Convolution ì´í›„ì— Pointwise Convolutionì„ ê²°í•©í•œ ê²ƒì´ë‹¤. 

![mobile1](https://user-images.githubusercontent.com/77332628/204940889-cb20724d-3e93-4de7-a5d9-35aad6f4507e.png)

1. Depthwise Convolution

Depthwise Convolutionì€ ê° ì…ë ¥ ì±„ë„ì— ëŒ€í•´ 3x3 conv í•˜ë‚˜ì˜ í•„í„°ê°€ ì—°ì‚°ì„ ìˆ˜í–‰í•´ì„œ í•˜ë‚˜ì˜ í”¼ì³ë§µì„ ìƒì„±í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ì…ë ¥ ì±„ë„ ê°œìˆ˜ê°€ Mê°œì´ë©´ Mê°œì˜ í”¼ì³ë§µì„ ìƒì„±í•œë‹¤. ë”°ë¼ì„œ Depthwise convolutionì˜ ì—°ì‚°ëŸ‰ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

![mobile2](https://user-images.githubusercontent.com/77332628/204940893-89090409-293c-4aa0-8877-8fde070f1eb3.png)

ì—¬ê¸°ì„œ DkëŠ” ì…ë ¥ê°’ í¬ê¸°, Mì€ ì…ë ¥ê°’ì˜ ì±„ë„ ìˆ˜, DFëŠ” í”¼ì³ë§µ í¬ê¸°ì´ë‹¤.

2. Pointwise convolution

Pointwise convolutionì€ depthwise convolutionì´ ìƒì„±í•œ í”¼ì³ë§µë“¤ì„ 1x1 convë¡œ ì±„ë„ ìˆ˜ë¥¼ ì¡°ì •í•œë‹¤.1x1 í•„í„°ëŠ” ëª¨ë“  ì±„ë„ì— ëŒ€í•´ ì—°ì‚°í•˜ê¸° ë•Œë¬¸ì— cross-channel correlationì„ ê³„ì‚°í•˜ëŠ” ì—­í• ì„ í•œë‹¤.

Pointwise convolutionì˜ ì—°ì‚°ëŸ‰ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

![mobile3](https://user-images.githubusercontent.com/77332628/204940895-1077c33d-0b05-4fd6-82e4-89adca86c4b8.png)

ì—¬ê¸°ì„œ Mì€ ì…ë ¥ ì±„ë„ ìˆ˜, Nì€ ì¶œë ¥ ì±„ë„ ìˆ˜, DFëŠ” í”¼ì³ë§µ í¬ê¸°ì´ë‹¤.

ì•„ë˜ ì´ë¯¸ì§€ëŠ” ê¸°ì¡´ CNN ê³„ì‚°ê³¼ Depthwise seperable convolutionì„ ë¹„êµí•œ ì´ë¯¸ì§€ë‹¤. 

![mobile4](https://user-images.githubusercontent.com/77332628/204940901-1cad8a89-e587-4f1b-ac68-64b52733dbd1.png)

ì—°ì‚°ëŸ‰ì„ ë¹„êµí•´ë³´ë©´ ê¸°ì¡´ conv ì—°ì‚°ëŸ‰ì€ 

![mobile5](https://user-images.githubusercontent.com/77332628/204940905-a8333882-6b00-4d50-aaeb-f81a016d5792.png) 

ì´ê³ , Depthwise seperable convolutionì˜ ì—°ì‚°ëŸ‰ì€ Depthwise convolutionì˜ ì—°ì‚°ëŸ‰ê³¼ Pointwise convolutionì˜ ì—°ì‚°ëŸ‰ì„ ë”í•˜ë©´ ë˜ê¸° ë•Œë¬¸ì— ë‹¤ìŒê³¼ ê°™ë‹¤.

![mobile6](https://user-images.githubusercontent.com/77332628/204940906-cbfd14dd-1276-4d89-84a6-c2aef1f5afaf.png)

ì´ëŠ” ê¸°ì¡´ conv ê³„ì‚°ì˜ ì—°ì‚°ëŸ‰ë³´ë‹¤ ì•½ 8ë°°ì •ë„ ì ê¸° ë•Œë¬¸ì— ê²½ëŸ‰í™”ê°€ ê°€ëŠ¥í•˜ë‹¤.

#### 9.1.2 MobileNet Architecture

MobileNetì˜ êµ¬ì¡°ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

![mobile7](https://user-images.githubusercontent.com/77332628/204940909-89245b70-afa0-4a37-ac86-b82c32df4506.png)

ì²« ë²ˆì§¸ convë¥¼ ì œì™¸í•˜ê³ ëŠ” depthwise seperable convolutionì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. ë˜í•œ ë§ˆì§€ë§‰ FCì¸µì„ ì œì™¸í•˜ê³  ëª¨ë“  ì¸µì— BN, ReLUë¥¼ ì‚¬ìš©í•˜ê³ , ë‹¤ìš´ ìƒ˜í”Œë§ì€ depthwise convolutionì¸µê³¼ ì²«ë²ˆì§¸ conv ì¸µì—ì„œ ì‚¬ìš©í•œë‹¤.ì´ 28ê°œì˜ layerë¥¼ ê°–ëŠ”ë‹¤.

#### 9.1.3 í•˜ì´í¼íŒŒë¼ë¯¸í„°
MobileNet ëª¨ë¸ì˜ latencyì™€ accuracyë¥¼ ì¡°ì ˆí•˜ëŠ” ë‘ê°œì˜ í•˜ì´í¼íŒŒë¼ë¯¸í„°ê°€ ìˆë‹¤.

1. Width Multiplier : Thinner Models

ì²« ë²ˆì§¸ í•˜ì´í¼íŒŒë¼ë¯¸í„° Î±ëŠ” ëª¨ë¸ì˜ ë‘ê»˜ë¥¼ ê²°ì •í•œë‹¤. ì»¨ë¸Œë„·ì—ì„œ ëª¨ë¸ì˜ ë‘ê»˜ëŠ” ê° ë ˆì´ì–´ì—ì„œì˜ í•„í„° ìˆ˜ë¥¼ ì˜ë¯¸í•œë‹¤. Î±ëŠ” ë” ì–‡ì€ ëª¨ë¸ì´ í•„ìš”í•  ë•Œ ì‚¬ìš©í•œë‹¤. ì…ë ¥ ì±„ë„ Mê³¼ ì¶œë ¥ ì±„ë„ Nì— ì ìš©í•˜ë©´ Î±M, Î±Nì´ ë˜ê³  ì—°ì‚°ëŸ‰ì€ ë‹¤ìŒê³¼ ê°™ì´ ëœë‹¤.

![mobile8](https://user-images.githubusercontent.com/77332628/204940913-9c68191a-0d10-4816-a658-777d41d49d6a.png)

Î±ì˜ ë²”ìœ„ëŠ” [0,1]ì´ê³ , Î±ì˜ ê°’ì„ ë‚®ì¶”ë©´ ëª¨ë¸ì˜ íŒŒë¼ë¯¸í„° ìˆ˜ê°€ ê°ì†Œí•œë‹¤. ê¸°ë³¸ MobileNetì€ 1ì„ ì‚¬ìš©í•œë‹¤. ë‹¤ìŒì€ Î±ì˜ ê°’ì— ë”°ë¥¸ ì •í™•ë„ì™€ íŒŒë¼ë¯¸í„° ìˆ˜ë¥¼ ì •ë¦¬í•œ í‘œë‹¤.

![mobile9](https://user-images.githubusercontent.com/77332628/204940915-f19647b0-1fb7-4e7d-90c3-4d79a3718c06.png)

2. Resolution Multiplier : Reduced Representation

Resolution Multiplier ÏëŠ” ëª¨ë¸ì˜ ì—°ì‚°ëŸ‰ì„ ê°ì†Œì‹œí‚¤ê¸° ìœ„í•´ ì‚¬ìš©í•œë‹¤. ÏëŠ” ì…ë ¥ ì´ë¯¸ì§€ì— ì ìš©í•´ì„œ í•´ìƒë„ë¥¼ ë‚®ì¶”ëŠ” ì—­í• ì„ í•œë‹¤. Ïì˜ ë²”ìœ„ ë˜í•œ [0,1]ì´ê³ , ê¸°ë³¸ MobileNetì€ Ï=1ì„ ì‚¬ìš©í•œë‹¤. ë‹¤ìŒì€ ì…ë ¥ ì´ë¯¸ì§€ í¬ê¸°ê°€ 224,192,169,128ì¼ë•Œ ì •í™•ë„ì™€ íŒŒë¼ë¯¸í„° ìˆ˜ë¥¼ ë¹„êµí•œ í‘œë‹¤.

![mobile10](https://user-images.githubusercontent.com/77332628/204940919-0ddbf3dc-11ab-4437-b467-997fdd65ad83.png)

#### 9.1.4 ë‹¤ë¥¸ ëª¨ë¸ê³¼ ë¹„êµ

ë‹¤ìŒì€ MobileNetê³¼ ë‹¤ë¥¸ ìœ ëª…í•œ ëª¨ë¸ë“¤ê³¼ ì •í™•ë„ì™€ íŒŒë¼ë¯¸í„° ìˆ˜ë¥¼ ë¹„êµí•œ í‘œë‹¤.

![mobile11](https://user-images.githubusercontent.com/77332628/204940921-826d3551-5084-4659-a7db-42de259de521.png)

### 9.2 MobileNetV2

ì´ë¦„ì—ì„œ ì•Œ ìˆ˜ ìˆë“¯ì´ MobileNetV2ëŠ” MobileNet(V1)ì˜ í›„ì†ì‘ì´ë‹¤. MobileNetV2ì€ ìˆ˜ì •ëœ Depthwise Seperable Convolutionì¸ Inverted Residualsê³¼ Linear Bottlenecksë¥¼ ì‚¬ìš©í•œ Convolution Blockì„ ì œì•ˆí•œë‹¤. 

#### 9.2.1 Inverted Residualsì™€ Linear Bottlenecksì˜ ë“±ì¥ ë°°ê²½

Inverted Residualsì™€ Linear Bottlenecksì€ ReLU í•¨ìˆ˜ë¥¼ ê±°ì¹˜ê²Œ ë˜ë©´ ì •ë³´ê°€ ì†ì‹¤ë˜ëŠ” ê²ƒì„ ìµœì†Œí™”í•˜ê¸° ìœ„í•´ ì œì•ˆë˜ì—ˆë‹¤. ReLUì˜ ì •ë³´ ì†ì‹¤ì— ëŒ€í•´ ì•Œì•„ë³´ë©´, ì±„ë„ ìˆ˜ê°€ ì ì€ ì…ë ¥ ê°’ì€ ReLU í•¨ìˆ˜ë¥¼ ê±°ì¹˜ë©´ ì •ë³´ê°€ ì†ì‹¤ë˜ì§€ë§Œ ì±„ë„ ìˆ˜ê°€ ë§ì€ ì…ë ¥ ê°’ì€ ReLU í•¨ìˆ˜ë¥¼ ê±°ì³ë„ ì •ë³´ê°€ ë³´ì¡´ëœë‹¤. ë”°ë¼ì„œ ReLU í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ë•ŒëŠ” í•´ë‹¹ layerì— ë§ì€ ì±„ë„ ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê³  í•´ë‹¹ ë ˆì´ì–´ì— ì±„ë„ ìˆ˜ê°€ ì ë‹¤ë©´ ReLU í•¨ìˆ˜ê°€ ì•„ë‹Œ linear í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤ëŠ” ì•„ì´ë””ì–´ê°€ MobileNetV2ì— ì‚¬ìš©ë˜ëŠ” ê¸°ë²•ë“¤ì˜ ë“±ì¥ ë°°ê²½ì´ë‹¤. ì•„ë˜ ì´ë¯¸ì§€ëŠ” ì±„ë„ ìˆ˜ì— ë”°ë¥¸ ReLU í•¨ìˆ˜ë¥¼ ê±°ì³¤ì„ ë•Œì˜ ì†ì‹¤ ì •ë„ë¥¼ ì‹¤í—˜ì ìœ¼ë¡œ ì¦ëª…í•œ ê²ƒì´ë‹¤.

![mobile12](https://user-images.githubusercontent.com/77332628/204940922-aaccddc4-e7ed-4bfd-82b0-6cf54d573099.png)

#### 9.2.2 Convolution Block for MobileNetV2

1. Linear Bottlenecks 

Bottleneck êµ¬ì¡°ëŠ” ResNetì—ì„œ ì—°ì‚°ëŸ‰ ê°ì†Œë¥¼ ìœ„í•´ ì œì•ˆëœ êµ¬ì¡°ì´ë‹¤. 9.2.1ì ˆì—ì„œ ì–¸ê¸‰í–ˆë“¯ì´ ì±„ë„ ìˆ˜ê°€ ì ì€ ë ˆì´ì–´ì—ëŠ” linear í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤. ë”°ë¼ì„œ ì´ BottleNeck êµ¬ì¡°ì— ì±„ë„ ìˆ˜ê°€ ì ì€ ë ˆì´ì–´ì—ëŠ” linear í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤. ë‹¤ìŒì€ ë¹„ì„ í˜• í•¨ìˆ˜ì™€ ì„ í˜• í•¨ìˆ˜ë¥¼ ì‚¬ìš©í–ˆì„ ë•Œ ì„±ëŠ¥ì„ ë¹„êµí•œ í‘œë‹¤.

![mobile13](https://user-images.githubusercontent.com/77332628/204940926-c2f5145e-0809-4a1d-9fab-c2beb3f6d90b.png)

ì„ í˜•í•¨ìˆ˜ë¥¼ ì‚¬ìš©í–ˆì„ ë•Œì˜ ì •í™•ë„ê°€ ë” ë†’ì€ ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.

2. Inverted residuals

ê¸°ì¡´ì˜ residual êµ¬ì¡°ëŠ” ì²«ë²ˆì§¸ 1x1 convì—ì„œ ì±„ë„ ìˆ˜ë¥¼ ê°ì†Œì‹œí‚¤ê³  3x3 convë¡œ ì „ë‹¬í•œë‹¤. ì´ë ‡ê²Œ ë˜ë©´ 1x1ì—ì„œ ì±„ë„ ìˆ˜ê°€ ê°ì†Œë˜ì—ˆê¸° ë•Œë¬¸ì— ReLU í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ì •ë³´ ì†ì‹¤ì´ ë°œìƒí•˜ê¸° ë•Œë¬¸ì— ì²«ë²ˆì§¸ ë ˆì´ì–´ì—ì„œ ì…ë ¥ê°’ì˜ ì±„ë„ ìˆ˜ë¥¼ ì¦ê°€ì‹œí‚¤ê³  3x3 conv ì¸µìœ¼ë¡œ ì „ë‹¬í•œë‹¤.

ë‹¤ìŒì€ ê¸°ì¡´ residual êµ¬ì¡°ì™€ inverted reisualêµ¬ì¡°ë¥¼ ë¹„êµí•œ ì´ë¯¸ì§€ë‹¤.

![mobile14](https://user-images.githubusercontent.com/77332628/204940931-7ab56318-30ae-4331-88c7-3d4c7f144afc.png)

3. ReLU6

MobileNetV2ì™€ MobileNetV1ì—ì„œëŠ” ReLU6 í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤. ì—°ì‚°ëŸ‰ ê°ì†Œ íš¨ê³¼ì— ë„ì›€ì„ ì¤€ë‹¤ê³  í•œë‹¤.

ReLU6í•¨ìˆ˜ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

![mobile15](https://user-images.githubusercontent.com/77332628/204940933-41f5e75d-7e2d-49c8-b79c-d1427e9a7db7.png)

ë‹¤ìŒì€ MobileNet(V1)ê³¼ MobileNetV2ì—ì„œ ì‚¬ìš©í•˜ëŠ” Convolution blockì„ ë¹„êµí•œ ì´ë¯¸ì§€ë‹¤. stride=2ì„ ì‚¬ìš©í•˜ëŠ” blockì€ ë‹¤ìš´ ìƒ˜í”Œë§ì„ ìœ„í•´ ì‚¬ìš©í•œë‹¤.

![mobile16](https://user-images.githubusercontent.com/77332628/204940937-76cc7268-2456-4cd6-9ef1-2179dd26d326.png)

#### 9.2.3 MobileNetV2ì˜ ì—°ì‚°

ìµœì¢…ì ìœ¼ë¡œ kì±„ë„ ì…ë ¥ ê°’ì€ 1x1 convë¥¼ ê±°ì³ tk ì±„ë„ë¡œ í™•ì¥ë˜ê³ , 3x3 convì— ì „ë‹¬ë˜ê³  linear 1x1 convë¥¼ ê±°ì³ì„œ k'ê°œë¡œ ì±„ë„ ìˆ˜ê°€ ê°ì†Œí•œë‹¤. ì—¬ê¸°ì„œ tëŠ” expansion factorì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ë„ì…ë˜ì—ˆê³  ë…¼ë¬¸ì—ì„œì˜ ì‹¤í—˜ì—ì„œëŠ” ëª¨ë‘ 6ìœ¼ë¡œ ì§€ì •ë˜ì–´ ì‚¬ìš©ë˜ì—ˆë‹¤.

![mobile17](https://user-images.githubusercontent.com/77332628/204940940-b83aac5d-a876-4a7b-a98e-52b4ba3aada8.png)

#### 9.2.4 MobileNetV2 architecture

ì²«ë²ˆì§¸ ë ˆì´ì–´ëŠ” ì¼ë°˜ì ì¸ convë¥¼ ì‚¬ìš©í•˜ê³ , ê·¸ ì´í›„ì— 18ê°œì˜ convolution blockì„ ìŒ“ì•˜ë‹¤. ì•„ë˜ í‘œì—ì„œ nì€ ê°™ì€ layerê°€ në²ˆ ë°˜ë³µí•´ì„œ ìŒ“ì˜€ë‹¤ëŠ” ê²ƒì´ê³ , cëŠ” ì¶œë ¥ ì±„ë„ ìˆ˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê²ƒì´ê³ , sëŠ” ê° blockì—ì„œ ì‚¬ìš©ëœ stridesì˜ ê°’ì´ë‹¤.

![mobile18](https://user-images.githubusercontent.com/77332628/204941504-55615669-9662-46cf-b95b-79165689bf9f.png)

#### 9.2.5 ë‹¤ë¥¸ ëª¨ë¸ë“¤ê³¼ ì„±ëŠ¥ë¹„êµ
ë‹¤ë¥¸ ê²½ëŸ‰í™” ëª¨ë¸ë“¤ì— ë¹„í•´ ë†’ì€ ì„±ëŠ¥ì„ ë³´ì´ê³  ë¹„êµì  ì ì€ parameterë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

![mobile19](https://user-images.githubusercontent.com/77332628/204940941-4d3ef7c5-3916-4831-8931-1f1180fbd89a.png)

