---
title : "ğŸ§¬ 1.6 ìƒë¬¼í•™ì  ì„œì—´ì˜ í´ë˜ìŠ¤"

categories:
    - Algorithm
tags:
    - [Bioinformatics, DNA, sequence, BioData]

toc : true
toc_sticky : true

date: 2021-12-31
last_modified_at: 2021-12-31
---

## 1.6 ìƒë¬¼í•™ì  ì„œì—´ì˜ í´ë˜ìŠ¤

ğŸ§¬ ì„œì—´ì„ ì²˜ë¦¬í•˜ëŠ” í•¨ìˆ˜ë“¤ë¡œ ì´ë£¨ì–´ì§„ <b>MySeq í´ë˜ìŠ¤</b> ìƒì„±

```py
# ì½”ëˆì„ ì•„ë¯¸ë…¸ì‚°ìœ¼ë¡œ ë²ˆì—­í•˜ê¸° ìœ„í•œ í‘œì¤€ ìœ ì „ ì½”ë“œ ë”•ì…”ë„ˆë¦¬ 

def translate_codon(cod):
    
    tc = {"GCT":"A", "GCC":"A", "GCG":"A",
          "TGT":"C", "TGC":"C",
          "GAT":"D", "GAC":"D",
          "GAA":"E", "GAG":"E",
          "TTT":"F", "TTC":"F",
          "GGT":"G", "GGC":"G", "GGA":"G", "GGG":"G",
          "CAT":"H", "CAC":"H",
          "ATA":"I", "ATT":"I", "ATC":"I",
          "AAA":"K", "AAG":"K",
          "TTA":"L", "TTG":"L", "CTT":"L", "CTC":"L", "CTA":"L", "CTG":"L",
          "ATG":"M", 
          "AAT":"N", "AAC":"N",
          "CCT":"P", "CCC":"P", "CCA":"P", "CCG":"P",
          "CAA":"Q", "CAG":"Q",
          "CGT":"R", "CGC":"R", "CGA":"R", "CGG":"R", "AGA":"R", "AGG":"R",
          "TCT":"S", "TCC":"S", "TCA":"S", "TCG":"S", "AGT":"S", "AGC":"S",
          "ACT":"T", "ACC":"T", "ACA":"T", "ACG":"T",
          "GTT":"V", "GTC":"V", "GTA":"V", "GTG":"V",
          "TGG":"W",
          "TAT":"Y", "TAC":"Y",
          "TAA":"_", "TAG":"_", "TGA":"_"}
          
    if cod in tc: return tc[cod]
    else: return None
```
```py
# ìƒë¬¼í•™ì  ì„œì—´ì˜ í´ë˜ìŠ¤

class MySeq:

    # MySeq í´ë˜ìŠ¤ì˜ ìš”ì†Œ : seq, seq_type-default : DNA
    def __init__(self, seq, seq_type = "DNA"):         
        self.seq = seq.upper()
        self.seq_type = seq_type
    
    # seqì˜ ê¸¸ì´ë¥¼ ë°˜í™˜
    def __len__(self):                                           
        return len(self.seq)
    
    # seqì˜ në²ˆì¨° ìš”ì†Œë¥¼ ë°˜í™˜
    def __getitem__(self, n):                                   
        return self.seq[n]
    
    # seqì„ ìŠ¬ë¼ì´ì‹±
    def __getslice__(self, i, j):                               
        return self.seq[i:j]
    
    # seq ë°˜í™˜
    def __str__(self):                                          
        return self.seq
    
    # seqì˜ seq_type ë°˜í™˜
    def get_seq_biotype(self):                                      
        return self.seq_type
    
    # seqì˜ ì •ë³´ ë°˜í™˜ - seq, biotype
    def show_info_seq(self):                                     
        print("Sequence: " + self.seq + " biotype: " + self.seq_type)
        
    # ì„œì—´ ì¢…ë¥˜ì— ë”°ë¥¸ í—ˆìš©ë¬¸ì 
    def alphabet(self):
        if(self.seq_type == "DNA"): return "ACGT"
        elif (self.seq_type == "RNA"): return "ACGU"
        elif (self.seq_type == "PROTEIN"): return "ACDEFGHIKLMNPQRSTVWY"
        else: return None

    # ì„œì—´ ê²€ì¦ 
    def validate(self):
        alp = self.alphabet()                             # alphabet() ë©”ì„œë“œë¥¼ ë°›ìŒ
        res = True
        i = 0
        while i < len(self.seq) and res:
            if self.seq[i] not in alp: res = False        # ì„œì—´ì´ í—ˆìš©ë¬¸ì ë‚´ì— ì—†ë‹¤ë©´ res = False
            else: i += 1                                  # ìˆìœ¼ë©´ ê³„ì† ì§„í–‰
        return res
    
    # DNAì„œì—´ì„ RNAì„œì—´ë¡œ ë°”ê¿”ì£¼ëŠ” ì „ì‚¬í•¨ìˆ˜ 
    def transcription(self):
        if(self.seq_type == "DNA"):
            return MySeq(self.seq.replace("T","U"), "RNA")  # seq_typeì„ RNAë¡œ replace
        else:
            return None
    
    # DNAì„œì—´ì˜ ì—­ìƒë³´ì„œì—´ì„ êµ¬í•˜ëŠ” í•¨ìˆ˜ 
    def reverse_comp(self):
        if(self.seq_type != "DNA"): return None
        comp = ""
        for c in self.seq:
            if (c == "A"): comp = "T" + comp
            elif (c == "T"): comp = "A" + comp
            elif (c == "C"): comp = "G" + comp
            elif (c == "G"): comp = "C" + comp
        return MySeq(comp, "DNA") 
    
  # ë‹¨ë°±ì§ˆì„ ë§Œë“œëŠ” ë²ˆì—­í•¨ìˆ˜ 
    def translate(self, iniPos = 0):
        if(self.seq_type != "DNA"): return None
        seq_aa = ""
        for pos in range(iniPos, len(self.seq)-2, 3):
            cod = self.seq[pos:pos+3]
            seq_aa += translate_codon(cod)      # MySeq í´ë˜ìŠ¤ì˜ ì™¸ë¶€í•¨ìˆ˜ translate_codon() - í´ë˜ìŠ¤ ì™¸ë¶€í•¨ìˆ˜ ì ‘ê·¼ ê°€ëŠ¥
        return MySeq(seq_aa, "PROTEIN")         # seq_type : PROTEIN
```

### 1.6.1. ì„œì—´ì˜ ìœ íš¨ì„± íŒë³„
* * *

ğŸ§¬ MySeq í´ë˜ìŠ¤ì˜ <b>validate( )</b> ë©”ì„œë“œ

```py
s1 = MySeq("ATGGGATCGTAGTCGTACTAGCTAGCTGATGGTACTCGATAGTCTACGTAGCTAGTGGTACTGGATGGTACTCAGTAACAT")
s2 = MySeq("MKVVLSVQERSVVSLL", "PROTEIN")
print(s1.validate(), s2.validate())    
```
```
>> True True
```
ìœ íš¨í•˜ì§€ ì•Šì€ ì„œì—´ì— ëŒ€í•´ì„œëŠ” ì•„ë˜ì™€ ê°™ì´ False ê°’ì„ ë°˜í™˜í•œë‹¤.
```py
s3 = MySeq("GTYSAFADASDBASDAF")
print(s3.validate())
```
```
>> False
```

### 1.6.2. ì „ì‚¬ / ì •ë³´
* * *

ğŸ§¬ MySeq í´ë˜ìŠ¤ì˜ <b>transcription( )</b> / <b>show_info_seq( )</b> ë©”ì„œë“œ 

```py
s1_rna = s1.transcription()
s1_rna.show_info_seq()
```
```
>> Sequence: AUGGGAUCGUAGUCGUACUAGCUAGCUGAUGGUACUCGAUAGUCUACGUAGCUAGUGGUACUGGAUGGUACUCAGUAACAU biotype: RNA
```

### 1.6.3. ì—­ìƒë³´ì„œì—´
* * *

ğŸ§¬ MySeq í´ë˜ìŠ¤ì˜ <b>reverse_comp( )</b> ë©”ì„œë“œ

```py
s1_reverse = s1.reverse_comp()
s1_reverse.show_info_seq()
```
```
>> Sequence: ATGTTACTGAGTACCATCCAGTACCACTAGCTACGTAGACTATCGAGTACCATCAGCTAGCTAGTACGACTACGATCCCAT biotype: DNA
```

### 1.6.4. ë²ˆì—­
* * *

ğŸ§¬ MySeq í´ë˜ìŠ¤ì˜ <b>translate( )</b> ë©”ì„œë“œ

```py
s1_prot_2 = s1.translate()
s1_prot_2.show_info_seq() 
```
```
>> Sequence: MGS_SY_LADGTR_ST_LVVLDGTQ_H biotype: PROTEIN
```  

ğŸ§¬ ì£¼ì–´ì§„ ì„œì—´ì´ ì£¼í˜•ê°€ë‹¥ì¸ì§€ ë¹„ì£¼í˜•ê°€ë‹¥ì¸ì§€ í™•ì‹¤í•˜ì§€ ì•Šìœ¼ë©´ ì—­ìƒë³´ì„œì—´ë„ ë²ˆì—­í•´ì„œ í™•ì¸í•œë‹¤.

```py
# ì—­ìƒë³´ì„œì—´ ë²ˆì—­
s1_prot = s1_reverse.translate()
s1_prot.show_info_seq() 
```
```
>> Sequence: MLLSTIQYH_LRRLSSTIS_LVRLRSH biotype: PROTEIN
```  
* * *
  

ğŸ§¬ ì´ë²ˆ í¬ìŠ¤íŒ…ìœ¼ë¡œ 1ì¥ì„ ëª¨ë‘ ë³µìŠµí•´ë³´ì•˜ë‹¤. ìƒë¬¼í•™ì  ì„œì—´ì„ ê¸°ë³¸ì ìœ¼ë¡œ ì²˜ë¦¬í•´ì„œ ì´ì œ ë˜ ë‹¤ë¥¸ ì‘ì—…ë“¤ì„ ê±°ì¹˜ê² ì§€ë§Œ, ë­ë“ ì§€ ì²˜ìŒë¶€í„° ì˜ ë¼ì›Œë†”ì•¼ ë’¤ì˜ ì¼ë„ ì˜ í’€ë¦°ë‹¤ê³  ìƒê°í•œë‹¤. ê±°ì°½í•œ ì•Œê³ ë¦¬ì¦˜ë“¤ì€ ì•„ë‹ˆì—ˆì§€ë§Œ ìƒëª…ë¿ë§Œ ì•„ë‹ˆë¼ ë‹¤ë¥¸ ì˜ì—­ì—ë„ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì•„ì´ë””ì–´ê°€ ì—¬ëŸ¬ê°œ ë‚˜ì˜¨ ê²ƒ ê°™ë‹¤. ê³µë¶€í•˜ë‹¤ê°€ ì¢…ì¢… ì™€ì„œ ì½ì–´ë´ì•¼ê² ë‹¤!!  

* * *
<div style="text-align: right">ğŸ’¡ Bioinformatics Algorithms(ì—ì´ì½˜ì¶œíŒ, 2020)ë¥¼ ê³µë¶€í•˜ê³  ê°œì¸ í•™ìŠµìš©ìœ¼ë¡œ ì •ë¦¬í•œ ìë£Œì…ë‹ˆë‹¤.</div>