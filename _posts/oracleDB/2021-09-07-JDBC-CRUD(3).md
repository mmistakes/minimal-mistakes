---
title:  "[Oracle DB] JDBC CRUD(3)"

categories:
  - oracleDB
tags:
  - [RDBMS,OracleDB,JDBC,JAVA]

toc: true
toc_sticky: true

date: 2021-09-07
last_modified_at: 2021-09-07

---

# Oracle DB- JDBC CRUD(3)
ê°œì¸ì ìœ¼ë¡œ ê³µë¶€í•˜ë©´ì„œ ì°¸ì¡°í•˜ë ¤ê³  ë§Œë“  í¬ìŠ¤íŠ¸ì…ë‹ˆë‹¤.
ìœ íŠœë¸Œ ë‰´ë ‰ì²˜ ë‹˜ì˜ ê°•ì˜ë¥¼ ì°¸ê³ í•˜ì˜€ìŠµë‹ˆë‹¤.


**í´ë”êµ¬ì¡°**
<br>
![image](https://user-images.githubusercontent.com/69495129/132339334-b9549691-a415-45b1-bc38-c165d48dc55e.png)
<br>

## CRUD ë¥¼ ë‹´ë‹¹í•˜ëŠ” ì„œë¹„ìŠ¤ í´ë˜ìŠ¤ ìƒì„±í•˜ê¸°
4ê°œì˜ ê¸°ëŠ¥ì„ ë‹´ê³ ìˆë‹¤. getListë¡œ List<Notice> ë¥¼ ë°˜í™˜í•œë‹¤. 
ì»¬ëŸ¼ë“¤ì„ ë‹´ì„ ìˆ˜ ìˆëŠ” ê°œë…ì ì¸ ê·¸ë¦‡ Notice ê°ì²´ë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤
ê·¸ë¦‡ì€ entity ë¼ê³  í•œí›„ Notice ë¼ëŠ” ê°ì²´ë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤ db ì˜ Column ì— ë“¤ì–´ê°€ëŠ” ì†ì„±ë“¤ì„ NoticeëŠ” ê°–ê³ ìˆì–´ì•¼í•œë‹¤.

``` java
package com.chanhyuk.app.entity;

import java.util.Date;

public class Notice {

    private int id;
    private String title;
    private String writerId;
    private Date regDate;
    private String content;
    private int hit;

    public int getId() {
        return id;
    }

    public String getTitle() {
        return title;
    }

    public String getWriterId() {
        return writerId;
    }

    public Date getRegDate() {
        return regDate;
    }

    public String getContent() {
        return content;
    }

    public int getHit() {
        return hit;
    }

    public void setId(int id) {
        this.id = id;
    }

    public void setTitle(String title) {
        this.title = title;
    }

    public void setWriterId(String writerId) {
        this.writerId = writerId;
    }

    public void setRegDate(Date regDate) {
        this.regDate = regDate;
    }

    public void setContent(String content) {
        this.content = content;
    }

    public void setHit(int hit) {
        this.hit = hit;
    }

    public Notice(int id, String title, String writerId, Date regDate, String content, int hit) {
        this.id = id;
        this.title = title;
        this.writerId = writerId;
        this.regDate = regDate;
        this.content = content;
        this.hit = hit;
    }

    public Notice(String title, String writerId, String content) {      // for insert constructor
        this.title = title;
        this.writerId = writerId;
        this.content = content;
    }

    public Notice(){

    }
}

  
```
  
ì•„ë˜ëŠ” ë„¤ê°€ì§€ CRUD ê¸°ëŠ¥ì„ ê°€ì§„ NoticeService.java ì´ë‹¤.
"[Oracle DB] JDBC CRUD(2)" ì—ì„œ CRUD method ì— ëŒ€í•œ ì†Œê°œëŠ” í•˜ì˜€ë‹¤. ë°‘ì— ì½”ë“œëŠ” 4ê°€ì§€ ì¢…í•©ì„¸íŠ¸ë¼ê³  ë³´ë©´ëœë‹¤.
url,uid,pwd,driver ê°™ì€ ì—¬ëŸ¬ë²ˆ ë°˜ë³µí•˜ëŠ” ìƒìˆ˜ë“¤ì€ ë³€ìˆ˜ë¡œ ëº´ì„œ ë³€ìˆ˜ë¡œ ì§€ì •í•´ë‘ì—ˆë‹¤.
ë‹¨ ì•„ë˜ 3ì¤„ì˜ ì½”ë“œëŠ” ê° ë©”ì†Œë“œì— í•œë²ˆì”© ê°ê° í˜¸ì¶œí•´ì¤˜ì•¼í•œë‹¤.
ë·°ë¥¼ ë§Œë“¤ì–´ì„œ ì¿¼ë¦¬ë¬¸ì„ ì‘ì„±í•´ì¤€ë‹¤ ë·°ë¥¼ ì‘ì„±í•˜ì§€ ì•Šìœ¼ë©´ ë³µì¡í•œ ì¿¼ë¦¬ë¬¸ì„ ì‘ì„±í•´ì•¼í•œë‹¤.
ì‚¬ìš©í•œ ë·°ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.
ë°‘ì˜ ì¿¼ë¦¬ëŠ” regdate ë¡œ ì •ë ¬í•˜ê³  ì¼ë ¨ë²ˆí˜¸ë¥¼ ë½‘ê³  ì‹¶ì€ë°. ë¨¼ì € NUM ì´ ì§€ì •ë˜ê³  ê·¸ í›„ regdate ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬ë˜ê¸°ë•Œë¬¸ì— ë‹¤ì‹œ ì¿¼ë¦¬ë¬¸ì„ ì‘ì„±í•œ ê²ƒì´ë‹¤.
  
``` sql
CREATE VIEW NOTICE_VIEW
AS
SELECT * FROM (
    SELECT ROWNUM NUM, N.* FROM(
        SELECT * FROM NOTICE ORDER BY REGDATE DESC
    ) N
);  
```
ê·¸ í›„ NOTICE_VIEWë¥¼ FROM ì ˆì— ë„£ëŠ” ë°©ë²•ìœ¼ë¡œ êµ¬í˜„í•˜ì˜€ë‹¤.  
  
``` java
Class.forName(driver);
Connection con = DriverManager.getConnection(url, uid, pwd);
PreparedStatement st = con.prepareStatement(sql);
```
  
  
``` java
package com.chanhyuk.app.service;

import com.chanhyuk.app.entity.Notice;

import java.sql.*;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

public class NoticeService {
    private String url = "jdbc:oracle:thin:@localhost:1521/xepdb1";
    private String uid = "id";
    private String pwd = "password";
    private String driver = "oracle.jdbc.driver.OracleDriver";

    public List<Notice> getList(int page, String field, String query) throws ClassNotFoundException, SQLException {

        int start = 1 + (page - 1) * 10;      // 1 , 11 , 21 , 31, ìˆ˜ì—´ ë“±ì°¨ìˆ˜ì—´
        int end = 10 * page;  // 10,20,30,40


        String sql = "SELECT * FROM NOTICE_VIEW WHERE "+ field +" LIKE ? AND NUM BETWEEN ? AND ?";

        Class.forName(driver);
        Connection con = DriverManager.getConnection(url, uid, pwd);
        PreparedStatement st = con.prepareStatement(sql);
        st.setString(1,"%"+query+"%");
        st.setInt(2, start);
        st.setInt(3, end);
        ResultSet rs = st.executeQuery();
        List<Notice> list = new ArrayList<Notice>();
        while (rs.next()) {
            int id = rs.getInt("ID");
            String title = rs.getString("TITLE");
            String writerId = rs.getString("WRITER_ID");
            Date regDate = rs.getDate("REGDATE");
            String content = rs.getString("CONTENT");
            int hit = rs.getInt("hit");

            Notice notice = new Notice(
                    id,
                    title,
                    writerId,
                    regDate,
                    content,
                    hit
            );

            list.add(notice);
        }


        rs.close();
        st.close();
        con.close();

        return list;
    }

    // Scalar ê°’ì„ ì–»ì–´ì˜¤ëŠ” í•¨ìˆ˜ => ë‹¨ì¼ê°’ì„ ì–»ì–´ì˜¤ëŠ” í•¨ìˆ˜
    public int getCount() throws ClassNotFoundException, SQLException {
        int count = 0;
        String sql = "SELECT COUNT(ID) COUNT FROM NOTICE";

        Class.forName(driver);
        Connection con = DriverManager.getConnection(url, uid, pwd);
        Statement st = con.createStatement();
        ResultSet rs = st.executeQuery(sql);
        if (rs.next()) {
            count = rs.getInt("COUNT");
        }
        rs.close();
        st.close();
        con.close();

        return count;
    }

    public int insert(Notice notice) throws ClassNotFoundException, SQLException {
        String title = notice.getTitle();
        String writerId = notice.getWriterId();
        String content = notice.getContent();

        String sql = "INSERT INTO notice (" +
                "    title," +
                "    writer_id," +
                "    content" +
                ") VALUES (?,?,?)";

        Class.forName(driver);
        Connection con = DriverManager.getConnection(url, uid, pwd);
//        Statement st = con.createStatement();
        PreparedStatement st = con.prepareStatement(sql);
        st.setString(1, title);
        st.setString(2, writerId);
        st.setString(3, content);
        int result = st.executeUpdate();

        st.close();
        con.close();

        return result;
    }

    public int update(Notice notice) throws ClassNotFoundException, SQLException {

        String title = notice.getTitle();
        String content = notice.getContent();
        int id = notice.getId();

        String sql = "UPDATE NOTICE SET " +
                "TITLE=?," +
                "CONTENT=?" +
                "WHERE ID=?";

        Class.forName(driver);
        Connection con = DriverManager.getConnection(url, uid, pwd);
//        Statement st = con.createStatement();
        PreparedStatement st = con.prepareStatement(sql);
        st.setString(1, title);
        st.setString(2, content);
        st.setInt(3, id);

        int result = st.executeUpdate();

        st.close();
        con.close();

        return result;
    }

    public int delete(int id) throws SQLException, ClassNotFoundException {


        String sql = "DELETE NOTICE WHERE ID=?";

        Class.forName(driver);
        Connection con = DriverManager.getConnection(url, uid, pwd);
//        Statement st = con.createStatement();
        PreparedStatement st = con.prepareStatement(sql);
        st.setInt(1, id);

        int result = st.executeUpdate();

        st.close();
        con.close();

        return result;
    }

}
```


ì‚¬ìš©ì UIë¥¼ ë§Œë“¤ì–´ì£¼ê¸°ìœ„í•´ ì›¹ í™˜ê²½ì´ ì•„ë‹Œ ì½˜ì†” í™˜ê²½ì„ êµ¬ì¶•í•´ì¤€ë‹¤
ì•„ë˜ì˜ ì½”ë“œëŠ” NoticeConsole.java ì´ë‹¤
  
``` java
  
package com.chanhyuk.app.console;

import com.chanhyuk.app.entity.Notice;
import com.chanhyuk.app.service.NoticeService;

import java.sql.SQLException;
import java.util.List;
import java.util.Scanner;

public class NoticeConsole {
    private NoticeService service;
    private int page;
    private String searchField;
    private String searchWord;


    public NoticeConsole() {
        service = new NoticeService();
        page = 1;
        searchField = "TITLE";
        searchWord = "";
    }


    public void printNoticeList() throws SQLException, ClassNotFoundException {
        List<Notice> list = service.getList(page, searchField, searchWord);
        int count = service.getCount();                             // ì´ ê²Œì‹œê¸€ ìˆ˜ë¥¼ ë‚˜íƒ€ëƒ„
        int lastPage = count / 10;
        lastPage = count % 10 == 0 ? lastPage : lastPage + 1;        // ë”±ë–¨ì–´ì§ˆê²½ìš° ì•„ë‹Œê²½ìš° ê³ ë ¤

        System.out.println("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€");
        System.out.printf("<ê³µì§€ì‚¬í•­> ì´ %d ê²Œì‹œê¸€\n", count);
        System.out.println("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€");

        for (Notice n : list) {
            System.out.println("ì‹¤í–‰");
            System.out.printf("%d. %s / %s / %s\n", n.getId(), n.getTitle(), n.getWriterId(), n.getRegDate());
        }
        System.out.println("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€");
        System.out.printf(" %d/%d pages \n", page, lastPage);

    }

    public int inputNoticeMenu() {
        Scanner scan = new Scanner(System.in);

        System.out.printf("< 1.ìƒì„¸ì¡°íšŒ/ 2.ì´ì „/3.ë‹¤ìŒ/4.ê¸€ì“°ê¸°/ 5.ê²€ìƒ‰/6.ì¢…ë£Œ >");
        String menu_ = scan.nextLine();
        int menu = Integer.parseInt(menu_);
        return menu;
    }

    public static void main(String[] args) {

    }

    public void movePrevList() {
        if (page == 1) {
            System.out.println("=========================");
            System.out.println("ì´ì „ í˜ì´ì§€ê°€ ì—†ìŠµë‹ˆë‹¤");
            System.out.println("=========================");

            return;
        }
        page--;
    }

    public void moveNextList() throws SQLException, ClassNotFoundException {

        int count = service.getCount();                             // ì´ ê²Œì‹œê¸€ ìˆ˜ë¥¼ ë‚˜íƒ€ëƒ„
        int lastPage = count / 10;                                  // ìœ„ì— printNoticeList í• ë•Œë„ ë°˜ë³µë˜ëŠ” 3ì¤„ì´ìˆë‹¤. í•˜ì§€ë§Œ ì—¬ê¸°ì„œ ë‹¤ì‹œì¨ì£¼ëŠ” ì´ìœ ëŠ”
        lastPage = count % 10 == 0 ? lastPage : lastPage + 1;       // ë‹¤ìŒí˜ì´ì§€ë¡œ ê°€ê¸°ë¥¼ ëˆ„ë¥¼ë•Œ ê·¸ ìˆœê°„ì— í˜ì´ì§€ ì´ë™ì„ ì œí•œí•´ì•¼í•˜ê¸° ë•Œë¬¸ì´ë‹¤
                                                                    // ì¦‰ ë‹¤ìŒì„ ëˆŒë €ì„ë•Œ ê·¸ ìˆœê°„ ì´ë¯¸ ë§ˆì§€ë§‰í˜ì´ì§€ë¼ë©´ ë‹¤ìŒí˜ì´ì§€ê°€ ì—†ë‹¤ê³ í•˜ê³  return ëœë‹¤.
        if (page == lastPage) {
            System.out.println("============");
            System.out.println("ë‹¤ìŒí˜ì´ì§€ê°€ì—†ìŠµë‹ˆë‹¤");
            System.out.println("============");
            return;
        }
        page++;
    }

    public void inputSearchWord() {
        Scanner scan = new Scanner(System.in);
        System.out.println("ê²€ìƒ‰ ë²”ì£¼(title/ content/writerId)ì¤‘ì— í•˜ë‚˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”");
        System.out.print(">");
        searchField = scan.nextLine();
        System.out.print("ê²€ìƒ‰ì–´ >");
        searchWord = scan.nextLine();

    }

    public void writeContent() throws SQLException, ClassNotFoundException {
        NoticeService service = new NoticeService();
        Scanner scan = new Scanner(System.in);
        System.out.println("ì œëª©");
        String newTitle = scan.nextLine();
        System.out.println("ì‘ì„±ì");
        String newWriterId = scan.nextLine();
        System.out.println("ë‚´ìš©");
        String newContent = scan.nextLine();
        Notice notice = new Notice(newTitle,newWriterId,newContent);
        int result = service.insert(notice);
        System.out.println(result);

    }
}

  
```
  
ì‹¤í–‰ì‹œí‚¬ ì‹¤í–‰íŒŒì¼ Program5.java ë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤
label break ë¬¸ì„ ì‚¬ìš©í–ˆë‹¤
case 6 ë²ˆì—ì„œ break EXIT; ì„ í•´ì„œ while ë¬¸ì´ ëë‚˜ë„ë¡ í–ˆë‹¤.  
``` java
package ex1.Program;

import com.chanhyuk.app.console.NoticeConsole;

import java.sql.SQLException;

public class Program5 {

    public static void main(String[] args) throws SQLException, ClassNotFoundException {
        NoticeConsole console = new NoticeConsole();
        //int page;

        EXIT:
        while (true){

            console.printNoticeList();
            int menu = console.inputNoticeMenu();

            switch (menu) {
                case 1:         //ìƒì„¸ì¡°íšŒ
                    break;
                case 2:         // ì´ì „
                    //page--;
                    console.movePrevList();
                    break;
                case 3:         // ë‹¤ìŒ
                    console.moveNextList();
                    //page++;
                    break;
                case 4:         // ê¸€ì“°ê¸°
                    console.writeContent();
                    break;
                case 5:         // ê²€ìƒ‰
                    console.inputSearchWord();
                    break;
                case 6:         // ì¢…ë£Œ
                    System.out.println("Bye~~");
                    break EXIT;
                default:
                    System.out.println("< ì‚¬ìš©ë°©ë²•  1~6 ê¹Œì§€ë§Œ ì…ë ¥í•´ì£¼ì„¸ìš”.> ");
                    break;
            }
        }
    }
}

```  
  
  
  
## Summary
 - ì˜ˆì™¸ì²˜ë¦¬ëŠ” UIì—ì„œ í•˜ëŠ”ê²ƒìœ¼ë¡œí•˜ê³  ì—ëŸ¬ë¥¼ throw í•´ì¤€ë‹¤.
 - ê°•ì˜ì—ì„œëŠ” ë°ì´í„°ì…ë ¥ insert ë¶€ë¶„ì„ ì²˜ë¦¬í•˜ì§€ ì•Šì•„ì„œ ì œê°€ ì„ì˜ë¡œ writeContent() method ë¥¼ ë§Œë“¤ì–´ì„œ ì²˜ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤.

***
<br>

    ğŸŒœ ì£¼ê´€ì ì¸ ê²¬í•´ê°€ ë‹´ê¸´ ê¸€ì…ë‹ˆë‹¤. ë‹¤ì–‘í•œ ì˜ê²¬ì´ ìˆìœ¼ì‹¤ ê²½ìš°
    ì–¸ì œë“ ì§€ ëŒ“ê¸€ í˜¹ì€ ë©”ì¼ë¡œ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ˜„

[ë§¨ ìœ„ë¡œ ì´ë™í•˜ê¸°](#){: .btn .btn--primary }{: .align-right}

