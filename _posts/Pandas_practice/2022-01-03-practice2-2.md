---
title : "ğŸ† 2. í–‰ì„±ì˜ ì—¬ëŸ¬ê°€ì§€ ì •ë³´ë¥¼ ì•Œì•„ë³´ì(2)"

categories:
    - Pandas_practice
tags:
    - [Pandas, Preprocessing, Visualization]

toc : true
toc_sticky : true

date: 2022-01-03
last_modified_at: 2022-01-03
---  

* * *
ğŸ† ì €ë²ˆ í¬ìŠ¤íŒ…ê³¼ ê°™ì€ planets ë°ì´í„°ë¥¼ ê°€ì§€ê³  ì „ì²˜ë¦¬ë¥¼ ì§„í–‰í•´ë³´ì.

## 1. ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°

```py
import pandas as pd

import seaborn as sns
planets = sns.load_dataset('planets')
planets.shape
```
```
>> (1035, 6)
```

```py
planets.head()
```
```
>>
        method	        number	orbital_period	mass	distance   year
0	Radial Velocity	1	269.300	        7.10	77.40	   2006
1	Radial Velocity	1	874.774	        2.21	56.95	   2008
2	Radial Velocity	1	763.000	        2.60	19.84	   2011
3	Radial Velocity	1	326.030	        19.40	110.62	   2007
4	Radial Velocity	1	516.220	        10.50	119.47	   2009
```  

```py
planets.info()
```
```
>>
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 1035 entries, 0 to 1034
Data columns (total 6 columns):
 #   Column          Non-Null Count  Dtype  
---  ------          --------------  -----  
 0   method          1035 non-null   object 
 1   number          1035 non-null   int64  
 2   orbital_period  992 non-null    float64
 3   mass            513 non-null    float64
 4   distance        808 non-null    float64
 5   year            1035 non-null   int64  
dtypes: float64(3), int64(2), object(1)
memory usage: 48.6+ KB
```
orbital_period / mass / distance ì—´ì— NaN ê°’ì´ ì¡´ì¬í•¨ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  
í•˜ì§€ë§Œ ì´ ê°’ë“¤ì€ ë‚˜ì¤‘ì— ìš°ë¦¬ê°€ ì›í•˜ëŠ” ë°ì´í„°ë¥¼ ì„ íƒí•˜ëŠ” ê²½ìš°ì— ì²˜ë¦¬í•´ì£¼ë„ë¡ í•˜ì.

## 2. Finding numbers per year by Redial Velocity since 1995

ğŸ† ì´ì „ í¬ìŠ¤íŒ…ì—ì„œ í–‰ì„±ì„ ê°€ì¥ ë§ì´ ë°œê²¬í•œ ê´€ì¸¡ë°©ë²•ì€ Radial Velocity ì„ì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.  
ğŸ† ì´ì œ ì´ ë°©ë²•ì´ ë…„ë„ë‹¹ ë°œê²¬í•œ í–‰ì„± ìˆ˜ëŠ” ëª‡ê°œì¸ì§€ ê·¸ ì¶”ì´ë¥¼ í•œë²ˆ ì•Œì•„ë³´ì.


```py
planets[planets['method'] == "Radial Velocity"].sort_values('year').head()
```
```
>>
        method	        number	orbital_period	mass	distance    year
441	Radial Velocity	1	83.888000	11.6800	40.57	    1989
16	Radial Velocity	1	4.230785	0.4720	15.36	    1995
62	Radial Velocity	1	3.313500	3.9000	15.60	    1996
64	Radial Velocity	4	4.617033	0.6876	13.47	    1996
25	Radial Velocity	1	116.688400	NaN	18.11	    1996
```

1989ë…„ë¶€í„° 2014ë…„ê¹Œì§€ ì—¬ëŸ¬ê°œì˜ í–‰ì„±ë“¤ì„ ë°œê²¬í•œ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  
í•˜ì§€ë§Œ 1989ë…„ê³¼ 1995ë…„ì˜ ê¸°ê°„ì´ ìƒë‹¹íˆ ê¸¸ê³ , 1989ë…„ì— ë°œê²¬ëœ í–‰ì„± ìˆ˜ê°€ í•˜ë‚˜ ë¿ì´ê¸° ë•Œë¬¸ì— 1995ë…„ë¶€í„° ì§‘ê³„ë¥¼ í•˜ëŠ” ê²ƒì´ ê¹”ë”í•  ìˆ˜ë„ ìˆì„ê±° ê°™ë‹¤.  
ì¼ë‹¨ì€ planets ë°ì´í„°í”„ë ˆì„ì—ì„œ í•„ìš”í•œ method, number, year ì—´ë§Œ ê°€ì ¸ì™€ì„œ Radial Velocity ë§Œì„ í•„í„°ë§í•´ë³´ì.

```py
planets_number_year = planets[['method', 'number', 'year']].copy()
planets_number_year_Radial =  planets_number_year[planets_number_year['method']=='Radial Velocity']
planets_number_year_Radial.head()
```
```
>>
        method	        number	year
0	Radial Velocity	1	2006
1	Radial Velocity	1	2008
2	Radial Velocity	1	2011
3	Radial Velocity	1	2007
4	Radial Velocity	1	2009
```
ì´ì œ í•„ìš”í•œ ë°ì´í„°ë§Œ ê°€ì ¸ì˜¬ ì°¨ë¡€ë‹¤.  
planets_number_year_Radial ë°ì´í„°í”„ë ˆì„ì€ ì–´ì°¨í”¼ Radial Velocity ë§Œì„ í•„í„°ë§í•œ ë°ì´í„°ì´ê¸° ë•Œë¬¸ì— ìš°ì„  method ì—´ì„ ì‚­ì œí•´ì„œ ê°„ëµí™”í•´ì£¼ì.  
ê·¸ ë‹¤ìŒì—ëŠ” yearì—´ì„ ê¸°ì¤€ìœ¼ë¡œ ê·¸ë£¹í™”í•˜ê³  sumìœ¼ë¡œ ì§‘ê³„í•´ì¤€ë‹¤.  
ê·¸ë¦¬ê³  ì¸ë±ìŠ¤ë¥¼ .sort_index() í•¨ìˆ˜ë¡œ ì •ë ¬í•˜ë©´ ê¹”ë”í•œ ë°ì´í„°ê°€ ë‚˜ì˜¨ë‹¤. 

```py
del planets_number_year_Radial['method']
planets_number_year_Radial = planets_number_year_Radial.groupby('year').sum().sort_index()
planets_number_year_Radial.head()
```
```
>>
        number
year	
1989	1
1995	1
1996	15
1997	1
1998	11
```
ë§ˆì§€ë§‰ìœ¼ë¡œ 1995ë…„ ì´ì „ì˜ ë…„ë„ë¥¼ ì—†ì• ì£¼ê¸° ìœ„í•´ì„œ ìŠ¬ë¼ì´ì‹±ì„ í•´ì£¼ì. 

```py
planets_number_year_Radial = planets_number_year_Radial[1:]
planets_number_year_Radial.head()
```
```
>>
        number
year	
1995	1
1996	15
1997	1
1998	11
1999	24
```

### 2.1. iplot ì‹œê°í™”
* * *

ğŸ† ë…„ë„ì— ë”°ë¥¸ ì¶”ì„¸ë¥¼ í•œëˆˆì— ì•Œì•„ë³´ê¸° ì‰½ê²Œ line ê·¸ë˜í”„ë¥¼ ê·¸ë ¤ë³´ì.

```py
import chart_studio.plotly as py
import cufflinks as cf
cf.go_offline(connected = True)
```

#### 2.1.1. Bar graph
* * *

```py
layout = {
    'title' : {'text' : '<b>Finding numbers per year in Redial Velocity since 1995</b>', 
    'font' : {'size':25}, 'x':0.5, 'y':0.9},
    
    'xaxis' : {'showticklabels' : True, 'dtick': 1, 'title' : {'text' : 'Year', 'font' : {'size' : 15}}},
    
    'yaxis' : {'showticklabels' : True, 'title' : {'text' : 'Number', 'font' : {'size' : 15}}}
}

planets_number_year_Radial.iplot(kind = 'scatter', mode = 'lines+markers', layout = layout)
```

<p align="center"><img src="https://user-images.githubusercontent.com/65170165/147881206-d214db7e-b1b4-4824-99c4-a7897d8873f2.png" width="1000" /></p>

### 2.2. plotly ì‹œê°í™”
* * *

ğŸ† ê°€ì¥ ë§ì€ í–‰ì„±ì„ ë°œê²¬í•œ í•´ë¥¼ ì•Œì•„ë³´ê¸° ì‰½ê²Œ bar ê·¸ë˜í”„ì™€ line ê·¸ë˜í”„ë¥¼ ë§Œë“¤ì–´ë³´ì.

```py
import plotly.graph_objects as go
import plotly.offline as pyo
pyo.init_notebook_mode()
```

#### 2.2.1. Bar graph 

```py
colors = ['#03658C',] * len(planets_number_year_Radial.index)
colors[16] = '#F29F05'
```

```py
fig = go.Figure()
fig.add_trace(
    go.Bar(
        x = planets_number_year_Radial.index, y = planets_number_year_Radial['number'],
        text = planets_number_year_Radial['number'], 
        textposition='inside', texttemplate = '%{text}', textfont=dict(color = 'white', size = 10),
        marker_color = colors))

fig.update_layout({
    'title' : {'text' : '<b>Finding numbers per year in Redial Velocity since 1995</b>', 
    'font' : {'size':25}, 'x':0.5, 'y':0.9},

    'xaxis' : {'showticklabels' : True, 'dtick' : 1, 'title' : {'text' : 'Year', 'font' : {'size' :  15}}},
    'yaxis' : {'showticklabels' : True, 'title' : {'text' : 'Year', 'font' : {'size' :  15}}},
    'template' : 'plotly_white'
})

fig.add_annotation(
            x = 2011, y = 180,
            text = '<b>2011 : 176</b>',
            showarrow = True,
            font = {'size' : 10, 'color' : '#ffffff'},
            align = 'center',
            arrowhead = 2,
            arrowsize = 1,
            arrowwidth = 2,
            arrowcolor = '#F29F05',
            ax = 40, ay = -30,
            bordercolor = '#F29F05',
            borderwidth = 2,
            borderpad = 4,
            bgcolor = '#F29F05',
            opacity = 0.8
)
fig.show()
```

<p align="center"><img src="https://user-images.githubusercontent.com/65170165/147881214-7a7783bf-3b56-4a27-b4a7-0d4ef27210c3.png" width="1000" /></p>

#### 2.2.2. Line graph

```py
fig = go.Figure()
fig.add_trace(
    go.Scatter(
        x = planets_number_year_Radial.index, y = planets_number_year_Radial['number'], mode = 'lines+markers'))

fig.update_layout({
    'title' : {'text' : '<b>Finding numbers per year in Redial Velocity since 1995</b>', 
    'font' : {'size' : 25}, 'x' : 0.5, 'y' : 0.9},
    
    'xaxis' : {'showticklabels' : True, 'dtick' : 1, 'title' : {'text' : 'Year', 'font' : {'size' :  15}}},
    'yaxis' : {'showticklabels' : True, 'title' : {'text' : 'Year', 'font' : {'size' :  15}}},
    'template' : 'ggplot2'
})

fig.add_annotation(
            x = 2011, y = 180,
    
            text = '<b>2011 : 176</b>',
            showarrow = True,
            font = {'size' : 10, 'color' : '#ffffff'},
    
            align = 'center',
            arrowhead = 2,
            arrowsize = 1,
            arrowwidth = 2,
            arrowcolor = '#F22E62',
            
    
            ax = 40, ay = -30,
            bordercolor = '#F22E62',
            borderwidth = 2,
            borderpad = 4,
            bgcolor = '#F22E62',
            opacity = 0.8
)

fig.show()
```

<p align="center"><img src="https://user-images.githubusercontent.com/65170165/147881224-7791ca86-91b9-4546-91b5-9dd3bc58df83.png" width="1000" /></p>

* * *

ğŸ† ì´ë ‡ê²Œ í¬ìŠ¤íŒ… ë‘ê°œë¥¼ í†µí•´ì„œ í–‰ì„± ë°ì´í„°ë¥¼ ì „ì²˜ë¦¬í•˜ê³  ì‹œê°í™”í•˜ëŠ” ê³¼ì •ì„ í™•ì¸í•´ë³´ì•˜ë‹¤.  
ğŸ† ì´ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ë©´ì„œ ì•„ì‰¬ìš´ ì ì€ ìš°ì£¼ í–‰ì„±ì˜ ë°ì´í„°ì´ë‹¤ ë³´ë‹ˆ ê° íŠ¹ì§•ë“¤ ê°„ì˜ ê´€ê³„ê°€ ê±°ì˜ ì—†ë‹¤ëŠ” ì ì´ì—ˆë‹¤. ì§ˆëŸ‰ì´ ì–´ëŠ ì •ë„ì¼ë•Œ ê¶¤ë„ì£¼ê¸°ëŠ” ì–´ëŠ ì •ë„ì´ë‹¤ ë¼ëŠ” ê´€ê³„ê°€ ìˆì„ ì¤„ ì•Œì•˜ëŠ”ë° ë°ì´í„°ì˜ í—¤ë“œë§Œ ë³´ì•„ë„ ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” ê²ƒì„ ì‰½ê²Œ ì•Œ ìˆ˜ ìˆì—ˆë‹¤. ë¬¼ë¡  ëª©ì ì— í•„ìš”í•œ ì—´ì—ëŠ” ê²°ì¸¡ì¹˜ê°€ ì—†ëŠ” ê¹”ë”í•œ ë°ì´í„°ì˜€ì§€ë§Œ, ê³µë¶€í•˜ëŠ” ì…ì¥ì—ì„œëŠ” ì•½ê°„ ì•„ì‰¬ì›€ì´ ìˆì—ˆë‹¤.  
ğŸ† í•˜ì§€ë§Œ Line ê·¸ë˜í”„ë¥¼ ê·¸ë¦¬ê³  ì§ì ‘ annotationì„ í•˜ëŠ” ê³¼ì •ì´ ì¬ë°Œì—ˆë‹¤ã…ã…
