---
title : "π†π† 3. λ―Έκµ­ μ—°λ„λ³„ μ¶μƒ λΉλ„λ¥Ό μ•μ•„λ³΄μ (1)"

categories:
    - Pandas_practice
tags:
    - [Pandas, Preprocessing, Visualization]

toc : true
toc_sticky : true

date: 2022-03-01
last_modified_at: 2022-03-01
---  

* * *
π† λ―Έκµ­ μ§λ³‘ κ΄€λ¦¬μ²­(CDC) μ—μ„ μ κ³µν•λ” μ¶μƒ μΈκµ¬ μλ¥Ό κ°€μ§€κ³  λ°μ΄ν„° λ¶„μ„μ„ μ§„ν–‰ν•΄ λ³΄μ.  

π† μ΄λ² ν¬μ¤ν…μ—μ„λ” <a>pd . to_datetime( )</a> ν•¨μλ¥Ό μ‚¬μ©ν•λ” λ²•κ³Ό μ¤‘κ°„ λ¶€λ¶„μ λ°μ΄ν„°λ¥Ό μ¬λΌμ΄μ‹± ν•λ” λ²•μ„ μ¤‘μ μΌλ΅ μ§„ν–‰ν•λ‹¤.
* * *

## 1. λ°μ΄ν„° λ¶λ¬μ¤κΈ°

```py
import pandas as pd
birth = pd.read_csv("Data/births.csv", encoding = 'utf-8-sig')
birth.head()
```
```
>>
	year	month	day	    gender	births
0	1969	1	    1.0	    F	    4046
1	1969	1	    1.0	    M	    4440
2	1969	1	    2.0	    F	    4454
3	1969	1	    2.0	    M	    4548
4	1969	1	    3.0	    F	    4548
```  

λ…„, μ›”, μΌ, μ„±λ³„, μ¶μƒ μμ λ°μ΄ν„°λ¥Ό κ°€μ§€λ” κ²ƒμ„ ν™•μΈν•μ.  

## 2. λ°μ΄ν„° μ „μ²λ¦¬ν•κΈ°

```py
birth.info()
```
```
>>
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 15547 entries, 0 to 15546
Data columns (total 5 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   year    15547 non-null  int64  
 1   month   15547 non-null  int64  
 2   day     15067 non-null  float64
 3   gender  15547 non-null  object 
 4   births  15547 non-null  int64  
dtypes: float64(1), int64(3), object(1)
memory usage: 607.4+ KB
```  

μ„μ info( ) ν•¨μ μ¶λ ¥μΌλ΅λ¶€ν„° dayμ— λ€ν• μ •λ³΄κ°€ μ—†λ” κ²ƒμ„ ν™•μΈν•  μ μλ‹¤. μ–΄λ κµ¬κ°„μ΄ κ²°μΈ΅μΉλ¥Ό κ°–λ”μ§€ ν™•μΈν•κΈ° μ„ν•΄ <a>.isnull( )</a> ν•¨μλ¥Ό μ‚¬μ©ν•΄λ³΄μ.  

```py
birth[birth['day'].isnull()]
```
```
>>

        year	month	day	    gender	births
15067	1989	1	    NaN	    F	    156749
15068	1989	1	    NaN	    M	    164052
15069	1989	2	    NaN	    F	    146710
15070	1989	2	    NaN	    M	    154047
15071	1989	3	    NaN	    F	    165889

...	...	...	...	...	 ...

15542	2008	10	    NaN	    M	    183219
15543	2008	11	    NaN	    F	    158939
15544	2008	11	    NaN	    M	    165468
15545	2008	12	    NaN	    F	    173215
15546	2008	12	    NaN	    M	    181235

480 rows Γ— 5 columns
```  

μ΄λ ‡κ² 1989 ~ 2008 κΈ°κ°„μ€ day μ— λ€ν• μ •λ³΄κ°€ μ—†μμ„ ν™•μΈν•  μ μλ‹¤. μ•μΌλ΅ μμ„ μ „μ²λ¦¬ κ³Όμ •μ€ birth λ°μ΄ν„°ν”„λ μ„μ„ 1989λ…„ μ΄μ „κ³Ό μ΄ν›„λ΅ λ‚λ μ„ μ§„ν–‰ν•  κ²ƒμ΄λ‹¤.  

λ°μ΄ν„°ν”„λ μ„μ„ λ‚λ„λ” λ°©λ²•μ€ μ „ν€ μ–΄λ µμ§€ μ•λ‹¤. μ–΄μ°¨ν”Ό μΈλ±μ‹±μ΄ λ‹¤ λμ–΄ μλ” μƒνƒμ΄κΈ° λ•λ¬Έμ— μΈλ±μ¤λ΅ <a>μ¬λΌμ΄μ‹±</a> μ„ ν•΄μ£Όλ©΄ λλ‹¤.  

μΈλ±μ¤ λ²νΈ 15067μ΄ 1989λ…„λ„μ μ²«λ²μ§Έ λ°μ΄ν„°λ¥Ό μλ―Έν•λ―€λ΅ κ·Έ μ•κΉμ§€ μ¬λΌμ΄μ‹±ν•λ©΄ 1988λ…„λ„κΉμ§€μ λ°μ΄ν„°λ¥Ό μ–»μ„ μ μλ‹¤.  

```py
birth_til_1988 = birth[:15067]
```  

μ΄μ  μ΄ λ°μ΄ν„°λ¥Ό λ‚¨μ„±κ³Ό μ—¬μ„±μΌλ΅ λ‚λ„λ” μ „μ²λ¦¬λ¥Ό μ§„ν–‰ν•λ‹¤.  

π† 1969 ~ 1988 μ—¬μ„± μ¶μƒ λ°μ΄ν„°
```py
birth_til_1988_F = birth_til_1988[birth_til_1988['gender'] == 'F'].copy()
birth_til_1988_F = birth_til_1988_F.groupby(by = ['year', 'month']).aggregate({'births' : 'sum'})
birth_til_1988_F = birth_til_1988_F.reset_index()
birth_til_1988_F.tail()
```
```
>>
    year	month	births
235	1988	8	    173088
236	1988	9	    169923
237	1988	10	    162361
238	1988	11	    153134
239	1988	12	    157444
```  

π† 1969 ~ 1988 λ‚¨μ„± μ¶μƒ λ°μ΄ν„°
```py
birth_til_1988_M = birth_til_1988[birth_til_1988['gender'] == 'M'].copy()
birth_til_1988_M = birth_til_1988_M.groupby(by = ['year', 'month']).aggregate({'births' : 'sum'})
birth_til_1988_M = birth_til_1988_M.reset_index()
birth_til_1988_M.tail()
```
```
>>
    year	month	births
235	1988	8	    181511
236	1988	9	    177354
237	1988	10	    169272
238	1988	11	    161532
239	1988	12	    164883
```  


π† 1989 ~ 2008 μ—¬μ„± μ¶μƒ λ°μ΄ν„°
```py
birth_after_1989 = birth[15067:]
birth_after_1989_F = birth_after_1989[birth_after_1989['gender']=="F"].copy()
birth_after_1989_F = birth_after_1989_F[['year','month','births']].copy()
birth_after_1989_F.head()
```
```
>>
        year	month	births
15067	1989	1	    156749
15069	1989	2	    146710
15071	1989	3	    165889
15073	1989	4	    155689
15075	1989	5	    163800
```  


π† 1989 ~ 2008 λ‚¨μ„± μ¶μƒ λ°μ΄ν„°
```py
birth_after_1989_M = birth_after_1989[birth_after_1989['gender']=="M"].copy()
birth_after_1989_M = birth_after_1989_M[['year','month','births']].copy()
birth_after_1989_M.head()
```
```
>>
        year	month	births
15068	1989	1	    164052
15070	1989	2	    154047
15072	1989	3	    174433
15074	1989	4	    163432
15076	1989	5	    172892
```  

λ§μ§€λ§‰μΌλ΅ μ„±λ³„λΌλ¦¬ λ°μ΄ν„°ν”„λ μ„μ„ ν•©μ³μ£Όμ.  

```py
birth_F = pd.concat([birth_til_1988_F, birth_after_1989_F])
birth_M = pd.concat([birth_til_1988_M, birth_after_1989_M])
```  

* * *
π† μ„μ κ³Όμ •μ„ ν†µν•΄μ„ μ›ν•λ” ν•νƒμ λ°μ΄ν„°λ¥Ό λ§λ“λ” λ°μ— μ„±κ³µν–λ‹¤. λ‹¤μ ν¬μ¤ν…μ—μ„λ” μ΄λ¥Ό λ°”νƒ•μΌλ΅ μ•„λμ λ°μ΄ν„°λ¶„μ„ μ‘μ—…μ„ μ§„ν–‰ν•΄ λ³΄μπ.  
- μ—°λ„λ³„ λ‚¨μ„± / μ—¬μ„± μ¶μƒ μ λΉ„κµ  
- μ”μΌλ³„ μ¶μƒ μ¶”μ΄ ν™•μΈ  
- 1969λ…„ μΌλ³„ μ¶μƒ μ¶”μ΄ νμ•…  
- λ¶„κΈ°λ³„ μ¶μƒ μ¶”μ΄ (1969 ~ 2008)    

* * *
<div style="text-align: left">π’΅νμ΄μ¬ λ°μ΄ν„° μ‚¬μ΄μ–Έμ¤ ν•Έλ“λ¶(μ„ν‚¤λ¶μ¤,2020)μ μ €μ Jake VanderPlas λ¶„μ κΉƒν—λΈμ—μ„ λ°μ΄ν„°λ¥Ό κ°€μ Έμ™”μμ„ λ°ν™λ‹λ‹¤.</div>
