---
title : "ğŸ† 2. í–‰ì„±ì˜ ì—¬ëŸ¬ê°€ì§€ ì •ë³´ë¥¼ ì•Œì•„ë³´ì (3)"

categories:
    - Pandas_practice
tags:
    - [Pandas, Preprocessing, Visualization, plotly]

toc : true
toc_sticky : true

date: 2022-03-02
last_modified_at: 2022-03-02
---  
* * *

ğŸ† ì˜¤ëœë§Œì— ë‹¤ë£¨ëŠ” í–‰ì„± ë°ì´í„°ë‹¤. ì‚¬ì‹¤ ì´ë ‡ê²Œ í•œë²ˆ ë” ë‹¤ë£°ë§Œí¼ ì¤‘ìš”í•œ ë°ì´í„°ëŠ” ì•„ë‹ˆë¼ê³  ìƒê°í–ˆì—ˆëŠ”ë°, í—ˆë¦¬ë””ìŠ¤í¬ë¡œ ëˆ„ì›ŒìˆëŠ” ë™ì•ˆ ì•„ì‰¬ìš´ ì ì„ ìƒê°í•´ë³´ë‹ˆ ì‹œê°í™”ë§Œ í•´ë†“ê³  ê·¸ ë°ì´í„°ê°€ ì˜ë¯¸í•˜ëŠ” ë°”ë¥¼ ì •í™•íˆ ë¶„ì„í•´ë³¸ ì ì€ ì—†ì—ˆë‹¤ëŠ” ê²ƒì´ ë– ì˜¬ëë‹¤. ê·¸ ì´ìœ ë¡œ ì´ë ‡ê²Œ ë‘ë‹¬ì •ë„ ì „ì— ë‹¤ë¤˜ë˜ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ë´¤ë‹¤ğŸ˜‰.  

ğŸ† ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” plotly ì‹œê°í™”ì—ì„œ forë¬¸ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ì†Œê°œí•œë‹¤.  
* * *


## 1. forë¬¸ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²½ìš°

ğŸ† ë¨¼ì € ì´ì „ í¬ìŠ¤íŒ…ì—ì„œ ì‹œê°í™”í•œ ê·¸ë˜í”„ë¥¼ ê°€ì ¸ì˜¤ë„ë¡ í•˜ì. í–‰ì„± ë°ì´í„°ì—ì„œ ë‹¤ë¥¸ ë¶„ì„ì„ í•´ì•¼ê² ë‹¤ê³  ìƒê°í•˜ê²Œ í•œ ê°€ì¥ í° ì´ìœ ì´ë‹¤.  

<p align="center"><img src="https://user-images.githubusercontent.com/65170165/156333694-39921cce-85d4-4c91-a636-6e404fd1220d.png" width="1000" /></p>  

ğŸ† ìœ„ì˜ ë§‰ëŒ€ê·¸ë˜í”„ë¥¼ ë³´ë©´ ì•Œê² ì§€ë§Œ Radial Velocity ì™€ Transit ì„ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ê´€ì¸¡ë°©ë²•ì€ ê·¸ë ‡ê²Œ ëˆˆì— ë„ëŠ” ê´€ì¸¡ ìˆ˜ë¥¼ ë³´ì´ì§€ëŠ” ëª»í•œë‹¤(ë¬¼ë¡  í–‰ì„±ì˜ ë°œê²¬ í•˜ë‚˜í•˜ë‚˜ê°€ ìš°ì£¼ ì—­ì‚¬ì— ìˆì–´ ëª¹ì‹œ í° ì—…ì ì´ì§€ë§Œ ì´ ë°ì´í„°ì—ì„œëŠ” ë°°ì œí•œë‹¤). ë‹¨ì§€ ì € ë‘ê°œì˜ ê´€ì¸¡ë²•ë§Œì´ ë§ì€ ê°œìˆ˜ë¥¼ ê°€ì§€ê³  ìˆìŒì´ ë°ì´í„°ë¶„ì„ì—ì„œ ì˜ë¯¸ê°€ í° ê²ƒì€ ì•„ë‹ˆê¸° ë•Œë¬¸ì—, ë‹¤ë¥¸ ë¶„ì„ë²•ì„ í•„ìš”ë¡œ í•œë‹¤. ê·¸ë˜ì„œ ìƒê°í•œ ë°©ë²•ì´ ë…„ë„ë³„ë¡œ ê´€ì¸¡ë²•ì˜ ì¶”ì´ë¥¼ ì•Œì•„ë³´ëŠ” ê²ƒì´ë‹¤. ê·¸ëŸ¬ë©´ ì„¸ì›”ì˜ íë¦„ì— ë”°ë¼ ë‘ê°ì„ ë‚˜íƒ€ë‚´ëŠ” ê´€ì¸¡ë²•ê³¼ ìƒˆë¡­ê²Œ ë– ì˜¤ë¥´ëŠ” ê´€ì¸¡ë²•ì„ ì•Œì•„ë³´ê¸°ì— ì¢‹ì„ ê²ƒì´ë¼ ìƒê°í•˜ê¸° ë•Œë¬¸ì´ë‹¤. ê·¸ëŸ¼ ì´ì œ ì‹œì‘í•´ë³´ìğŸƒâ€â™‚ï¸.  
* * *

ì¼ë‹¨ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì.  

```py
import pandas as pd
import seaborn as sns

planets = sns.load_dataset('planets')
planets.head()
```
```
>>
	method	        number	orbital_period	mass	distance    year
0	Radial Velocity	1	269.300	        7.10	77.40	    2006
1	Radial Velocity	1	874.774	        2.21	56.95	    2008
2	Radial Velocity	1	763.000	        2.60	19.84	    2011
3	Radial Velocity	1	326.030	        19.40	110.62	    2007
4	Radial Velocity	1	516.220	        10.50	119.47	    2009
```  

ìš°ë¦¬ëŠ” 2ê°œì˜ í˜•íƒœë¡œ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•  ê²ƒì´ê¸° ë•Œë¬¸ì— ë°ì´í„°í”„ë ˆì„ì˜ ì´ë¦„ì„ _1 / _2 ë¡œ ëª…ëª…í•˜ê² ë‹¤.   

```py
planets_year_method_1 = planets.groupby(['method', 'year']).agg({'number':'sum'})
planets_year_method_1 = planets_year_method_1.reset_index()
planets_year_method_1
```  
```
>> 
        method	                        year	number
0	Astrometry	                2010	1
1	Astrometry	                2013	1
2	Eclipse Timing Variations	2008	4
3	Eclipse Timing Variations	2009	1
4	Eclipse Timing Variations	2010	4
...	...	                        ...	...
64	Transit	                        2014	93
65	Transit Timing Variations	2011	2
66	Transit Timing Variations	2012	2
67	Transit Timing Variations	2013	2
68	Transit Timing Variations	2014	3

69 rows Ã— 3 columns
```  

method, year, number ì—´ì„ ê°€ì§€ëŠ” planets_year_method_1 ë°ì´í„°í”„ë ˆì„ì´ ì™„ì„±ë˜ì—ˆë‹¤ğŸ˜‰.  

ë¨¼ì € Bar ê·¸ë˜í”„ë¡œ ì‹œê°í™”í•´ë³´ì.  

```py
import plotly.graph_objects as go
import plotly.offline as pyo
pyo.init_notebook_mode()

fig = go.Figure()
fig.add_trace(
        go.Bar(
            x = planets_year_method_1[planets_year_method_1['method']=='Imaging']['year'],
            y = planets_year_method_1[planets_year_method_1['method']=='Imaging']['number'], name = 'Imaging'))

fig.add_trace(
        go.Bar(
            x = planets_year_method_1[planets_year_method_1['method']=='Radial Velocity']['year'],
            y = planets_year_method_1[planets_year_method_1['method']=='Radial Velocity']['number'], name = 'Radial Velocity'))

fig.add_trace(
        go.Bar(
            x = planets_year_method_1[planets_year_method_1['method']=='Eclipse Timing Variations']['year'],
            y = planets_year_method_1[planets_year_method_1['method']=='Eclipse Timing Variations']['number'], name = 'Eclipse Timing Variations'))

fig.add_trace(
        go.Bar(
            x = planets_year_method_1[planets_year_method_1['method']=='Transit']['year'],
            y = planets_year_method_1[planets_year_method_1['method']=='Transit']['number'], name = 'Transit'))

fig.add_trace(
        go.Bar(
            x = planets_year_method_1[planets_year_method_1['method']=='Microlensing']['year'],
            y = planets_year_method_1[planets_year_method_1['method']=='Microlensing']['number'], name = 'Microlensing'))
fig.show()
```  

ìš°ì„  forë¬¸ì„ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— ë§ì€ ê´€ì¸¡ìˆ˜ë¥¼ ê°€ì§€ëŠ” 5ê°œì˜ ë°ì´í„°ë§Œ ì‹œê°í™”í•´ë´¤ë‹¤. ê²°ê³¼ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.  

<p align="center"><img src="https://user-images.githubusercontent.com/65170165/156353696-4ccf329b-580b-4144-b868-2e90e93d852d.png" width="1000" /></p>  

ë§‰ëŒ€ê·¸ë˜í”„ì— ë„ˆë¬´ ë§ì€ ë‚´ìš©ì´ ë“¤ì–´ ìˆì–´ í•œëˆˆì— ì•Œì•„ë³´ê¸° ì–´ë µë‹¤. ì „ì²´ì ì¸ ì¶”ì´ë¥¼ ìœ„í•´ line ê·¸ë˜í”„ë¥¼ í•œë²ˆ ê·¸ë ¤ë³´ì.  

```py
fig = go.Figure()
fig.add_trace(
        go.Scatter(
            x = planets_year_method_1[planets_year_method_1['method']=='Imaging']['year'],
            y = planets_year_method_1[planets_year_method_1['method']=='Imaging']['number'], name = 'Imaging', mode = 'lines'))

fig.add_trace(
        go.Scatter(
            x = planets_year_method_1[planets_year_method_1['method']=='Radial Velocity']['year'],
            y = planets_year_method_1[planets_year_method_1['method']=='Radial Velocity']['number'], name = 'Radial Velocity', mode = 'lines'))

fig.add_trace(
        go.Scatter(
            x = planets_year_method_1[planets_year_method_1['method']=='Eclipse Timing Variations']['year'],
            y = planets_year_method_1[planets_year_method_1['method']=='Eclipse Timing Variations']['number'], name = 'Eclipse Timing Variations', mode = 'lines'))

fig.add_trace(
        go.Scatter(
            x = planets_year_method_1[planets_year_method_1['method']=='Transit']['year'],
            y = planets_year_method_1[planets_year_method_1['method']=='Transit']['number'], name = 'Transit', mode = 'lines'))

fig.add_trace(
        go.Scatter(
            x = planets_year_method_1[planets_year_method_1['method']=='Microlensing']['year'],
            y = planets_year_method_1[planets_year_method_1['method']=='Microlensing']['number'], name = 'Microlensing', mode = 'lines'))
fig.show()
```
<p align="center"><img src="https://user-images.githubusercontent.com/65170165/156354257-74177fc9-4999-4cc2-92d4-a297bb82dfab.png" width="1000" /></p>   

ğŸ‘‰ ì´ë ‡ê²Œ ì‹œê°í™”í•˜ë‹ˆ í™•ì‹¤íˆ ì „ì²´ì ì¸ ëª¨ì–‘ì´ ì˜ ë³´ì¸ë‹¤. Radial Velocity ëŠ” 1990ë…„ëŒ€ë¶€í„° ê¾¸ì¤€íˆ ê·¸ ë‘ê°ì„ ë³´ì—¬ì™”ê³  Transit ì€ 2000ë…„ëŒ€ ì´ˆë°˜ë¶€í„° ì ì°¨ì ìœ¼ë¡œ ì„±ì¥í•˜ë”ë‹ˆ 2010ë…„ëŒ€ ë“¤ì–´ì„œ ìš°ì„¸í•œ ê´€ì¸¡ì¹˜ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. ë‚˜ë¨¸ì§€ ì„¸ê°œì˜ ê´€ì¸¡ë²•ì€ ìµœê·¼ ë“¤ì–´ì„œ ëª¨ìŠµì„ ë³´ì´ëŠ” ë°©ë²•ì¸ ë“¯í•˜ë‹¤. í•œë‘ê°€ì§€ ë°©ë²•ì— ì˜ì¡´í•˜ì§€ ì•Šê³  ë‹¤ë¥¸ ê¸°ìˆ ì´ ë°œë‹¬í•˜ê³  ìˆëŠ” ê·¸ë˜í”„ë¼ê³  í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤.  

## 2. for ë¬¸ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°

ğŸ† ì´ë²ˆì—ëŠ” for ë¬¸ì„ ì´ìš©í—¤ë³´ì. ì‚¬ì‹¤ ì´ëŸ°ì €ëŸ° ì±…ì„ ì°¸ê³ í•˜ê±°ë‚˜ êµ¬ê¸€ë§ì„ í•´ì„œ ì°¾ì•„ë´ë„ plotly ì—ì„œ for ë¬¸ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ ì˜ ë‚˜ì˜¤ì§€ ì•Šì•„ì„œ ë‹µë‹µí–ˆëŠ”ë°, êµ³ì´ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì´ìœ ë¥¼ ì´ë²ˆì— ì•Œ ìˆ˜ ìˆì—ˆë˜ ê²ƒ ê°™ë‹¤(ì•„ë‹ˆë©´ êµ‰ì¥íˆ ë†’ì€ í™•ë¥ ë¡œ ë‚´ê°€ ëª¨ë¥´ëŠ” ê±°ëŒœ...ğŸ˜¢).  

ë°”ë¡œ ì‹œê°í™”í•´ë³´ì.  

```py
fig = go.Figure()
for i in planets_year_method_1['method']:
    fig.add_trace(
        go.Scatter(
            x = planets_year_method_1[planets_year_method_1['method']==i]['year'],
            y = planets_year_method_1[planets_year_method_1['method']==i]['number'], name = i, mode = 'lines'))
    
fig.show()
```  

ğŸ”‘ ìœ„ì— ë³´ì´ëŠ” ëŒ€ë¡œ forë¬¸ ì•ˆì— add_trace() ëª…ë ¹ì–´ì™€ graph_object ê°ì²´(go.âšª)ë¥¼ ë„£ì–´ì„œ ê·¸ë˜í”„ ê°ì²´ë¥¼ for ë£¨í”„ë§Œí¼ ìƒì„±í•˜ëŠ” ê²ƒì´ë‹¤. ê·¸ëŸ¬ë©´ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.   

<p align="center"><img src="https://user-images.githubusercontent.com/65170165/156355845-5f114d99-0910-4fbc-93b0-2a9a792d1be1.png" width="1000" /></p>   

ìœ„ì˜ ê·¸ë˜í”„ì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ì´ ê°™ì€ method ì´ì§€ë§Œ ì¤‘ë³µë˜ëŠ” legned ë¥¼ ê°€ì§€ê³  ìˆëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤. ì‹¬ì§€ì–´ legned ìƒì— ì¤‘ë³µëœ ìƒ‰ê¹”ë„ ìˆë‹¤ğŸ˜‚. ê·¸ë˜ì„œ ë‚˜ëŠ” ì´ ìƒí™©ì„ columnì— ìˆëŠ” ëª¨ë“  ë°ì´í„°ë¥¼ ë¬¼ëŸ¬ì˜¤ëŠë¼ ìƒê¸´ ì¼ì´ë¼ ìƒê°í•˜ê³  method ë¥¼ ì¸ë±ìŠ¤ë¡œ <a>groupby</a> í•˜ë©´ í•´ê²°í•  ìˆ˜ ìˆì§€ ì•Šì„ê¹Œ ì˜ˆìƒí–ˆë‹¤. ì½”ë“œì™€ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.  

```py
planets_year_method_2 = planets.groupby(['method', 'year']).agg({'number':'sum'})
planets_year_method_2
```
```
>>
                                        number
method                  	year	
Astrometry	                2010	1
                                2013	1
Eclipse Timing Variations	2008	4
                                2009	1
                                2010	4
...	                        ...	...
Transit	                        2014	93
Transit Timing Variations	2011	2
2012	2
2013	2
2014	3

69 rows Ã— 1 columns
```  

ìœ„ì˜ ê²°ê³¼ ë°ì´í„°í”„ë ˆì„ì„ ë³´ë©´ method ì™€ year ê°€ ì¸ë±ìŠ¤ë¡œ ë“¤ì–´ê°€ ìˆê³  number ë§Œ column ìœ¼ë¡œ ì§€ì •ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì´ì œ ìœ„ì˜ ë°©ë²•ì²˜ëŸ¼ for ë¬¸ì„ ëŒë ¤ë³´ì.  

```py
fig = go.Figure()
for i in range(len(planets_year_method_2.index)):
    fig.add_trace(
        go.Scatter(
            x = pd.Series(planets_year_method_2.index[i][1]),
            y = pd.Series(planets_year_method_2['number'][i]),
            name = planets_year_method_2.index[i][0], mode = 'lines + markers'))
    
fig.show()
```  

<p align="center"><img src="https://user-images.githubusercontent.com/65170165/156357151-da99affa-d4e3-4f8a-9fd2-b4e95e4e0521.png" width="1000" /></p>  

ì´ì œëŠ” ì‹¬ì§€ì–´ line ë„ ì•ˆ ê·¸ë ¤ì¤€ë‹¤(...) ê·¸ë˜ì„œ ë‚´ ìƒê°ìœ¼ë¡œëŠ” plotly ì—ì„œ for ë¬¸ì„ ì‚¬ìš©í•˜ë ¤ë©´ ì¤‘ë³µë˜ëŠ” ë°ì´í„°ë¥¼ ê°€ì§€ê³  ìˆëŠ” column ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ìì œí•˜ê±°ë‚˜ legend ë¥¼ ê·¸ë¦¬ì§€ ì•ŠëŠ” ë°©ë²•ì´ ìˆì„ ê²ƒ ê°™ë‹¤. ë¬¼ë¡  ì´ì œ ê·¸ì € ê±¸ìŒë§ˆë¥¼ ë–¼ê³  ìˆëŠ” í•™ìƒì´ê³ , ì•ìœ¼ë¡œ ë°°ì›Œë‚˜ê°€ì•¼ í•  ê²ƒì´ ë„ˆë¬´ ë§ì§€ë§Œ ì¼ë‹¨ ë‚´ ì§§ì€ ì†Œê²¬ìœ¼ë¡œëŠ” ê·¸ë ‡ë‹¤.  
* * *

ğŸ† ê·¸ë˜ë„ ì´ë ‡ê²Œ plotly ì—ì„œ for loop ëŒë¦¬ëŠ” ë°©ë²•ì„ ì•Œê²Œ ë˜ì—ˆìœ¼ë‹ˆ ë§Œì¡±í•œë‹¤!! ë‚˜ì¤‘ì— ì´ì— ëŒ€í•œ í•´ê²°ì±…ì„ ë°œê²¬í•˜ë©´ í–‰ë³µí•˜ê²Œ ë‹¤ì‹œ í•œë²ˆ í¬ìŠ¤íŒ… í•´ë´ì•¼ê² ë‹¤.
