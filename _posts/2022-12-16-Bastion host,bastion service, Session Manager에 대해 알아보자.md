```yaml
title: "[AWS]bastion hostì™€ Session manager ê·¸ë¦¬ê³  bastion Service"
categories: AWS
tag: [AWS,ë„¤íŠ¸ì›Œí¬, network]
toc: true
author_profile: false
sidebar:
 nav: "docs"
#search: false
```

<img title="" src="../images/2022-12-16-Bastion%20host,bastion%20service,%20Session%20Managerì—%20ëŒ€í•´%20ì•Œì•„ë³´ì/8d78af3f911e518709cd8c7f3874e193755b6dd9.png" alt="bastion1.png" width="263" data-align="center">

# **bastion host, Session manager ê·¸ë¦¬ê³   bastion service**

[AWS Systems Manager Session Manager](https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager.html)

[Linux Bastion Hosts on AWS - ì†”ë£¨ì…˜](https://aws.amazon.com/ko/solutions/implementations/linux-bastion/)

## **Bastion host**

ì¼ë°˜ì ìœ¼ë¡œ bastion serverë¼ê³ ë„ í•˜ë©° OpenSSH ì„œë²„ ë˜ëŠ” RDP ê²Œì´íŠ¸ì›¨ì´ì™€ ê°™ì€ í”„ë¡œí† ì½œë³„ ì„œë²„ê°€ ìˆëŠ” ìµœì†Œí•œì˜ ìš´ì˜ ì²´ì œë¡œ êµ¬ì„±ëœë‹¤.

  

![bastion2.png](../images/2022-12-16-Bastion%20host,bastion%20service,%20Session%20Managerì—%20ëŒ€í•´%20ì•Œì•„ë³´ì/672a21b4150937f3dd1a64762cdc49c6b1bb246e.png)

  

  

**SSH Bastion host ëª¨ë²” ì‚¬ë¡€**

[14 Best Practices to Secure SSH Bastion Host](https://goteleport.com/blog/security-hardening-ssh-bastion-best-practices/)

ì´ê²ƒì €ê²ƒ ì½ì–´ë³´ë©´ì„œ ì •ë¦¬í•œ Bastion hostì˜ ë‹¨ì ìœ¼ë¡œëŠ” ìš°ì„  ê´€ë¦¬í•  ì „ìš©ì„œë²„ê°€ í•„ìš”í•˜ë‹¤. AWSì˜ ê²½ìš° VMì¸ EC2ë¡œ ìƒì„±í•˜ì—¬ VPNê³¼ ì—°ê²°í•˜ê³¤ í•˜ëŠ”ë°, ë‹¨ìˆœíˆ ì í”„ìš©ë„ë¡œ ì‚¬ìš©í•˜ëŠ” ì¼€ì´ìŠ¤ê°€ ë§ë‹¤.

ë³¸ì¸ì€ í”„ë¡ì‹œ ìš©ë„ë¡œ í™œìš©í•˜ëŠ” bastion hostë¥¼ ë³´ë©´ì„œ í•´ì»¤ê°€ bastion hostì— ì¹¨íˆ¬í•  ìˆ˜ ìˆëŠ” ê²½ìš°, ë°©í™”ë²½ì„ ë¹„í™œì„±í™”í•  ìˆ˜ ìˆì§€ ì•Šì„ê¹Œë¼ëŠ” ìƒê°ì´ ë“¤ì—ˆë‹¤. êµ¬ê¸€ë§í•´ë³´ë‹ˆ Bastion hostê°€ ì†ìƒë˜ëŠ” ê²½ìš°ëŠ” ì í”„ìš©ë„ë¡œë§Œ ì“¸ ê²½ìš° í”ì¹˜ëŠ” ì•Šê³ , sudoë¥¼ ì½ì–´ ê´€ë¦¬ìì˜ íŒ¨ìŠ¤ì›Œë“œë¥¼ í•˜ì´ì¬í‚¹í•œ ê²½ìš°ê°€ ìˆì—ˆë‹¤ê³  í•œë‹¤. ê·¸ë˜ì„œ Bastion Hostì—ì„œ sudoë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ OTPì—ë§Œ ê°•ì œí•˜ë„ë¡ í•´ì•¼í•˜ê³  ì´ê²Œ í˜ë“¤ë©´ ì´ì¤‘ ì¸ì¦ì ˆì°¨(2FA)ë¥¼ ì“°ê¸¸ ê¶Œìœ í•œë‹¤. ë˜ ê°€ì¥ ì¢‹ì€ ë°©ë²•ì€ bastion hostë¥¼ ì½ê¸°ì „ìš© ì´ë¯¸ì§€ì—ì„œ ì‹¤í–‰í•˜ê³  ì—…ê·¸ë ˆì´ë“œë‚˜ ê´€ë¦¬ ì‘ì—…ì„ ì „í˜€ ìˆ˜í–‰í•˜ì§€ ëª»í•˜ê²Œ í•˜ëŠ” ê²ƒ ê°™ë‹¤. ì—¬ê¸°ì— ë‹¨ì¼ ê³„ì •ì´ ì•„ë‹ˆë¼ ê¶Œí•œì„ ê²©ë¦¬ì‹œí‚¤ë©´ ë” ì¢‹ì„ ê²ƒ ê°™ë‹¤.

ì´ì— Bastion hostê°€ ë¦¬ëˆ…ìŠ¤ë¼ë©´ Tripwire IDS(ì¹¨ì…ë°©ì§€ì‹œìŠ¤í…œ)ë¥¼ ì„¤ì¹˜í•´ì„œ ìŠ¹ì¸ë˜ì§€ì•Šì€ ì¼ì´ ë°œìƒí•˜ë©´ ì¦‰ì‹œ ì•Œë¦¬ë„ë¡í•˜ê³ , logwatch ì„¤ì¹˜ ë° í™œìš©ìœ¼ë¡œ í•˜ì´ì¬í‚¹í•˜ëŠ” ì¹¨ì…ìë¥¼ ì¡ëŠ” ê²ƒì´ ì–´ì©Œë©´ ì—”ì§€ë‹ˆì–´ê°€ í•  ìˆ˜ ìˆëŠ” ìµœì„ ì´ë¼ëŠ” ìƒê°ì´ ë“ ë‹¤.

[Securing the Linux filesystem with Tripwire](https://opensource.com/article/18/1/securing-linux-filesystem-tripwire)

## AWS System Managerì˜ Session Managerê¸°ëŠ¥

AWSëŠ” bastion host ì—†ì´ í”„ë¼ì´ë¹— ì¸í”„ë¼ì— ì•ˆì „í•˜ê²Œ ì—°ê²°í•  ìˆ˜ ìˆëŠ” ìƒˆë¡œìš´ AWS Systems Manager(Session Manager) ê¸°ëŠ¥ì„ ì¶œì‹œí–ˆë‹¤. ì•¡ì„¸ìŠ¤ ì œì–´ë¥¼ ì¤‘ì•™ ì§‘ì¤‘í™”í•˜ê³  ì¸ë°”ìš´ë“œ ì•¡ì„¸ìŠ¤ë¥¼ ì¤„ì„ìœ¼ë¡œì¨ ë³´ì•ˆ ë° ê°ì‚¬ ìƒíƒœê°€ í¬ê²Œ í–¥ìƒëœë‹¤ê³  AWSëŠ” ê°•ì¡°í•œë‹¤.

ì´ëŸ¬í•œ Bastion hostì˜ ìœ ìŠ¤ì¼€ì´ìŠ¤ì™€ ë¹„êµí•˜ì—¬ Session Managerë¥¼ ì‚¬ìš©í•˜ì—¬ SSH í‚¤ ë˜ëŠ” SSH ì¸ì¦ì„œë¥¼ ì²˜ë¦¬í•˜ê³  SSH ì„œë²„ë¥¼ ë…¸ì¶œí•˜ê³  ë°©í™”ë²½ ê·œì¹™ì„ ì²˜ë¦¬í•˜ì—¬ ì•¡ì„¸ìŠ¤ë¥¼ í•„í„°ë§í•˜ëŠ” ë°©ì‹ì´ ë¹„ìš©, ê´€ë¦¬, ìš´ì˜, ë³´ì•ˆ ì¸¡ë©´ì—ì„œ ì¢‹ì€ê²Œ ì•„ë‹Œê°€?ë¼ëŠ” ì˜ê²¬ì´ ìƒê²¨ë‚¬ê³  AWSì—ì„œë„ ëˆì„ë²Œê¸° ìœ„í•´ì„œì¸ì§€ëŠ” ëª¨ë¥´ê² ì§€ë§Œ ê·¸ë ‡ê²Œ ë§í•˜ëŠ” ê²ƒ ê°™ë‹¤.

**â€” AWS System Manager íŠ¹ì§•**

í„°ë„ë§ SSH ì—†ì´ SSMì„ ì‚¬ìš©í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì´ì ì´ ìˆë‹¤.

- ì„¸ì…˜ ì¤‘ì— ì‹¤í–‰ëœ ëª…ë ¹ê³¼ ê²°ê³¼ë¥¼ ê¸°ë¡í•©ë‹ˆë‹¤.Â Session Manager ë‚´ì—ì„œ SSHë¥¼ ì‚¬ìš©í•˜ë©´ ëª¨ë‘ ì•”í˜¸í™”
- SSH í‚¤ë¥¼ ê´€ë¦¬í•  í•„ìš”ê°€ ì—†ë‹¤
- Shell accessëŠ” IAM(Identity and Access Management) ì •ì±… ë‚´ì— ì™„ì „íˆ í¬í•¨ë˜ì–´ ìˆìœ¼ë¯€ë¡œ í•´ë‹¹ ì ‘ê·¼ì„ ì œì–´í•˜ëŠ” í•˜ë‚˜ì˜ í†µë¡œê°€ ìˆë‹¤
- ì›ê²© ì•¡ì„¸ìŠ¤ë¥¼ í™œì„±í™”í•˜ê¸° ìœ„í•´ ê³µìš© IP ì£¼ì†Œë¥¼ ê°€ìƒ ë¨¸ì‹ ê³¼ ì—°ê²°í•  í•„ìš”ëŠ” ì—†ë‹¤
- SSH ë‹¤ì¤‘í™” ê³µê²©ì˜ ê°€ëŠ¥ì„±ì„ ì œê±°
- IAM ìê²© ì¦ëª…ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤(ì˜ˆ: SSH ë˜ëŠ” RDP)ë¥¼ í†µí•©
- ì›ê²© ì•¡ì„¸ìŠ¤ë¥¼ ìœ„í•´ ë©”íƒ€ë°ì´í„° ë° ì „ì²´ ì„¸ì…˜ ë¡œê·¸(ê°€ëŠ¥í•œ ê²½ìš°)ë¥¼ ìº¡ì²˜
- Session ManagerëŠ” ì•¡ì„¸ìŠ¤ ë° ë¡œê¹…ê³¼ ê´€ë ¨ëœ ë‹¤ì–‘í•œ ì„œë¹„ìŠ¤ì— ëŒ€í•´ VPC ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì¸í„°ë„·ì— ëŒ€í•œ ë…¸ì¶œì´ ìµœì†Œí™”ë©ë‹ˆë‹¤

**â€” AWS System Managerêµ¬ì„± ì‹œ í•„ìš”í•œê²ƒ**

- **ë¡œê·¸**Â ë¥¼ ì €ì¥í•  S3 bucket
- **AWS System Manager logging**Â í™œì„±í™”
- ë¦¬ì†ŒìŠ¤ì—ì„œ SSMì„ í—ˆìš©í•˜ê³  ë¡œê·¸ë¥¼ bucketìœ¼ë¡œ ì „ì†¡Â í•˜ëŠ”Â **IAM ì—­í• **
- **SSM agent**Â ê°€ ìˆëŠ” EC2 ì¸ìŠ¤í„´ìŠ¤

ğŸ’¡ ìµœì†Œí•œ ë¡œê·¸ ì „ìš© AWS ê³„ì •ì´ ìˆëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

## Bastion Service

Bastion hostì—ì„œ ìƒˆë¡œìš´ ì§„í™”ë¼ê³  í•˜ëŠ” Bastion serviceê°€ ìˆë‹¤. (Bastion Serviceì— ëŒ€í•œ ì†Œê°œëŠ” Teleportì‚¬ì´íŠ¸ì—ì„œ ê°€ì ¸ì˜¨ í‘œë¡œ ëŒ€ì²´.)

| íŠ¹ì§•      | Bastion host                                          | Bastion Service                                                                          |
| ------- | ----------------------------------------------------- | ---------------------------------------------------------------------------------------- |
| ë°°í¬ ìœ í˜•   | ì „ìš© Linux ì„œë²„, VM, ë°©í™”ë²½                                  | í”Œë«í¼ì— êµ¬ì• ë°›ì§€ ì•ŠìŠµë‹ˆë‹¤.Â í´ë¼ìš°ë“œ ë„¤ì´í‹°ë¸Œ ì›Œí¬í”Œë¡œë¥¼ ì§€ì›í•˜ê³  ì„ì‹œ ì„œë¹„ìŠ¤ê°€ ë  ìˆ˜ ìˆìœ¼ë©° Kubernetesì— ë°°í¬í•˜ê±°ë‚˜ PaaSë¡œ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. |
| í† í´ë¡œì§€ ìœ í˜• | ì¼ë°˜ì ìœ¼ë¡œ ë‹¨ì¼ ì‚¬ì„¤ ë„¤íŠ¸ì›Œí¬ì— ì—°ê²°ë¨                                 | ë‹¤ì¤‘ í´ë¼ìš°ë“œ, ë‹¤ì¤‘ ë°ì´í„° ì„¼í„° í´ëŸ¬ìŠ¤í„°ë¥¼ ì§€ì›í•˜ì—¬ ìƒí˜¸ ì—°ê²°ëœ ì§€ë¦¬ì  ë²”ìœ„ ì•¡ì„¸ìŠ¤ í¬ì¸íŠ¸ë¥¼ í—ˆìš©í•©ë‹ˆë‹¤.                              |
| êµ¬ì„±í’ˆ     | ì—¬ëŸ¬ ì„œë¹„ìŠ¤(SSH, FTP, HTTP ë“±)ë¥¼ ì§€ì›í•˜ëŠ” ê°œë³„ êµ¬ì„± ìš”ì†Œ               | ì—¬ëŸ¬ í”„ë¡œí† ì½œì„ ì´í•´í•˜ê³  ìˆ˜ìš©í•˜ëŠ” ë‹¨ì¼ ì„œë¹„ìŠ¤                                                                |
| ë„¤íŠ¸ì›Œí¬ ë§¤í•‘ | ê°œì¸-ê³µìš© ë„¤íŠ¸ì›Œí¬ ë§¤í•‘                                         | ë‚´ë¶€ ì• í”Œë¦¬ì¼€ì´ì…˜ ë° ì„œë¹„ìŠ¤ ë§¤í•‘ì— ëŒ€í•œ ê³µìš© ë„¤íŠ¸ì›Œí¬.                                                          |
| ìš´ì†¡ ë³´ì•ˆ   | ì¼ë°˜ í…ìŠ¤íŠ¸ ì „ì†¡ ê°€ëŠ¥                                          | ì•”í˜¸í™”ëœ ì—°ê²°ë§Œ(ì£¼ë¡œ TLS)                                                                         |
| í”„ë¡œí† ì½œ ì¸ì‹ | ë„¤íŠ¸ì›Œí¬ ì¸ì‹                                               | í”„ë¡œí† ì½œ ë° ì• í”Œë¦¬ì¼€ì´ì…˜ ê¶Œí•œ ì¸ì‹                                                                      |
| ì…ì¦      | ë„¤íŠ¸ì›Œí¬ ê¸°ë°˜ ì•¡ì„¸ìŠ¤ ì œì–´.Â ì¶”ê°€ ì¸ì¦ì€ ì—°ê²° ì „ë‹¬ì„ ë‹´ë‹¹í•˜ëŠ” ì„œë¹„ìŠ¤(ì˜ˆ: SSH)ì— ë”°ë¼ ë‹¤ë¦„ | ê¸°ì—… IAMê³¼ í†µí•©ëœ ê¸°ë³¸ ì•¡ì„¸ìŠ¤ ì œì–´.Â í´ë¼ì´ì–¸íŠ¸ ì¸ì¦, ì¥ì¹˜ ì¦ëª…ì„ ì§€ì›                                               |

Bastion Serviceì— ê´€ì‹¬ì´ ìƒê¸´ ì´ìœ ëŠ” ë¬¸ì œ í•´ê²°ê³¼ íŒ¨ì¹˜ ë° ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•´ ë‹¨ìˆœíˆ sshë¥¼ ë¹„í™œì„±ì‹œí‚¤ëŠ” í™˜ê²½ì€ ìì²´ì ìœ¼ë¡œ ê´€ë¦¬í•˜ê¸° ì‰¬ìš´ ì‘ì—…í™˜ê²½ì´ ì•„ë‹ˆë©°, ê¸´ê¸‰ìƒí™©ì— ì„œë²„ì— ë¹ ë¥´ê²Œ ì•¡ì„¸ìŠ¤í•˜ê³ , ë””ë²„ê·¸ ë° ìˆ˜ì •í•˜ëŠ” ê¸°ëŠ¥ì„ ì“°ëŠ”ê³³ì´ ëŒ€ë¶€ë¶„ì´ê¸° ë•Œë¬¸ì— sshë¥¼ ê´€ë¦¬í•œë‹¤ëŠ” ì  ë•Œë¬¸ì´ë‹¤. ê·¸ë¦¬ê³  ë³´ì•ˆì„±ì´ ê°•í™”ëœ Bastion Serviceê°€ ì—¬ê¸°ì— íŠ¹í™”ë˜ì–´ ìˆë‹¤.

> **BastionÂ ì„œë¹„ìŠ¤ ëª‡ ê°€ì§€** : [BeyondCorp](https://cloud.google.com/beyondcorp)Â ,Â [Teleport](https://goteleport.com/how-it-works/)Â ,Â [Azure Bastion](https://docs.microsoft.com/en-us/azure/bastion/bastion-overview)

## **Teleport**

![bastion3.png](../images/2022-12-16-Bastion%20host,bastion%20service,%20Session%20Managerì—%20ëŒ€í•´%20ì•Œì•„ë³´ì/50c6fda7212b5a0f3bb57b91567d10ad123bb17b.png)



ì¶œì²˜: [How Teleport Works: Basic Concepts | Teleport](https://goteleport.com/how-it-works)

Bastion Service ì¤‘ TeleportëŠ” SSH ì„œë²„, Windows ì„œë²„ ë° desktop, Kubernetes í´ëŸ¬ìŠ¤í„°, ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ë˜ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë‹¤.

  

![bastion4.png](../images/2022-12-16-Bastion%20host,bastion%20service,%20Session%20Managerì—%20ëŒ€í•´%20ì•Œì•„ë³´ì/9d31ad065b475b173506c0508b8b3c4b39d06e21.png)



- ì¥ì 
  
  - SSH ëª…ë ¹ì–´ ë ˆì½”ë”© ê¸°ëŠ¥ê³¼ dbì¿¼ë¦¬ ë¡œê¹… ê¸°ëŠ¥
  
  - Teleport Webì—ì„œ Consoleë¡œ ì ‘ê·¼í•˜ì—¬ ssh ì ‘ê·¼ê°€ëŠ¥, tshë¼ëŠ” Teleport sshë¥¼ OSë³„ë¡œ ì„¤ì¹˜í•  ìˆ˜ ìˆì–´ì„œ ì„¸íŒ…ì´ ê°„í¸
  
  - ì´ì¤‘ ì¸ì¦ ì ˆì°¨(2FA)ë¥¼ ê¸°ë³¸ì ìœ¼ë¡œ ê°–ì¶”ê³  ìˆì–´ ë³´ì•ˆì´ ë›°ì–´ë‚¨(ì•ì„œ ì–˜ê¸°í•œ Bastion hostì˜ ë‹¨ì ì„ ë³´ì™„)

  

  

## ì§¤ë§‰í•œ ê²°ë¡ 

ì—¬ì°¨ì €ì°¨ ìµœê·¼ ì§„í–‰í•˜ëŠ” Peak Triffic Test í”„ë¡œì íŠ¸ì— AWS Session Manager ë¨¼ì € ë„ì…í•´ë³´ê³ ë‚˜ì„œ Teleportë¡œ ì ‘ê·¼ì œì–´í•˜ëŠ” ë°©ì‹ë„ í•œë²ˆ ì ìš©ì„ ê³ ë ¤í•´ë´ì•¼ê² ë‹¤.

[Teleport: Identity-Native Infrastructure Access. Faster. More Secure.](https://goteleport.com/)

ê·¸ì™¸ ìœ ìš©í•œ ë ˆí¼ëŸ°ìŠ¤

[New - Port Forwarding Using AWS System Manager Session Manager](https://aws.amazon.com/ko/blogs/aws/new-port-forwarding-using-aws-system-manager-sessions-manager/)

[Running a bastion host/jumpbox on Fargate](https://blog.deleu.dev/running-a-bastion-host-on-fargate/)

(ìš”ê±´ ECS fargate ì‚¬ìš©í•  ë•Œ ì°¸ê³ )
