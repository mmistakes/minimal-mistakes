---
layout: post
title: "calendar insert, ë‹¤ë¥¸ ë°ì´í„° select"
---

# formìœ¼ë¡œ ë‹¹ì¼ ë‚ ì§œì— ëŒ€í•œ todolist insert
1. calendar.htmlì—ì„œ ë²„íŠ¼ `input-data`ê°€ í´ë¦­ë˜ë©´ readForm í•¨ìˆ˜ ì‹¤í–‰  
```
    $("#input-data").click(function(){
        readForm("toDoList", "/toDoList");
    })
```

<br>

2. controller "toDoList" ë§Œë“¤ì–´ì„œ ì„œë¹„ìŠ¤ ì²˜ë¦¬  
ì–´ì°¨í”¼ ajaxê°€ toDoListë¡œ ë§¤í•‘ëœ ì»¨íŠ¸ë¡¤ëŸ¬ì—ê²Œ ë°ì´í„° ì „ë‹¬í•œë‹¤  
ê·¸ë¦¬ê³  ì´ì „ì—ë„ readForm í•¨ìˆ˜ëŠ” ì˜ ì‚¬ìš© ëê¸° ë•Œë¬¸ì— ìˆ˜ì • X  

```
    @Transactional
    @RequestMapping(value="/toDoList", produces="text/html;charset=UTF-8")
    @ResponseBody
    @PostMapping
    public String toDoListInsert(@RequestParam Map<String, String> params) throws ParseException{

        System.out.println("toDoListInsert");

        for (String key : params.keySet()) {
            System.out.println(key + " : " + params.get(key));
        }

        return "success";
    }
```
ajaxë¶€í„° ë°ì´í„° ê°€ì ¸ì˜¤ëŠ”ê±°X

<br>

# ì´ìŠˆì‚¬í•­
to_do_colorëŠ” ì‚¬ìš©ìì—ê²Œ ì–´ë–»ê²Œ ë°›ì„ ê²ƒì¸ì§€?  
ğŸ‘‰ `<input type:color>` ë¡œ ë°›ìœ¼ë©´ ëœë‹¤!

<br>

# ì§„í–‰í•´ì•¼í•  ê²ƒ
- í”„ë¡ íŠ¸  
(1) planDate form ì•ˆì— ì¶”ê°€ âœ”  

<br>

(2) hidden ì²˜ë¦¬ë¡œ setUpDate form ì•ˆì— ì¶”ê°€!!  
JSì—ì„œ todayë¥¼ html ìª½ìœ¼ë¡œ ë‚ ë ¤ì£¼ë©´ ë¨  
```
    const mainMonth = document.getElementById('main-month');
    mainMonth.innerHTML = today.toLocaleString("en-US", {month : "short"});
```

<br>

(3) toDoContent í¼íƒœê·¸ì—ì„œ serialize ì™œ ì•ˆë˜ëŠ”ì§€? âœ”  
ajax ë°ì´í„° ì½ëŠ” ë¶€ë¶„ì—ì„œ `data : $(formId).serialize()` ì´ë ‡ê²Œ jqueryë¡œ ë°›ëŠ”ë°  
```
    $("#input-data").click(function(){
        readForm("toDoList", "/toDoList");
        console.log("input btn is clicked + ajax");
    })
```
toDoList ì•ì— `#`ì´ ë¹ ì ¸ì„œ ì•ˆëœê±°ì˜€ë‹¤  

<br>

(4) selectedDateëŠ” ì–´ë””ì„œ ì˜¨ê²ƒì¸ì§€ í™•ì¸ âœ”  
ì¸í…”ë¦¬ì œì´ í„°ë¯¸ë„ì— ìê¾¸ selectedDateê°€ ì°í˜”ë‹¤  
ì•Œê³ ë³´ë‹ˆ calendar í˜ì´ì§€ë¥¼ ë¡œë“œí•  ë•Œ ì‘ë™í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ syso ì•ˆì§€ìš´ê²ƒì´ì—ˆë‹¤!  

<br>

- ë°±  
(1) ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ajaxì—ì„œ ì˜¨ ë°ì´í„° ì˜ ë°›ì•„ì§€ë©´  
![image](https://user-images.githubusercontent.com/86642180/168484936-29b0288a-e3a1-4fcd-8736-2520cc0a595e.png)  
ì„±ê³µ!  

<br>

(2) CalendarMapper.xml ì¿¼ë¦¬ ì‘ì„± ë’¤ í…ŒìŠ¤íŠ¸  
![image](https://user-images.githubusercontent.com/86642180/168485104-761a8f81-f5c9-48e0-a00a-d0ccf921db0c.png)  
![image](https://user-images.githubusercontent.com/86642180/168485118-cd968896-b375-4dfe-ad38-a78524c2ed8f.png)  
ì„±ê³µ!  

<br>

### ì½”ë“œ  
- CalendarMapper.xml  
```
    <insert id="inputTodoList" parameterType="hashMap">
        INSERT INTO to_do(
                          to_do_code,
                          member_code,
                          to_do_content,
                          set_up_date,
                          to_do_state,
                          to_do_color,
                          done_date,
                          plan_date
        )
        VALUES(
               (select IFNULL(MAX(a.to_do_code), 0) + 1 FROM to_do a),
               2,
               #{toDoContent},
               #{setUpDate},
               0,
               #{toDoColor},
               0000-00-00,
               #{planDate}
              )
    </insert>
```
- CalendarMapper.java  
```
@Mapper
@Repository
public interface CalendarMapper {
    List<Todo> getTodoList(String selectedDate);
    void inputTodoList(Map<String, String> params);
}
```
- CalendarServiceImpl.java  
```
@Service
@RequiredArgsConstructor
public class CalendarServiceImpl implements CalendarService {

    private final CalendarMapper calendarMapper;

    @Override
    public List<Todo> getTodoList(String selectedDate){
        return calendarMapper.getTodoList(selectedDate);
    }

    @Override
    public void inputTodoList(Map<String, String> params) throws ParseException {
        calendarMapper.inputTodoList(params);
    }
}
```
- CalendarService.java  
```
package com.project.smallbeginjava11.service;

import com.project.smallbeginjava11.DTO.Todo;

import java.text.ParseException;
import java.util.List;
import java.util.Map;

public interface CalendarService {
    List<Todo> getTodoList(String selectedDate);
    void inputTodoList(Map<String, String> map) throws ParseException;
}
```
- CalendarController.java  
```
    @Transactional
    @RequestMapping(value="/toDoList", produces="text/html;charset=UTF-8")
    @ResponseBody
    @PostMapping
    public String toDoListInsert(@RequestParam Map<String, String> params) throws ParseException {

        System.out.println("toDoListInsert");

        for (String key : params.keySet()) {
            System.out.println(key + " : " + params.get(key));
        }

        calendarService.inputTodoList(params);

        return "success";
    }
```
